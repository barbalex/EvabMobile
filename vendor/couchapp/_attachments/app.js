(function e (t, n, r) {function s (o, u) {if(!n[o]) {if(!t[o]) {var a = typeof require == 'function' && require;if(!u && a)return a(o, !0);if(i)return i(o, !0);var f = new Error("Cannot find module '" + o + "'");throw f.code = 'MODULE_NOT_FOUND', f}var l = n[o] = {exports: {}};t[o][0].call(l.exports, function (e) {var n = t[o][1][e];return s(n? n: e)}, l, l.exports, e, t, n, r)}return n[o].exports}var i = typeof require == 'function' && require; for (var o = 0;o < r.length;o++)s(r[o]);return s})({'./vendor/couchapp/_attachments/evab.js': [function (require, module, exports) {
    /*
    Diese Funktionen werden in evab auf mehreren Seiten benutzt
    */

    window.em = window.em || {}

    /*
     * dieser Code war der Versuch, Models einzuführen
     * zwischenzeitlich aufgegeben (stattdessen in neuem Projekt)

    window.em.sync = require('./modules/dbSync')

    var BeobEinfachListe = require('./modules/BeobEinfachListe')
        , testData = require('./test_data/beobEinfachListe.json')

    window.em.beobEinfachListe = new BeobEinfachListe(testData.rows)
    */

    window.em.melde = function (Meldung) {
      'use strict'
      $("<div id='meldung' data-role='popup' class='ui-content' data-overlay-theme='a'><a href='#' data-rel='back' class='ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right'>Close</a>" + Meldung + '</div>')
        .css({'line-height': '95%', 'font-weight': 'bold'})
        .appendTo($.mobile.pageContainer)
      $('#meldung').popup({
        afterclose: function () {
          // Meldung wieder aus pageContainer entfernen
          $('#meldung').remove()
        }
      }).popup('open')
    }

    // wird in FeldEdit.html verwendet
    window.em.geheZurueckFE = function () {
      'use strict'
      window.em.leereStorageFeldEdit()
      if (window.localStorage.zurueck && window.localStorage.zurueck !== 'FelderWaehlen.html') {
        // via die Feldliste zurück
        window.em.leereStorageFeldEdit()
        $.mobile.navigate('FeldListe.html')
      } else if (window.localStorage.zurueck && window.localStorage.zurueck === 'FelderWaehlen.html') {
        // direkt zurück, Feldliste auslassen
        window.em.leereStorageFeldEdit()
        window.em.leereStorageFeldListe()
        // TODO: Geht zwar richtig zurück. Springt dann aber direkt zur BeobListe.html!
        $.mobile.navigate('FelderWaehlen.html')
        delete window.localStorage.zurueck
      } else {
        // uups, kein zurück vorhanden
        window.em.leereAlleVariabeln()
        $.mobile.navigate('BeobListe.html')
      }
    }

    // Neue Beobachtungen werden gespeichert
    // ausgelöst durch BeobListe.html, BeobEdit.html, hArtListe.html oder hArtEdit.html
    // aufgerufen bloss von Artenliste.html
    window.em.speichereNeueBeob = function (aArtBezeichnung) {
      'use strict'
      var doc = {},
        erstelleNeuesDatum = require('./util/erstelleNeuesDatum'),
        erstelleNeueUhrzeit = require('./util/erstelleNeueUhrzeit')
      doc.User = window.localStorage.Email
      doc.aAutor = window.localStorage.Autor
      doc.aArtGruppe = window.localStorage.aArtGruppe
      // delete window.localStorage.aArtGruppe
      doc.aArtName = aArtBezeichnung
      doc.aArtId = window.localStorage.aArtId
      if (window.localStorage.Von === 'hArtListe' || window.localStorage.Von === 'hArtEdit') {
        doc.Typ = 'hArt'
        doc.hProjektId = window.localStorage.ProjektId
        doc.hRaumId = window.localStorage.RaumId
        doc.hOrtId = window.localStorage.OrtId
        doc.hZeitId = window.localStorage.ZeitId
        doc.aArtId = window.localStorage.aArtId
        window.em.speichereNeueBeob_02(doc)
      } else {
        // window.localStorage.Von == "BeobListe" || window.localStorage.Von == "BeobEdit"
        doc.Typ = 'Beobachtung'
        doc.zDatum = erstelleNeuesDatum()
        doc.zUhrzeit = erstelleNeueUhrzeit()
        window.em.speichereNeueBeob_02(doc)
      }
    }

    // Neue Beobachtungen werden gespeichert
    // ausgelöst durch BeobListe.html, BeobEdit.html, hArtListe.html oder hArtEdit.html
    // dies ist der letzte Schritt:
    // Autor anfügen und weiter zum Edit-Formular
    window.em.speichereNeueBeob_02 = function (doc) {
      'use strict'
      var $db = $.couch.db('evab')
      $db.saveDoc(doc, {
        success: function (data) {
          var row_objekt = {}
          // doc um id und rev ergänzen
          doc._id = data.id
          doc._rev = data.rev
          if (doc.Typ === 'hArt') {
            // Variabeln verfügbar machen
            window.localStorage.hArtId = data.id
            // damit hArtEdit.html die hArt nicht aus der DB holen muss
            window.em.hArt = doc
            window.localStorage.aArtId = window.em.hArt.aArtId
            window.localStorage.aArtName = window.em.hArt.aArtName
            window.localStorage.aArtGruppe = window.em.hArt.aArtGruppe
            // window.em.hArtListe ergänzen, damit bei der nächsten Art kontrolliert werden kann, ob sie schon erfasst wurde
            row_objekt.id = data.id
            row_objekt.doc = doc
            // Vorsicht: window.em.hArtListe existiert nicht, wenn in hArtEdit F5 gedrückt wurde!
            if (window.em.hArtListe && window.em.hArtListe.rows) {
              window.em.hArtListe.rows.push(row_objekt)
              // jetzt die Liste neu sortieren
              window.em.hArtListe.rows = _.sortBy(window.em.hArtListe.rows, function (row) {
                return row.doc.aArtName
              })
            }
            if (window.localStorage.hArtSicht === 'liste') {
              $.mobile.navigate('hArtEditListe.html')
            } else {
              $.mobile.navigate('hArtEdit.html')
            }
          } else {
            // Variabeln verfügbar machen
            window.localStorage.BeobId = data.id
            // damit BeobEdit.html die Beob nicht aus der DB holen muss
            window.em.Beobachtung = doc
            // Globale Variablen für BeobListe zurücksetzen, damit die Liste beim nächsten Aufruf neu aufgebaut wird
            window.em.leereStorageBeobListe()
            $.mobile.navigate('BeobEdit.html')
          }
        },
        error: function () {
          window.em.melde('Beobachtung nicht gespeichert.')
        }
      })
    }

    // Speichert, wenn in BeobEdit oder hArtEdit eine neue Art und ev. auch eine neue Artgruppe gewählt wurde
    // erwartet window.localStorage.Von = von welchem Formular aufgerufen wurde
    window.em.speichereBeobNeueArtgruppeArt = function (aArtName) {
      'use strict'
      var docId
      if (window.localStorage.Von === 'BeobListe' || window.localStorage.Von === 'BeobEdit') {
        docId = window.localStorage.BeobId
      } else {
        docId = window.localStorage.hArtId
      }
      var $db = $.couch.db('evab')
      $db.openDoc(docId, {
        success: function (beob) {
          if (window.localStorage.aArtGruppe) {
            beob.aArtGruppe = window.localStorage.aArtGruppe
          }
          beob.aArtName = aArtName
          beob.aArtId = window.localStorage.aArtId
          $db.saveDoc(beob, {
            success: function (data) {
              if (window.localStorage.Von === 'BeobListe' || window.localStorage.Von === 'BeobEdit') {
                // Variabeln verfügbar machen
                window.localStorage.BeobId = docId
                // Globale Variablen für BeobListe zurücksetzen, damit die Liste beim nächsten Aufruf neu aufgebaut wird
                window.em.leereStorageBeobListe()
                $.mobile.navigate('BeobEdit.html')
              } else {
                // Variabeln verfügbar machen
                window.localStorage.hArtId = docId
                // damit hArtEdit.html die hArt nicht aus der DB holen muss
                window.em.hArt = data
                window.localStorage.aArtId = window.em.hArt.aArtId
                window.localStorage.aArtName = window.em.hArt.aArtName
                window.localStorage.aArtGruppe = window.em.hArt.aArtGruppe
                // window.em.hArtListe anpassen
                // Vorsicht: window.em.hArtListe existiert nicht, wenn in hArtEdit F5 gedrückt wurde!
                if (window.em.hArtListe && window.em.hArtListe.rows) {
                  _.each(window.em.hArtListe.rows, function (row) {
                    var hArt = row.doc
                    if (hArt._id == docId) {
                      hArt.aArtGruppe = window.localStorage.aArtGruppe
                      hArt.aArtName = aArtName
                      hArt.aArtId = window.localStorage.aArtId
                    }
                  })
                  // window.em.hArtListe neu sortieren
                  window.em.hArtListe.rows = _.sortBy(window.em.hArtListe.rows, function (row) {
                    return row.doc.aArtName
                  })
                }
                delete window.localStorage.aArtGruppe
                if (window.localStorage.hArtSicht === 'liste') {
                  $.mobile.navigate('hArtEditListe.html')
                } else {
                  $.mobile.navigate('hArtEdit.html')
                }
              }
            },
            error: function () {
              window.em.melde('Fehler: Beobachtung nicht gespeichert')
            }
          })
        }
      })
    }

    window.em.erstelleNeueZeit = function () {
      'use strict'
      // Neue Zeiten werden erstellt
      // ausgelöst durch hZeitListe.html oder hZeitEdit.html
      // dies ist der erste Schritt: doc bilden
      var doc = {},
        $hZeitEdit = $('#hZeitEdit'),
        erstelleNeuesDatum = require('./util/erstelleNeuesDatum'),
        erstelleNeueUhrzeit = require('./util/erstelleNeueUhrzeit')
      doc.Typ = 'hZeit'
      doc.User = window.localStorage.Email
      doc.hProjektId = window.localStorage.ProjektId
      doc.hRaumId = window.localStorage.RaumId
      doc.hOrtId = window.localStorage.OrtId
      doc.zDatum = erstelleNeuesDatum()
      doc.zUhrzeit = erstelleNeueUhrzeit()
      // an hZeitEdit.html übergeben
      window.em.hZeit = doc
      // Variabeln verfügbar machen
      delete window.localStorage.ZeitId
      window.localStorage.Status = 'neu'
      // Globale Variablen für ZeitListe zurücksetzen, damit die Liste beim nächsten Aufruf neu aufgebaut wird
      delete window.em.ZeitListe
      // Vorsicht: Von hZeitEdit.html aus samepage transition!
      if ($hZeitEdit.length > 0 && $hZeitEdit.attr('data-url') !== 'hZeitEdit') {
        // Wenn die data-url ein Pfad ist, verursacht changePage einen Fehler: b.data("page") is undefined
        // das Objekt muss über die window.localStorage übermittelt werden
        window.localStorage.hZeit = JSON.stringify(window.em.hZeit)
        window.open('hZeitEdit.html', '_self')
      } else if ($hZeitEdit.length > 0 && $hZeitEdit.attr('data-url') === 'hZeitEdit') {
        // $(":mobile-pagecontainer").pagecontainer("change", "#hZeitEdit.html", { allowSamePageTransition : true });    FUNKTIONIERT NICHT
        window.localStorage.hZeit = JSON.stringify(window.em.hZeit)
        window.open('hZeitEdit.html', '_self')
      } else {
        $.mobile.navigate('hZeitEdit.html')
      }
    }

    // erstellt einen neuen Ort
    // wird aufgerufen von: hOrtEdit.html, hOrtListe.html
    // erwartet Username, hProjektId, hRaumId
    window.em.erstelleNeuenOrt = function () {
      'use strict'
      var doc = {},
        $hOrtEdit = $('#hOrtEdit')
      doc.Typ = 'hOrt'
      doc.User = window.localStorage.Email
      doc.hProjektId = window.localStorage.ProjektId
      doc.hRaumId = window.localStorage.RaumId
      // an hOrtEdit.html übergeben
      window.em.hOrt = doc
      // Variabeln verfügbar machen
      delete window.localStorage.OrtId
      // Globale Variablen für OrtListe zurücksetzen, damit die Liste beim nächsten Aufruf neu aufgebaut wird
      window.em.leereStorageOrtListe('mitLatLngListe')
      window.localStorage.Status = 'neu'	// das löst bei initiiereOrtEdit die Verortung aus
      // Vorsicht: Von hOrtEdit.html aus samepage transition!
      if ($hOrtEdit.length > 0 && $hOrtEdit.attr('data-url') !== 'hOrtEdit') {
        // Wenn die data-url ein Pfad ist, verursacht changePage einen Fehler: b.data("page") is undefined
        // das Objekt muss über die window.localStorage übermittelt werden
        window.localStorage.hOrt = JSON.stringify(window.em.hOrt)
        window.open('hOrtEdit.html', '_self')
      } else if ($hOrtEdit.length > 0 && $hOrtEdit.attr('data-url') === 'hOrtEdit') {
        // $(":mobile-pagecontainer").pagecontainer("change", "#hOrtEdit.html", {allowSamePageTransition : true})    FUNKTIONIERT NICHT
        window.localStorage.hOrt = JSON.stringify(window.em.hOrt)
        window.open('hOrtEdit.html', '_self')
      } else {
        $.mobile.navigate('hOrtEdit.html')
      }
    }

    window.em.erstelleNeuenRaum = function () {
      'use strict'
      var doc = {},
        $hRaumEdit = $('#hRaumEdit')
      doc.Typ = 'hRaum'
      doc.User = window.localStorage.Email
      doc.hProjektId = window.localStorage.ProjektId
      // in Objekt speichern, das an hRaumEdit.html übergeben wird
      window.em.hRaum = doc
      // Variabeln verfügbar machen
      delete window.localStorage.RaumId
      window.localStorage.Status = 'neu'
      // Globale Variablen für RaumListe zurücksetzen, damit die Liste beim nächsten Aufruf neu aufgebaut wird
      window.em.leereStorageRaumListe('mitLatLngListe')
      // Vorsicht: Von hRaumEdit.html aus same page transition!
      if ($hRaumEdit.length > 0 && $hRaumEdit.attr('data-url') !== 'hRaumEdit') {
        // Wenn die data-url ein Pfad ist, verursacht changePage einen Fehler: b.data("page") is undefined
        // das Objekt muss über die window.localStorage übermittelt werden
        window.localStorage.hRaum = JSON.stringify(window.em.hRaum)
        window.open('hRaumEdit.html', '_self')
      } else if ($hRaumEdit.length > 0 && $hRaumEdit.attr('data-url') === 'hRaumEdit') {
        // $(":mobile-pagecontainer").pagecontainer("change", "#hRaumEdit.html", {allowSamePageTransition : "true"})   FUNKTIONIERT NICHT
        window.localStorage.hRaum = JSON.stringify(window.em.hRaum)
        window.open('hRaumEdit.html', '_self')
      } else {
        $.mobile.navigate('hRaumEdit.html')
      }
    }

    // erstellt ein Objekt für ein neues Projekt und öffnet danach hProjektEdit.html
    // das Objekt wird erst von initiiereProjektEdit gespeichert (einen DB-Zugriff sparen)
    window.em.erstelleNeuesProjekt = function () {
      'use strict'
      var doc = {},
        $hProjektEdit = $('#hProjektEdit')
      doc.Typ = 'hProjekt'
      doc.User = window.localStorage.Email
      // damit hProjektEdit.html die hArt nicht aus der DB holen muss
      window.em.hProjekt = doc
      // ProjektId faken, sonst leitet die edit-Seite an die oberste Liste weiter
      delete window.localStorage.ProjektId
      window.localStorage.Status = 'neu'
      // Globale Variablen für hProjektListe zurücksetzen, damit die Liste beim nächsten Aufruf neu aufgebaut wird
      window.em.leereStorageProjektListe('mitLatLngListe')
      // Vorsicht: Von hProjektEdit.html aus same page transition!
      if ($hProjektEdit.length > 0 && $hProjektEdit.attr('data-url') !== 'hProjektEdit') {
        // Wenn die data-url ein Pfad ist, verursacht changePage einen Fehler: b.data("page") is undefined
        // das Objekt muss über die window.localStorage übermittelt werden
        window.localStorage.hProjekt = JSON.stringify(window.em.hProjekt)
        window.open('hProjektEdit.html', '_self')
      } else if ($hProjektEdit.length > 0 && $hProjektEdit.attr('data-url') === 'hProjektEdit') {
        // $.mobile.navigate($hProjektEdit, {allowSamePageTransition: true})    FUNKTIONIERT NICHT
        window.localStorage.hProjekt = JSON.stringify(window.em.hProjekt)
        window.open('hProjektEdit.html', '_self')
      } else {
        $.mobile.navigate('hProjektEdit.html')
      }
    }

    window.em.öffneMeineEinstellungen = function () {
      'use strict'
      $.mobile.navigate('UserEdit.html')
    }

    window.em.löscheDokument = function (DocId) {
      'use strict'
      var $db = $.couch.db('evab')
      return $db.openDoc(DocId, {
        success: function (document) {
          $db.removeDoc(document, {
            success: function () {
              return true
            },
            error: function () {
              return false
            }
          })
        },
        error: function () {
          return false
        }
      })
    }

    // initiiert Variabeln, fixe Felder und dynamische Felder in BeobEdit.html
    // wird aufgerufen von BeobEdit.html und Felder_Beob.html
    window.em.initiiereBeobEdit = function () {
      'use strict'
      // Anhänge ausblenden, weil sie sonst beim Wechsel stören
      // $('#AnhängeBE').hide()
      // prüfen, ob die Feldliste schon geholt wurde
      // wenn ja: deren globale Variable verwenden
      if (window.em.FeldlisteBeobEdit) {
        window.em.initiiereBeobEdit_2()
      } else {
        // das dauert länger - hinweisen
        $('#BeobEditFormHtml').html('<p class="HinweisDynamischerFeldaufbau">Die Felder werden aufgebaut...</p>')
        // holt die Feldliste aus der DB
        var $db = $.couch.db('evab')
        $db.view('evab/FeldListeBeob?include_docs=true', {
          success: function (data) {
            // Globale Variable erstellen, damit ab dem zweiten mal die vorige Abfrage gespaart werden kann
            window.em.FeldlisteBeobEdit = data
            window.em.initiiereBeobEdit_2()
          }
        })
      }
    }

    // allfällige Beob übernehmen von speichereNeueBeob
    // um die DB-Abfrage zu sparen
    window.em.initiiereBeobEdit_2 = function () {
      'use strict'
      // achtung: wenn soeben die Art geändert wurde, müssen ArtId und ArtName neu geholt werden
      if (window.em.Beobachtung && (!window.localStorage.Von || window.localStorage.Von !== 'BeobEdit')) {
        window.em.initiiereBeobEdit_3()
      } else {
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.BeobId, {
          success: function (data) {
            window.em.Beobachtung = data
            window.em.initiiereBeobEdit_3()
          }
        })
      }
    }

    window.em.initiiereBeobEdit_3 = function () {
      'use strict'
      // diese (globalen) Variabeln werden in BeobEdit.html gebraucht
      // bei neuen Beob hat das Objekt noch keine ID
      if (window.em.Beobachtung._id) {
        window.localStorage.BeobId = window.em.Beobachtung._id
      } else {
        window.localStorage.BeobId = 'neu'
      }
      window.localStorage.aArtGruppe = window.em.Beobachtung.aArtGruppe
      window.localStorage.aArtName = window.em.Beobachtung.aArtName
      window.localStorage.aArtId = window.em.Beobachtung.aArtId
      window.localStorage.oLongitudeDecDeg = window.em.Beobachtung.oLongitudeDecDeg || ''
      window.localStorage.oLatitudeDecDeg = window.em.Beobachtung.oLatitudeDecDeg || ''
      window.localStorage.oLagegenauigkeit = window.em.Beobachtung.oLagegenauigkeit || ''
      window.localStorage.oXKoord = window.em.Beobachtung.oXKoord
      window.localStorage.oYKoord = window.em.Beobachtung.oYKoord
      window.em.setzeFixeFelderInBeobEdit(window.em.Beobachtung)
      window.em.erstelleDynamischeFelderBeobEdit()
      window.em.blendeMenus()
      // letzte url speichern - hier und nicht im pageshow, damit es bei jedem Datensatzwechsel passiert
      window.em.speichereLetzteUrl()
    }

    // generiert in BeobEdit.html dynamisch die von den Sichtbarkeits-Einstellungen abhängigen Felder
    // und aktualisiert die Links für pagination
    // Mitgeben: id der Beobachtung, Username
    window.em.erstelleDynamischeFelderBeobEdit = function () {
      'use strict'
      var htmlContainer = window.em.generiereHtmlFürBeobEditForm()
      // Linie nur anfügen, wenn Felder erstellt wurden
      if (htmlContainer) {
        htmlContainer = '<hr />' + htmlContainer
      } else {
        htmlContainer = ''
      }
      // nötig, weil sonst die dynamisch eingefügten Elemente nicht erscheinen (Felder) bzw. nicht funktionieren (links)
      $('#BeobEditFormHtml').html(htmlContainer).trigger('create').trigger('refresh')
      // jetzt alle Flipswitsches, die "nein" sind, aktiv setzen
      window.em.aktiviereFlipswitches('#BeobEditFormHtml', window.em.Beobachtung)

      $('#BeobEdit').trigger('create').trigger('refresh')
    }

    // setzt die Values in die hart codierten Felder im Formular BeobEdit.html
    // erwartet das Objekt Beob, welches die Werte enthält
    window.em.setzeFixeFelderInBeobEdit = function () {
      'use strict'
      var $aArtGruppeBE = $('#aArtGruppeBE'),
        $aArtNameBE = $('#aArtNameBE')
      $aArtGruppeBE.selectmenu()
      $aArtGruppeBE.html("<option value='" + window.em.Beobachtung.aArtGruppe + "'>" + window.em.Beobachtung.aArtGruppe + '</option>')
      $aArtGruppeBE.val(window.em.Beobachtung.aArtGruppe)
      // JQUERY MOBILE BRACHT MANCHMAL LANGE UM ZU INITIALIIEREN
      // OHNE TIMEOUT REKLAMIERT ES BEIM REFRESH, DAS WIDGET SEI NOCH NICHT INITIALISIERT!!!!
      // NACH EIN MAL VERZÖGERN HAT ES ABER WIEDER FUNKTIONIERT????!!!!
      setTimeout(function () {
        $aArtGruppeBE.selectmenu('refresh')
      }, 0)
      $aArtNameBE.selectmenu()
      $aArtNameBE.html("<option value='" + window.em.Beobachtung.aArtName + "'>" + window.em.Beobachtung.aArtName + '</option>')
      $aArtNameBE.val(window.em.Beobachtung.aArtName)
      $aArtNameBE.selectmenu('refresh')
      $("[name='aAutor']").val(window.em.Beobachtung.aAutor)
      $("[name='oXKoord']").val(window.em.Beobachtung.oXKoord)
      $("[name='oYKoord']").val(window.em.Beobachtung.oYKoord)
      $("[name='oLagegenauigkeit']").val(window.em.Beobachtung.oLagegenauigkeit)
      $("[name='zDatum']").val(window.em.Beobachtung.zDatum)
      $("[name='zUhrzeit']").val(window.em.Beobachtung.zUhrzeit)
    }

    // generiert das Html für das Formular in BeobEdit.html
    // erwartet Feldliste als Objekt; Beob als Objekt, Artgruppe
    // der htmlContainer wird zurück gegeben
    window.em.generiereHtmlFürBeobEditForm = function () {
      'use strict'
      var htmlContainer = '',
        ArtGruppe = window.em.Beobachtung.aArtGruppe,
        FeldWert
      _.each(window.em.FeldlisteBeobEdit.rows, function (row) {
        var Feld = row.doc,
          FeldName = Feld.FeldName
        // nur sichtbare eigene Felder. Bereits im Formular integrierte Felder nicht anzeigen
        if ((Feld.User === window.localStorage.Email || Feld.User === 'ZentrenBdKt') && Feld.SichtbarImModusEinfach.indexOf(window.localStorage.Email) !== -1 && ['aArtGruppe', 'aArtName', 'aAutor', 'aAutor', 'oXKoord', 'oYKoord', 'oLagegenauigkeit', 'zDatum', 'zUhrzeit'].indexOf(FeldName) === -1) {
          // In Hierarchiestufe Art muss die Artgruppe im Feld Artgruppen enthalten sein
          // vorsicht: Erfasst jemand ein Feld der Hierarchiestufe Art ohne Artgruppe, sollte das keinen Fehler auslösen
          if (Feld.Hierarchiestufe !== 'Art' || (typeof Feld.ArtGruppe !== 'undefined' && (Feld.ArtGruppe.indexOf(ArtGruppe) >= 0 || Feld.ArtGruppe[0] === 'alle'))) {
            if (window.localStorage.Status === 'neu' && Feld.Standardwert && Feld.Standardwert[window.localStorage.Email]) {
              FeldWert = Feld.Standardwert[window.localStorage.Email]
              // Objekt Beob um den Standardwert ergänzen, um später zu speichern
              window.em.Beobachtung[FeldName] = FeldWert
            } else {
              // "" verhindert die Anzeige von undefined im Feld
              FeldWert = window.em.Beobachtung[FeldName] || ''
            }
            htmlContainer += window.em.generiereHtmlFürFormularelement(Feld, FeldWert)
          }
        }
      })
      if (window.localStorage.Status === 'neu') {
        // in neuen Datensätzen dynamisch erstellte Standardwerte speichern
        var $db = $.couch.db('evab')
        $db.saveDoc(window.em.Beobachtung, {
          success: function (data) {
            window.em.Beobachtung._id = data.id
            window.em.Beobachtung._rev = data.rev
            window.localStorage.BeobId = data.id
            window.em.GetGeolocation(data.id, 'Beobachtung')
          }
        })
        delete window.localStorage.Status
      } else {
        // Neue Datensätze haben keine Attachments
        window.em.zeigeAttachments(window.em.Beobachtung, 'BE')
      }
      return htmlContainer
    }

    // BeobListe in BeobList.html vollständig neu aufbauen
    window.em.initiiereBeobliste = function () {
      'use strict'
      // hat BeobEdit.html eine BeobListe übergeben?
      if (window.em.BeobListe) {
        // Beobliste aus globaler Variable holen - muss nicht geparst werden
        window.em.initiiereBeobliste_2()
      } else {
        // Beobliste aus DB holen
        var $db = $.couch.db('evab')
        $db.view('evab/BeobListe?startkey=["' + window.localStorage.Email + '",{}]&endkey=["' + window.localStorage.Email + '"]&descending=true&include_docs=true', {
          success: function (data) {
            // BeobListe für BeobEdit bereitstellen
            window.em.BeobListe = data
            window.em.initiiereBeobliste_2()
          }
        })
      }
    }

    window.em.initiiereBeobliste_2 = function () {
      'use strict'
      var anzBeob = window.em.BeobListe.rows.length,
        beob,
        key,
        listItemContainer = '',
        Titel2,
        artgruppenname

      // Im Titel der Seite die Anzahl Beobachtungen anzeigen
      Titel2 = ' Beobachtungen'
      if (anzBeob === 1) {
        Titel2 = ' Beobachtung'
      }
      $('#BeobListePageHeader')
        .find('.BeobListePageTitel')
        .text(anzBeob + Titel2)

      if (anzBeob === 0) {
        listItemContainer = '<li><a href="#" class="erste NeueBeobBeobListe">Erste Beobachtung erfassen</a></li>'
      } else {
        _.each(window.em.BeobListe.rows, function (row) {
          beob = row.doc
          key = row.key
          artgruppenname = encodeURIComponent(beob.aArtGruppe.replace('ü', 'ue').replace('ä', 'ae').replace('ö', 'oe')) + '.png'
          if (beob.aArtGruppe === 'DiverseInsekten') {
            artgruppenname = 'unbenannt.png'
          }
          listItemContainer += "<li class='beob ui-li-has-thumb' id='"
          listItemContainer += beob._id
          listItemContainer += "'><a href='#'><img class='ui-li-thumb' src='"
          listItemContainer += 'Artgruppenbilder/' + artgruppenname
          listItemContainer += "' /><h3 class='aArtName'>"
          listItemContainer += beob.aArtName
          listItemContainer += "<\/h3><p class='zUhrzeit'>"
          listItemContainer += beob.zDatum
          listItemContainer += '&nbsp; &nbsp;'
          listItemContainer += beob.zUhrzeit
          listItemContainer += '<\/p><\/a> <\/li>'
        })
      }
      $('#BeoblisteBL')
        .html(listItemContainer)
        .listview('refresh')
      window.em.blendeMenus()
      // Fokus in das Suchfeld setzen
      $('#BeobListe')
        .find('.ui-input-search')
        .children('input')[0]
        .focus()
      window.em.speichereLetzteUrl()
    }

    // löscht Anhänge
    // erwartet den Datensatz als Objekt und das Objekt, dass geklickt wurde
    window.em.löscheAnhang = function (that, Objekt, id) {
      'use strict'
      if (Objekt) {
        // Es wurde ein Objekt übergeben, keine DB-Abfrage nötig
        window.em.löscheAnhang_2(that, Objekt)
      } else {
        // Objekt aus der DB holen
        var $db = $.couch.db('evab')
        $db.openDoc(id, {
          success: function (data) {
            window.em[Objekt.Typ] = data
            window.em.löscheAnhang_2(that, window.em[Objekt.Typ])
          },
          error: function () {
            window.em.melde('Fehler: Anhang wurde nicht entfernt')
          }
        })
      }
    }

    window.em.löscheAnhang_2 = function (that, Objekt) {
      'use strict'
      var Dateiname = that.id
      // Anhang aus Objekt entfernen
      delete window.em[Objekt.Typ]._attachments[Dateiname]
      // Objekt in DB speichern
      $db.saveDoc(window.em[Objekt.Typ], {
        success: function (data) {
          // rev im Objekt ergänzen
          // die globale Variable heisst gleich, wie der Typ im Objekt
          window.em[Objekt.Typ]._rev = data.rev
          // im Formular den Anhang und die Lösch-Schaltfläche entfernen
          $(that).parent().parent().remove()
        },
        error: function () {
          window.em.melde('Fehler: Anhänge werden nicht richtig angezeigt')
        }
      })
    }

    // initiiert UserEdit.html
    window.em.initiiereUserEdit = function () {
      'use strict'
      $('#ue_Email').val(window.localStorage.Email)
      $("[name='Datenverwendung']").checkboxradio()
      if (window.localStorage.Autor) {
        $('#Autor').val(window.localStorage.Autor)
      }
      $.couch.userDb(function (db) {
        db.openDoc('org.couchdb.user:' + window.localStorage.Email, {
          success: function (User) {
            // fixe Felder aktualisieren
            if (User.Datenverwendung) {
              $('#' + User.Datenverwendung).prop('checked', true).checkboxradio('refresh')
              window.localStorage.Datenverwendung = User.Datenverwendung
            } else {
              // Standardwert setzen
              $('#JaAber').prop('checked', true).checkboxradio('refresh')
            }
            window.em.blendeMenus()
            window.em.speichereLetzteUrl()
          },
          error: function () {
            console.log('Fehler in window.em.initiiereUserEdit')
            // Standardwert setzen
            $('#JaAber').prop('checked', true).checkboxradio('refresh')
          }
        })
      })
    }

    // initiiert Installieren.html
    // kurz, da keine Daten benötigt werden
    window.em.initiiereInstallieren = function () {
      'use strict'
      window.em.blendeMenus()
      window.em.speichereLetzteUrl()
    }

    // generiert in hProjektEdit.html dynamisch die von den Sichtbarkeits-Einstellungen abhängigen Felder
    // Mitgeben: id des Projekts, Username
    // bei neuen Projekten wird das zuvor erzeugte Projekt übernommen, um die DB-Anfrage zu sparen
    window.em.initiiereProjektEdit = function () {
      'use strict'
      // Anhänge ausblenden, weil sonst beim Einblenden diejenigen des vorigen Datensatzes aufblitzen
      // $('#AnhängehPE').hide().trigger('updatelayout')
      // window.em.hProjekt existiert schon bei neuem Projekt
      if (window.em.hProjekt) {
        window.em.initiiereProjektEdit_2()
      } else if (window.localStorage.Status === 'neu' && window.localStorage.hProjekt) {
        // wenn mit window.open von neu gekommen, existiert die globale Variable nicht mehr
        window.em.hProjekt = JSON.parse(window.localStorage.hProjekt)
        delete window.localStorage.hProjekt
        window.em.initiiereProjektEdit_2()
      } else {
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.ProjektId, {
          success: function (data) {
            window.em.hProjekt = data
            window.em.initiiereProjektEdit_2()
          },
          error: function () {
            // hoppla, zu dieser ID gibt es kein Projekt > Speicher löschen und Liste anzeigen
            window.em.leereStorageProjektEdit('mitLatLngListe')
            $.mobile.navigate('hProjektListe.html')
          }
        })
      }
    }

    window.em.initiiereProjektEdit_2 = function () {
      'use strict'
      // fixe Felder aktualisieren
      $('#pName').val(window.em.hProjekt.pName)
      // Variabeln bereitstellen (bei neuen Projekten wird ProjektId später nachgeschoben)
      if (window.em.hProjekt._id) {
        window.localStorage.ProjektId = window.em.hProjekt._id
      } else {
        window.localStorage.ProjektId = 'neu'
      }
      // prüfen, ob die Feldliste schon geholt wurde
      // wenn ja: deren globale Variable verwenden
      if (window.em.FeldlisteProjekt) {
        window.em.initiiereProjektEdit_3()
      } else {
        // das dauert länger - Hinweis einblenden
        $('#hProjektEditFormHtml').html('<p class="HinweisDynamischerFeldaufbau">Die Felder werden aufgebaut...</p>')
        // Feldliste aus der DB holen
        var $db = $.couch.db('evab')
        $db.view('evab/FeldListeProjekt?include_docs=true', {
          success: function (Feldliste) {
            window.em.FeldlisteProjekt = Feldliste
            window.em.initiiereProjektEdit_3()
          }
        })
      }
    }

    window.em.initiiereProjektEdit_3 = function () {
      'use strict'
      var htmlContainer = window.em.generiereHtmlFürProjektEditForm()
      // Linie nur anfügen, wenn Felder erstellt wurden
      if (htmlContainer) {
        htmlContainer = '<hr />' + htmlContainer
      }
      $('#hProjektEditFormHtml').html(htmlContainer).trigger('create').trigger('refresh')
      // jetzt alle Flipswitsches, die "nein" sind, aktiv setzen
      window.em.aktiviereFlipswitches('#hProjektEditFormHtml', window.em.hProjekt)
      window.em.blendeMenus()
      // letzte url speichern - hier und nicht im pageshow, damit es bei jedem Datensatzwechsel passiert
      window.em.speichereLetzteUrl()
    }

    // generiert das Html für das Formular in hProjektEdit.html
    // erwartet Feldliste als Objekt; Projekt als Objekt
    // der htmlContainer wird zurück gegeben
    window.em.generiereHtmlFürProjektEditForm = function () {
      'use strict'
      var Feld = {},
        FeldName,
        FeldWert,
        htmlContainer = ''
      _.each(window.em.FeldlisteProjekt.rows, function (row) {
        Feld = row.doc
        FeldName = Feld.FeldName
        // nur sichtbare eigene Felder. Bereits im Formular integrierte Felder nicht anzeigen
        if ((Feld.User === window.localStorage.Email || Feld.User === 'ZentrenBdKt') && Feld.SichtbarImModusHierarchisch.indexOf(window.localStorage.Email) !== -1 && FeldName !== 'pName') {
          if (window.localStorage.Status === 'neu' && Feld.Standardwert && Feld.Standardwert[window.localStorage.Email]) {
            FeldWert = Feld.Standardwert[window.localStorage.Email]
            // window.em.hProjekt um den Standardwert ergänzen, um später zu speichern
            window.em.hProjekt[FeldName] = FeldWert
          } else {
            // "" verhindert die Anzeige von undefined im Feld
            FeldWert = window.em.hProjekt[FeldName] || ''
          }
          htmlContainer += window.em.generiereHtmlFürFormularelement(Feld, FeldWert)
        }
      })
      if (window.localStorage.Status === 'neu') {
        $('#pName').focus()
        // in neuen Datensätzen dynamisch erstellte Standardwerte speichern
        var $db = $.couch.db('evab')
        $db.saveDoc(window.em.hProjekt, {
          success: function (data) {
            window.em.hProjekt._id = data.id
            window.em.hProjekt._rev = data.rev
            //
            window.localStorage.ProjektId = data.id
          }
        })
        delete window.localStorage.Status
      } else {
        // neue Datensätze haben keine Attachments
        window.em.zeigeAttachments(window.em.hProjekt, 'hPE')
      }
      return htmlContainer
    }

    // initiiert FeldEdit.html
    window.em.initiiereFeldEdit = function () {
      'use strict'
      // Bei neuem Feld gibt es Feld schon
      if (window.em.Feld) {
        window.em.initiiereFeldEdit_2()
      } else {
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.FeldId, {
          success: function (doc) {
            // Feld bereitstellen
            window.em.Feld = doc
            window.em.initiiereFeldEdit_2()
          }
        })
      }
    }

    window.em.initiiereFeldEdit_2 = function () {
      'use strict'
      var SichtbarImModusHierarchisch = window.em.Feld.SichtbarImModusHierarchisch,
        $SichtbarImModusHierarchisch = $('#SichtbarImModusHierarchisch'),
        SichtbarInHArtEditListe = window.em.Feld.SichtbarInHArtEditListe,
        $SichtbarInHArtEditListe = $('#SichtbarInHArtEditListe'),
        SichtbarImModusEinfach = window.em.Feld.SichtbarImModusEinfach,
        $SichtbarImModusEinfach = $('#SichtbarImModusEinfach'),
        Standardwert,
        $Standardwert = $('#Standardwert')

      // alle radio und checkboxen leeren (damit keine voher gewählten Werte verbleiben)
      window.em.checkAllRadiosOfForm('FeldEdit', false)

      // Sichtbarkeit anzeigen
      if (SichtbarImModusHierarchisch && SichtbarImModusHierarchisch.indexOf(window.localStorage.Email) >= 0) {
        $SichtbarImModusHierarchisch
          .val('ja')
          .parent().removeClass('ui-flipswitch-active')
      } else {
        $SichtbarImModusHierarchisch
          .val('nein')
          .parent().addClass('ui-flipswitch-active')
      }
      if (SichtbarInHArtEditListe && SichtbarInHArtEditListe.indexOf(window.localStorage.Email) >= 0) {
        $SichtbarInHArtEditListe
          .val('ja')
          .parent().removeClass('ui-flipswitch-active')
      } else {
        $SichtbarInHArtEditListe
          .val('nein')
          .parent().addClass('ui-flipswitch-active')
      }
      if (SichtbarImModusEinfach && SichtbarImModusEinfach.indexOf(window.localStorage.Email) >= 0) {
        $SichtbarImModusEinfach.val('ja')
        $SichtbarImModusEinfach.parent().removeClass('ui-flipswitch-active')
      } else {
        $SichtbarImModusEinfach.val('nein')
        $SichtbarImModusEinfach.parent().addClass('ui-flipswitch-active')
      }

      // Artgruppe Aufbauen, wenn Hierarchiestufe == Art
      if (window.em.Feld.Hierarchiestufe === 'Art') {
        window.em.ArtGruppeAufbauenFeldEdit(window.em.Feld.ArtGruppe)
      }

      // allfälligen Standardwert anzeigen
      // Standardwert ist Objekt, darin werden die Standardwerte aller Benutzer gespeichert
      // darum hier auslesen und setzen
      // Zuerst leeren Wert setzen, sonst bleibt letzter, wenn keiner existiert!
      $Standardwert.val('')
      if (window.em.Feld.Standardwert) {
        Standardwert = window.em.Feld.Standardwert[window.localStorage.Email]
        if (Standardwert) {
          $Standardwert.val(Standardwert)
        }
      }

      if (window.em.Feld.FeldName) {
        // fix in Formulare eingebaute Felder: Standardwerte ausblenden und erklären
        if (['aArtGruppe', 'aArtName'].indexOf(window.em.Feld.FeldName) > -1) {
          $Standardwert
            .attr('placeholder', 'Keine Voreinstellung möglich')
            .attr('disabled', true)
        // ausschalten, soll jetzt im Feld verwaltet werden
        /*} else if (window.em.Feld.FeldName === "aAutor") {
        	$Standardwert.attr("placeholder", 'Bitte im Menü "meine Einstellungen" voreinstellen')
        	$Standardwert.attr("disabled", true)*/
        } else if (['oXKoord', 'oYKoord', 'oLatitudeDecDeg', 'oLongitudeDecDeg', 'oLagegenauigkeit'].indexOf(window.em.Feld.FeldName) > -1) {
          $Standardwert
            .attr('placeholder', 'Lokalisierung erfolgt automatisch, keine Voreinstellung möglich')
            .attr('disabled', true)
        } else if (['zDatum', 'zUhrzeit'].indexOf(window.em.Feld.FeldName) > -1) {
          $Standardwert
            .attr('placeholder', 'Standardwert ist "jetzt", keine Voreinstellung möglich')
            .attr('disabled', true)
        }
      }
      $('.FeldEditHeaderTitel').text(window.em.Feld.Hierarchiestufe + ': ' + window.em.Feld.FeldBeschriftung)

      // Radio Felder initiieren (ausser ArtGruppe, das wird dynamisch erzeugt)
      $("input[name='Hierarchiestufe']").checkboxradio()
      $('#' + window.em.Feld.Hierarchiestufe).prop('checked', true).checkboxradio('refresh')
      $("input[name='Formularelement']").checkboxradio()
      $('#' + window.em.Feld.Formularelement).prop('checked', true).checkboxradio('refresh')
      $("input[name='InputTyp']").checkboxradio()
      $('#' + window.em.Feld.InputTyp).prop('checked', true).checkboxradio('refresh')

      // Werte in übrige Felder einfügen
      $('#FeldName').val(window.em.Feld.FeldName)
      $('#FeldBeschriftung').val(window.em.Feld.FeldBeschriftung)
      $('#FeldBeschreibung').val(window.em.Feld.FeldBeschreibung)	// Textarea - anders refreshen?
      $('#Reihenfolge').val(window.em.Feld.Reihenfolge)
      $('#FeldNameEvab').val(window.em.Feld.FeldNameEvab)
      $('#FeldNameZdsf').val(window.em.Feld.FeldNameZdsf)
      $('#FeldNameCscf').val(window.em.Feld.FeldNameCscf)
      $('#FeldNameNism').val(window.em.Feld.FeldNameNism)
      $('#FeldNameWslFlechten').val(window.em.Feld.FeldNameWslFlechten)
      $('#FeldNameWslPilze').val(window.em.Feld.FeldNameWslPilze)
      $('#Optionen').val(window.em.Feld.Optionen)	// Textarea - anders refreshen?
      $('#SliderMinimum').val(window.em.Feld.SliderMinimum)
      $('#SliderMaximum').val(window.em.Feld.SliderMaximum)

      window.em.erstelleSelectFeldFolgtNach()	// BESSER: Nur aufrufen, wenn erstaufbau oder auch Feldliste zurückgesetzt wurde
      window.em.speichereLetzteUrl()
      // abhängige Felder blenden
      window.em.blendeDatentypabhängigeFelder()
      window.em.blendeMenus()
      // Fokus auf Page richten, damit die Pagination mit den Pfeiltasten funktioniert
      $(":jqmData(role='page')").focus()
    }

    // wird von FeldEdit.html aufgerufen
    // erstellt das Selectmenu, um die Reihenfolge-Position des Felds zu bestimmen
    window.em.erstelleSelectFeldFolgtNach = function () {
      'use strict'
      // Nur bei eigenen Feldern anzeigen
      if (window.em.Feld.User !== 'ZentrenBdKt') {
        if (window.em.Feldliste) {
          // Feldliste aus globaler Variable verwenden - muss nicht geparst werden
          window.em.erstelleSelectFeldFolgtNach_2()
        } else {
          var $db = $.couch.db('evab')
          $db.view('evab/FeldListe?include_docs=true', {
            success: function (data) {
              window.em.Feldliste = data
              window.em.erstelleSelectFeldFolgtNach_2()
            }
          })
        }
      }
    }

    window.em.erstelleSelectFeldFolgtNach_2 = function () {
      'use strict'
      var tempFeld,
        optionen = [],
        htmlContainer
      optionen.push('')
      _.each(window.em.Feldliste.rows, function (row) {
        tempFeld = row.doc
        // Liste aufbauen
        // Nur eigene Felder und offizielle
        if (tempFeld.User === window.localStorage.Email || tempFeld.User === 'ZentrenBdKt') {
          optionen.push(tempFeld.FeldName)
        }
      })
      htmlContainer = window.em.generiereHtmlFürSelectmenu('FeldFolgtNach', 'Feld folgt nach:', '', optionen, 'SingleSelect')
      $('#FeldFolgtNachDiv').html(htmlContainer).trigger('create').trigger('refresh')
    }

    // wird benutzt in FeldEdit.html
    // von je einer Funktion in FeldEdit.html und evab.js
    // Funktion ist zweigeteilt, um wenn möglich Datenbankabfragen zu sparen
    window.em.ArtGruppeAufbauenFeldEdit = function (ArtGruppenArrayIn) {
      'use strict'
      if (window.em.Artgruppen) {
        // Artgruppen von globaler Variable holen
        window.em.ArtGruppeAufbauenFeldEdit_2(ArtGruppenArrayIn)
      } else if (window.localStorage.Artgruppen) {
        // Artgruppen aus window.localStorage holen und parsen
        window.em.Artgruppen = JSON.parse(window.localStorage.Artgruppen)
        window.em.ArtGruppeAufbauenFeldEdit_2(ArtGruppenArrayIn)
      } else {
        // Artgruppen aus DB holen
        var $db = $.couch.db('evab')
        $('select#ArtGruppe').empty()
        $db.view('evab/Artgruppen', {
          success: function (data) {
            window.em.Artgruppen = data
            window.localStorage.Artgruppen = JSON.stringify(data)
            window.em.ArtGruppeAufbauenFeldEdit_2(ArtGruppenArrayIn)
          }
        })
      }
    }

    window.em.ArtGruppeAufbauenFeldEdit_2 = function (ArtGruppenArrayIn) {
      'use strict'
      var ArtGruppe,
        listItemContainer = "<fieldset data-role='controlgroup'><legend>In diesen Artgruppen kann das Feld angezeigt werden (erforderlich):</legend>",
        listItem,
        ArtGruppenArray = ArtGruppenArrayIn || []
      _.each(window.em.Artgruppen.rows, function (row) {
        ArtGruppe = row.key
        listItem = "<input type='checkbox' class='custom Feldeigenschaften' name='ArtGruppe' id='"
        listItem += ArtGruppe
        listItem += "' value='"
        listItem += ArtGruppe
        if (ArtGruppenArray.indexOf(ArtGruppe) !== -1) {
          listItem += "' checked='checked"
        }
        listItem += "'/>\n<label for='"
        listItem += ArtGruppe
        listItem += "'>"
        listItem += ArtGruppe
        listItem += '</label>'
        listItemContainer += listItem
      })
      listItemContainer += '\n</fieldset>'
      $('#Artgruppenliste_FeldEdit').html(listItemContainer).trigger('create').trigger('refresh')
      $('#SichtbarInHArtEditListeFieldContain').show()
    }

    // initiiert FeldListe.html
    window.em.initiiereFeldliste = function () {
      'use strict'
      // hat FeldEdit.html eine Feldliste übergeben?
      if (window.em.Feldliste) {
        // Feldliste aus globaler Variable holen - muss nicht geparst werden
        window.em.initiiereFeldliste_2()
      } else {
        // FeldListe aus DB holen
        var $db = $.couch.db('evab')
        $db.view('evab/FeldListe?include_docs=true', {
          success: function (data) {
            window.em.Feldliste = data
            window.em.initiiereFeldliste_2()
          }
        })
      }
    }

    window.em.initiiereFeldliste_2 = function () {
      'use strict'
      var tempFeld,
        anzFelder = 0,
        ImageLink,
        listItemContainer = '',
        Hierarchiestufe,
        FeldBeschriftung,
        FeldBeschreibung
      _.each(window.em.Feldliste.rows, function (row) {
        tempFeld = row.doc
        // Liste aufbauen
        // Nur eigene Felder und offizielle
        if (tempFeld.User === window.localStorage.Email || tempFeld.User === 'ZentrenBdKt') {
          Hierarchiestufe = tempFeld.Hierarchiestufe
          FeldBeschriftung = tempFeld.FeldBeschriftung || '(ohne Feldbeschriftung)'
          FeldBeschreibung = ''
          if (tempFeld.FeldBeschreibung) {
            FeldBeschreibung = tempFeld.FeldBeschreibung
          }
          ImageLink = 'Hierarchiebilder/' + Hierarchiestufe + '.png'
          listItemContainer += "<li class='Feld ui-li-has-thumb' FeldId='"
          listItemContainer += tempFeld._id
          listItemContainer += "'><a href='#'><img class='ui-li-thumb' src='"
          listItemContainer += ImageLink + "' /><h2>"
          listItemContainer += Hierarchiestufe
          listItemContainer += ': '
          listItemContainer += FeldBeschriftung
          listItemContainer += '<\/h2><p>'
          listItemContainer += FeldBeschreibung
          listItemContainer += '</p><\/a><\/li>'
          // Felder zählen
          anzFelder += 1
        }
      })
      // Im Titel der Seite die Anzahl Beobachtungen anzeigen
      $('#FeldListeHeader')
        .find('.FeldListeTitel')
        .text(anzFelder + ' Felder')
      $('#FeldListeFL')
        .html(listItemContainer)
        .listview('refresh')
      window.em.blendeMenus()
      // Fokus in das Suchfeld setzen
      $('#FeldListePage')
        .find('.ui-input-search')
        .children('input')[0]
        .focus()
      window.em.speichereLetzteUrl()
    }

    // wird benutzt von hOrtEdit.html, BeobEdit.html und Karte.html
    // die Felder werden aus window.localStorage übernommen, die Liste ihrer Namen wird als Array FelderArray überbeben
    // die Felder werden in der DB und im übergebenen Objekt "DatensatzObjekt" gespeichert
    // und anschliessend in Formularfeldern aktualisiert
    // function speichereKoordinaten übernimmt id und den ObjektNamen
    // kontrolliert, ob das Objekt existiert
    // wenn nein wird es aus der DB geholt
    window.em.speichereKoordinaten = function (id, ObjektName) {
      'use strict'
      // kontrollieren, ob Ort oder Beob als Objekt vorliegt
      if (window.em[ObjektName]) {
        // ja: Objekt verwenden
        window.em.speichereKoordinaten_2(id, ObjektName)
      } else {
        // nein: Objekt aus DB holen
        var $db = $.couch.db('evab')
        $db.openDoc(id, {
          success: function (data) {
            window.em[ObjektName] = data
            window.em.speichereKoordinaten_2(id, ObjektName)
          },
          error: function () {
            window.em.melde('Fehler: Koordinaten nicht gespeichert')
          }
        })
      }
    }

    // setzt das DatensatzObjekt voraus
    // aktualisiert darin die Felder, welche in FelderArray aufgelistet sind
    // Variablen müssen in Objekt und window.localStorage denselben Namen verwenden
    window.em.speichereKoordinaten_2 = function (id, ObjektName) {
      'use strict'
      var FelderArray = ['oLongitudeDecDeg', 'oLongitudeDecDeg', 'oLatitudeDecDeg', 'oXKoord', 'oYKoord', 'oLagegenauigkeit', 'oHöhe', 'oHöheGenauigkeit']
      window.em.speichereFelderAusLocalStorageInObjekt(ObjektName, FelderArray, 'FormularAktualisieren')
      // nun die Koordinaten in den Zeiten und Arten dieses Objekts aktualisieren
      window.em.speichereFelderAusLocalStorageInObjektliste('ZeitenVonOrt', FelderArray, 'hOrtId', id, 'hZeitIdVonOrt')
      window.em.speichereFelderAusLocalStorageInObjektliste('ArtenVonOrt', FelderArray, 'hOrtId', id, 'hArtIdVonOrt')
    }

    // übernimmt eine Liste von Feldern und eine Objektliste (via Name)
    // sucht in der Objektliste nach den Objekten mit der BezugsId
    // aktualisiert diese Objekte
    // wird verwendet, um die Koordinaten von Orten in Zeiten und Arten zu schreiben
    // im ersten Schritt prüfen, ob die Objektliste vorhanden ist. Wenn nicht, aus DB holen
    window.em.speichereFelderAusLocalStorageInObjektliste = function (ObjektlistenName, FelderArray, BezugsIdName, BezugsIdWert, Querystring) {
      'use strict'
      if (window.em[ObjektlistenName]) {
        // vorhandene Objektliste nutzen
        window.em.speichereFelderAusLocalStorageInObjektliste_2(ObjektlistenName, FelderArray, BezugsIdName, BezugsIdWert)
      } else {
        // Objektliste aus DB holen
        var viewname = 'evab/' + Querystring + '?startkey=["' + BezugsIdWert + '"]&endkey=["' + BezugsIdWert + '",{}]&include_docs=true'
        var $db = $.couch.db('evab')
        $db.view(viewname, {
          success: function (data) {
            window.em[ObjektlistenName] = data
            window.em.speichereFelderAusLocalStorageInObjektliste_2(ObjektlistenName, FelderArray, BezugsIdName, BezugsIdWert)
          }
        })
      }
    }

    window.em.speichereFelderAusLocalStorageInObjektliste_2 = function (ObjektlistenName, FelderArray, BezugsIdName, BezugsIdWert) {
      'use strict'
      // in allen Objekten in der Objektliste
      var DsBulkListe = {},
        Docs = [],
        doc
      // nur machen, wenn rows vorhanden!
      if (window.em[ObjektlistenName].rows.length > 0) {
        _.each(window.em[ObjektlistenName].rows, function (row) {
          doc = row.doc
          // Objekte mit dem richtigen Wert in der BezugsId suchen (z.B. die richtige hOrtId)
          if (doc[BezugsIdName] && doc[BezugsIdName] === BezugsIdWert) {
            // im Objekt alle in FelderArray aufgelisteten Felder suchen
            _.each(FelderArray, function (feldname) {
              // und ihre Werte aktualisieren
              if (window.localStorage[feldname]) {
                if (window.em.myTypeOf(window.localStorage[feldname]) === 'integer') {
                  doc[feldname] = parseInt(window.localStorage[feldname], 10)
                } else if (window.em.myTypeOf(window.localStorage[feldname]) === 'float') {
                  doc[feldname] = parseFloat(window.localStorage[feldname])
                } else {
                  doc[feldname] = window.localStorage[feldname]
                }
              } else {
                delete doc[feldname]
              }
            })
            Docs.push(doc)
          }
        })
        DsBulkListe.docs = Docs
        // Objektliste in DB speichern
        $.ajax({
          type: 'POST',
          url: '../../_bulk_docs',
          contentType: 'application/json',
          data: JSON.stringify(DsBulkListe)
        }).done(function (data) {
          var objekt,
            doc
          // _rev in den Objekten in Objektliste aktualisieren
          // für alle zurückgegebenen aktualisierten Zeilen
          // offenbar muss data zuerst geparst werden ??!!
          data = JSON.parse(data)
          _.each(data, function (ds, index) {
            // das zugehörige Objekt in der Objektliste suchen
            objekt = _.find(window.em[ObjektlistenName].rows, function (row) {
              doc = row.doc
              return doc._id === data[index].id
            })
            objekt._rev = data[index].rev
          })
        })
      }
    }

    // Neue Daten liegen in window.localStorage vor
    // sie werden in Objekt und in DB geschrieben
    // Variablen müssen in Objekt und window.localStorage denselben Namen verwenden
    // FelderArray enthält eine Liste der Namen der zu aktualisierenden Felder
    // ObjektName ist der Name des zu aktualisierenden Objekts bzw. Datensatzes
    window.em.speichereFelderAusLocalStorageInObjekt = function (ObjektName, FelderArray, FormularAktualisieren) {
      'use strict'
      // Objekt aktualisieren
      _.each(FelderArray, function (feldname) {
        if (window.localStorage[feldname]) {
          if (window.em.myTypeOf(window.localStorage[feldname]) === 'integer') {
            window.em[ObjektName][feldname] = parseInt(window.localStorage[feldname], 10)
          } else if (window.em.myTypeOf(window.localStorage[feldname]) === 'float') {
            window.em[ObjektName][feldname] = parseFloat(window.localStorage[feldname])
          } else {
            window.em[ObjektName][feldname] = window.localStorage[feldname]
          }
        } else {
          delete window.em[ObjektName][feldname]
        }
      })
      // in DB speichern
      var $db = $.couch.db('evab')
      $db.saveDoc(window.em[ObjektName], {
        success: function (data) {
          window.em[ObjektName]._rev = data.rev
          if (FormularAktualisieren) {
            window.em.aktualisiereKoordinatenfelderInFormular(ObjektName)
          }
        }
      })
    }

    // übernimmt ein Objekt (via dessen Namen) und eine Liste von Feldern (FelderArray)
    // setzt in alle Felder mit den Namen gemäss FelderArray die Werte gemäss Objekt
    window.em.aktualisiereKoordinatenfelderInFormular = function (ObjektName, FelderArray) {
      'use strict'
      _.each(FelderArray, function (feldname) {
        $("[name='" + feldname + "']").val(window.em[ObjektName][feldname] || null)
      })
    }

    // dient der Unterscheidung von Int und Float
    // NICHT BENUTZT
    window.em.isInt = function (n) {
      'use strict'
      return typeof n === 'number' && parseFloat(n) == parseInt(n, 10) && !isNaN(n)
    }

    // Hilfsfunktion, die typeof ersetzt und ergänzt
    // typeof gibt bei input-Feldern immer String zurück!
    window.em.myTypeOf = function (Wert) {
      'use strict'
      if (typeof Wert === 'boolean') {
        return 'boolean'
      } else if (parseInt(Wert, 10) && parseFloat(Wert) && parseInt(Wert, 10) != parseFloat(Wert) && parseInt(Wert, 10) == Wert) {
        // es ist eine Float
        return 'float'
      } else if (parseInt(Wert, 10) == Wert) {
        // es ist eine Integer
        return 'integer'
      } else {
        // als String behandeln
        return 'string'
      }
    }

    // Übernimmt einen Feldnamen, einen feldwert
    // und eine Datensatzliste (z.B. alle Räume eines Projekts) sowie ihren Namen
    // speichert das neue Feld in alle Datensätze der Liste in der DB
    // und aktualisiert die Liste selber, damit sie das nächste mal nicht in der DB geholt werden muss
    // NICHT IM GEBRAUCH
    window.em.speichereFeldInDatensatzliste = function (Feldname, Feldwert, DatensatzlisteName) {
      'use strict'
      var DsBulkListe = {},
        Docs = [],
        doc
      // nur machen, wenn Datensätze da sind
      _.each(DatensatzlisteName.rows, function (row) {
        doc = row.doc
        if (Feldwert) {
          if (window.em.myTypeOf(Feldwert) === 'float') {
            doc[Feldname] = parseFloat(Feldwert)
          } else if (window.em.myTypeOf(Feldwert) === 'integer') {
            doc[Feldname] = parseInt(Feldwert, 10)
          } else {
            doc[Feldname] = Feldwert
          }
        } else if (doc[Feldname]) {
          delete doc[Feldname]
        }
        Docs.push(doc)
      })
      DsBulkListe.docs = Docs
      $.ajax({
        type: 'POST',
        url: '../../_bulk_docs',
        contentType: 'application/json',
        data: JSON.stringify(DsBulkListe)
      })
    }

    // löscht Datensätze in Massen
    // nimmt das Ergebnis einer Abfrage entgegen, welche im key einen Array hat
    // Array[0] ist fremde _id (mit der die Abfrage gefiltert wurde),
    // Array[1] die _id des zu löschenden Datensatzes und Array[2] dessen _rev
    window.em.loescheIdIdRevListe = function (Datensatzobjekt) {
      'use strict'
      var ObjektMitDeleteListe = {},
        Docs = []
      _.each(Datensatzobjekt.rows, function (row) {
        // unsere Daten sind im key
        var rowkey = row.key,
          Datensatz = {}
        Datensatz._id = rowkey[1]
        Datensatz._rev = rowkey[2]
        Datensatz._deleted = true
        Docs.push(Datensatz)
      })
      ObjektMitDeleteListe.docs = Docs
      $.ajax({
        type: 'POST',
        url: '../../_bulk_docs',
        contentType: 'application/json',
        data: JSON.stringify(ObjektMitDeleteListe)
      })
    }

    window.em.initiiereProjektliste = function () {
      'use strict'
      // hat hProjektEdit.html eine Projektliste übergeben?
      if (window.em.Projektliste) {
        window.em.initiiereProjektliste_2()
      } else {
        // Daten für die Projektliste aus DB holen
        var $db = $.couch.db('evab')
        $db.view('evab/hProjListe?startkey=["' + window.localStorage.Email + '"]&endkey=["' + window.localStorage.Email + '",{}]&include_docs=true', {
          success: function (data) {
            // Projektliste für hProjektEdit bereitstellen
            window.em.Projektliste = data
            window.em.initiiereProjektliste_2()
          }
        })
      }
    }

    window.em.initiiereProjektliste_2 = function () {
      'use strict'
      var anzProj = window.em.Projektliste.rows.length,
        listItem,
        listItemContainer = '',
        Titel2

      // Im Titel der Seite die Anzahl Projekte anzeigen
      Titel2 = ' Projekte'
      if (anzProj === 1) {
        Titel2 = ' Projekt'
      }
      $('#hProjektListePageHeader')
        .find('.hProjektListePageTitel')
        .text(anzProj + Titel2)

      if (anzProj === 0) {
        listItemContainer = "<li><a href='#' class='erste NeuesProjektProjektListe'>Erstes Projekt erfassen</a></li>"
      } else {
        _.each(window.em.Projektliste.rows, function (row) {
          var Proj = row.doc,
            key = row.key,
            pName = key[1]
          listItem = "<li ProjektId='" + Proj._id + "' class='Projekt'>"
          listItem += "<a href='#'>"
          listItem += '<h3>' + pName + '<\/h3><\/a><\/li>'
          listItemContainer += listItem
        })
      }
      $('#ProjektlistehPL')
        .html(listItemContainer)
        .listview('refresh')
      window.em.blendeMenus()
      // Fokus in das Suchfeld setzen
      $('#hProjektListe')
        .find('.ui-input-search')
        .children('input')[0]
        .focus()
      window.em.speichereLetzteUrl()
    }

    // generiert in hRaumEdit.html dynamisch die von den Sichtbarkeits-Einstellungen abhängigen Felder
    // Mitgeben: id des Raums, Username
    // Bei neuen Räumen wird der Raum übernommen um eine DB-Abfrage zu sparen
    window.em.initiiereRaumEdit = function () {
      'use strict'
      // Anhänge ausblenden, weil sie sonst beim Wechsel stören
      // $('#AnhängehRE').hide()
      if (window.em.hRaum) {
        window.em.initiiereRaumEdit_2()
      } else if (window.localStorage.Status === 'neu' && window.localStorage.hRaum) {
        // wenn mit window.open von neu gekommen, existiert die globale Variable nicht mehr
        window.em.hRaum = JSON.parse(window.localStorage.hRaum)
        delete window.localStorage.hRaum
        window.em.initiiereRaumEdit_2()
      } else {
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.RaumId, {
          success: function (data) {
            window.em.hRaum = data
            window.em.initiiereRaumEdit_2()
          }
        })
      }
    }

    window.em.initiiereRaumEdit_2 = function () {
      'use strict'
      // fixes Feld setzen
      $('#rName').val(window.em.hRaum.rName)
      // Variabeln bereitstellen
      window.localStorage.ProjektId = window.em.hRaum.hProjektId
      // bei neuen Räumen hat das Objekt noch keine ID
      if (window.em.hRaum._id) {
        window.localStorage.RaumId = window.em.hRaum._id
      } else {
        window.localStorage.RaumId = 'neu'
      }
      // prüfen, ob die Feldliste schon geholt wurde
      // wenn ja: deren globale Variable verwenden
      if (window.em.FeldlisteRaumEdit) {
        window.em.initiiereRaumEdit_3()
      } else {
        // das dauert länger - hinweisen
        $('#hRaumEditFormHtml').html('<p class="HinweisDynamischerFeldaufbau">Die Felder werden aufgebaut...</p>')
        // holt die Feldliste aus der DB
        var $db = $.couch.db('evab')
        $db.view('evab/FeldListeRaum?include_docs=true', {
          success: function (Feldliste) {
            // Variabeln bereitstellen
            window.em.FeldlisteRaumEdit = Feldliste
            window.em.initiiereRaumEdit_3()
          }
        })
      }
    }

    window.em.initiiereRaumEdit_3 = function () {
      'use strict'
      var htmlContainer = window.em.generiereHtmlFuerRaumEditForm()
      // Linie nur anfügen, wenn Felder erstellt wurden
      if (htmlContainer) {
        htmlContainer = '<hr />' + htmlContainer
      }
      $('#hRaumEditFormHtml').html(htmlContainer).trigger('create').trigger('refresh')
      // jetzt alle Flipswitsches, die "nein" sind, aktiv setzen
      window.em.aktiviereFlipswitches('#hRaumEditFormHtml', window.em.hRaum)
      window.em.blendeMenus()
      // letzte url speichern - hier und nicht im pageshow, damit es bei jedem Datensatzwechsel passiert
      window.em.speichereLetzteUrl()
    }

    // generiert das Html für das Formular in hRaumEdit.html
    // erwartet Feldliste als Objekt; window.em.hRaum als Objekt
    // der htmlContainer wird zurück gegeben
    window.em.generiereHtmlFuerRaumEditForm = function () {
      'use strict'
      var Feld = {},
        FeldName,
        FeldWert,
        htmlContainer = ''
      _.each(window.em.FeldlisteRaumEdit.rows, function (row) {
        Feld = row.doc
        FeldName = Feld.FeldName
        // nur sichtbare eigene Felder. Bereits im Formular integrierte Felder nicht anzeigen
        if ((Feld.User === window.localStorage.Email || Feld.User === 'ZentrenBdKt') && Feld.SichtbarImModusHierarchisch.indexOf(window.localStorage.Email) !== -1 && FeldName !== 'rName') {
          if (window.localStorage.Status === 'neu' && Feld.Standardwert && Feld.Standardwert[window.localStorage.Email]) {
            FeldWert = Feld.Standardwert[window.localStorage.Email]
            // Objekt window.em.hRaum um den Standardwert ergänzen, um später zu speichern
            window.em.hRaum[FeldName] = FeldWert
          } else {
            // "" verhindert die Anzeige von undefined im Feld
            FeldWert = window.em.hRaum[FeldName] || ''
          }
          htmlContainer += window.em.generiereHtmlFürFormularelement(Feld, FeldWert)
        }
      })
      // In neuen Datensätzen allfällige Standardwerte speichern
      if (window.localStorage.Status === 'neu') {
        $('#rName').focus()
        var $db = $.couch.db('evab')
        $db.saveDoc(window.em.hRaum, {
          success: function (data) {
            window.em.hRaum._id = data.id
            window.em.hRaum._rev = data.rev
            window.localStorage.RaumId = data.id
          }
        })
        delete window.localStorage.Status
      } else {
        // Attachments gibt's bei neuen Datensätzen nicht
        window.em.zeigeAttachments(window.em.hRaum, 'hRE')
      }
      return htmlContainer
    }

    window.em.initiiereRaumListe = function () {
      'use strict'
      // hat hRaumEdit.html eine RaumListe übergeben?
      if (window.em.RaumListe) {
        // Raumliste aus globaler Variable holen - muss nicht geparst werden
        window.em.initiiereRaumListe_2()
      } else {
        // Raumliste aud DB holen
        var $db = $.couch.db('evab')
        $db.view('evab/hRaumListe?startkey=["' + window.localStorage.Email + '", "' + window.localStorage.ProjektId + '"]&endkey=["' + window.localStorage.Email + '", "' + window.localStorage.ProjektId + '" ,{}]&include_docs=true', {
          success: function (data) {
            // RaumListe für haumEdit bereitstellen
            window.em.RaumListe = data
            window.em.initiiereRaumListe_2()
          }
        })
      }
    }

    window.em.initiiereRaumListe_2 = function () {
      'use strict'
      var anzRaum = window.em.RaumListe.rows.length,
        Raum,
        key,
        rName,
        listItemContainer = '',
        Titel2

      // Im Titel der Seite die Anzahl Räume anzeigen
      Titel2 = ' Räume'
      if (anzRaum === 1) {
        Titel2 = ' Raum'
      }
      $('#hRaumListePageHeader')
        .find('.hRaumListePageTitel')
        .text(anzRaum + Titel2)

      if (anzRaum === 0) {
        listItemContainer = '<li><a href="#" name="NeuerRaumRaumListe" class="erste">Ersten Raum erfassen</a></li>'
      } else {
        _.each(window.em.RaumListe.rows, function (row) {
          Raum = row.doc
          key = row.key
          rName = Raum.rName
          listItemContainer += "<li RaumId='" + Raum._id + "' class='Raum'><a href='#'><h3>" + rName + '<\/h3><\/a><\/li>'
        })
      }
      $('#RaumlistehRL')
        .html(listItemContainer)
        .listview('refresh')
      window.em.blendeMenus()
      // Fokus in das Suchfeld setzen
      $('#hRaumListe')
        .find('.ui-input-search')
        .children('input')[0]
        .focus()
      window.em.speichereLetzteUrl()
    }

    // generiert in hOrtEdit.html dynamisch die von den Sichtbarkeits-Einstellungen abhängigen Felder
    // Mitgeben: id des Orts
    window.em.initiiereOrtEdit = function () {
      'use strict'
      // Anhänge ausblenden, weil sie sonst beim Wechsel stören
      // $('#AnhängehOE').hide()
      if (window.em.hOrt) {
        window.em.initiiereOrtEdit_2()
      } else if (window.localStorage.Status === 'neu' && window.localStorage.hOrt) {
        // wenn mit window.open von neu gekommen, existiert die globale Variable nicht mehr
        window.em.hOrt = JSON.parse(window.localStorage.hOrt)
        delete window.localStorage.hOrt
        window.em.initiiereOrtEdit_2()
      } else {
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.OrtId, {
          success: function (data) {
            window.em.hOrt = data
            window.em.initiiereOrtEdit_2()
          }
        })
      }
    }

    window.em.initiiereOrtEdit_2 = function () {
      'use strict'
      // fixe Felder aktualisieren
      $("[name='oName']").val(window.em.hOrt.oName)
      $("[name='oXKoord']").val(window.em.hOrt.oXKoord)
      $("[name='oYKoord']").val(window.em.hOrt.oYKoord)
      $("[name='oLagegenauigkeit']").val(window.em.hOrt.oLagegenauigkeit)
      // Variabeln bereitstellen
      window.localStorage.ProjektId = window.em.hOrt.hProjektId
      window.localStorage.RaumId = window.em.hOrt.hRaumId
      // bei neuen Orten hat das Objekt noch keine ID
      if (window.em.hOrt._id) {
        window.localStorage.OrtId = window.em.hOrt._id
      } else {
        window.localStorage.OrtId = 'neu'
      }
      // Lat Lng werden geholt. Existieren sie nicht, erhalten Sie den Wert ""
      window.localStorage.oLongitudeDecDeg = window.em.hOrt.oLongitudeDecDeg
      window.localStorage.oLatitudeDecDeg = window.em.hOrt.oLatitudeDecDeg
      window.localStorage.oLagegenauigkeit = window.em.hOrt.oLagegenauigkeit
      window.localStorage.oXKoord = window.em.hOrt.oXKoord
      window.localStorage.oYKoord = window.em.hOrt.oYKoord
      // prüfen, ob die Feldliste schon geholt wurde
      // wenn ja: deren globale Variable verwenden
      if (window.em.FeldlisteOrtEdit) {
        window.em.initiiereOrtEdit_3()
      } else {
        // das dauert länger - hinweisen
        $('#hOrtEditFormHtml').html('<p class="HinweisDynamischerFeldaufbau">Die Felder werden aufgebaut...</p>')
        // holt die Feldliste aus der DB
        var $db = $.couch.db('evab')
        $db.view('evab/FeldListeOrt?include_docs=true', {
          success: function (Feldliste) {
            // Globale Variable erstellen, damit ab dem zweiten mal die vorige Abfrage gespaart werden kann
            window.em.FeldlisteOrtEdit = Feldliste
            window.em.initiiereOrtEdit_3()
          }
        })
      }
    }

    window.em.initiiereOrtEdit_3 = function () {
      'use strict'
      var htmlContainer = window.em.generiereHtmlFürOrtEditForm()
      // Linie nur anfügen, wenn Felder erstellt wurden
      if (htmlContainer) {
        htmlContainer = '<hr />' + htmlContainer
      }
      $('#hOrtEditFormHtml').html(htmlContainer).trigger('create').trigger('refresh')
      // jetzt alle Flipswitsches, die "nein" sind, aktiv setzen
      window.em.aktiviereFlipswitches('#hOrtEditFormHtml', window.em.hOrt)
      window.em.blendeMenus()
      // letzte url speichern - hier und nicht im pageshow, damit es bei jedem Datensatzwechsel passiert
      window.em.speichereLetzteUrl()
    }

    // generiert das Html für das Formular in hOrtEdit.html
    // erwartet Feldliste als Objekt (aus der globalen Variable); window.em.hOrt als Objekt
    // der htmlContainer wird zurück gegeben
    window.em.generiereHtmlFürOrtEditForm = function () {
      'use strict'
      var Feld = {},
        FeldName,
        FeldWert,
        htmlContainer = ''
      _.each(window.em.FeldlisteOrtEdit.rows, function (row) {
        'use strict'
        Feld = row.doc
        FeldName = Feld.FeldName
        // nur sichtbare eigene Felder. Bereits im Formular integrierte Felder nicht anzeigen
        if ((Feld.User === window.localStorage.Email || Feld.User === 'ZentrenBdKt') && Feld.SichtbarImModusHierarchisch.indexOf(window.em.hOrt.User) !== -1 && (FeldName !== 'oName') && (FeldName !== 'oXKoord') && (FeldName !== 'oYKoord') && (FeldName !== 'oLagegenauigkeit')) {
          'use strict'
          if (window.localStorage.Status === 'neu' && Feld.Standardwert && Feld.Standardwert[window.localStorage.Email]) {
            'use strict'
            FeldWert = Feld.Standardwert[window.localStorage.Email]
            // Objekt window.em.hOrt um den Standardwert ergänzen, um später zu speichern
            window.em.hOrt[FeldName] = FeldWert
          } else {
            // "" verhindert die Anzeige von undefined im Feld
            FeldWert = window.em.hOrt[FeldName] || ''
          }
          htmlContainer += window.em.generiereHtmlFürFormularelement(Feld, FeldWert)
        }
      })
      // Allfällige Standardwerte speichern
      if (window.localStorage.Status === 'neu') {
        'use strict'
        $("[name='oName']").focus()
        var $db = $.couch.db('evab')
        $db.saveDoc(window.em.hOrt, {
          success: function (data) {
            'use strict'
            window.em.hOrt._id = data.id
            window.em.hOrt._rev = data.rev
            window.localStorage.OrtId = data.id
            window.em.GetGeolocation(data.id, 'hOrt')
          }
        })
        // Status zurücksetzen - es soll nur ein mal verortet werden
        delete window.localStorage.Status
      } else {
        // Attachments gibt es bei neuen Orten nicht
        window.em.zeigeAttachments(window.em.hOrt, 'hOE')
      }
      return htmlContainer
    }

    // erstellt die Ortliste in hOrtListe.html
    window.em.initiiereOrtListe = function () {
      'use strict'
      // hat hOrtEdit.html eine OrtListe übergeben?
      if (window.em.OrtListe) {
        // Ortliste aus globaler Variable holen - muss nicht geparst werden
        window.em.initiiereOrtListe_2()
      } else {
        // Ortliste aus DB holen
        var $db = $.couch.db('evab')
        $db.view('evab/hOrtListe?startkey=["' + window.localStorage.Email + '", "' + window.localStorage.RaumId + '"]&endkey=["' + window.localStorage.Email + '", "' + window.localStorage.RaumId + '" ,{}]&include_docs=true', {
          success: function (data) {
            // OrtListe für hOrtEdit bereitstellen
            window.em.OrtListe = data
            window.em.initiiereOrtListe_2()
          }
        })
      }
    }

    window.em.initiiereOrtListe_2 = function () {
      'use strict'
      var anzOrt = window.em.OrtListe.rows.length,
        Ort,
        key,
        listItemContainer = '',
        Titel2

      // Im Titel der Seite die Anzahl Orte anzeigen
      Titel2 = ' Orte'
      if (anzOrt === 1) {
        Titel2 = ' Ort'
      }
      $('#hOrtListePageHeader')
        .find('.hOrtListePageTitel')
        .text(anzOrt + Titel2)

      if (anzOrt === 0) {
        listItemContainer = '<li><a href="#" class="erste NeuerOrtOrtListe">Ersten Ort erfassen</a></li>'
      } else {
        _.each(window.em.OrtListe.rows, function (row) {
          Ort = row.doc
          key = row.key
          listItemContainer += "<li OrtId='" + Ort._id + "' class='Ort'><a href='#'><h3>" + Ort.oName + '<\/h3><\/a><\/li>'
        })
      }
      $('#OrtlistehOL')
        .html(listItemContainer)
        .listview('refresh')
      window.em.blendeMenus()
      // Fokus in das Suchfeld setzen
      $('#hOrtListe')
        .find('.ui-input-search')
        .children('input')[0]
        .focus()
      window.em.speichereLetzteUrl()
    }

    // generiert in hZeitEdit.html dynamisch die von den Sichtbarkeits-Einstellungen abhängigen Felder
    // Mitgeben: id der Zeit
    window.em.initiiereZeitEdit = function () {
      'use strict'
      // Anhänge ausblenden, weil sie sonst beim Wechsel stören
      // $('#AnhängehZE').hide()
      // hZeit existiert schon bei neuer Zeit
      // alert("window.em.hZeit = " + JSON.stringify(window.em.hZeit))
      if (window.em.hZeit) {
        window.em.initiiereZeitEdit_2()
      } else if (window.localStorage.Status === 'neu' && window.localStorage.hZeit) {
        // wenn mit window.open von neu gekommen, existiert die globale Variable nicht mehr
        window.em.hZeit = JSON.parse(window.localStorage.hZeit)
        delete window.localStorage.hZeit
        window.em.initiiereZeitEdit_2()
      } else {
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.ZeitId, {
          success: function (data) {
            window.em.hZeit = data
            window.em.initiiereZeitEdit_2()
          }
        })
      }
    }

    window.em.initiiereZeitEdit_2 = function () {
      'use strict'
      // fixe Felder aktualisieren
      $("[name='zDatum']").val(window.em.hZeit.zDatum)
      $("[name='zUhrzeit']").val(window.em.hZeit.zUhrzeit)
      // Variabeln bereitstellen
      window.localStorage.ProjektId = window.em.hZeit.hProjektId
      window.localStorage.RaumId = window.em.hZeit.hRaumId
      window.localStorage.OrtId = window.em.hZeit.hOrtId
      // bei neuen Zeiten hat das Objekt noch keine ID
      if (window.em.hZeit._id) {
        window.localStorage.ZeitId = window.em.hZeit._id
      }
      // prüfen, ob die Feldliste schon geholt wurde
      // wenn ja: deren globale Variable verwenden
      if (window.em.FeldlisteZeitEdit) {
        window.em.initiiereZeitEdit_3()
      } else {
        // Feldliste aus der DB holen
        // das dauert länger - hinweisen
        $('#hZeitEditFormHtml').html('<p class="HinweisDynamischerFeldaufbau">Die Felder werden aufgebaut...</p>')
        var $db = $.couch.db('evab')
        $db.view('evab/FeldListeZeit?include_docs=true', {
          success: function (Feldliste) {
            window.em.FeldlisteZeitEdit = Feldliste
            window.em.initiiereZeitEdit_3()
          }
        })
      }
    }

    window.em.initiiereZeitEdit_3 = function () {
      'use strict'
      var htmlContainer = window.em.generiereHtmlFuerZeitEditForm()
      // Linie nur anfügen, wenn Felder erstellt wurden
      if (htmlContainer) {
        htmlContainer = '<hr />' + htmlContainer
      }
      $('#hZeitEditFormHtml').html(htmlContainer).trigger('create').trigger('refresh')
      // jetzt alle Flipswitsches, die "nein" sind, aktiv setzen
      window.em.aktiviereFlipswitches('#hZeitEditFormHtml', window.em.hZeit)
      window.em.blendeMenus()
      // letzte url speichern - hier und nicht im pageshow, damit es bei jedem Datensatzwechsel passiert
      window.em.speichereLetzteUrl()
    }

    // erstellt die Liste der Zeiten in Formular hZeitListe.html
    window.em.initiiereZeitListe = function () {
      'use strict'
      // hat hZeitEdit.html eine ZeitListe übergeben?
      if (window.em.ZeitListe) {
        // Zeitliste aus globaler Variable holen - muss nicht geparst werden
        window.em.initiiereZeitListe_2()
      } else {
        // Zeitliste aus DB holen
        var $db = $.couch.db('evab')
        $db.view('evab/hZeitListe?startkey=["' + window.localStorage.Email + '", "' + window.localStorage.OrtId + '"]&endkey=["' + window.localStorage.Email + '", "' + window.localStorage.OrtId + '" ,{}]&include_docs=true', {
          success: function (data) {
            // ZeitListe für hZeitEdit bereitstellen
            window.em.ZeitListe = data
            window.em.initiiereZeitListe_2()
          }
        })
      }
    }

    window.em.initiiereZeitListe_2 = function () {
      'use strict'
      var anzZeit = window.em.ZeitListe.rows.length,
        Zeit,
        key,
        listItemContainer = '',
        Titel2,
        zZeitDatum

      // Im Titel der Seite die Anzahl Zeiten anzeigen
      Titel2 = ' Zeiten'
      if (anzZeit === 1) {
        Titel2 = ' Zeit'
      }
      $('#hZeitListePageHeader')
        .find('.hZeitListePageTitel')
        .text(anzZeit + Titel2)

      if (anzZeit === 0) {
        listItemContainer = '<li><a href="#" class="erste NeueZeitZeitListe">Erste Zeit erfassen</a></li>'
      } else {
        _.each(window.em.ZeitListe.rows, function (row) {
          Zeit = row.doc
          key = row.key
          zZeitDatum = key[2] + '&nbsp; &nbsp;' + key[3]
          listItemContainer += "<li ZeitId='" + Zeit._id + "' class='Zeit'><a href='#'><h3>" + zZeitDatum + '<\/h3><\/a><\/li>'
        })
      }
      $('#ZeitlistehZL')
        .html(listItemContainer)
        .listview('refresh')
      window.em.blendeMenus()
      // Fokus in das Suchfeld setzen
      $('#hZeitListe')
        .find('.ui-input-search')
        .children('input')[0]
        .focus()
      window.em.speichereLetzteUrl()
    }

    // generiert das Html für das Formular in hZeitEdit.html
    // erwartet Feldliste als Objekt; Zeit als Objekt
    // der htmlContainer wird zurück gegeben
    window.em.generiereHtmlFuerZeitEditForm = function () {
      'use strict'
      var Feld = {},
        FeldName,
        FeldWert,
        htmlContainer = ''
      _.each(window.em.FeldlisteZeitEdit.rows, function (row) {
        Feld = row.doc
        FeldName = Feld.FeldName
        // nur sichtbare eigene Felder. Bereits im Formular integrierte Felder nicht anzeigen
        if ((Feld.User === window.em.hZeit.User || Feld.User === 'ZentrenBdKt') && Feld.SichtbarImModusHierarchisch.indexOf(window.em.hZeit.User) !== -1 && FeldName !== 'zDatum' && FeldName !== 'zUhrzeit') {
          if (window.localStorage.Status === 'neu' && Feld.Standardwert && window.em.hZeit[FeldName]) {
            FeldWert = Feld.Standardwert[window.em.hZeit.User] || ''
            // Objekt window.em.hZeit um den Standardwert ergänzen, um später zu speichern
            window.em.hZeit[FeldName] = FeldWert
          } else {
            FeldWert = window.em.hZeit[FeldName] || ''
          }
          htmlContainer += window.em.generiereHtmlFürFormularelement(Feld, FeldWert)
        }
      // window.localStorage.Status wird schon im aufrufenden function gelöscht!
      })
      if (window.localStorage.Status === 'neu') {
        // in neuen Datensätzen dynamisch erstellte Standardwerte speichern
        var $db = $.couch.db('evab')
        $db.saveDoc(window.em.hZeit, {
          success: function (data) {
            window.em.hZeit._id = data.id
            window.em.hZeit._rev = data.rev
            window.localStorage.ZeitId = data.id
          }
        })
        delete window.localStorage.Status
      } else {
        // Neue Datensätze haben keine Attachments
        window.em.zeigeAttachments(window.em.hZeit, 'hZE')
      }
      return htmlContainer
    }

    // managt den Aufbau aller Daten und Felder für hArtEdit.html
    // erwartet die hArtId
    // wird aufgerufen von hArtEdit.html bei pageshow
    window.em.initiierehArtEdit = function () {
      'use strict'
      // markieren, dass die Einzelsicht aktiv ist
      window.localStorage.hArtSicht = 'einzel'
      // achtung: wenn soeben die Art geändert wurde, müssen ArtId und ArtName neu geholt werden
      if (window.em.hArt && (!window.localStorage.Von || window.localStorage.Von !== 'hArtEdit')) {
        window.em.initiierehArtEdit_2(window.em.hArt)
      } else {
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.hArtId, {
          success: function (data) {
            window.em.hArt = data
            window.localStorage.aArtId = window.em.hArt.aArtId
            window.localStorage.aArtName = window.em.hArt.aArtName
            window.localStorage.aArtGruppe = window.em.hArt.aArtGruppe
            window.em.initiierehArtEdit_2(data)
          }
        })
      }
    }

    window.em.initiierehArtEdit_2 = function () {
      'use strict'
      // hier werden Variablen gesetzt,
      // in die fixen Felder Werte eingesetzt,
      // die dynamischen Felder aufgebaut
      // und die Nav-Links gesetzt

      // Anhänge ausblenden, weil sie sonst beim Wechsel stören
      // $('#AnhängehAE').hide()

      // diese (globalen) Variabeln werden in hArtEdit.html gebraucht
      // Variabeln bereitstellen
      window.localStorage.ProjektId = window.em.hArt.hProjektId
      window.localStorage.RaumId = window.em.hArt.hRaumId
      window.localStorage.OrtId = window.em.hArt.hOrtId
      window.localStorage.ZeitId = window.em.hArt.hZeitId
      // bei neuen hArt hat das Objekt noch keine ID
      if (window.em.hArt._id) {
        window.localStorage.hArtId = window.em.hArt._id
      } else {
        window.localStorage.hArtId = 'neu'
      }
      window.localStorage.aArtGruppe = window.em.hArt.aArtGruppe
      window.localStorage.aArtName = window.em.hArt.aArtName
      window.localStorage.aArtId = window.em.hArt.aArtId
      // fixe Felder aktualisieren
      $('#aArtGruppe')
        .val(window.em.hArt.aArtGruppe)
        .html("<option value='" + window.em.hArt.aArtGruppe + "'>" + window.em.hArt.aArtGruppe + '</option>')
        .selectmenu()
        .selectmenu('refresh')
      // JQUERY MOBILE BRACHT MANCHMAL LANGE UM ZU INITIALIIEREN
      // OHNE TIMEOUT REKLAMIERT ES BEIM REFRESH, DAS WIDGET SEI NOCH NICHT INITIALISIERT!!!!
      // NACH EIN MAL VERZÖGERN HAT ES ABER WIEDER FUNKTIONIERT????!!!!
      /*setTimeout(function() {
      	$("#aArtGruppe").selectmenu("refresh")
      }, 0)*/
      $('#aArtName')
        .val(window.em.hArt.aArtName)
        .html("<option value='" + window.em.hArt.aArtName + "'>" + window.em.hArt.aArtName + '</option>')
        .selectmenu()
        .selectmenu('refresh')
      // prüfen, ob die Feldliste schon geholt wurde
      // wenn ja: deren globale Variable verwenden
      if (window.em.FeldlistehArtEdit) {
        window.em.erstelleDynamischeFelderhArtEdit()
      } else {
        // Feldliste aus der DB holen
        // das dauert länger - hinweisen
        $('#hArtEditFormHtml').html('<p class="HinweisDynamischerFeldaufbau">Die Felder werden aufgebaut...</p>')
        var $db = $.couch.db('evab')
        $db.view('evab/FeldListeArt?include_docs=true', {
          success: function (data) {
            window.em.FeldlistehArtEdit = data
            window.em.erstelleDynamischeFelderhArtEdit()
          }
        })
      }
    }

    // generiert dynamisch die Artgruppen-abhängigen Felder
    // Mitgeben: Feldliste, Beobachtung
    window.em.erstelleDynamischeFelderhArtEdit = function () {
      'use strict'
      var htmlContainer = window.em.generiereHtmlFürhArtEditForm()
      // Linie nur anfügen, wenn Felder erstellt wurden
      if (htmlContainer) {
        htmlContainer = '<hr />' + htmlContainer
      }
      $('#hArtEditFormHtml').html(htmlContainer).trigger('create').trigger('refresh')
      // jetzt alle Flipswitsches, die "nein" sind, aktiv setzen
      window.em.aktiviereFlipswitches('#hArtEditFormHtml', window.em.hArt)
      window.em.blendeMenus()
      // letzte url speichern - hier und nicht im pageshow, damit es bei jedem Datensatzwechsel passiert
      window.em.speichereLetzteUrl()
    }

    // Flipswitches mit Wert "nein" aktiv schalten
    // dazu muss der Wert aus der Objekt-Variabeln geholt werden
    // keine Ahnung, wieso das jQuery-mobile nicht macht
    window.em.aktiviereFlipswitches = function (dom_element, objekt_variable) {
      'use strict'
      $(dom_element)
        .find("select[data-role='flipswitch']")
        .each(function () {
          if (objekt_variable[this.name] === 'nein') {
            $(this).parent().addClass('ui-flipswitch-active')
          }
        })
    }

    // generiert das Html für Formular in hArtEdit.html
    // erwartet ArtGruppe; Feldliste als Objekt; Beobachtung als Objekt
    // der htmlContainer wird zurück gegeben
    window.em.generiereHtmlFürhArtEditForm = function () {
      'use strict'
      var Feld = {},
        FeldName,
        FeldWert,
        htmlContainer = '',
        ArtGruppe = window.em.hArt.aArtGruppe
      _.each(window.em.FeldlistehArtEdit.rows, function (row) {
        Feld = row.doc
        FeldName = Feld.FeldName
        // nur sichtbare eigene Felder. Bereits im Formular integrierte Felder nicht anzeigen
        // Vorsicht: Erfasst jemand ein Feld der Hierarchiestufe Art ohne Artgruppe, sollte das keinen Fehler auslösen
        if ((Feld.User === window.em.hArt.User || Feld.User === 'ZentrenBdKt') && Feld.SichtbarImModusHierarchisch.indexOf(window.em.hArt.User) !== -1 && (typeof Feld.ArtGruppe !== 'undefined' && (Feld.ArtGruppe.indexOf(ArtGruppe) >= 0 || Feld.ArtGruppe[0] === 'alle')) && (FeldName !== 'aArtId') && (FeldName !== 'aArtGruppe') && (FeldName !== 'aArtName')) {
          if (window.em.hArt[FeldName] && window.localStorage.Status === 'neu' && Feld.Standardwert && Feld.Standardwert[window.em.hArt.User]) {
            FeldWert = Feld.Standardwert[window.em.hArt.User]
            // Objekt window.em.hArt um den Standardwert ergänzen, um später zu speichern
            window.em.hArt[FeldName] = FeldWert
          } else {
            // "" verhindert, dass im Feld undefined erscheint
            FeldWert = window.em.hArt[FeldName] || ''
          }
          htmlContainer += window.em.generiereHtmlFürFormularelement(Feld, FeldWert)
        }
      })
      if (window.localStorage.Status === 'neu') {
        // in neuen Datensätzen dynamisch erstellte Standardwerte speichern
        var $db = $.couch.db('evab')
        $db.saveDoc(window.em.hArt, {
          success: function (data) {
            window.em.hArt._id = data.id
            window.em.hArt._rev = data.rev
            window.localStorage.hArtId = data.id
          }
        })
        delete window.localStorage.Status
      } else {
        // Neue Datensätze haben keine Anhänge
        window.em.zeigeAttachments(window.em.hArt, 'hAE')
      }
      return htmlContainer
    }

    // initiiert BeobListe.html
    window.em.initiierehArtListe = function () {
      'use strict'
      // hat hArtEdit.html eine hArtListe übergeben?
      if (window.em.hArtListe) {
        // Beobliste aus globaler Variable holen - muss nicht geparst werden
        window.em.initiierehArtListe_2()
      } else {
        // Beobliste aus DB holen
        var $db = $.couch.db('evab')
        $db.view('evab/hArtListe?startkey=["' + window.localStorage.Email + '", "' + window.localStorage.ZeitId + '"]&endkey=["' + window.localStorage.Email + '", "' + window.localStorage.ZeitId + '" ,{}]&include_docs=true', {
          success: function (data) {
            // Liste bereitstellen, um Datenbankzugriffe zu reduzieren
            window.em.hArtListe = data
            window.em.initiierehArtListe_2()
          }
        })
      }
    }

    window.em.initiierehArtListe_2 = function () {
      'use strict'
      var anzArt = window.em.hArtListe.rows.length,
        listItemContainer = '',
        Titel2,
        hArtTemp,
        $ArtlistehAL = $('#ArtlistehAL')

      // Im Titel der Seite die Anzahl Arten anzeigen
      Titel2 = ' Arten'
      if (anzArt === 1) {
        Titel2 = ' Art'
      }
      $('#hArtListePageHeader')
        .find('.hArtListePageTitel')
        .text(anzArt + Titel2)

      if (anzArt === 0) {
        listItemContainer = '<li><a href="#" class="erste NeueBeobhArtListe">Erste Art erfassen</a></li>'
      } else {
        _.each(window.em.hArtListe.rows, function (row) {
          hArtTemp = row.doc
          if (hArtTemp) {
            listItemContainer += window.em.erstelleHtmlFürBeobInHArtListe(hArtTemp)
          }
        })
      }
      $ArtlistehAL.html(listItemContainer)
      $ArtlistehAL.listview('refresh')
      window.em.blendeMenus()
      // Fokus in das Suchfeld setzen
      $('#hArtListe')
        .find('.ui-input-search')
        .children('input')[0]
        .focus()
      window.em.speichereLetzteUrl()
    }

    // übernimmt eine hArt
    // retourniert das html für deren Zeile in der Liste
    window.em.erstelleHtmlFürBeobInHArtListe = function (beob) {
      'use strict'
      var artgruppenname = encodeURIComponent(beob.aArtGruppe.replace('ü', 'ue').replace('ä', 'ae').replace('ö', 'oe')) + '.png',
        listItem
      if (beob.aArtGruppe === 'DiverseInsekten') {
        // das leere Bild anzeigen
        artgruppenname = 'unbenannt.png'
      }
      listItem = "<li class='beob ui-li-has-thumb' hArtId='" + beob._id + "' aArtGruppe='" + beob.aArtGruppe + "'" + "' aArtId='" + beob.aArtId + "'>" +
        "<a href='#'>" +
        "<img class='ui-li-thumb' src='Artgruppenbilder/" + artgruppenname + "' />" +
        '<h3>' + beob.aArtName + '<\/h3>' +
        '<\/a> <\/li>'
      return listItem
    }

    // generiert das Html für ein Formularelement
    // erwartet diverse Übergabewerte
    // der htmlContainer wird zurück gegeben
    // OhneLabel: Für die Tabelle in hArtEditListe.html werden die Felder ohne Label benötigt, weil dieses im Spaltentitel steht
    window.em.generiereHtmlFürFormularelement = function (Feld, FeldWert, OhneLabel) {
      'use strict'
      var htmlContainer = '',
        SliderMinimum,
        SliderMaximum,
        optionen = Feld.Optionen || ['Bitte in Feldverwaltung Optionen erfassen'],
        FeldName = Feld.FeldName,
        FeldBeschriftung = Feld.FeldBeschriftung || FeldName
      // abfangen, wenn Inputtyp vergessen wurde
      Feld.InputTyp = Feld.InputTyp || 'text'
      switch (Feld.Formularelement) {
        case 'textinput':
          htmlContainer = window.em.generiereHtmlFürTextinput(FeldName, FeldBeschriftung, FeldWert, Feld.InputTyp, OhneLabel)
          break
        case 'textarea':
          htmlContainer = window.em.generiereHtmlFürTextarea(FeldName, FeldBeschriftung, FeldWert, OhneLabel)
          break
        case 'toggleswitch':
          htmlContainer = window.em.generiereHtmlFürToggleswitch(FeldName, FeldBeschriftung, FeldWert, OhneLabel)
          break
        case 'checkbox':
          htmlContainer = window.em.generiereHtmlFürCheckbox(FeldName, FeldBeschriftung, FeldWert, optionen, OhneLabel)
          break
        case 'radio':
          htmlContainer = window.em.generiereHtmlFürRadio(FeldName, FeldBeschriftung, FeldWert, optionen, OhneLabel)
          break
        case 'selectmenu':
          htmlContainer = window.em.generiereHtmlFürSelectmenu(FeldName, FeldBeschriftung, FeldWert, optionen, 'SingleSelect', OhneLabel)
          break
        case 'multipleselect':
          htmlContainer = window.em.generiereHtmlFürSelectmenu(FeldName, FeldBeschriftung, FeldWert, optionen, 'MultipleSelect', OhneLabel)
          break
        case 'slider':
          SliderMinimum = Feld.SliderMinimum || 0
          SliderMaximum = Feld.SliderMaximum || 100
          htmlContainer = window.em.generiereHtmlFürSlider(FeldName, FeldBeschriftung, FeldWert, SliderMinimum, SliderMaximum, OhneLabel)
          break
        case null:
          // Abfangen, wenn das Formularelement nicht gewählt wurde
          htmlContainer = window.em.generiereHtmlFürTextinput(FeldName, FeldBeschriftung, FeldWert, Feld.InputTyp, OhneLabel)
          break
      }
      return htmlContainer
    }

    // generiert den html-Inhalt für Textinputs
    // wird von erstellehArtEdit aufgerufen
    window.em.generiereHtmlFürTextinput = function (FeldName, FeldBeschriftung, FeldWert, InputTyp, OhneLabel) {
      'use strict'
      var htmlContainer = '<div class="ui-field-contain">'
      if (!OhneLabel) {
        htmlContainer += '<label for="'
        htmlContainer += FeldName
        htmlContainer += '">'
        htmlContainer += FeldBeschriftung
        htmlContainer += ':</label>'
      }
      htmlContainer += '<input id="'
      htmlContainer += FeldName
      htmlContainer += '" name="'
      htmlContainer += FeldName
      htmlContainer += '" type="'
      htmlContainer += InputTyp
      htmlContainer += '" value="'
      htmlContainer += FeldWert
      htmlContainer += '" class="speichern"/></div>'
      return htmlContainer
    }

    // generiert den html-Inhalt für Slider
    // wird von erstellehArtEdit aufgerufen
    window.em.generiereHtmlFürSlider = function (FeldName, FeldBeschriftung, FeldWert, SliderMinimum, SliderMaximum, OhneLabel) {
      'use strict'
      var htmlContainer = '<div class="ui-field-contain">'
      if (!OhneLabel) {
        htmlContainer += '<label for="'
        htmlContainer += FeldName
        htmlContainer += '">'
        htmlContainer += FeldBeschriftung
        htmlContainer += ':</label>'
      }
      htmlContainer += '<input class="speichernSlider" type="range" data-highlight="true" name="'
      htmlContainer += FeldName
      htmlContainer += '" id="'
      htmlContainer += FeldName
      htmlContainer += '" value="'
      htmlContainer += FeldWert
      htmlContainer += '" min="'
      htmlContainer += SliderMinimum
      htmlContainer += '" max="'
      htmlContainer += SliderMaximum
      htmlContainer += '"/></div>'
      return htmlContainer
    }

    // generiert den html-Inhalt für Textarea
    // wird von erstellehArtEdit aufgerufen
    window.em.generiereHtmlFürTextarea = function (FeldName, FeldBeschriftung, FeldWert, OhneLabel) {
      'use strict'
      var htmlContainer = '<div class="ui-field-contain">'
      if (!OhneLabel) {
        htmlContainer += '<label for="'
        htmlContainer += FeldName
        htmlContainer += '">'
        htmlContainer += FeldBeschriftung
        htmlContainer += ':</label>'
      }
      htmlContainer += '<textarea id="'
      htmlContainer += FeldName
      htmlContainer += '" name="'
      htmlContainer += FeldName
      htmlContainer += '" class="speichern">'
      htmlContainer += FeldWert
      htmlContainer += '</textarea></div>'
      return htmlContainer
    }

    // generiert den html-Inhalt für Toggleswitch
    // wird von erstellehArtEdit aufgerufen
    window.em.generiereHtmlFürToggleswitch = function (FeldName, FeldBeschriftung, FeldWert, OhneLabel) {
      'use strict'
      var htmlContainer = "<div class='ui-field-contain'>"
      if (!OhneLabel) {
        htmlContainer += "<label for='"
        htmlContainer += FeldName
        htmlContainer += "'>"
        htmlContainer += FeldBeschriftung
        htmlContainer += '</label>'
      }
      htmlContainer += "<select name='"
      htmlContainer += FeldName
      htmlContainer += "' id='"
      htmlContainer += FeldName
      htmlContainer += "' data-role='flipswitch' value='"
      htmlContainer += FeldWert
      htmlContainer += "' class='speichern flipswitch'><option value='ja'>ja</option><option value='nein'>nein</option></select></div>"
      return htmlContainer
    }

    // generiert den html-Inhalt für Checkbox
    // wird von erstellehArtEdit aufgerufen
    window.em.generiereHtmlFürCheckbox = function (FeldName, FeldBeschriftung, FeldWert, optionen, OhneLabel) {
      'use strict'
      var htmlContainer = "<div class='ui-field-contain'><fieldset data-role='controlgroup'>"
      if (!OhneLabel) {
        htmlContainer += '<legend>'
        htmlContainer += FeldBeschriftung
        htmlContainer += '</legend>'
      }
      htmlContainer += window.em.generiereHtmlFürCheckboxOptionen(FeldName, FeldWert, optionen)
      htmlContainer += '</fieldset></div>'
      return htmlContainer
    }

    // generiert den html-Inhalt für Optionen von Checkbox
    // wird von generiereHtmlFürCheckbox aufgerufen
    window.em.generiereHtmlFürCheckboxOptionen = function (FeldName, FeldWert, optionen) {
      'use strict'
      var htmlContainer = '',
        listItem,
        id
      _.each(optionen, function (option) {
        id = _.uniqueId(FeldName + '_option_')
        listItem = "<label for='"
        listItem += id
        listItem += "'>"
        listItem += option
        listItem += "</label><input type='checkbox' name='"
        listItem += FeldName
        listItem += "' id='"
        listItem += id
        listItem += "' value='"
        listItem += option
        listItem += "' class='custom speichern'"
        if (FeldWert.indexOf(option) >= 0) {
          listItem += " checked='checked'"
        }
        listItem += '/>'
        htmlContainer += listItem
      })
      return htmlContainer
    }

    // generiert den html-Inhalt für Radio
    // wird von erstellehArtEdit aufgerufen
    window.em.generiereHtmlFürRadio = function (FeldName, FeldBeschriftung, FeldWert, optionen, OhneLabel) {
      'use strict'
      var htmlContainer = "<div class='ui-field-contain'><fieldset data-role='controlgroup'>"
      if (!OhneLabel) {
        htmlContainer += '<legend>'
        htmlContainer += FeldBeschriftung
        htmlContainer += '</legend>'
      }
      htmlContainer += window.em.generiereHtmlFürRadioOptionen(FeldName, FeldWert, optionen)
      htmlContainer += '</fieldset></div>'
      return htmlContainer
    }

    // generiert den html-Inhalt für Optionen von Radio
    // wird von generiereHtmlFürRadio aufgerufen
    window.em.generiereHtmlFürRadioOptionen = function (feldname, feldwert, optionen) {
      'use strict'
      var htmlContainer = '',
        listItem,
        id,
        feldname_eindeutig = _.uniqueId(feldname + '_')
      _.each(optionen, function (option) {
        id = _.uniqueId(feldname + '_option_')
        listItem = "<label for='"
        listItem += id
        listItem += "'>"
        listItem += option
        listItem += "</label><input class='speichern' type='radio' name='"
        // listItem += feldname
        listItem += feldname_eindeutig
        listItem += "'"
        listItem += " id='"
        listItem += id
        listItem += "'"
        listItem += " value='"
        listItem += option
        if (feldwert === option) {
          listItem += "' checked='checked"
        }
        listItem += "'/>"
        htmlContainer += listItem
      })
      return htmlContainer
    }

    // generiert den html-Inhalt für Selectmenus
    // wird von erstellehArtEdit aufgerufen
    window.em.generiereHtmlFürSelectmenu = function (FeldName, FeldBeschriftung, FeldWert, optionen, MultipleSingleSelect, OhneLabel, icon) {
      'use strict'
      var htmlContainer = "<div class='ui-field-contain'>",
        id
      id = _.uniqueId(FeldName + '_')
      if (!OhneLabel) {
        htmlContainer += "<label for='"
        htmlContainer += id
        htmlContainer += "' class='select'>"
        htmlContainer += FeldBeschriftung
        htmlContainer += '</label>'
      }
      htmlContainer += "<select name='"
      htmlContainer += FeldName
      htmlContainer += "' id='"
      htmlContainer += id
      htmlContainer += "' value='"
      htmlContainer += FeldWert.toString()
      htmlContainer += "' data-native-menu='false'"
      if (MultipleSingleSelect === 'MultipleSelect') {
        htmlContainer += " multiple='multiple'"
      }
      if (icon) {
        htmlContainer += " data-icon='" + icon + "'"
      }
      htmlContainer += " class='speichern'>"
      if (MultipleSingleSelect === 'MultipleSelect') {
        htmlContainer += window.em.generiereHtmlFuerMultipleselectOptionen(FeldName, FeldWert, optionen)
      } else {
        htmlContainer += window.em.generiereHtmlFuerSelectmenuOptionen(FeldName, FeldWert, optionen)
      }
      htmlContainer += '</select></div>'
      return htmlContainer
    }

    // generiert den html-Inhalt für Optionen von Selectmenu
    // wird von generiereHtmlFürSelectmenu aufgerufen
    window.em.generiereHtmlFuerSelectmenuOptionen = function (feldname, feldwert, optionen) {
      'use strict'
      var htmlContainer = "<option value=''></option>",
        listItem
      _.each(optionen, function (option) {
        listItem = "<option value='"
        listItem += option
        listItem += "' class='speichern'"
        if (feldwert === option) {
          listItem += " selected='selected'"
        }
        listItem += '>'
        listItem += option
        listItem += '</option>'
        htmlContainer += listItem
      })
      return htmlContainer
    }

    // generiert den html-Inhalt für Optionen von MultipleSelect
    // wird von generiereHtmlFürSelectmenu aufgerufen
    // FeldWert ist ein Array
    window.em.generiereHtmlFuerMultipleselectOptionen = function (feldname, feldwert, optionen) {
      'use strict'
      var htmlContainer = "<option value=''></option>",
        listItem
      _.each(optionen, function (option) {
        listItem = "<option value='"
        listItem += option
        listItem += "' class='speichern'"
        if (feldwert.indexOf(option) !== -1) {
          listItem += " selected='selected'"
        }
        listItem += '>'
        listItem += option
        listItem += '</option>'
        htmlContainer += listItem
      })
      return htmlContainer
    }(function ($) {
      // friendly helper http://tinyurl.com/6aow6yn
      // Läuft durch alle Felder im Formular
      // Wenn ein Wert enthalten ist, wird Feldname und Wert ins Objekt geschrieben
      // nicht vergessen: Typ, _id und _rev dazu geben, um zu speichern
      $.fn.serializeObject = function () {
        var o = {},
          a = this.serializeArray()
        $.each(a, function () {
          if (this.value) {
            if (o[this.name]) {
              if (!o[this.name].push) {
                o[this.name] = [o[this.name]]
              }
              o[this.name].push(this.value)
            } else {
              if (window.em.myTypeOf(this.value) === 'integer') {
                // typ ist Int
                o[this.name] = parseInt(this.value, 10)
              } else if (window.em.myTypeOf(this.value) === 'float') {
                // typ ist Float
                o[this.name] = parseFloat(this.value)
              } else {
                // anderer Typ, als String behandeln
                o[this.name] = this.value
              }
            }
          }
        })
        return o
      }
      // friendly helper http://tinyurl.com/6aow6yn
      // Läuft durch alle Felder im Formular
      // Feldname und Wert aller Felder werden ins Objekt geschrieben
      // so können auch bei soeben gelöschten Feldinhalten das entsprechende Feld im doc gelöscht werden
      // siehe Beispiel in FeldEdit.html
      // nicht vergessen: Typ, _id und _rev dazu geben, um zu speichern
      $.fn.serializeObjectNull = function () {
        var o = {},
          a = this.serializeArray()
        $.each(a, function () {
          if (o[this.name]) {
            if (!o[this.name].push) {
              o[this.name] = [o[this.name]]
            }
            o[this.name].push(this.value)
          } else {
            if (window.em.myTypeOf(this.value) === 'integer') {
              // typ ist Int
              o[this.name] = parseInt(this.value, 10)
            } else if (window.em.myTypeOf(this.value) === 'float') {
              // typ ist Float
              o[this.name] = parseFloat(this.value)
            } else {
              // anderer Typ, als String behandeln
              o[this.name] = this.value
            }
          }
        })
        return o
      }
    })(jQuery)

    window.em.checkAllCheckboxesOfForm = function (pagename, checktoggle) {
      'use strict'
      var checkboxes = $('#' + pagename).find('input')
      _.each(checkboxes, function (checkbox) {
        if (checkbox.type === 'checkbox') {
          checkbox.checked = checktoggle
          $('#' + checkbox.id).checkboxradio('refresh')
        }
      })
    }

    window.em.checkAllRadiosOfForm = function (pagename, checktoggle) {
      'use strict'
      var radios = $('#' + pagename).find('input')
      _.each(radios, function (radio) {
        if (radio.type == 'radio') {
          radio.checked = checktoggle
          $('#' + radio.id).checkboxradio('refresh')
        }
      })
    }

    // verorted mit Hilfe aller Methoden
    // wird benutzt von BeobEdit.html und hOrtEdit.html
    // erwartet die docId, um am Ende der Verortung die neuen Koordinaten zu speichern
    window.em.GetGeolocation = function (docId, OrtOderBeob) {
      'use strict'
      // benötigte Variabeln setzen
      window.localStorage.docId = docId
      // Zweck: Genau solange animieren, wie verortet wird
      window.localStorage.NavbarVerortungAnimieren = 'true'
      // übergebene Herkunft (Ort oder Beob) für die listeners bereitstellen
      window.localStorage.OrtOderBeob = OrtOderBeob
      // dem Benutzer zeigen, dass verortet wird
      window.em.NavbarVerortungAnimieren()
      // Koordinaten zurücksetzen
      delete window.localStorage.oXKoord
      delete window.localStorage.oYKoord
      delete window.localStorage.oLongitudeDecDeg
      delete window.localStorage.oLatitudeDecDeg
      delete window.localStorage.oLagegenauigkeit
      delete window.localStorage.oHöhe
      delete window.localStorage.oHöheGenauigkeit
      // Mit der Verortung beginnen
      window.em.watchID = null
      window.em.watchID = navigator.geolocation.watchPosition(window.em.onGeolocationSuccess, window.em.onGeolocationError, { frequency: 3000, enableHighAccuracy: true })
      // nach spätestens 20 Sekunden aufhören
      window.em.stop = setTimeout('window.em.stopGeolocation()', 20000)
      return window.em.watchID
    }

    // solange verortet wird, 
    // wird die Verortung in der Navbar jede Sekunde ein- und ausgeblendet
    window.em.NavbarVerortungAnimieren = function () {
      'use strict'
      if (window.localStorage.NavbarVerortungAnimieren && window.localStorage.NavbarVerortungAnimieren === 'true') {
        $('.neu').removeClass('ui-btn-active')
        $('.verorten').addClass('ui-btn-active').fadeToggle('slow')
        setTimeout('window.em.NavbarVerortungAnimieren()', 1000)
      } else {
        $('.verorten').removeClass('ui-btn-active').fadeIn('slow')
      // $(".neu").addClass("ui-btn-active")
      }
    }

    window.em.GeolocationAuslesen = function (position) {
      'use strict'
      var DdInChX = require('./util/ddInChX'),
        DdInChY = require('./util/ddInChY')
      window.localStorage.oLagegenauigkeit = Math.floor(position.coords.accuracy)
      window.localStorage.oLongitudeDecDeg = position.coords.longitude
      window.localStorage.oLatitudeDecDeg = position.coords.latitude
      window.localStorage.oXKoord = DdInChX(position.coords.latitude, position.coords.longitude)
      window.localStorage.oYKoord = DdInChY(position.coords.latitude, position.coords.longitude)
      $("[name='oXKoord']").val(window.localStorage.oXKoord)
      $("[name='oYKoord']").val(window.localStorage.oYKoord)
      $("[name='oLongitudeDecDeg']").val(position.coords.longitude)
      $("[name='oLatitudeDecDeg']").val(position.coords.latitude)
      $("[name='oLagegenauigkeit']").val(position.coords.accuracy)
      if (position.coords.altitude > 0) {
        $("[name='oHöhe']").val(position.coords.altitude)
        $("[name='oHöheGenauigkeit']").val(position.coords.altitudeAccuracy)
        window.localStorage.oHöhe = position.coords.altitude
        window.localStorage.oHöheGenauigkeit = position.coords.altitudeAccuracy
      }
      window.em.speichereKoordinaten(window.localStorage.docId, window.localStorage.OrtOderBeob)
    }

    // Position ermitteln war erfolgreich
    window.em.onGeolocationSuccess = function (position) {
      'use strict'
      // nur erste Position akzeptieren oder solche, die genauer sind als vorige
      if (!window.localStorage.oLagegenauigkeit || position.coords.accuracy < window.localStorage.oLagegenauigkeit) {
        if (position.coords.accuracy < 100) {
          window.em.GeolocationAuslesen(position)
          if (position.coords.accuracy <= 5) {
            window.em.stopGeolocation()
          }
        }
      }
    }

    // Position ermitteln war nicht erfolgreich
    // onError Callback receives a PositionError object
    window.em.onGeolocationError = function (error) {
      'use strict'
      window.em.melde('Keine Position erhalten\n' + error.message)
      window.em.stopGeolocation()
    }

    // Beendet Ermittlung der Position
    window.em.stopGeolocation = function () {
      'use strict'
      // Positionssuche beenden
      // wenn keine watchID mehr, wurde sie schon beendet
      // stop timeout stoppen
      clearTimeout(window.em.stop)
      delete window.em.stop
      delete window.localStorage.VerortungAbgeschlossen
      // Vorsicht: In BeobEdit.html und hOrtEdit.html ist watchID nicht defined
      if (typeof window.em.watchID !== 'undefined') {
        navigator.geolocation.clearWatch(window.em.watchID)
        delete window.em.watchID
      }
      // Animation beenden
      delete window.localStorage.NavbarVerortungAnimieren
      // auf den Erfolg reagieren
      if (window.localStorage.oLagegenauigkeit > 30) {
        window.em.melde('Koordinaten nicht sehr genau\nAuf Karte verorten?')
      } else if (!window.localStorage.oLagegenauigkeit) {
        // Felder leeren
        $("[name='oXKoord']").val('')
        $("[name='oYKoord']").val('')
        $("[name='oLongitudeDecDeg']").val('')
        $("[name='oLatitudeDecDeg']").val('')
        $("[name='oLagegenauigkeit']").val('')
        $("[name='oHöhe']").val('')
        $("[name='oHöheGenauigkeit']").val('')
        // Diesen neuen Stand speichern (allfällige alte Koordinaten werden verworfen)
        window.em.speichereKoordinaten(window.localStorage.docId, window.localStorage.OrtOderBeob)
        window.em.melde('Keine genaue Position erhalten')
      }
      // Variablen aufräumen
      delete window.localStorage.docId
      delete window.localStorage.OrtOderBeob
    }

    // damit kann bei erneuter Anmeldung window.em.öffneZuletztBenutzteSeite() die letzte Ansicht wiederherstellen
    // host wird NICHT geschrieben, weil sonst beim Wechsel von lokal zu iriscouch Fehler!
    window.em.speichereLetzteUrl = function () {
      'use strict'
      window.localStorage.LetzteUrl = window.location.pathname + window.location.search
    }

    window.em.holeAutor = function () {
      'use strict'
      // aAutor holen
      var $db = $.couch.db('evab')
      $db.openDoc('f19cd49bd7b7a150c895041a5d02acb0', {
        success: function (doc) {
          if (doc.Standardwert) {
            if (doc.Standardwert[window.localStorage.Email]) {
              window.localStorage.Autor = doc.Standardwert[window.localStorage.Email]
            }
          }
        }
      })
    }

    // speichert Anhänge
    // setzt ein passendes Formular mit den feldern _rev und _attachments voraus
    // nimmt den Formnamen entgegen respektive einen Anhang dazu, damit die Form ID eindeutig sein kann
    // wird benutzt von allen Formularen mit Anhängen
    window.em.speichereAnhänge = function (id, Objekt, Page) {
      'use strict'
      // prüfen, ob der Datensatz als Objekt übergeben wurde
      if (Objekt) {
        // das Objekt verwenden
        window.em.speichereAnhänge_2(id, Objekt, Page)
      } else {
        // Objekt aus der DB holen
        var $db = $.couch.db('evab')
        $db.openDoc(id, {
          success: function (data) {
            window.em[Objekt.Typ] = data
            window.em.speichereAnhänge_2(id, data, Page)
          },
          error: function () {
            window.em.melde('Fehler: Anhang nicht gespeichert')
          }
        })
      }
    }

    window.em.speichereAnhänge_2 = function (id, Objekt, Page) {
      'use strict'
      var $db = $.couch.db('evab')
      $('#_rev' + Page).val(window.em[Objekt.Typ]._rev)
      $('#FormAnhänge' + Page).ajaxSubmit({
        url: '/evab/' + id,
        success: function () {
          // doc nochmals holen, damit der Anhang mit Dateiname dabei ist
          $db.openDoc(id, {
            success: function (data2) {
              window.em[Objekt.Typ] = data2
              // show attachments in form
              window.em.zeigeAttachments(data2, Page)
            },
            error: function () {
              window.em.melde('Uups, Anhang wird erst beim nächsten Mal angezeigt')
            }
          })
        },
        // form.jquery.js meldet einen Fehler, obwohl der Vorgang funktioniert!
        error: function () {
          // doc nochmals holen, damit der Anhang mit Dateiname dabei ist
          $db.openDoc(id, {
            success: function (data3) {
              window.em[Objekt.Typ] = data3
              window.em.zeigeAttachments(data3, Page)
            },
            error: function () {
              window.em.melde('Uups, Anhang wird erst beim nächsten Mal angezeigt')
            }
          })
        }
      })
    }

    // zeigt Anhänge im Formular an
    // setzt ein passendes Formular mit dem Feld _attachments + Page voraus
    // und eine div namens Anhänge + Page, in der die Anhänge angezeigt werden
    // wird benutzt von allen (h)Beobachtungs-Edit-Formularen
    // erwartet Page, damit sowohl das AttachmentFeld als auch das div um die Anhänge reinzuhängen eindeutig sind 
    window.em.zeigeAttachments = function (doc, Page) {
      'use strict'
      var htmlContainer = '',
        url
      $('#_attachments' + Page).val('')
      if (doc._attachments) {
        $.each(doc._attachments, function (Dateiname) {
          url = '/evab/' + doc._id + '/' + Dateiname
          // url_zumLöschen = url + "?" + doc._rev	// theoretisch kann diese rev bis zum Löschen veraltet sein, praktisch kaum
          htmlContainer += "<div><a href='"
          htmlContainer += url
          htmlContainer += "' data-inline='true' data-role='button' target='_blank'>"
          htmlContainer += Dateiname
          htmlContainer += "</a><button name='LöscheAnhang' id='"
          htmlContainer += Dateiname
          htmlContainer += "' data-icon='delete' data-inline='true' data-iconpos='notext'/></div>"
        })
      }
      $('#Anhänge' + Page).html(htmlContainer).trigger('create')
      // Fokus auf Page richten, damit die Pagination mit den Pfeiltasten funktioniert
      $(":jqmData(role='page')").focus()
    }

    // initiiert FelderWaehlen.html
    // generiert dynamisch die Felder im Checkbox Felder
    // checked diejenigen, die der User anzeigen will
    window.em.initiiereFelderWählen = function () {
      'use strict'
      var TextUeberListe_FW,
        FeldlisteViewname
      // Je nach aufrufender Seite Variabeln setzen
      switch (window.localStorage.AufrufendeSeiteFW) {
        case 'hProjektEdit':
          TextUeberListe_FW = '<h3>Felder für Projekte wählen:</h3>'
          window.localStorage.FeldlisteFwName = 'FeldlisteProjekt'
          FeldlisteViewname = 'FeldListeProjekt'
          window.localStorage.KriterienFürZuWählendeFelder = "Feld.Hierarchiestufe === 'Projekt' && FeldName !== 'pName'"
          break
        case 'hRaumEdit':
          TextUeberListe_FW = '<h3>Felder für Räume wählen:</h3>'
          window.localStorage.FeldlisteFwName = 'FeldlisteRaumEdit'
          FeldlisteViewname = 'FeldListeRaum'
          window.localStorage.KriterienFürZuWählendeFelder = "Feld.Hierarchiestufe === 'Raum' && FeldName !== 'rName'"
          break
        case 'hOrtEdit':
          TextUeberListe_FW = '<h3>Felder für Orte wählen:</h3>'
          window.localStorage.FeldlisteFwName = 'FeldlisteOrtEdit'
          FeldlisteViewname = 'FeldListeOrt'
          window.localStorage.KriterienFürZuWählendeFelder = "Feld.Hierarchiestufe === 'Ort' && FeldName !== 'oName' && FeldName !== 'oXKoord' && FeldName !== 'oYKoord' && FeldName !== 'oLagegenauigkeit'"
          break
        case 'hZeitEdit':
          TextUeberListe_FW = '<h3>Felder für Zeiten wählen:</h3>'
          window.localStorage.FeldlisteFwName = 'FeldlisteZeitEdit'
          FeldlisteViewname = 'FeldListeZeit'
          window.localStorage.KriterienFürZuWählendeFelder = "Feld.Hierarchiestufe === 'Zeit' && Feld.FeldName !== 'zDatum' && Feld.FeldName !== 'zUhrzeit'"
          break
        case 'hArtEdit':
          TextUeberListe_FW = '<h3>Felder für Art wählen:</h3><p>Die Felder der Hierarchiestufe Art werden nur in den in der Feldverwaltung definierten Artgruppen angezeigt!</p>'
          window.localStorage.FeldlisteFwName = 'FeldlistehArtEdit'
          FeldlisteViewname = 'FeldListeArt'
          window.localStorage.KriterienFürZuWählendeFelder = "Feld.Hierarchiestufe === 'Art' && (Feld.FeldName !== 'aArtGruppe') && (Feld.FeldName !== 'aArtName') && (Feld.FeldName !== 'aArtId')"
          break
        case 'hArtEditListe':
          TextUeberListe_FW = '<h3>Felder für Artliste wählen:</h3><p>Die Felder der Hierarchiestufe Art werden nur in den in der Feldverwaltung definierten Artgruppen angezeigt!</p>'
          window.localStorage.FeldlisteFwName = 'FeldlistehArtEdit'	// dieselbe Liste verwenden, weil die Einstellungen in window.em.FeldlistehArtEdit bei jeder Wahl angepasst werden, inkl. _rev. Und beim Anpassen der letzte Wert aus window.em.FeldlistehArtEdit genommen wird, ohne die DB abzufragen, weil das sonst zu langsam ist
          FeldlisteViewname = 'FeldListeArt'
          window.localStorage.KriterienFürZuWählendeFelder = "Feld.Hierarchiestufe === 'Art' && (Feld.FeldName !== 'aArtGruppe') && (Feld.FeldName !== 'aArtName') && (Feld.FeldName !== 'aArtId')"
          break
        case 'BeobEdit':
          TextUeberListe_FW = '<h3>Felder für Beobachtungen wählen:</h3><p>Die Felder der Hierarchiestufe Art werden nur in den in der Feldverwaltung definierten Artgruppen angezeigt!</p>'
          window.localStorage.FeldlisteFwName = 'FeldlisteBeobEdit'
          FeldlisteViewname = 'FeldListeBeob'
          window.localStorage.KriterienFürZuWählendeFelder = "['aArtGruppe', 'aArtName', 'aAutor', 'aAutor', 'oXKoord', 'oYKoord', 'oLagegenauigkeit', 'zDatum', 'zUhrzeit'].indexOf(FeldName) === -1"
          break
      }
      $('#TextUeberListe_FW').html(TextUeberListe_FW)
      // Feldliste nur abfragen, wenn sie nicht schon als globale Variable existiert
      // Für FelderWaehlen.html könnte an sich immer die vollständige Liste verwendet werden
      // besser ist aber, dieselbe Liste zu teilen, die in derselben Hierarchiestufe für die Anzeige der Felder verwendet wird
      // darum wird hier für jede Seite eine eigene verwendet
      if (window.em[window.localStorage.FeldlisteFwName]) {
        window.em.initiiereFelderWählen_2()
      } else {
        // holt die Feldliste aus der DB
        var $db = $.couch.db('evab')
        $db.view('evab/' + FeldlisteViewname + '?include_docs=true', {
          success: function (data) {
            window.em[window.localStorage.FeldlisteFwName] = data
            window.em.initiiereFelderWählen_2()
          }
        })
      }
    }

    window.em.initiiereFelderWählen_2 = function () {
      'use strict'
      var htmlContainer = "<div class='ui-field-contain'>\n\t<fieldset data-role='controlgroup'>",
        anzFelder = 0,
        Feld,
        FeldName,
        FeldBeschriftung,
        listItem
      _.each(window.em[window.localStorage.FeldlisteFwName].rows, function (row) {
        Feld = row.doc
        FeldName = Feld.FeldName
        // Nur eigene und offizielle Felder berücksichtigen
        if (Feld.User === window.localStorage.Email || Feld.User === 'ZentrenBdKt') {
          // im Formular fix integrierte Felder nicht aufbauen
          if (eval(window.localStorage.KriterienFürZuWählendeFelder)) {
            anzFelder += 1
            FeldBeschriftung = Feld.Hierarchiestufe + ': ' + Feld.FeldBeschriftung
            if (Feld.Hierarchiestufe === 'Art' && Feld.ArtGruppe && Feld.ArtGruppe[0] !== 'alle' && Feld.ArtGruppe.indexOf(window.localStorage.aArtGruppe) === -1) {
              FeldBeschriftung += "<span style='font-weight:normal;'> (nicht sichtbar in Artgruppe " + window.localStorage.aArtGruppe + ')</span>'
            }
            listItem = "<label for='"
            listItem += FeldName
            listItem += "'>"
            listItem += FeldBeschriftung
            listItem += "</label><input type='checkbox' name='"
            listItem += 'Felder'
            listItem += "' id='"
            listItem += FeldName
            listItem += "' FeldId='"
            listItem += Feld._id
            listItem += "' value='"
            listItem += FeldName
            listItem += "' class='custom'"
            if (window.localStorage.AufrufendeSeiteFW === 'BeobEdit') {
              if (Feld.SichtbarImModusEinfach) {
                if (Feld.SichtbarImModusEinfach.indexOf(window.localStorage.Email) !== -1) {
                  // wenn sichtbar, anzeigen
                  listItem += " checked='checked'"
                }
              }
            } else if (window.localStorage.AufrufendeSeiteFW === 'hArtEditListe') {
              if (Feld.SichtbarInHArtEditListe) {
                if (Feld.SichtbarInHArtEditListe.indexOf(window.localStorage.Email) !== -1) {
                  // wenn sichtbar, anzeigen
                  listItem += " checked='checked'"
                }
              }
            } else {
              if (Feld.SichtbarImModusHierarchisch) {
                if (Feld.SichtbarImModusHierarchisch.indexOf(window.localStorage.Email) !== -1) {
                  // wenn sichtbar, anzeigen
                  listItem += " checked='checked'"
                }
              }
            }
            listItem += '/>'
            htmlContainer += listItem
          }
        }
      })
      $('#FelderWaehlenPageHeader')
        .find('.FelderWaehlenPageTitel')
        .text(anzFelder + ' Felder')
      htmlContainer += '</fieldset></div>'
      $('#FeldlisteFW').html(htmlContainer).trigger('create')
      $("input[name='Felder']").checkboxradio()
      // letzte url speichern - hier und nicht im pageshow, damit es bei jedem Datensatzwechsel passiert
      window.em.speichereLetzteUrl()
    }

    // kreiert ein neues Feld
    // wird benutzt von FeldListe.html und FeldEdit.html
    window.em.neuesFeld = function () {
      'use strict'
      var NeuesFeld = {},
        hierarchiestufe
      NeuesFeld.Typ = 'Feld'
      NeuesFeld.User = window.localStorage.Email
      NeuesFeld.SichtbarImModusEinfach = []
      NeuesFeld.SichtbarImModusHierarchisch = []
      NeuesFeld.SichtbarInHArtEditListe = []
      // Hierarchiestufe aufgrund der Herkunft wählen
      switch (window.localStorage.zurueck) {
        case 'hProjektEdit.html':
        case 'hProjektListe.html':
          hierarchiestufe = 'Projekt'
          break
        case 'hRaumEdit.html':
        case 'hRaumListe.html':
          hierarchiestufe = 'Raum'
          break
        case 'hOrtEdit.html':
        case 'hOrtListe.html':
          hierarchiestufe = 'Ort'
          break
        case 'hZeitEdit.html':
        case 'hZeitListe.html':
          hierarchiestufe = 'Zeit'
          break
        default:
          hierarchiestufe = 'Art'
          break
      }
      NeuesFeld.Hierarchiestufe = hierarchiestufe
      // Feldtyp vorwählen
      NeuesFeld.Formularelement = 'textinput'
      NeuesFeld.InputTyp = 'text'
      // gleich sichtbar stellen
      NeuesFeld.SichtbarImModusEinfach.push(window.localStorage.Email)
      NeuesFeld.SichtbarImModusHierarchisch.push(window.localStorage.Email)
      NeuesFeld.SichtbarInHArtEditListe.push(window.localStorage.Email)
      var $db = $.couch.db('evab')
      $db.saveDoc(NeuesFeld, {
        success: function (data) {
          window.localStorage.FeldId = data.id
          NeuesFeld._id = data.id
          NeuesFeld._rev = data.rev
          window.em.Feld = NeuesFeld
          // Feldliste soll neu aufgebaut werden
          window.em.leereStorageFeldListe()
          $(':mobile-pagecontainer').pagecontainer('change', 'FeldEdit.html', { allowSamePageTransition: true })
        },
        error: function () {
          window.em.melde('Fehler: Feld nicht erzeugt')
        }
      })
    }

    // MOMENTAN NICHT BENUTZT
    window.em.prüfeAnmeldung = function () {
      'use strict'
      // Username Anmeldung überprüfen
      // Wenn angemeldet, globale Variable Username aktualisieren
      // Wenn nicht angemeldet, Anmeldedialog öffnen
      if (!window.localStorage.Email) {
        $.ajax({
          url: '/_session',
          dataType: 'json',
          async: false
        }).done(function (session) {
          if (session.userCtx.name !== undefined && session.userCtx.name !== null) {
            window.localStorage.Email = session.userCtx.name
          } else {
            window.localStorage.UserStatus = 'neu'
            $.mobile.navigate('index.html')
          }
        })
      }
    }

    // setzt die OrtId, damit hOrtEdit.html am richtigen Ort öffnet
    // und ruft dann hOrtEdit.html auf
    // wird von den Links in der Karte benutzt
    window.em.öffneOrt = function (OrtId) {
      'use strict'
      window.localStorage.OrtId = OrtId
      $.mobile.navigate('hOrtEdit.html')
    }

    // setzt die BeobId, damit BeobEdit.html am richtigen Ort öffnet
    // und ruft dann BeobEdit.html auf
    // wird von den Links in der Karte auf BeobListe.html benutzt
    window.em.öffneBeob = function (BeobId) {
      'use strict'
      window.localStorage.BeobId = BeobId
      $.mobile.navigate('BeobEdit.html')
    }

    // wird benutzt in Artenliste.html
    // wird dort aufgerufen aus pageshow und pageinit, darum hierhin verlagert
    // erwartet einen filterwert
    // Wenn mehrmals nacheinander dieselbe Artenliste aufgerufen wird, soll wenn möglich die alte Liste verwendet werden können
    // möglich ist dies wenn diese Faktoren gleich sind: Artgruppe, allfällige Unterauswahl
    window.em.initiiereArtenliste = function (filterwert) {
      'use strict'
      // wenn alle drei Faktoren gleich sind, direkt die Artenliste erstellen
      // nur wenn eine Artenliste existiert. Grund: window.em.Artenliste lebt nicht so lang wie window.localStorage
      // aber die Artenliste aus der window.localStorage zu parsen macht auch keinen sinn
      if (window.em.Artenliste && window.localStorage.aArtGruppeZuletzt === window.localStorage.aArtGruppe) {
        window.em.erstelleArtenliste(filterwert)
      } else {
        // sonst aus der DB holen
        window.em.holeArtenliste(filterwert)
      }
      // letzte Artgruppe aktualisieren
      window.localStorage.aArtGruppeZuletzt = window.localStorage.aArtGruppe
    }

    // wird benutzt in Artenliste.html
    // aufgerufen von initiiereArtenliste
    window.em.holeArtenliste = function (filterwert) {
      'use strict'
      var viewname = 'evab/Artliste?startkey=["' + encodeURIComponent(window.localStorage.aArtGruppe) + '"]&endkey=["' + encodeURIComponent(window.localStorage.aArtGruppe) + '",{},{}]&include_docs=true'
      var $db = $.couch.db('evab')
      $db.view(viewname, {
        success: function (data) {
          window.em.Artenliste = data.rows
          window.em.erstelleArtenliste(filterwert)
        }
      })
    }

    // bekommt eine Artenliste und baut damit im Formular die Artenliste auf
    // filterwert: übergebener Teil aus der Artbezeichnung
    window.em.erstelleArtenliste = function (filterwert) {
      'use strict'
      var html = '',
        ArtBezeichnung,
        artenliste_gefiltert
      // gefiltert werden muss nur, wenn mehr als 200 Arten aufgelistet würden
      if (window.em.Artenliste.length > 0) {
        if (filterwert) {
          // artenliste filtern
          artenliste_gefiltert = _.filter(window.em.Artenliste, function (art) {
            ArtBezeichnung = art.key[2]
            return ArtBezeichnung.toLowerCase().indexOf(filterwert) > -1
          })
          if (artenliste_gefiltert.length > 0) {
            if (artenliste_gefiltert.length > 200) {
              html = '<li class="artlistenhinweis">' + artenliste_gefiltert.length + ' Arten gefiltert.<br>Um Mobilgeräte nicht zu überfordern, <b>werden nur die ersten 200 angezeigt</b>.<br>Versuchen Sie einen strengeren Filter</li>'
            } else {
              html = '<li class="artlistenhinweis">' + artenliste_gefiltert.length + ' Arten gefiltert</li>'
            }
            // html der ersten 200 aufbauen
            _.each(_.first(artenliste_gefiltert, 200), function (art_row) {
              ArtBezeichnung = art_row.key[2]
              html += window.em.holeHtmlFürArtInArtenliste(art_row.doc, ArtBezeichnung)
            })

          } else {
            html = '<li class="artlistenhinweis">Keine Arten gefunden</li>'
          }
        } else {
          // kein Filter gesetzt
          if (window.em.Artenliste.length > 200) {
            html = '<li class="artlistenhinweis">Die Artengruppe hat ' + window.em.Artenliste.length + ' Arten.<br>Um Mobilgeräte nicht zu überfordern, <b>werden nur die ersten 200 angezeigt</b>.<br>Tipp: Setzen Sie einen Filter</li>'
          } else {
            html = '<li class="artlistenhinweis">' + window.em.Artenliste.length + ' Arten</li>'
          }
          // erste zweihundert anzeigen
          _.each(_.first(window.em.Artenliste, 200), function (art_row) {
            ArtBezeichnung = art_row.key[2]
            html += window.em.holeHtmlFürArtInArtenliste(art_row.doc, ArtBezeichnung)
          })
        }
      } else {
        // Artenliste.length ==== 0
        html = '<li class="artlistenhinweis">Die Artengruppe enthält keine Arten</li>'
      }
      $('#al_ArtenListe')
        .html(html)
        .show()
        .listview('refresh')
      // Fokus in das Suchfeld setzen
      $('#Artenliste')
        .find('.ui-input-search')
        .children('input')[0]
        .focus()

    }

    window.em.holeHtmlFürArtInArtenliste = function (Art, ArtBezeichnung) {
      'use strict'
      var html = "<li name='ArtListItem' ArtBezeichnung='"
      html += ArtBezeichnung
      html += "' ArtId='"
      html += Art._id
      html += "'>"
      html += "<a href='#'><h3>"
      html += ArtBezeichnung
      html += '<\/h3>'
      if (Art.HinweisVerwandschaft) {
        html += '<p>' + Art.HinweisVerwandschaft + '<\/p>'
      }
      html += '<\/a><\/li>'
      return html
    }

    // wird benutzt in Artgruppenliste.html
    // aufgerufen von erstelleArtgruppenListe
    window.em.erstelleArtgruppenListe = function () {
      'use strict'
      // Artgruppenliste verfügbar machen
      if (window.em.Artgruppenliste) {
        window.em.erstelleArtgruppenListe_2()
      } else if (window.localStorage.Artgruppenliste) {
        window.em.Artgruppenliste = JSON.parse(window.localStorage.Artgruppenliste)
        window.em.erstelleArtgruppenListe_2()
      } else {
        var $db = $.couch.db('evab')
        $db.view('evab/Artgruppen?include_docs=true', {
          success: function (data) {
            // Artgruppenliste bereitstellen
            window.em.Artgruppenliste = data
            window.localStorage.Artgruppenliste = JSON.stringify(window.em.Artgruppenliste)
            window.em.erstelleArtgruppenListe_2()
          }
        })
      }
    }

    // wird benutzt in Artgruppenliste.html
    // aufgerufen von erstelleArtgruppenListe
    window.em.erstelleArtgruppenListe_2 = function () {
      'use strict'
      var html = '',
        ArtGruppe,
        AnzArten
      _.each(window.em.Artgruppenliste.rows, function (row) {
        ArtGruppe = row.key
        AnzArten = row.doc.AnzArten
        html += "<li name='ArtgruppenListItem' ArtGruppe='" + ArtGruppe + "'>"
        html += "<a href='#'><h3>" + ArtGruppe + "<\/h3><span class='ui-li-count'>" + AnzArten + '</span><\/a><\/li>'
      })
      $('#agl_ArtgruppenListe')
        .html(html)
        .listview('refresh')
      $('#agl_Hinweistext')
        .empty()
        .remove()
      // Fokus in das Suchfeld setzen
      $('#Artgruppenliste')
        .find('.ui-input-search')
        .children('input')[0]
        .focus()
    }

    // Stellt die Daten des Users bereit
    // In der Regel nach gelungener Anmeldung
    // Auch wenn eine Seite direkt geöffnet wird und die Userdaten vermisst
    // braucht den Usernamen
    window.em.stelleUserDatenBereit = function () {
      'use strict'
      window.em.holeAutor()
      $.couch.userDb(function (db) {
        db.openDoc('org.couchdb.user:' + window.localStorage.Email, {
          success: function (doc) {
            if (doc.Datenverwendung) {
              window.localStorage.Datenverwendung = doc.Datenverwendung
            } else {
              // Datenverwendung existiert nicht
              // Kann es sein, dass dieser User sein Konto ursprünglich in ArtenDb erstellt hat
              $.mobile.navigate('UserEdit.html')
              return
            }
            window.em.öffneZuletztBenutzteSeite()
          }
        })
      })
    }

    // wird benutzt von window.em.stelleUserDatenBereit()
    // öffnet die zuletzt benutzte Seite oder BeobListe.html
    window.em.öffneZuletztBenutzteSeite = function () {
      'use strict'
      var LetzteUrl
      // unendliche Schlaufe verhindern, falls LetzteUrl auf diese Seite verweist
      if (window.localStorage.LetzteUrl && window.localStorage.LetzteUrl !== '/evab/_design/evab/index.html') {
        LetzteUrl = window.localStorage.LetzteUrl
      } else {
        LetzteUrl = 'BeobListe.html'
      }
      $.mobile.navigate(LetzteUrl)
    }

    // die nachfolgenden funktionen bereinigen die window.localStorage und die globalen Variabeln
    // sie entfernen die im jeweiligen Formular ergänzten window.localStorage-Einträge
    // mitLatLngListe gibt an, ob die Liste für die Karte auch entfernt werden soll

    window.em.leereAlleVariabeln = function (ohneClear) {
      'use strict'
      // ohne clear: nötig, wenn man in FelderWaehlen.html ist und keine aufrufende Seite kennt
      // Username soll erhalten bleiben
      if (!ohneClear) {
        window.localStorage.clear()
      }
      delete window.localStorage.Autor
      window.em.leereStorageProjektListe('mitLatLngListe')
      window.em.leereStorageProjektEdit('mitLatLngListe')
      window.em.leereStorageRaumListe('mitLatLngListe')
      window.em.leereStorageRaumEdit('mitLatLngListe')
      window.em.leereStorageOrtListe('mitLatLngListe')
      window.em.leereStorageOrtEdit()
      window.em.leereStorageZeitListe()
      window.em.leereStorageZeitEdit()
      window.em.leereStoragehArtListe()
      window.em.leereStoragehArtEdit()
      window.em.leereStorageBeobListe()
      window.em.leereStorageBeobEdit()
      window.em.leereStorageFeldListe()
      window.em.leereStorageFeldEdit()
    }

    window.em.leereStorageProjektListe = function (mitLatLngListe) {
      'use strict'
      delete window.em.Projektliste
      if (mitLatLngListe) {
        delete window.em.hOrteLatLngProjektliste
      }
    }

    // ohneId wird beim paginaten benutzt, da die ID übermittelt werden muss
    window.em.leereStorageProjektEdit = function (mitLatLngListe, ohneId) {
      'use strict'
      if (!ohneId) {
        delete window.localStorage.ProjektId
      }
      delete window.em.hProjekt
      if (mitLatLngListe) {
        delete window.em.hOrteLatLngProjekt
      }
      // hierarchisch tiefere Listen löschen
      delete window.em.RaeumeVonProjekt
      delete window.em.OrteVonProjekt
      delete window.em.OrteVonRaum
      delete window.em.ZeitenVonProjekt
      delete window.em.ZeitenVonRaum
      delete window.em.ZeitenVonOrt
      delete window.em.ArtenVonProjekt
      delete window.em.ArtenVonRaum
      delete window.em.ArtenVonOrt
      delete window.em.ArtenVonZeit
    }

    window.em.leereStorageRaumListe = function (mitLatLngListe) {
      'use strict'
      delete window.em.RaumListe
      if (mitLatLngListe) {
        delete window.em.hOrteLatLngProjekt
      }
      delete window.em.RaeumeVonProjekt
    }

    window.em.leereStorageRaumEdit = function (mitLatLngListe, ohneId) {
      'use strict'
      if (!ohneId) {
        delete window.localStorage.RaumId
      }
      delete window.em.hRaum
      if (mitLatLngListe) {
        delete window.em.hOrteLatLngRaum
      }
      // hierarchisch tiefere Listen löschen
      delete window.em.OrteVonProjekt
      delete window.em.OrteVonRaum
      delete window.em.ZeitenVonProjekt
      delete window.em.ZeitenVonRaum
      delete window.em.ZeitenVonOrt
      delete window.em.ArtenVonProjekt
      delete window.em.ArtenVonRaum
      delete window.em.ArtenVonOrt
      delete window.em.ArtenVonZeit
    }

    window.em.leereStorageOrtListe = function (mitLatLngListe) {
      'use strict'
      delete window.em.OrtListe
      if (mitLatLngListe) {
        delete window.em.hOrteLatLngRaum
      }
      delete window.em.OrteVonProjekt
      delete window.em.OrteVonRaum
    }

    window.em.leereStorageOrtEdit = function (ohneId) {
      'use strict'
      if (!ohneId) {
        delete window.localStorage.OrtId
      }
      delete window.em.hOrt
      delete window.localStorage.oXKoord
      delete window.localStorage.oYKoord
      delete window.localStorage.oLagegenauigkeit
      delete window.localStorage.oLatitudeDecDeg
      delete window.localStorage.oLongitudeDecDeg
      delete window.localStorage.aArtId
      delete window.localStorage.aArtName
      delete window.localStorage.aArtGruppe
      // hierarchisch tiefere Listen löschen
      delete window.em.ZeitenVonProjekt
      delete window.em.ZeitenVonRaum
      delete window.em.ZeitenVonOrt
      delete window.em.ArtenVonProjekt
      delete window.em.ArtenVonRaum
      delete window.em.ArtenVonOrt
      delete window.em.ArtenVonZeit
      // allfällige Lokalisierung abbrechen
      if (typeof window.em.watchID !== 'undefined') {
        window.em.stopGeolocation()
      }
    }

    window.em.leereStorageZeitListe = function () {
      'use strict'
      delete window.em.ZeitListe
      delete window.em.ZeitenVonProjekt
      delete window.em.ZeitenVonRaum
      delete window.em.ZeitenVonOrt
    }

    window.em.leereStorageZeitEdit = function (ohneId) {
      'use strict'
      if (!ohneId) {
        delete window.localStorage.ZeitId
      }
      delete window.em.hZeit
      // hierarchisch tiefere Listen löschen
      delete window.em.ArtenVonProjekt
      delete window.em.ArtenVonRaum
      delete window.em.ArtenVonOrt
      delete window.em.ArtenVonZeit
    }

    window.em.leereStoragehArtListe = function () {
      'use strict'
      delete window.em.hArtListe
      delete window.em.ArtenVonProjekt
      delete window.em.ArtenVonRaum
      delete window.em.ArtenVonOrt
      delete window.em.ArtenVonZeit
    }

    window.em.leereStoragehArtEdit = function (ohneId) {
      'use strict'
      if (!ohneId) {
        delete window.localStorage.hArtId
      }
      delete window.em.hArt
    }

    window.em.leereStorageBeobListe = function () {
      'use strict'
      delete window.em.BeobListe
      delete window.em.BeobListeLatLng
    }

    window.em.leereStorageBeobEdit = function (ohneId) {
      'use strict'
      if (!ohneId) {
        delete window.localStorage.BeobId
      }
      delete window.em.Beobachtung
      delete window.localStorage.oXKoord
      delete window.localStorage.oYKoord
      delete window.localStorage.oLagegenauigkeit
      delete window.localStorage.oLatitudeDecDeg
      delete window.localStorage.oLongitudeDecDeg
      delete window.localStorage.aArtId
      delete window.localStorage.aArtName
      delete window.localStorage.aArtGruppe
      // allfällige Lokalisierung abbrechen
      if (typeof window.em.watchID !== 'undefined') {
        window.em.stopGeolocation()
      }
    }

    window.em.leereStorageFeldListe = function () {
      'use strict'
      delete window.em.Feldliste
      delete window.em.FeldlisteBeobEdit
      delete window.em.FeldlistehArtEdit
      delete window.em.FeldlistehArtEditListe
      delete window.em.FeldlisteZeitEdit
      delete window.em.FeldlisteOrtEdit
      delete window.em.FeldlisteRaumEdit
      delete window.em.FeldlisteProjekt
    }

    window.em.leereStorageFeldEdit = function (ohneId) {
      'use strict'
      if (!ohneId) {
        delete window.localStorage.FeldId
      }
      delete window.em.Feld
    }

    // setzt alle Felder im Modus Hierarchisch sichtbar
    // Erwartet die Email
    // Modus einfach wird hier nicht eingestellt: Die minimalen Felder sind fix programmiert
    // wird verwendet in: Signup.html, UserEdit.html
    window.em.erstelleSichtbareFelder = function () {
      'use strict'
      var viewname = 'evab/FeldListeFeldName?include_docs=true'
      var $db = $.couch.db('evab')
      $db.view(viewname, {
        success: function (data) {
          var Feld
          _.each(data.rows, function (row) {
            Feld = row.doc
            // Nur ausgewählte offizielle Felder berücksichtigen
            // if (Feld.User === "ZentrenBdKt") {
            if (['pBemerkungen', 'rBemerkungen', 'oLatitudeDecDeg', 'oLongitudeDecDeg', 'oHöhe', 'oHöheGenauigkeit', 'oBemerkungen', 'zBemerkungen', 'aArtNameUnsicher', 'aArtNameEigener', 'aArtNameBemerkungen', 'aMenge', 'aBemerkungen'].indexOf(Feld.FeldName) > -1) {
              $db.openDoc(Feld._id, {
                success: function (Feld) {
                  var Username = window.localStorage.Email
                  Feld.SichtbarImModusHierarchisch.push(Username)
                  $db.saveDoc(Feld)
                }
              })
            }
          })
        }
      })
    }

    // erstellt die sichtbaren Felder
    // wird benutzt von: Signup.html
    window.em.speichereAutorAlsStandardwert = function () {
      'use strict'
      var $db = $.couch.db('evab')
      $db.openDoc('f19cd49bd7b7a150c895041a5d02acb0', {
        success: function (Feld) {
          // Falls Standardwert noch nicht existiert, 
          // muss zuerst das Objekt geschaffen werden
          if (!Feld.Standardwert) {
            Feld.Standardwert = {}
          }
          Feld.Standardwert[window.localStorage.Email] = window.localStorage.Autor
          $db.saveDoc(Feld, {
            success: function () {
              // Felder sictbar schalten
              window.em.erstelleSichtbareFelder()
              // Feldliste soll neu aufgebaut werden
              window.em.leereStorageFeldListe()
              $.mobile.navigate('BeobListe.html')
            },
            error: function () {
              window.em.erstelleSichtbareFelder()
              window.em.melde('Konto erfolgreich erstellt\nAnmeldung gescheitert\nBitte melden Sie sich neu an')
            }
          })
        },
        error: function () {
          window.em.erstelleSichtbareFelder()
          window.em.melde('Konto erfolgreich erstellt\nAnmeldung gescheitert\nBitte melden Sie sich neu an')
        }
      })
    }

    /*
    *validiert email-adressen
    *Quelle: http://stackoverflow.com/questions/2507030/email-validation-using-jquery
    */
    window.em.validateEmail = function (email) {
      'use strict'
      var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/
      return emailReg.test(email)
    }

    // testet, ob die lokale Version erreichbar ist
    // wenn ja, wird diese geöffnet, sonst arteigenschaften.ch
    window.em.öffneEigenschaftenVonArt = function (id) {
      'use strict'
      var url,
        // neues Fenster jetzt schon gründen
        // wenn man window.open nach dem callback ausführt, öffnet das Fenster als popup
        win = window.open('', '_blank')

      $.ajax({
        type: 'HEAD',
        url: 'http://127.0.0.1:5984/artendb/_design/artendb/index.html'
      })
        .done(function () {
          // lokale db ist erreichbar, diese verwenden
          url = 'http://127.0.0.1:5984/artendb/_design/artendb/index.html?id=' + id
          // url des im neuen tab geöffneten Fensters anpassen
          win.location.href = url
        })
        .fail(function () {
          // lokale db ist nicht erreichbar
          url = 'http://arteigenschaften.ch/artendb/_design/artendb/index.html?id=' + id
          // url des im neuen tab geöffneten Fensters anpassen
          win.location.href = url
        })
    }

    // wenn Artenliste.html initiiert wird
    window.em.handleAlPageinit = function () {
      'use strict'
      $(document)
        .on('keypress', window.em.handleAlKeypress)

      $('#Artenliste')
        .on('click', '#al_filter_setzen', window.em.handleAlAlFilterClick)
        .on('click', '.ui-icon-delete', window.em.handleAlUiIconDeleteClick)
        .on('click', '#al_standardgruppe', window.em.handleAlAlStandardgruppeClick)

      $('#al_ArtenListe')
        .on('click', "[name='ArtListItem']", function (event) {
          event.preventDefault()
          window.em.handleAlArtListItemClick(this)
        })
    }

    // wenn Artenliste.html gezeigt wird
    window.em.handleAlPageshow = function () {
      'use strict'
      window.em.initiiereArtenliste('')
      if (window.em.gruppe_merken) {
        $('#al_standardgruppe').removeClass('ui-disabled')
      } else {
        $('#al_standardgruppe').addClass('ui-disabled')
      }
    }

    // wenn Artenliste.html verschwindet
    window.em.handleAlPagehide = function () {
      'use strict'
      $('#al_ArtenListe').hide()
    }

    // wenn in Artenliste.html eine Taste gedrückt wird
    window.em.handleAlKeypress = function () {
      'use strict'
      if (event.which == 13) {
        var filterwert = $('#al_filter').val().toLowerCase()
        window.em.initiiereArtenliste(filterwert)
      }
    }

    // wenn in Artenliste.html #al_filter_setzen geklickt wird
    window.em.handleAlAlFilterClick = function () {
      'use strict'
      var filterwert = $('#al_filter').val().toLowerCase()
      window.em.initiiereArtenliste(filterwert)
    }

    // wenn in Artenliste.html .ui-icon-delete geklickt wird
    window.em.handleAlUiIconDeleteClick = function () {
      'use strict'
      var filterwert = ''
      window.em.initiiereArtenliste(filterwert)
    }

    // wenn in Artenliste.html #al_standardgruppe geklickt wird
    window.em.handleAlAlStandardgruppeClick = function () {
      'use strict'
      delete window.em.gruppe_merken
      $.mobile.navigate('Artgruppenliste.html')
    }

    // wenn in Artenliste.html [name='ArtListItem'] geklickt wird
    window.em.handleAlArtListItemClick = function (that) {
      'use strict'
      var ArtBezeichnung = $(that).attr('ArtBezeichnung'),
        artid = $(that).attr('artid'),
        harten_mit_gleicher_artid = []

      // kontrollieren, ob diese Art schon erfasst wurde
      // Vorsicht: window.em.hArtListe existiert nicht, wenn in hArtEdit F5 gedrückt wurde!
      if (window.em.hArtListe && window.em.hArtListe.rows) {
        harten_mit_gleicher_artid = _.filter(window.em.hArtListe.rows, function (row) {
          return row.doc.aArtId === artid && artid !== undefined
        })
      }

      if (harten_mit_gleicher_artid.length > 0) {
        window.em.melde('Diese Art wurde bereits erfasst')
      } else {
        window.localStorage.aArtId = artid
        if (window.localStorage.Status === 'neu') {
          window.em.speichereNeueBeob(ArtBezeichnung)
        } else {
          window.em.speichereBeobNeueArtgruppeArt(ArtBezeichnung)
        }
      }
    }

    // wenn Artgruppenliste.html erscheint
    window.em.handleAglPageshow = function () {
      'use strict'
      window.em.erstelleArtgruppenListe()
      delete window.em.gruppe_merken
    }

    // wenn Artgruppenliste.html verschwindet
    window.em.handleAglPagehide = function () {
      'use strict'
      $('#agl_standardgruppe').html('nächste Gruppe merken')
    }

    // wenn Artgruppenliste.html initiiert wird
    window.em.handleAglPageinit = function () {
      'use strict'
      // Vorsicht: Genauer als body funktioniert hier nicht,
      // weil die nested List im DOM jedes mal eine eigene Page aufbaut
      $('body')
        .on('click', "[name='ArtgruppenListItem']", function (event) {
          event.preventDefault()
          window.em.handleAglArtgruppenListItemClick(this)
        })

      $('#Artgruppenliste')
        .on('click', '#agl_standardgruppe', window.em.handleAglAglStandardgruppeClick)
    }

    // wenn in Artgruppenliste.html [name='ArtgruppenListItem'] geklickt wird
    window.em.handleAglArtgruppenListItemClick = function (that) {
      'use strict'
      window.localStorage.aArtGruppe = $(that).attr('ArtGruppe')
      // wenn die Gruppe gemerkt werden soll, sie als globale Variable speichern
      if (window.em.gruppe_merken) {
        window.em.gruppe_merken = $(that).attr('ArtGruppe')
      }
      $.mobile.navigate('Artenliste.html')
    }

    // wenn in Artgruppenliste.html #agl_standardgruppe geklickt wird
    window.em.handleAglAglStandardgruppeClick = function () {
      'use strict'
      if ($(this).html() === 'nächste Gruppe merken') {
        window.em.gruppe_merken = true
        $(this).html('nächste Gruppe wird gemerkt')
      } else {
        delete window.em.gruppe_merken
        $(this).html('nächste Gruppe merken')
      }
    }

    // wenn BeobEdit.html erscheint
    window.em.handleBeobEditPageshow = function () {
      'use strict'
      // Sollte keine id vorliegen, zu BeobListe.html wechseln
      // das kommt im Normalfall nur vor, wenn der Cache des Browsers geleert wurde
      // oder in der Zwischenzeit auf einem anderen Browser dieser Datensatz gelöscht wurde
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if ((!window.localStorage.Status || window.localStorage.Status === 'undefined') && (!window.localStorage.BeobId || window.localStorage.BeobId === 'undefined')) {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('BeobListe.html')
        return
      }
      window.em.initiiereBeobEdit()
    }

    // wenn BeobEdit.html verschwindet
    window.em.handleBeobEditPagehide = function () {
      'use strict'
      if (typeof window.em.watchID !== 'undefined') {
        window.em.stopGeolocation()
      }
    }

    // wenn BeobEdit.html initiiert wird
    window.em.handleBeobEditPageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if ((!window.localStorage.Status || window.localStorage.Status === 'undefined') && (!window.localStorage.BeobId || window.localStorage.BeobId === 'undefined')) {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('BeobListe.html')
        return
      }

      $('#BeobEditHeader')
        .on('click', '#OeffneBeobListeBeobEdit', window.em.handleOeffneBeobListeBeobEditClick)

      $('#BeobEditForm')
        .on('click', '.aArtGruppe', function (event) {
          event.preventDefault()
          window.em.handleBeobEditAArtGruppeClick()
        })
        .on('click', '.aArtName', function (event) {
          event.preventDefault()
          window.em.handleBeobEditAArtnameClick()
        })
        .on('change', '.speichern', window.em.handleBeobEditSpeichernChange)
        // Eingabe im Zahlenfeld abfangen (blur)
        // Ende des Schiebens abfangen (slidestop)
        .on('blur slidestop', '.speichernSlider', window.em.speichereBeob)
        // Klicken auf den Pfeilen im Zahlenfeld abfangen
        .on('mouseup', '.ui-slider-input', window.em.speichereBeob)

      $('#BeobEditPageFooterNavbar')
        .on('click', '#NeueBeobBeobEdit', function (event) {
          event.preventDefault()
          window.em.handleNeueBeobBeobEditClick()
        })
        .on('click', '#waehleFelderBeobEdit', function (event) {
          event.preventDefault()
          window.em.handleWaehleFelderBeobEditClick()
        })
        .on('click', '#OeffneKarteBeobEdit', function (event) {
          event.preventDefault()
          window.em.handleBeobEditOeffneKarteClick()
        })
        .on('click', '#verorteBeobBeobEdit', function (event) {
          event.preventDefault()
          window.em.GetGeolocation(window.localStorage.BeobId, 'Beob')
        })
        .on('click', '#LoescheBeobBeobEdit', function (event) {
          event.preventDefault()
          $('#beob_löschen_meldung').popup('open')
        })

      $('#beob_löschen_meldung')
        .on('click', '#beob_löschen_meldung_ja_loeschen', window.em.löscheBeob)

      $('#FormAnhängeBE')
        .on('change', '.speichernAnhang', window.em.handleBeobEditSpeichernAnhangChange)
        .on('click', "[name='LöscheAnhang']", function (event) {
          event.preventDefault()
          window.em.löscheAnhang(this, window.em.Beobachtung, window.localStorage.BeobId)
        })

      $('#BeobEdit')
        .on('swipeleft', '#BeobEditContent', window.em.handleBeobEditContentSwipeleft)
        .on('swiperight', '#BeobEditContent', window.em.handleBeobEditContentSwiperight)
        .on('vclick', '.ui-pagination-prev', function (event) {
          event.preventDefault()
          // zum vorigen Datensatz wechseln
          window.em.nächsteVorigeBeob('vorige')
        })
        .on('vclick', '.ui-pagination-next', function (event) {
          event.preventDefault()
          // zum nächsten Datensatz wechseln
          window.em.nächsteVorigeBeob('nächste')
        })
        .on('keyup', function (event) {
          'use strict'
          // Wechsel zwischen Datensätzen via Pfeiltasten steuern
          // nicht in separate Funktion auslagern, weil IE9 event.preventDefault nicht kenn (und hier jQuery das abfängt)
          // nur reagieren, wenn BeobEdit sichtbar und Fokus nicht in einem Feld
          if (!$(event.target).is('input, textarea, select, button') && $('#BeobEdit').is(':visible')) {
            // Left arrow
            if (event.keyCode === $.mobile.keyCode.LEFT) {
              window.em.nächsteVorigeBeob('vorige')
              event.preventDefault()
            }
            // Right arrow
            else if (event.keyCode === $.mobile.keyCode.RIGHT) {
              window.em.nächsteVorigeBeob('nächste')
              event.preventDefault()
            }
          }
        })

      $('#MenuBeobEdit')
        .on('click', '.menu_arteigenschaften', window.em.handleBeobEditMenuArteigenschaftenClick)
        .on('click', '.menu_hierarchischer_modus', window.em.handleBeobEditMenuHierarchischerModusClick)
        .on('click', '.menu_felder_verwalten', window.em.handleBeobEditMenuFelderVerwaltenClick)
        .on('click', '.menu_beob_exportieren', window.em.handleBeobEditMenuBeobExportierenClick)
        .on('click', '.menu_einstellungen', window.em.handleBeobEditMenuEinstellungenClick)
        .on('click', '.menu_neu_anmelden', window.em.meldeNeuAn)
        .on('click', '.menu_artengruppen_importieren', window.em.öffneArtengruppenImportieren)
        .on('click', '.menu_arten_importieren', window.em.öffneArtenImportieren)
        .on('click', '.menu_admin', window.em.öffneAdmin)
    }

    // wenn in BeobEdit.html #OeffneBeobListeBeobEdit geklickt wird
    window.em.handleOeffneBeobListeBeobEditClick = function () {
      'use strict'
      window.em.leereStorageBeobEdit()
      $.mobile.navigate('BeobListe.html')
    }

    // wenn in BeobEdit.html #NeueBeobBeobEdit geklickt wird
    // neue Beobachtung erfassen
    window.em.handleNeueBeobBeobEditClick = function () {
      'use strict'
      // Globale Variable für BeobListe zurücksetzen, damit die Liste neu aufgebaut wird
      window.em.leereStorageBeobListe()
      window.localStorage.Status = 'neu'
      window.localStorage.Von = 'BeobEdit'
      if (window.em.gruppe_merken) {
        // Artgruppenliste auslassen
        // window.localStorage.ArtGruppe ist schon gesetzt
        $.mobile.navigate('Artenliste.html')
      } else {
        $.mobile.navigate('Artgruppenliste.html')
      }
    }

    // wenn in BeobEdit.html .aArtGruppe geklickt wird
    // Editieren von Beobachtungen managen, ausgehend von Artgruppe
    window.em.handleBeobEditAArtGruppeClick = function () {
      'use strict'
      // Globale Variablen für BeobListe zurücksetzen, damit die Liste neu aufgebaut wird
      window.em.leereStorageBeobListe()
      delete window.localStorage.Status	// ja kein Status neu
      window.localStorage.Von = 'BeobEdit'
      if (window.em.gruppe_merken) {
        // Artgruppenliste auslassen
        // window.localStorage.aArtGruppe ist schon gesetzt
        $.mobile.navigate('Artenliste.html')
      } else {
        $.mobile.navigate('Artgruppenliste.html')
      }
    }

    // wenn in BeobEdit.html #waehleFelderBeobEdit geklickt wird
    // sichtbare Felder wählen
    window.em.handleWaehleFelderBeobEditClick = function () {
      'use strict'
      window.localStorage.AufrufendeSeiteFW = 'BeobEdit'
      $.mobile.navigate('FelderWaehlen.html')
    }

    // wenn in BeobEdit.html .aArtName geklickt wird
    // Editieren von Beobachtungen managen, ausgehend von ArtName
    window.em.handleBeobEditAArtnameClick = function () {
      'use strict'
      // Globale Variablen für BeobListe zurücksetzen, damit die Liste neu aufgebaut wird
      window.em.leereStorageBeobListe()
      window.localStorage.Von = 'BeobEdit'
      $.mobile.navigate('Artenliste.html')
    }

    // wenn in BeobEdit.html .speichern geändert wird
    // Für jedes Feld bei Änderung speichern
    window.em.handleBeobEditSpeichernChange = function () {
      'use strict'
      var $oXKoord = $("[name='oXKoord']"),
        $oYKoord = $("[name='oYKoord']"),
        ChToWgsLng = require('./util/chToWgsLng'),
        ChToWgsLat = require('./util/chToWgsLat')
      if (['oXKoord', 'oYKoord'].indexOf(this.name) > -1 && $oXKoord.val() && $oYKoord.val()) {
        // Wenn Koordinaten und beide erfasst
        window.localStorage.oXKoord = $oXKoord.val()
        window.localStorage.oYKoord = $oYKoord.val()
        // Längen- und Breitengrade berechnen
        window.localStorage.oLongitudeDecDeg = ChToWgsLng(window.localStorage.oYKoord, window.localStorage.oXKoord)
        window.localStorage.oLatitudeDecDeg = ChToWgsLat(window.localStorage.oYKoord, window.localStorage.oXKoord)
        window.localStorage.oLagegenauigkeit = null
        // und Koordinaten speichern
        window.em.speichereKoordinaten(window.localStorage.BeobId, 'Beobachtung')
      } else {
        window.em.speichereBeob(this)
      }
    }

    // wenn in BeobEdit.html .speichernAnhang geändert wird
    // Änderungen im Formular für Anhänge speichern
    window.em.handleBeobEditSpeichernAnhangChange = function () {
      'use strict'
      var _attachments = $('#_attachmentsBE').val()
      if (_attachments && _attachments.length !== 0) {
        window.em.speichereAnhänge(window.localStorage.BeobId, window.em.Beobachtung, 'BE')
      }
    }

    // wenn in BeobEdit.html #OeffneKarteBeobEdit geklickt wird
    window.em.handleBeobEditOeffneKarteClick = function () {
      'use strict'
      window.localStorage.zurueck = 'BeobEdit'
      $.mobile.navigate('Karte.html')
    }

    // wenn in BeobEdit.html auf #BeobEditContent nach links gewischt wird
    window.em.handleBeobEditContentSwipeleft = function () {
      'use strict'
      if (!$('*:focus').attr('aria-valuenow')) {
        // kein slider
        window.em.nächsteVorigeBeob('nächste')
      }
    }

    // wenn in BeobEdit.html auf #BeobEditContent nach rechts gewischt wird
    window.em.handleBeobEditContentSwiperight = function () {
      'use strict'
      if (!$('*:focus').attr('aria-valuenow')) {
        // kein slider
        window.em.nächsteVorigeBeob('vorige')
      }
    }

    // wenn in BeobEdit.html .menu_arteigenschaften geklickt wird
    window.em.handleBeobEditMenuArteigenschaftenClick = function () {
      'use strict'
      window.em.öffneEigenschaftenVonArt(window.localStorage.aArtId)
    }

    // wenn in BeobEdit.html .menu_hierarchischer_modus geklickt wird
    window.em.handleBeobEditMenuHierarchischerModusClick = function () {
      'use strict'
      window.em.leereStorageBeobEdit()
      $.mobile.navigate('hProjektListe.html')
    }

    // wenn in BeobEdit.html .menu_felder_verwalten geklickt wird
    window.em.handleBeobEditMenuFelderVerwaltenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'BeobEdit.html'
      $.mobile.navigate('FeldListe.html')
    }

    // wenn in BeobEdit.html .menu_beob_exportieren geklickt wird
    window.em.handleBeobEditMenuBeobExportierenClick = function () {
      'use strict'
      window.open('_list/ExportBeob/ExportBeob?startkey=["' + window.localStorage.Email + '"]&endkey=["' + window.localStorage.Email + '",{},{}]&include_docs=true')
      $('#MenuBeobEdit')
        // völlig unlogisch: das bereits offene popup muss zuerst initialisiert werden...
        .popup()
        // ...bevor es geschlossen werden muss, weil es sonst offen bleibt
        .popup('close')
    }

    // wenn in BeobEdit.html .menu_einstellungen geklickt wird
    window.em.handleBeobEditMenuEinstellungenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'BeobEdit.html'
      window.em.öffneMeineEinstellungen()
    }

    // wenn BeobListe.html erscheint
    window.em.handleBeobListePageshow = function () {
      'use strict'
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      }
      window.em.initiiereBeobliste()
    }

    // Wenn BeobListe.html initiiert wird
    window.em.handleBeobListePageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      }

      $('#BeobListePageFooter')
        .on('click', '#OeffneKarteBeobListe', function (event) {
          event.preventDefault()
          window.em.handleBeobListeOeffneKarteBeobListeClick()
        })

      $('#BeobListePageHeader')
        .on('click', '#OeffneProjektListeBeobListe', function (event) {
          event.preventDefault()
          $.mobile.navigate('hProjektListe.html')
        })

      $('#BeoblisteBL')
        .on('swipeleft click', '.beob', window.em.handleBeobListeBeobSwipeleftClick)
        .on('taphold', '.beob', window.em.handleBeobListeBeobTaphold)
        .on('swipeleft', '.erste', window.em.erstelleNeueBeob_1_Artgruppenliste)

      $('#BeobListe')
        .on('click', '.NeueBeobBeobListe', function (event) {
          event.preventDefault()
          window.em.erstelleNeueBeob_1_Artgruppenliste()
        })
        .on('swiperight', '#BeobListePageContent', window.em.handleBeobListeBeobListePageContentSwiperight)

      $('#MenuBeobListe')
        .on('click', '.menu_hierarchischer_modus', window.em.handleBeobListeMenuHierarchischerModusClick)
        .on('click', '.menu_felder_verwalten', window.em.handleBeobListeMenuFelderVerwaltenClick)
        .on('click', '.menu_beob_exportieren', window.em.handleBeobListeMenuBeobExportierenClick)
        .on('click', '.menu_einstellungen', window.em.handleBeobListeMenuEinstellungenClick)
        .on('click', '.menu_neu_anmelden', window.em.meldeNeuAn)
        .on('click', '.menu_artengruppen_importieren', window.em.öffneArtengruppenImportieren)
        .on('click', '.menu_arten_importieren', window.em.öffneArtenImportieren)
        .on('click', '.menu_admin', window.em.öffneAdmin)
    }

    // wenn in BeobListe.html .beob geklickt oder nach links geswiped wird
    window.em.handleBeobListeBeobSwipeleftClick = function () {
      window.localStorage.BeobId = $(this).attr('id')
      $.mobile.navigate('BeobEdit.html')
    }

    // wenn in BeobListe.html .beob taphold
    window.em.handleBeobListeBeobTaphold = function () {
      // FUNKTIONIERT NICHT, WEIL JQUERY MOBILE NACH TAPHOLD IMMER EINEN TAP AUSFÜHRT!!!!!!!!!!!!!!!	
      console.log('taphold')
    }

    // wenn in BeobListe.html #OeffneKarteBeobListe geklickt wird
    window.em.handleBeobListeOeffneKarteBeobListeClick = function () {
      'use strict'
      window.localStorage.zurueck = 'BeobListe'
      $.mobile.navigate('Karte.html')
    }

    // wenn in BeobListe.html #BeobListePageContent nach rechts gewischt wird
    window.em.handleBeobListeBeobListePageContentSwiperight = function () {
      'use strict'
      $.mobile.navigate('hProjektListe.html')
    }

    // wenn in BeobListe.html .menu_hierarchischer_modus geklickt wird
    window.em.handleBeobListeMenuHierarchischerModusClick = function () {
      'use strict'
      $.mobile.navigate('hProjektListe.html')
    }

    // wenn in BeobListe.html .menu_felder_verwalten geklickt wird
    window.em.handleBeobListeMenuFelderVerwaltenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'BeobListe.html'
      $.mobile.navigate('FeldListe.html')
    }

    // wenn in BeobListe.html .menu_beob_exportieren geklickt wird
    window.em.handleBeobListeMenuBeobExportierenClick = function () {
      'use strict'
      window.open('_list/ExportBeob/ExportBeob?startkey=["' + window.localStorage.Email + '"]&endkey=["' + window.localStorage.Email + '",{},{}]&include_docs=true')
      $('#MenuBeobListe')
        // völlig unlogisch: das bereits offene popup muss zuerst initialisiert werden...
        .popup()
        // ...bevor es geschlossen werden muss, weil es sonst offen bleibt
        .popup('close')
    }

    // wenn in BeobListe.html .menu_einstellungen geklickt wird
    window.em.handleBeobListeMenuEinstellungenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'BeobListe.html'
      window.em.öffneMeineEinstellungen()
    }

    // wenn FeldEdit.html erscheint
    // Sollte keine id vorliegen, zu FeldListe.html wechseln
    // das kommt im Normalfall nur vor, wenn der Cache des Browsers geleert wurde
    // oder in der Zwischenzeit auf einem anderen Browser dieser Datensatz gelöscht wurde
    window.em.handleFeldEditPageshow = function () {
      'use strict'
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
      } else if ((!window.localStorage.Status || window.localStorage.Status === 'undefined') && (!window.localStorage.FeldId || window.localStorage.FeldId === 'undefined')) {
        window.em.leereAlleVariabeln('ohneClear')
        window.em.geheZurueckFE()
      }
      window.em.initiiereFeldEdit()
    }

    // wenn FeldEdit.html initiiert wird
    // Code, der nur beim ersten Aufruf der Seite laufen soll
    window.em.handleFeldEditPageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
      } else if ((!window.localStorage.Status || window.localStorage.Status === 'undefined') && (!window.localStorage.FeldId || window.localStorage.FeldId === 'undefined')) {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('BeobListe.html')
      }

      $('#FeldEditHeader')
        .on('click', '#zurueckFeldEdit', function (event) {
          event.preventDefault()
          window.em.geheZurueckFE()
        })

      $('#UserFeldForm')
        .on('change', '.meineEinstellungen', window.em.handleFeldEditMeineEinstellungenChange)
        .on('change', '#Standardwert', window.em.handleFeldEditStandardwertChange)

      $('#FeldEditForm')
        .on('change', '.Feldeigenschaften', window.em.handleFeldEditFeldeigenschaftenChange)
        .on('change', '#FeldFolgtNach', window.em.handleFeldEditFeldFolgtNachChange)

      $('#fe_löschen_meldung')
        .on('click', '#fe_löschen_meldung_ja_loeschen', window.em.handleFeldEditFeLoeschenMeldungJaClick)

      $('#FeldEdit')
        .on('swipeleft', '#FeldEditContent', window.em.geheZumNächstenFeld)
        .on('swiperight', '#FeldEditContent', window.em.geheZumVorigenFeld)
        .on('vclick', '.ui-pagination-prev', function (event) {
          event.preventDefault()
          window.em.geheZumVorigenFeld()
        })
        .on('vclick', '.ui-pagination-next', function (event) {
          event.preventDefault()
          window.em.geheZumNächstenFeld()
        })
        .on('keyup', function (event) {
          'use strict'
          // wenn in FeldEdit.htm eine Taste gedrückt wird
          // mit Pfeiltasten Datensätze wechseln
          // nur reagieren, wenn hProjektEdit sichtbar und Fokus nicht in einem Feld
          if (!$(event.target).is('input, textarea, select, button') && $('#FeldEdit').is(':visible')) {
            // Left arrow
            if (event.keyCode === $.mobile.keyCode.LEFT) {
              window.em.geheZumVorigenFeld()
              event.preventDefault()
            }
            // Right arrow
            else if (event.keyCode === $.mobile.keyCode.RIGHT) {
              window.em.geheZumNächstenFeld()
              event.preventDefault()
            }
          }
        })

      $('#FeldEditFooter')
        .on('click', '#NeuesFeldFeldEdit', function (event) {
          event.preventDefault()
          window.em.neuesFeld()
        })
        .on('click', '#LoescheFeldFeldEdit', function (event) {
          event.preventDefault()
          window.em.handleFeldEditLoescheFeldFeldEditClick()
        })

      $('#MenuFeldEdit')
        .on('click', '.menu_datenfelder_exportieren', window.em.handleFeldEditMenuDatenfelderExportierenClick)
    }

    window.em.handleFeldEditMeineEinstellungenChange = function () {
      'use strict'
      var feldname = this.name,
        feldwert = this.value
      // prüfen, ob das Feld als Objekt vorliegt
      if (window.em.Feld) {
        // bestehendes Objekt verwenden
        window.em.handleFeldEditMeineEinstellungenChange_2(feldname, feldwert)
      } else {
        // Objekt aus der DB holen
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.FeldId, {
          success: function (data) {
            window.em.Feld = data
            window.em.handleFeldEditMeineEinstellungenChange_2(feldname, feldwert)
          },
          error: function () {
            window.em.melde('Fehler: Die letzte Änderung wurde nicht gespeichert')
          }
        })
      }
    }

    window.em.handleFeldEditMeineEinstellungenChange_2 = function (feldname, feldwert) {
      'use strict'
      // Sichtbarkeitseinstellungen: In einem Array werden die User aufgelistet, welche das Feld sehen
      // Es muss geprüft werden, ob der aktuelle User in diesem Array enthalten ist
      if (feldwert === 'ja') {
        // User ergänzen, wenn noch nicht enthalten
        window.em.Feld[feldname] = _.union(window.em.Feld[feldname], window.localStorage.Email)
      } else if (feldwert === 'nein') {
        // User entfernen, wenn enthalten
        window.em.Feld[feldname] = _.without(window.em.Feld[feldname], window.localStorage.Email)
      }
      var $db = $.couch.db('evab')
      $db.saveDoc(window.em.Feld, {
        success: function (data) {
          window.em.Feld._rev = data.rev
        },
        error: function () {
          window.em.melde('Fehler: Die letzte Änderung wurde nicht gespeichert')
        }
      })
    }

    // wenn in FeldEdit.htm .Feldeigenschaften geändert wird
    // jedes Feld aus Feldeigenschaften bei Änderung speichern
    window.em.handleFeldEditFeldeigenschaftenChange = function () {
      'use strict'
      window.localStorage.FeldWert = this.value
      if (this.name) {
        window.localStorage.FeldName = this.name
        window.localStorage.AlterFeldWert = window.em.Feld[this.name]
      } else {
        window.localStorage.FeldName = this.id
        window.localStorage.AlterFeldWert = window.em.Feld[this.id]
      }
      // Felder der Datenzentren dürfen nicht verändert werden
      // ausser Standardwert, dessen Änderung wird aber in einer anderen Funktion verarbeitet
      // aber: Der Benutzer soll wählen können, in welchen Artgruppen er ein solches Feld anzeigt
      if (window.em.Feld.User === 'ZentrenBdKt' && window.localStorage.FeldName !== 'ArtGruppe') {
        // feldwert zurücksetzen
        if (window.localStorage.AlterFeldWert) {
          $('#' + window.localStorage.FeldName).val(window.localStorage.AlterFeldWert)
        } else {
          $('#' + window.localStorage.FeldName).val('')
        }
        delete window.localStorage.FeldName
        delete window.localStorage.FeldWert
        delete window.localStorage.AlterFeldWert
        window.em.melde('Dies ist ein geschütztes Feld eines öffentlichen Datenzentrums<br><br>Statt dieses zu ändern können Sie ein eigenes Feld erstellen')
      } else if (window.localStorage.FeldName === 'FeldName') {
        // Wenn eigener Feldname verändert wird, kontrollieren, dass er nicht schon verwendet wurde
        // ohne explizit auf undefined zu prüfen, akzeptierte die Bedingung einen alten feldwert von
        // undefined als o.k.!!!!
        if (window.localStorage.AlterFeldWert !== 'undefined' && window.localStorage.AlterFeldWert) {
          // wenn ein alter Feldname existiert,
          // zählen, in wievielen Datensätzen das Feld verwendet wird
          var $db = $.couch.db('evab')
          $db.view('evab/FeldSuche?key="' + window.localStorage.Email + '"&include_docs=true', {
            success: function (data) {
              var anzVorkommen = 0,
                Datensatz,
                feldname,
                ds
              // zählen, in wievielen Datensätzen das bisherige Feld verwendet wird
              _.each(data.rows, function (row) {
                Datensatz = row.doc
                feldname = Datensatz[window.localStorage.AlterFeldWert]
                if (feldname) {
                  anzVorkommen++
                }
              })
              if (anzVorkommen === 0) {
                // alter Feldname wurde noch in keinem Datensatz verwendet
                // prüfen, ob der neue Feldname schon existiert
                // wenn ja: melden, zurückstellen
                // wenn nein: speichern
                window.em.prüfeFeldNamen()
              } else {
                // Feldname wird schon verwendet > melden, zurückstellen
                ds = 'Datensätzen'
                if (anzVorkommen === 1) {
                  ds = 'Datensatz'
                }
                $('#FeldName').val(window.localStorage.AlterFeldWert)
                delete window.localStorage.FeldName
                delete window.localStorage.FeldWert
                delete window.localStorage.AlterFeldWert
                window.em.melde('Dieses Feld wird in ' + anzVorkommen + ' ' + ds + ' verwendet.<br>Es kann deshalb nicht verändert werden.<br>Bereinigen Sie zuerst die Daten.')
              }
            }
          })
        } else {
          // Vorher gab es keinen Feldnamen
          // prüfen, ob der neue Feldname schon existiert
          // wenn ja: melden, zurückstellen
          // wenn nein: speichern
          window.em.prüfeFeldNamen()
        }
      } else if (window.localStorage.FeldName === 'Hierarchiestufe' && window.localStorage.FeldWert === 'Art') {
        $('.FeldEditHeaderTitel').text(window.localStorage.FeldWert + ': ' + window.em.Feld.FeldBeschriftung)
        window.em.leereStorageFeldListe()
        window.em.speichereFeldeigenschaften()
        // Wenn die Hierarchiestufe zu Art geändert wird, muss das Feld für die Artgruppe aufgebaut werden
        window.em.ArtGruppeAufbauenFeldEdit()
        window.em.melde('Jetzt müssen Sie wählen, in welchen Artgruppen dieses Feld angezeigt werden kann')
      } else if (window.localStorage.FeldName === 'Hierarchiestufe' && window.localStorage.FeldWert !== 'Art') {
        $('.FeldEditHeaderTitel').text(window.localStorage.FeldWert + ': ' + window.em.Feld.FeldBeschriftung)
        if (window.em.Feld.Hierarchiestufe === 'Art') {
          // Wenn die Hierarchiestufe Art war und geändert wird, muss das Feld für die Artgruppe entfernt werden
          $('#Artgruppenliste_FeldEdit').empty()
          $('#SichtbarInHArtEditListeFieldContain').hide()
        }
        window.em.leereStorageFeldListe()
        window.em.speichereFeldeigenschaften()
      } else {
        if (window.localStorage.FeldName === 'FeldBeschriftung') {
          $('.FeldEditHeaderTitel').text(window.em.Feld.Hierarchiestufe + ': ' + window.localStorage.FeldWert)
        }
        window.em.speichereFeldeigenschaften()
      }
      window.em.blendeDatentypabhängigeFelder()
    }

    window.em.blendeDatentypabhängigeFelder = function () {
      'use strict'
      var $feldedit_inputtyp = $('#feldedit_inputtyp'),
        $feldedit_optionen = $('#feldedit_optionen'),
        $feldedit_slider = $('.feldedit_slider')
      switch (window.em.Feld.Formularelement) {
        case 'textinput':
          $feldedit_inputtyp.show()
          $feldedit_optionen.hide()
          $feldedit_slider.hide()
          break
        case 'selectmenu':
        case 'multipleselect':
        case 'radio':
        case 'checkbox':
          $feldedit_optionen.show()
          $feldedit_inputtyp.hide()
          $feldedit_slider.hide()
          break
        case 'slider':
          $feldedit_slider.show()
          $feldedit_inputtyp.hide()
          $feldedit_optionen.hide()
          break
        default:
          $feldedit_slider.hide()
          $feldedit_inputtyp.hide()
          $feldedit_optionen.hide()
          break
      }
    }

    // wenn in FeldEdit.htm #FeldFolgtNach geändert wird
    window.em.handleFeldEditFeldFolgtNachChange = function () {
      'use strict'
      window.em.setzeReihenfolgeMitVorgänger(this.value)
      // Feldliste soll neu aufgebaut werden
      delete window.em.Feldliste
    }

    // wenn in FeldEdit.htm #Standardwert geändert wird
    window.em.handleFeldEditStandardwertChange = function () {
      'use strict'
      var optionen = $('#Optionen').val() || [],	// undefined verhindern
        Feldwert = this.value || [],	// undefined verhindern
        LetzterFeldwert,
        StandardwertOptionen,
        $Standardwert = $('#Standardwert')
      if (optionen.length > 0) {
        // es gibt Optionen. Der Standardwert muss eine oder allenfalls mehrere Optionen sein
        LetzterFeldwert = []
        if (window.em.Feld.Standardwert) {
          if (window.em.Feld.Standardwert[window.localStorage.Email]) {
            LetzterFeldwert = window.em.Feld.Standardwert[window.localStorage.Email]
          }
        }
        // Standardwert in Array verwandeln
        StandardwertOptionen = []
        if (Feldwert.length > 0) {
          // Fehler verhindern, falls feldwert undefined ist
          StandardwertOptionen = Feldwert.split(',')
        }
        if (['multipleselect', 'checkbox'].indexOf(window.em.Feld.Formularelement) > -1) {
          // alle StandardwertOptionen müssen Optionen sein
          _.each(StandardwertOptionen, function (standardwertoption) {
            if (optionen.indexOf(standardwertoption) === -1) {
              // ein Wert ist keine Option, abbrechen
              $Standardwert.val(LetzterFeldwert)
              window.em.melde('Bitte wählen Sie eine oder mehrere der Optionen')
            // return ist hier nicht nötig
            }
          })
          // alle Werte sind Optionen
          window.em.speichereStandardwert()
        } else if (['toggleswitch', 'selectmenu', 'radio'].indexOf(window.em.Feld.Formularelement) > -1) {
          // Array darf nur ein Element enthalten
          if (StandardwertOptionen.length > 1) {
            // Array enthält mehrere Optionen, nicht zulässig
            $Standardwert.val(LetzterFeldwert)
            window.em.melde('Bitte wählen Sie nur EINE der Optionen')
          } else {
            // Array enthält eine einzige Option
            _.each(StandardwertOptionen, function (standardwertoption) {
              if (optionen.indexOf(standardwertoption) === -1) {
                // der Wert ist keine Option, abbrechen
                $Standardwert.val(LetzterFeldwert)
                window.em.melde('Bitte wählen Sie eine der Optionen')
              // return ist hier nicht nötig
              }
            })
            // alle Werte sind Optionen
            window.em.speichereStandardwert()
          // return ist hier nicht nötig
          }
        } else {
          // Optionen sind erfasst, Feld braucht aber keine. Alle Werte akzeptieren
          window.em.speichereStandardwert()
        }
      } else {
        // Es gibt keine Optionen. Alle Standardwerte akzeptieren
        window.em.speichereStandardwert()
      }
    }

    // wenn in FeldEdit.htm #LoescheFeldFeldEdit geklickt wird
    // Beim Löschen rückfragen
    window.em.handleFeldEditLoescheFeldFeldEditClick = function () {
      'use strict'
      if (window.em.Feld.User === 'ZentrenBdKt') {
        window.em.melde('Dies ist ein Feld eines nationalen Datenzentrums<br><br>Es kann nicht gelöscht werden<br><br>Sie können es ausblenden')
      } else {
        $('#fe_löschen_meldung').popup('open')
      }
    }

    // wenn in FeldEdit.htm #fe_löschen_meldung_ja_loeschen geklickt wird
    window.em.handleFeldEditFeLoeschenMeldungJaClick = function () {
      'use strict'
      if (!window.em.Feld.FeldName) {
        // Ohne Feldname kann nicht kontrolliert werden, in wievielen Datensätzen das Feld vorkommt
        window.em.löscheFeld()
      } else {
        var $db = $.couch.db('evab')
        // zählen, in wievielen Datensätzen das Feld verwendet wird
        $db.view('evab/FeldSuche?key="' + window.localStorage.Email + '"&include_docs=true', {
          success: function (data) {
            var anzVorkommen = 0,
              Datensatz,
              feldname,
              ds
            _.each(data.rows, function (row) {
              Datensatz = row.doc
              feldname = Datensatz[window.em.Feld.FeldName]
              if (feldname) {
                anzVorkommen++
              }
            })
            if (anzVorkommen === 0) {
              window.em.löscheFeld()
            } else {
              ds = 'Datensätzen'
              if (anzVorkommen === 1) {
                ds = 'Datensatz'
              }
              window.em.melde('Löschen abgebrochen:<br>Dieses Feld wird in ' + anzVorkommen + ' ' + ds + ' verwendet<br>Bereinigen Sie zuerst die Daten')
            }
          }
        })
      }
    }

    // wenn in FeldEdit.htm .menu_datenfelder_exportieren geklickt wird
    window.em.handleFeldEditMenuDatenfelderExportierenClick = function () {
      'use strict'
      window.open('_list/FeldExport/FeldListe?include_docs=true')
      $('#MenuFeldEdit')
        // völlig unlogisch: das bereits offene popup muss zuerst initialisiert werden...
        .popup()
        // ...bevor es geschlossen werden muss, weil es sonst offen bleibt
        .popup('close')
    }

    // wenn FelderWaehlen.html erscheint
    window.em.handleFelderWählenPageshow = function () {
      'use strict'
      // Sollte keine id vorliegen, zu BeobListe.html wechseln
      // das kommt im Normalfall nur vor, wenn der Cache des Browsers geleert wurde
      // oder in der Zwischenzeit auf einem anderen Browser dieser Datensatz gelöscht wurde
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if (!window.localStorage.AufrufendeSeiteFW || window.localStorage.AufrufendeSeiteFW === 'undefined') {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('BeobListe.html')
        return
      }
      window.em.initiiereFelderWählen()
    }

    // wenn FelderWaehlen.html verschwindet
    window.em.handleFelderWählenPagehide = function () {
      'use strict'
      // globale Variablen aufräumen
      delete window.localStorage.FeldlisteFwName
      delete window.localStorage.KriterienFürZuWählendeFelder
      // ausgeschaltet, weil es das braucht, wenn man von FelderWahlen direkt nach FeldEdit springt und dann zu FeldWaehlen zurück
      // delete window.localStorage.AufrufendeSeiteFW
      // verhindern, dass beim nächsten Mal zuerst die alten Felder angezeigt werden
      $('#FeldlisteFW').empty()
    }

    // wenn FelderWaehlen.html initiiert wird
    window.em.handleFelderWählenPageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
      } else if (!window.localStorage.AufrufendeSeiteFW || window.localStorage.AufrufendeSeiteFW === 'undefined') {
        // oh, kein zurück bekannt
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('BeobListe.html')
      }

      $('#FelderWaehlenPage')
        .on('click', '#FelderWaehlenPage_back', function (event) {
          event.preventDefault()
          $.mobile.navigate(window.localStorage.AufrufendeSeiteFW + '.html')
        })

      $('#FeldlisteFW')
        .on('change', "input[name='Felder']", window.em.handleFelderWählenInputFelderChange)
        // aus unbekanntem Grund funktioniert .on nicht aber .bind schon
        .bind('taphold', "input[name='Felder']", function (event) {
          'use strict'
          event.preventDefault()
          // event.target ist immer das label
          var FeldName = $(event.target).prop('for')
          window.em.öffneFeld(FeldName)
        })
    }

    // wenn in FelderWaehlen.html input[name='Felder'] geändert wird
    // Felder speichern (checkbox)
    window.em.handleFelderWählenInputFelderChange = function () {
      'use strict'
      var FeldName = $(this).prop('id'),
        FeldId = $(this).attr('feldid'),
        Feld,
        feldrow,
        feld_mit_sichtbarkeit,
        sichtbar_für_benutzer
      feldrow = _.find(window.em[window.localStorage.FeldlisteFwName].rows, function (row) {
        return row.doc._id === FeldId
      })
      Feld = feldrow.doc
      // Bei BeobEdit.html muss SichtbarImModusEinfach gesetzt werden, sonst SichtbarImModusHierarchisch
      if (window.localStorage.AufrufendeSeiteFW === 'BeobEdit') {
        feld_mit_sichtbarkeit = 'SichtbarImModusEinfach'
      } else if (window.localStorage.AufrufendeSeiteFW === 'hArtEditListe') {
        feld_mit_sichtbarkeit = 'SichtbarInHArtEditListe'
      } else {
        // eines der hierarchischen Formulare
        feld_mit_sichtbarkeit = 'SichtbarImModusHierarchisch'
      }
      sichtbar_für_benutzer = Feld[feld_mit_sichtbarkeit] || []
      if ($('#' + FeldName).prop('checked') === true) {
        sichtbar_für_benutzer.push(window.localStorage.Email)
      } else {
        sichtbar_für_benutzer = _.without(sichtbar_für_benutzer, window.localStorage.Email)
      }
      Feld[feld_mit_sichtbarkeit] = sichtbar_für_benutzer
      // Änderung in DB speichern
      var $db = $.couch.db('evab')
      $db.saveDoc(Feld, {
        success: function (data) {
          // neue rev holen (aktualisiert auch Feldliste-Objekt)
          Feld._rev = data.rev
        },
        error: function () {
          window.em.melde('Fehler: nicht gespeichert<br>Vielleicht klicken Sie zu schnell?')
        }
      })
    }

    window.em.öffneFeld = function (FeldName) {
      'use strict'
      var $db = $.couch.db('evab')
      $db.view('evab/FeldListeFeldName?key="' + FeldName + '"&include_docs=true', {
        success: function (data) {
          window.localStorage.FeldId = data.rows[0].doc._id
          window.localStorage.zurueck = 'FelderWaehlen.html'
          $.mobile.navigate('FeldEdit.html')
        }
      })
    }

    // wenn FeldListe.html erscheint
    window.em.handleFeldListePageshow = function () {
      'use strict'
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
      }
      window.em.initiiereFeldliste()
    }

    // wenn FeldListe.html initiiert wird
    window.em.handleFeldListePageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
      }

      // sicherstellen, dass zurueck nie leer ist
      if (!window.localStorage.zurueck) {
        window.localStorage.zurueck = 'BeobListe.html'
      }

      $('#FeldListeFL')
        .on('click', '.Feld', function (event) {
          event.preventDefault()
          window.em.handleFeldListeFeldClick(this)
        })

      $('#FeldListeFooter')
        .on('click', '#NeuesFeldFeldListe', function (event) {
          event.preventDefault()
          window.em.neuesFeld()
        })

      $('#MenuFeldListe')
        .on('click', '.menu_datenfelder_exportieren', window.em.handleFeldListeMenuDatenfelderExportierenClick)

      $('#FeldListeHeader')
        .on('click', '#FeldListeBackButton', function (event) {
          event.preventDefault()
          window.em.handleFeldListeBackButtonClick()
        })
    }

    // wenn in FeldListe.html .Feld geklickt wird
    // Feld öffnen
    window.em.handleFeldListeFeldClick = function (that) {
      'use strict'
      window.localStorage.FeldId = $(that).attr('FeldId')
      $.mobile.navigate('FeldEdit.html')
    }

    // wenn in FeldListe.html .menu_datenfelder_exportieren geklickt wird
    window.em.handleFeldListeMenuDatenfelderExportierenClick = function () {
      'use strict'
      window.open('_list/FeldExport/FeldListe?include_docs=true')
      // völlig unlogisch: das bereits offene popup muss zuerst initialisiert werden...
      // ...bevor es geschlossen werden muss, weil es sonst offen bleibt
      $('#MenuFeldListe').popup().popup('close')
    }

    // wenn in FeldListe.html #FeldListeBackButton geklickt wird
    window.em.handleFeldListeBackButtonClick = function () {
      'use strict'
      if (window.localStorage.hArtSicht === 'liste' && window.localStorage.zurueck === 'hArtEdit.html') {
        $.mobile.navigate('hArtEditListe.html')
      } else {
        $.mobile.navigate(window.localStorage.zurueck)
      }
      delete window.localStorage.zurueck
    }

    // wenn hArtEdit.html erscheint
    window.em.handleHArtEditPageshow = function () {
      'use strict'
      // Sollte keine id vorliegen, zu hProjektListe.html wechseln
      // das kommt im Normalfall nur vor, wenn der Cache des Browsers geleert wurde
      // oder in der Zwischenzeit auf einem anderen Browser dieser Datensatz gelöscht wurde
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if (!window.localStorage.Status && !window.localStorage.hArtId) {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
        return
      }
      window.em.initiierehArtEdit()
    }

    // wenn hArtEdit.html initiiert wird
    window.em.handleHArtEditPageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if ((!window.localStorage.Status || window.localStorage.Status === 'undefined') && (!window.localStorage.hArtId || window.localStorage.hArtId === 'undefined')) {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
        return
      }

      $('#hArtEditPageHeader')
        .on('click', "[name='OeffneArtListehArtEdit']", function (event) {
          event.preventDefault()
          window.em.handleHArtEditÖffneArtListehArtEditClick()
        })
        .on('click', '.OeffneZeithArtEdit', function (event) {
          event.preventDefault()
          window.em.handleHArtEditÖffneZeithArtEditClick()
        })
        .on('click', '.OeffneOrthArtEdit', function (event) {
          event.preventDefault()
          window.em.handleHArtEditÖffneOrthArtEditClick()
        })
        .on('click', '.OeffneRaumhArtEdit', function (event) {
          event.preventDefault()
          window.em.handleHArtEditÖffneRaumhArtEditClick()
        })
        .on('click', '.OeffneProjekthArtEdit', function (event) {
          event.preventDefault()
          window.em.handleHArtEditÖffneProjekthArtEditClick()
        })

      $('#hArtEditForm')
        // Für jedes Feld bei Änderung speichern
        .on('change', '.speichern', window.em.speichereHArt)
        // Eingabe im Zahlenfeld abfangen
        .on('blur', '.speichernSlider', window.em.speichereHArt)
        // Klicken auf den Pfeilen im Zahlenfeld abfangen
        .on('mouseup', '.ui-slider-input', window.em.speichereHArt)
        // Ende des Schiebens abfangen
        .on('slidestop', '.speichernSlider', window.em.speichereHArt)
        // Editieren von Beobachtungen managen, ausgehend von Artgruppe
        .on('click', '.aArtGruppe', function (event) {
          event.preventDefault()
          window.em.zuArtgruppenliste()
        })
        // Editieren von Beobachtungen managen, ausgehend von ArtName
        .on('click', '.aArtName', function (event) {
          event.preventDefault()
          window.em.zuArtliste()
        })

      $('#hArtEditPageFooter')
        // Neue Beobachtung managen
        .on('click', '#NeueBeobhArtEdit', function (event) {
          event.preventDefault()
          window.em.handleHArtEditNeueBeobhArtEditClick()
        })
        // sichtbare Felder wählen
        .on('click', '#waehleFelderhArtEdit', function (event) {
          event.preventDefault()
          window.em.handleHArtEditWähleFelderClick()
        })
        // Code für den Art-Löschen-Dialog
        .on('click', '#LoescheBeobhArtEdit', function (event) {
          event.preventDefault()
          $('#hae_löschen_meldung').popup('open')
        })
        // Code für den Art-Löschen-Dialog
        .on('click', '#öffnehArtEditListe', function (event) {
          event.preventDefault()
          $.mobile.navigate('hArtEditListe.html')
        })

      $('#hae_löschen_meldung')
        .on('click', '#hae_löschen_meldung_ja_loeschen', window.em.löscheHArt)

      $('#hArtEdit')
        .on('swipeleft', window.em.handleHArtEditSwipeleft)
        .on('swiperight', window.em.handleHArtEditSwiperight)
        // Pagination Pfeil voriger initialisieren
        .on('vclick', '.ui-pagination-prev', function (event) {
          event.preventDefault()
          window.em.nächsteVorigeArt('vorige')
        })
        // Pagination Pfeil nächster initialisieren
        .on('vclick', '.ui-pagination-next', function (event) {
          event.preventDefault()
          window.em.nächsteVorigeArt('nächste')
        })
        // Pagination Pfeiltasten initialisieren
        .on('keyup', function (event) {
          'use strict'
          // nur reagieren, wenn hArtEdit sichtbar und Fokus nicht in einem Feld
          if (!$(event.target).is('input, textarea, select, button') && $('#hArtEdit').is(':visible')) {
            // Left arrow
            if (event.keyCode === $.mobile.keyCode.LEFT) {
              window.em.nächsteVorigeArt('vorige')
              event.preventDefault()
            }
            // Right arrow
            else if (event.keyCode === $.mobile.keyCode.RIGHT) {
              window.em.nächsteVorigeArt('nächste')
              event.preventDefault()
            }
          }
        })

      $('#FormAnhängehAE')
        .on('click', "[name='LöscheAnhang']", function (event) {
          event.preventDefault()
          window.em.handleHArtEditLöscheAnhangClick(this)
        })
        // Änderungen im Formular für Anhänge speichern
        .on('change', '.speichernAnhang', window.em.handleHArtEditSpeichernAnhangChange)

      $('#MenuhArtEdit')
        .on('click', '.menu_arteigenschaften', window.em.handleHArtEditMenuArteigenschaftenClick)
        .on('click', '.menu_einfacher_modus', window.em.handleHArtEditMenuEinfacherModusClick)
        .on('click', '.menu_felder_verwalten', window.em.handleHArtEditMenuFelderVerwaltenClick)
        .on('click', '.menu_beob_exportieren', window.em.handleHArtEditMenuBeobExportierenClick)
        .on('click', '.menu_einstellungen', window.em.handleHArtEditMenuEinstellungenClick)
        .on('click', '.menu_neu_anmelden', window.em.meldeNeuAn)
        .on('click', '.menu_artengruppen_importieren', window.em.öffneArtengruppenImportieren)
        .on('click', '.menu_arten_importieren', window.em.öffneArtenImportieren)
        .on('click', '.menu_admin', window.em.öffneAdmin)
    }

    // wenn hArtEditListe.html erscheint
    window.em.handleHArtEditListePageshow = function () {
      'use strict'
      // Sollte keine id vorliegen, zu hProjektListe.html wechseln
      // das kommt im Normalfall nur vor, wenn der Cache des Browsers geleert wurde
      // oder in der Zwischenzeit auf einem anderen Browser dieser Datensatz gelöscht wurde
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if (!window.localStorage.Status && !window.localStorage.hArtId) {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
        return
      }
      window.em.initiierehArtEditListe()
    }

    // managt den Aufbau aller Daten und Felder für hArtEditListe.html
    // Artliste und hArt holen
    window.em.initiierehArtEditListe = function () {
      'use strict'
      // markieren, dass die Listensicht aktiv ist
      window.localStorage.hArtSicht = 'liste'
      // hat hArtEdit.html eine hArtListe übergeben?
      /*if (window.em.hArtListe) {
      	// Beobliste aus globaler Variable holen - muss nicht geparst werden
      	window.em.initiierehArtEditListe_2()
      } else {*/
      // Beobliste aus DB holen
      // Problem: Wenn in hArtEdit ein Wert geändert wurde, ist er sonst nicht aktuell
      // Alternative: Beim Speichern window.em.hArtListe nachführen
      var $db = $.couch.db('evab')
      $db.view('evab/hArtListe?startkey=["' + window.localStorage.Email + '", "' + window.localStorage.ZeitId + '"]&endkey=["' + window.localStorage.Email + '", "' + window.localStorage.ZeitId + '" ,{}]&include_docs=true', {
        success: function (data) {
          var hart_row
          // Liste bereitstellen, um Datenbankzugriffe zu reduzieren
          window.em.hArtListe = data
          // window.em.hArt herstellen, falls nicht vorhanden
          if (!window.em.hArt && window.localStorage.hArtId) {
            hart_row = _.find(window.em.hArtListe.rows, function (row) {
              return row.doc._id === window.localStorage.hArtId
            })
            window.em.hArt = hart_row.doc
            window.localStorage.aArtId = window.em.hArt.aArtId
            window.localStorage.aArtName = window.em.hArt.aArtName
            window.localStorage.aArtGruppe = window.em.hArt.aArtGruppe
          }
          window.em.initiierehArtEditListe_2()
        }
      })
    // }
    }

    // Artgruppe ermitteln
    window.em.initiierehArtEditListe_2 = function () {
      'use strict'
      var anzArt = window.em.hArtListe.rows.length,
        Titel2,
        artgruppen = [],
        artgruppe

      // Im Titel der Seite die Anzahl Arten anzeigen
      Titel2 = ' Arten'
      if (anzArt === 1) {
        Titel2 = ' Art'
      }
      $('#hArtEditListePageHeader')
        .find('.hArtEditListePageTitel')
        .text(anzArt + Titel2)

      if (anzArt === 0) {
        // Sollte nicht vorkommen, weil man nur aus einer existierenden Beobachtung in die Liste wechseln kann
      } else {
        // Felder bestimmen, die in der Tabelle angezeigt werden können
        // Es sind alle EINER ARTENGRUPPE
        // wenn also die Liste mehr als eine Artengruppe enthält, muss der Benutzer eine davon wählen
        // also zuerst eine Liste der Artengruppen erstellen
        _.each(window.em.hArtListe.rows, function (row) {
          if (row.doc.aArtGruppe) {
            artgruppen.push(row.doc.aArtGruppe)
          }
        })
        // artgruppen-array reduzieren, damit jede Artgruppe nur ein mal vorkommt
        artgruppen = _.uniq(artgruppen)
        if ((!window.em.hArt || !window.em.hArt.aArtGruppe) && artgruppen.length > 1) {
          // Benutzer muss eine Artgruppe wählen
          $('#hael_artgruppen_popup_fieldcontain').html(window.em.erstelleHtmlFürHaelArtgruppenPopupRadiogroup(artgruppen)).trigger('create')
          $('#hael_artgruppen_popup').popup().popup('open')
        } else {
          // die Artgruppen der zuletzt gewählten Art nehmen
          artgruppe = window.em.hArt.aArtGruppe
          window.em.initiierehArtEditListe_3(artgruppe)
        }
      }

    }

    // Feldliste holen
    window.em.initiierehArtEditListe_3 = function (artgruppe) {
      'use strict'
      // prüfen, ob die Feldliste schon geholt wurde
      // wenn ja: deren globale Variable verwenden
      // immer neu holen, sonst hat man veraltete Daten, wenn zuvor in hArtEdit Felder geändert wurden
      /*if (window.em.FeldlistehArtEditListe) {
      	window.em.initiierehArtEditListe_4(artgruppe)
      } else {*/
      // Feldliste aus der DB holen
      var $db = $.couch.db('evab')
      $db.view('evab/FeldListeArt?include_docs=true', {
        success: function (data) {
          window.em.FeldlistehArtEditListe = data
          window.em.initiierehArtEditListe_4(artgruppe)
        }
      })
      // }

    }

    // baut das HTML für die hArtEditListeForm auf
    window.em.initiierehArtEditListe_4 = function (artgruppe) {
      'use strict'
      var htmlContainer = '<table id="hArtEditListeTable" data-role="table" class="ui-body-d ui-responsive felder_tabelle" data-mode="reflow">',
        htmlContainerHead,
        htmlContainerBody,
        feldliste = [],
        beob_der_gewählten_artgruppe_rows

      // zuerst mal ermitteln, welche Felder für diese Artgruppe und diesen User im Formular eingeblendet werden sollen
      _.each(window.em.FeldlistehArtEditListe.rows, function (row) {
        var Feld = row.doc,
          FeldName = Feld.FeldName
        if (Feld.Hierarchiestufe === 'Art' && (Feld.User === window.localStorage.Email || Feld.User === 'ZentrenBdKt') && Feld.SichtbarInHArtEditListe && Feld.SichtbarInHArtEditListe.indexOf(window.localStorage.Email) !== -1 && (typeof Feld.ArtGruppe !== 'undefined' && (Feld.ArtGruppe.indexOf(artgruppe) >= 0 || Feld.ArtGruppe[0] === 'alle')) && (FeldName !== 'aArtId') && (FeldName !== 'aArtGruppe') && (FeldName !== 'aArtName')) {
          feldliste.push(Feld)
        }
      })

      // mit diesen Feldern den Head aufbauen
      // dazu wird der Feldname gebraucht
      // Die Art wird immer angezeigt
      htmlContainerHead = '<thead><tr class="ui-bar-d"><th data-priority="1">Art</th>'
      _.each(feldliste, function (feld) {
        htmlContainerHead += '<th>'
        htmlContainerHead += feld.FeldBeschriftung
        htmlContainerHead += '</th>'
      })
      htmlContainerHead += '</tr></thead>'

      // Den Body aufbauen
      htmlContainerBody = '<tbody>'
      // Beobachtungen der gewählten Artgruppe wählen
      beob_der_gewählten_artgruppe_rows = _.filter(window.em.hArtListe.rows, function (row) {
        return row.doc.aArtGruppe === artgruppe
      })
      // pro hArt das html erzeugen
      _.each(beob_der_gewählten_artgruppe_rows, function (row) {
        var hart = row.doc,
          optionen = [],
          artname = hart.aArtName
        optionen.push(hart.aArtName)
        htmlContainerBody += '<tr class="hart" hartid="'
        htmlContainerBody += hart._id
        htmlContainerBody += '">'
        // Artname ergänzen
        htmlContainerBody += '<td>'
        htmlContainerBody += window.em.generiereHtmlFürSelectmenu('aArtName_hael', '', artname, optionen, 'SingleSelect', true, 'arrow-r')
        htmlContainerBody += '</td>'
        // dynamische Felder setzen
        _.each(feldliste, function (feld) {
          var FeldName = feld.FeldName,
            FeldWert
          // feldwert setzen
          if (window.em.hArt[FeldName] && window.localStorage.Status === 'neu' && feld.Standardwert && feld.Standardwert[window.em.hArt.User]) {
            FeldWert = feld.Standardwert[window.em.hArt.User]
            // Objekt window.em.hArt um den Standardwert ergänzen, um später zu speichern
            window.em.hArt[FeldName] = FeldWert
          } else {
            // "" verhindert, dass im Feld undefined erscheint
            FeldWert = hart[FeldName] || ''
          }
          // html generieren
          htmlContainerBody += '<td>'
          htmlContainerBody += window.em.generiereHtmlFürFormularelement(feld, FeldWert, true)
          htmlContainerBody += '</td>'
        })
        // Tabellenzeile abschliessen
        htmlContainerBody += '</tr>'
      })

      htmlContainerBody += '</tbody>'

      // head und body zusammensetzen
      htmlContainer += htmlContainerHead
      htmlContainer += htmlContainerBody
      // Tabelle abschliessen
      htmlContainer += '</table>'

      // htmlContainer in Formular setzen
      $('#hArtEditListeForm').html(htmlContainer).trigger('create').trigger('refresh')
      $('#hArtEditListeTable').table().table('refresh')
      // jetzt alle Flipswitsches, die "nein" sind, aktiv setzen
      _.each(beob_der_gewählten_artgruppe_rows, function (row) {
        window.em.aktiviereFlipswitches("[hartid='" + row.id + "']", row.doc)
      })
      // Menus blenden und letzte url speichern
      window.em.blendeMenus()
      window.em.speichereLetzteUrl()
    }

    window.em.erstelleHtmlFürHaelArtgruppenPopupRadiogroup = function (artgruppen) {
      'use strict'
      var html = '<fieldset id="hael_artgruppen_popup_fieldset" data-role="controlgroup">'
      _.each(artgruppen, function (artgruppe) {
        html += '<input type="radio" name="hael_artgruppen_popup_input" id="hael_'
        html += artgruppe
        html += '" value="'
        html += artgruppe
        html += '" class="hael_artgruppen_popup_input">'
        html += '<label for="hael_'
        html += artgruppe
        html += '" class="hael_artgruppen_popup_input_label" artgruppe="'
        html += artgruppe
        html += '">'
        html += artgruppe
        html += '</label>'
      })
      html += '</fieldset>'
      return html
    }

    // managt das Initialisieren einer Art in hArtEditListe.html
    // erwartet die hArtId
    // wird aufgerufen von hArtEditListe.html, wenn der Fokus in einen Datensatz kommt
    window.em.initiierehArtEditListeArt = function (hartid) {
      'use strict'
      // Infos zur Art holen
      // achtung: wenn soeben die Art geändert wurde, müssen ArtId und ArtName neu geholt werden
      if (window.em.hArt && window.em.hArt._id === hartid && (!window.localStorage.Von || window.localStorage.Von !== 'hArtEdit')) {
        window.em.initiierehArtEditListeArt_2(window.em.hArt)
      } else {
        var $db = $.couch.db('evab')
        $db.openDoc(hartid, {
          success: function (data) {
            window.em.hArt = data
            window.em.initiierehArtEditListeArt_2(data)
            window.localStorage.aArtId = window.em.hArt.aArtId
            window.localStorage.aArtName = window.em.hArt.aArtName
            window.localStorage.aArtGruppe = window.em.hArt.aArtGruppe
          }
        })
      }
    }

    window.em.initiierehArtEditListeArt_2 = function (hart) {
      'use strict'
      // bei neuen hArt hat das Objekt noch keine ID
      if (hart._id) {
        window.localStorage.hArtId = hart._id
      } else {
        window.localStorage.hArtId = 'neu'
      }
      window.localStorage.aArtGruppe = hart.aArtGruppe
      window.localStorage.aArtName = hart.aArtName
      window.localStorage.aArtId = hart.aArtId
    }

    // generiert dynamisch die Artgruppen-abhängigen Felder
    // Mitgeben: Feldliste, Beobachtung
    window.em.erstelleDynamischeFelderhArtEditListe = function () {
      'use strict'
      var htmlContainer = window.em.generiereHtmlFürhArtEditListeForm()
      // Linie nur anfügen, wenn Felder erstellt wurden
      if (htmlContainer) {
        htmlContainer = '<hr />' + htmlContainer
      }
      $('#hArtEditListeFormHtml').html(htmlContainer).trigger('create').trigger('refresh')
      window.em.blendeMenus()
      // letzte url speichern - hier und nicht im pageshow, damit es bei jedem Datensatzwechsel passiert
      window.em.speichereLetzteUrl()
    }

    // generiert das Html für Formular in hArtEdit.html
    // erwartet ArtGruppe; Feldliste als Objekt; Beobachtung als Objekt
    // der htmlContainer wird zurück gegeben
    window.em.generiereHtmlFürhArtEditListeForm = function () {
      'use strict'
      var Feld = {},
        FeldName,
        FeldWert,
        htmlContainer = '',
        ArtGruppe = window.em.hArt.aArtGruppe
      _.each(window.em.FeldlistehArtEditListe.rows, function (row) {
        Feld = row.doc
        FeldName = Feld.FeldName
        // nur sichtbare eigene Felder. Bereits im Formular integrierte Felder nicht anzeigen
        // Vorsicht: Erfasst jemand ein Feld der Hierarchiestufe Art ohne Artgruppe, sollte das keinen Fehler auslösen
        if ((Feld.User === window.em.hArt.User || Feld.User === 'ZentrenBdKt') && Feld.SichtbarInHArtEditListe.indexOf(window.em.hArt.User) !== -1 && (typeof Feld.ArtGruppe !== 'undefined' && (Feld.ArtGruppe.indexOf(ArtGruppe) >= 0 || Feld.ArtGruppe[0] === 'alle')) && (FeldName !== 'aArtId') && (FeldName !== 'aArtGruppe') && (FeldName !== 'aArtName')) {
          if (window.em.hArt[FeldName] && window.localStorage.Status === 'neu' && Feld.Standardwert && Feld.Standardwert[window.em.hArt.User]) {
            FeldWert = Feld.Standardwert[window.em.hArt.User]
            // Objekt window.em.hArt um den Standardwert ergänzen, um später zu speichern
            window.em.hArt[FeldName] = FeldWert
          } else {
            // "" verhindert, dass im Feld undefined erscheint
            FeldWert = window.em.hArt[FeldName] || ''
          }
          htmlContainer += window.em.generiereHtmlFürFormularelement(Feld, FeldWert)
        }
      })
      if (window.localStorage.Status === 'neu') {
        // in neuen Datensätzen dynamisch erstellte Standardwerte speichern
        var $db = $.couch.db('evab')
        $db.saveDoc(window.em.hArt, {
          success: function (data) {
            window.em.hArt._id = data.id
            window.em.hArt._rev = data.rev
            window.localStorage.hArtId = data.id
          }
        })
        delete window.localStorage.Status
      } else {
        // Neue Datensätze haben keine Anhänge
        window.em.zeigeAttachments(window.em.hArt, 'hAE')
      }
      return htmlContainer
    }

    // wenn hArtEditListe.html initiiert wird
    window.em.handleHArtEditListePageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if ((!window.localStorage.Status || window.localStorage.Status === 'undefined') && (!window.localStorage.hArtId || window.localStorage.hArtId === 'undefined')) {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
        return
      }

      $('#hArtEditListePageHeader')
        .on('click', "[name='OeffneArtListehArtEdit']", function (event) {
          event.preventDefault()
          window.em.handleHArtEditÖffneArtListehArtEditClick()
        })
        .on('click', '.OeffneZeithArtEdit', function (event) {
          event.preventDefault()
          window.em.handleHArtEditÖffneZeithArtEditClick()
        })
        .on('click', '.OeffneOrthArtEdit', function (event) {
          event.preventDefault()
          window.em.handleHArtEditÖffneOrthArtEditClick()
        })
        .on('click', '.OeffneRaumhArtEdit', function (event) {
          event.preventDefault()
          window.em.handleHArtEditÖffneRaumhArtEditClick()
        })
        .on('click', '.OeffneProjekthArtEdit', function (event) {
          event.preventDefault()
          window.em.handleHArtEditÖffneProjekthArtEditClick()
        })

      $('#hArtEditListeForm')
        // Für jedes Feld bei Änderung speichern
        .on('change', '.speichern', window.em.speichereHArt)
        // Eingabe im Zahlenfeld abfangen
        .on('blur', '.speichernSlider', window.em.speichereHArt)
        // Klicken auf den Pfeilen im Zahlenfeld abfangen
        .on('mouseup', '.ui-slider-input', window.em.speichereHArt)
        // Ende des Schiebens abfangen
        .on('slidestop', '.speichernSlider', window.em.speichereHArt)
        // Sobald auf einen Datensatz geklickt wird, ihn initiieren - falls noch nicht geschehen
        .on('click', '.hart', function () {
          'use strict'
          var hartid = $(this).attr('hartid')
          if (!window.localStorage.hArtId || window.localStorage.hArtId !== hartid) {
            // die Art muss initiiert werden
            window.localStorage.hArtId = hartid
            window.em.initiierehArtEditListeArt(hartid)
          }
        })

      $('#hArtEditListePageFooter')
        // Neue Beobachtung managen
        .on('click', '#NeueBeobhArtEdit', function (event) {
          event.preventDefault()
          window.em.handleHArtEditNeueBeobhArtEditClick()
        })
        // sichtbare Felder wählen
        .on('click', '#waehleFelderhArtEditListe', function (event) {
          event.preventDefault()
          window.em.handleHArtEditListeWähleFelderClick()
        })
        // In Einzelansicht wechseln
        .on('click', '#hArtEditListeEinzelsicht', function (event) {
          event.preventDefault()
          $.mobile.navigate('hArtEdit.html')
        })

      $('#hArtEditListe')
        // Editieren von Beobachtungen managen, ausgehend von ArtName
        // irgendwie funktioniert das hier nicht. Keine Ahnung wieso
        .on('click', "[name='aArtName_hael']", function (event) {
          event.preventDefault()
          window.em.zuArtliste()
        })
        // darum so gegriffen:
        .on('click', ".hart [role='button']", function (event) {
          if ($(this).next('select').attr('name') === 'aArtName_hael') {
            // ja, das ist die Art
            event.preventDefault()
            window.em.zuArtliste()
          }
        })
        .on('click', '.hael_artgruppen_popup_input_label', function () {
          window.em.initiierehArtEditListe_3($(this).attr('artgruppe'))
          $('#hael_artgruppen_popup').popup('close')
        })

      $('#MenuhArtEditListe')
        .on('click', '.menu_einfacher_modus', window.em.handleHArtEditMenuEinfacherModusClick)
        .on('click', '.menu_felder_verwalten', window.em.handleHArtEditMenuFelderVerwaltenClick)
        .on('click', '.menu_beob_exportieren', window.em.handleHArtEditMenuBeobExportierenClick)
        .on('click', '.menu_einstellungen', window.em.handleHArtEditMenuEinstellungenClick)
        .on('click', '.menu_neu_anmelden', window.em.meldeNeuAn)
        .on('click', '.menu_artengruppen_importieren', window.em.öffneArtengruppenImportieren)
        .on('click', '.menu_arten_importieren', window.em.öffneArtenImportieren)
        .on('click', '.menu_admin', window.em.öffneAdmin)
    }

    // wenn in hArtEditListe.html #waehleFelderhArtEditListe geklickt wird
    window.em.handleHArtEditListeWähleFelderClick = function () {
      'use strict'
      window.localStorage.AufrufendeSeiteFW = 'hArtEditListe'
      $.mobile.navigate('FelderWaehlen.html')
    }

    // wenn hArtListe.html erscheint
    window.em.handleHArtListePageshow = function () {
      'use strict'
      // Sollte keine id vorliegen, zu hProjektListe.html wechseln
      // das kommt im Normalfall nur vor, wenn der Cache des Browsers geleert wurde
      // oder in der Zwischenzeit auf einem anderen Browser dieser Datensatz gelöscht wurde
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if (!window.localStorage.ZeitId || window.localStorage.ZeitId === 'undefined') {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
        return
      }
      window.em.initiierehArtListe()
    }

    // wenn hArtListe.html initiiert wird
    window.em.handleHArtListePageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if (!window.localStorage.ZeitId || window.localStorage.ZeitId === 'undefined') {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
        return
      }

      $('#hArtListePageHeader')
        // Link zu Raum in Navbar und Titelleiste
        .on('click', "[name='OeffneZeithArtListe']", function (event) {
          event.preventDefault()
          window.em.handleHArtListeOeffneZeitClick()
        })
        .on('click', '#OeffneOrthArtListe', function (event) {
          event.preventDefault()
          window.em.handleHArtListeÖffneOrtClick()
        })
        .on('click', '#OeffneRaumhArtListe', function (event) {
          event.preventDefault()
          window.em.handleHArtListeÖffneRaumClick()
        })
        .on('click', '#OeffneProjekthArtListe', function (event) {
          event.preventDefault()
          window.em.handleHArtListeÖffneProjektClick()
        })

      $('#hArtListe')
        // Neue Beobachtung managen
        .on('click', '.NeueBeobhArtListe', function (event) {
          event.preventDefault()
          window.em.öffneArtgruppenliste_hal()
        })
        .on('swiperight', window.em.handleHArtListeSwiperight)

      $('#ArtlistehAL')
        .on('swipeleft', '.erste', window.em.öffneArtgruppenliste_hal)
        .on('swipeleft click', '.beob', window.em.handleHArtListeBeobClick)

      $('#MenuhArtListe')
        .on('click', '.menu_einfacher_modus', window.em.handleHArtListeMenuEinfacherModusClick)
        .on('click', '.menu_felder_verwalten', window.em.handleHArtListeMenuFelderVerwaltenClick)
        .on('click', '.menu_beob_exportieren', window.em.handleHArtListeMenuFelderVerwaltenClick)
        .on('click', '.menu_einstellungen', window.em.handleHArtListeMenuEinstellungenClick)
        .on('click', '.menu_neu_anmelden', window.em.meldeNeuAn)
        .on('click', '.menu_artengruppen_importieren', window.em.öffneArtengruppenImportieren)
        .on('click', '.menu_arten_importieren', window.em.öffneArtenImportieren)
        .on('click', '.menu_admin', window.em.öffneAdmin)
    }

    // wenn in hArtListe.html [name='OeffneZeithArtListe'] geklickt wird
    window.em.handleHArtListeOeffneZeitClick = function () {
      'use strict'
      window.em.leereStoragehArtListe()
      $.mobile.navigate('hZeitEdit.html')
    }

    // wenn in hArtListe.html #OeffneOrthArtListe geklickt wird
    window.em.handleHArtListeÖffneOrtClick = function () {
      'use strict'
      window.em.leereStoragehArtListe()
      window.em.leereStorageZeitEdit()
      window.em.leereStorageZeitListe()
      $.mobile.navigate('hOrtEdit.html')
    }

    // wenn in hArtListe.html #OeffneRaumhArtListe geklickt wird
    window.em.handleHArtListeÖffneRaumClick = function () {
      'use strict'
      window.em.leereStoragehArtListe()
      window.em.leereStorageZeitEdit()
      window.em.leereStorageZeitListe()
      window.em.leereStorageOrtEdit()
      window.em.leereStorageOrtListe()
      $.mobile.navigate('hRaumEdit.html')
    }

    // wenn in hArtListe.html #OeffneProjekthArtListe geklickt wird
    window.em.handleHArtListeÖffneProjektClick = function () {
      'use strict'
      window.em.leereStoragehArtListe()
      window.em.leereStorageZeitEdit()
      window.em.leereStorageZeitListe()
      window.em.leereStorageOrtEdit()
      window.em.leereStorageOrtListe()
      window.em.leereStorageRaumEdit()
      window.em.leereStorageRaumListe()
      $.mobile.navigate('hProjektEdit.html')
    }

    // wenn in hArtListe.html .beob geklickt wird
    window.em.handleHArtListeBeobClick = function () {
      'use strict'
      window.localStorage.hArtId = $(this).attr('hArtId')
      if (window.localStorage.hArtSicht === 'liste') {
        $.mobile.navigate('hArtEditListe.html')
      } else {
        $.mobile.navigate('hArtEdit.html')
      }
    }

    // wenn in hArtListe.html nach rechts gewischt wird
    window.em.handleHArtListeSwiperight = function () {
      'use strict'
      $.mobile.navigate('hZeitListe.html')
    }

    // wenn in hArtListe.html .menu_einfacher_modus geklickt wird
    window.em.handleHArtListeMenuEinfacherModusClick = function () {
      'use strict'
      window.em.leereStoragehArtListe()
      window.em.leereStorageZeitEdit()
      window.em.leereStorageZeitListe()
      window.em.leereStorageOrtEdit()
      window.em.leereStorageOrtListe()
      window.em.leereStorageRaumEdit()
      window.em.leereStorageRaumListe()
      window.em.leereStorageProjektEdit()
      $.mobile.navigate('BeobListe.html')
    }

    // wenn in hArtListe.html .menu_felder_verwalten geklickt wird
    window.em.handleHArtListeMenuFelderVerwaltenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hArtListe.html'
      $.mobile.navigate('FeldListe.html')
    }

    // wenn in hArtListe.html .menu_beob_exportieren geklickt wird
    window.em.handleHArtListeMenuBeobExportierenClick = function () {
      'use strict'
      window.open('_list/ExportBeob/ExportBeob?startkey=["' + window.localStorage.Email + '"]&endkey=["' + window.localStorage.Email + '",{},{}]&include_docs=true')
      $('#MenuhArtListe')
        // völlig unlogisch: das bereits offene popup muss zuerst initialisiert werden...
        .popup()
        // ...bevor es geschlossen werden muss, weil es sonst offen bleibt
        .popup('close')
    }

    // wenn in hArtListe.html .menu_einstellungen geklickt wird
    window.em.handleHArtListeMenuEinstellungenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hArtListe.html'
      window.em.öffneMeineEinstellungen()
    }

    // wenn hOrtEdit.html erscheint
    window.em.handleHOrtEditPageshow = function () {
      'use strict'
      // Sollte keine id vorliegen, zu hProjektListe.html wechseln
      // das kommt im Normalfall nur vor, wenn der Cache des Browsers geleert wurde
      // oder in der Zwischenzeit auf einem anderen Browser dieser Datensatz gelöscht wurde
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if ((!window.localStorage.Status || window.localStorage.Status === 'undefined') && (!window.localStorage.OrtId || window.localStorage.OrtId === 'undefined')) {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
        return
      }
      window.em.initiiereOrtEdit()
    }

    // wenn hOrtEdit.html verschwindet
    window.em.handleHOrtEditPagehide = function () {
      'use strict'
      if (typeof window.em.watchID !== 'undefined') {
        window.em.stopGeolocation()
      }
    }

    // wenn hOrtEdit.html initiiert wird
    window.em.handleHOrtEditPageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if ((!window.localStorage.Status || window.localStorage.Status === 'undefined') && (!window.localStorage.OrtId || window.localStorage.OrtId === 'undefined')) {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
        return
      }

      // inaktive tabs inaktivieren
      $(document)
        .on('click', '.tab_inaktiv', function (event) {
          event.preventDefault()
          event.stopPropagation()
        })

      $('#OrtEditHeader')
        .on('click', "[name='OeffneOrtListeOrtEdit']", function (event) {
          event.preventDefault()
          window.em.handleHOrtEditÖffneOrtListeClick()
        })
        .on('click', '#OeffneRaumOrtEdit', function (event) {
          event.preventDefault()
          window.em.handleHOrtEditÖffneRaumClick()
        })
        .on('click', '#OeffneZeitListeOrtEdit', function (event) {
          event.preventDefault()
          $.mobile.navigate('hZeitListe.html')
        })
        .on('click', '#OeffneProjektOrtEdit', function (event) {
          event.preventDefault()
          window.em.handleHOrtEditÖffneProjektClick()
        })

      $('#hOrtEditForm')
        // Für jedes Feld bei Änderung speichern
        .on('change', '.speichern', window.em.handleHOrtEditSpeichernChange)
        // Eingabe im Zahlenfeld abfangen
        .on('blur', '.speichernSlider', window.em.speichereHOrtEdit)
        // Klicken auf den Pfeilen im Zahlenfeld abfangen
        .on('mouseup', '.ui-slider-input', window.em.speichereHOrtEdit)
        // Ende des Schiebens abfangen
        .on('slidestop', '.speichernSlider', window.em.speichereHOrtEdit)

      $('#FormAnhängehOE')
        // Änderungen im Formular für Anhänge speichern
        .on('change', '.speichernAnhang', window.em.handleHOrtEditSpeichernAnhangChange)
        .on('click', "[name='LöscheAnhang']", function (event) {
          event.preventDefault()
          window.em.löscheAnhang(this, window.em.hOrt, window.localStorage.OrtId)
        })

      $('#hOrtEdit')
        .on('swipeleft', '#OrtEditContent', window.em.handleHOrtEditContentSwipeleft)
        .on('swiperight', '#OrtEditContent', window.em.handleHOrtEditContentSwiperight)
        // Pagination Pfeil voriger initialisieren
        .on('vclick', '.ui-pagination-prev', function (event) {
          event.preventDefault()
          window.em.nächsterVorigerOrt('voriger')
        })
        // Pagination Pfeil nächster initialisieren
        .on('vclick', '.ui-pagination-next', function (event) {
          event.preventDefault()
          window.em.nächsterVorigerOrt('nächster')
        })
        // Pagination Pfeiltasten initialisieren
        .on('keyup', function (event) {
          'use strict'
          // nur reagieren, wenn hProjektEdit sichtbar und Fokus nicht in einem Feld
          if (!$(event.target).is('input, textarea, select, button') && $('#hOrtEdit').is(':visible')) {
            // Left arrow
            if (event.keyCode === $.mobile.keyCode.LEFT) {
              window.em.nächsterVorigerOrt('voriger')
              event.preventDefault()
            }
            // Right arrow
            else if (event.keyCode === $.mobile.keyCode.RIGHT) {
              window.em.nächsterVorigerOrt('nächster')
              event.preventDefault()
            }
          }
        })

      $('#OrtEditFooter')
        // neuen Ort erstellen
        .on('click', '#NeuerOrtOrtEdit', function (event) {
          event.preventDefault()
          window.em.erstelleNeuenOrt()
        })
        // sichtbare Felder wählen
        .on('click', '#waehleFelderOrtEdit', function (event) {
          event.preventDefault()
          window.em.handleHOrtEditWähleFelderClick()
        })
        // Code für den Ort-Löschen-Dialog
        .on('click', '#LoescheOrtOrtEdit', function (event) {
          event.preventDefault()
          window.em.handleHOrtEditLöscheOrtClick(this)
        })
        // Karte managen
        .on('click', '#KarteOeffnenOrtEdit', function (event) {
          event.preventDefault()
          window.em.handleHOrtEditKarteÖffnenClick()
        })
        .on('click', '#VerortungOrtEdit', function (event) {
          event.preventDefault()
          window.em.GetGeolocation(window.localStorage.OrtId, 'Ort')
        })

      $('#hoe_löschen_meldung')
        .on('click', '#hoe_löschen_meldung_ja_loeschen', window.em.handleHOrtEditLöschenMeldungJaClick)

      $('#MenuOrtEdit')
        .on('click', '.menu_einfacher_modus', window.em.handleHOrtEditMenuEinfacherModusClick)
        .on('click', '.menu_felder_verwalten', window.em.handleHOrtEditMenuFelderVerwaltenClick)
        .on('click', '.menu_orte_exportieren', window.em.handleHOrtEditMenuOrteExportierenClick)
        .on('click', '.menu_einstellungen', window.em.handleHOrtEditMenuEinstellungenClick)
        .on('click', '.menu_neu_anmelden', window.em.meldeNeuAn)
        .on('click', '.menu_artengruppen_importieren', window.em.öffneArtengruppenImportieren)
        .on('click', '.menu_admin', window.em.öffneAdmin)
    }

    // wenn in hOrtEdit.html [name='OeffneOrtListeOrtEdit'] geklickt wird
    window.em.handleHOrtEditÖffneOrtListeClick = function () {
      'use strict'
      window.em.leereStorageOrtEdit()
      $.mobile.navigate('hOrtListe.html')
    }

    // wenn in hOrtEdit.html #OeffneRaumOrtEdit geklickt wurde
    window.em.handleHOrtEditÖffneRaumClick = function () {
      'use strict'
      // sonst wird bei Rückkehr die alte Liste angezeigt, egal von welchem Raum man kommt!
      window.em.leereStorageOrtListe()
      $.mobile.navigate('hRaumEdit.html')
    }

    // wenn in hOrtEdit.html #OeffneProjektOrtEdit geklickt wird
    window.em.handleHOrtEditÖffneProjektClick = function () {
      'use strict'
      // sonst wird bei Rückkehr die alte Liste angezeigt, egal von welchem Raum man kommt!
      window.em.leereStorageOrtListe()
      window.em.leereStorageRaumListe()
      $.mobile.navigate('hProjektEdit.html')
    }

    // wenn in hOrtEdit.html .speichern geändert wird
    window.em.handleHOrtEditSpeichernChange = function () {
      'use strict'
      var Feldname = this.name,
        $oXKoord = $("[name='oXKoord']"),
        $oYKoord = $("[name='oYKoord']"),
        ChToWgsLng = require('./util/chToWgsLng'),
        ChToWgsLat = require('./util/chToWgsLat')
      if (['oXKoord', 'oYKoord'].indexOf(Feldname) > -1 && $oXKoord.val() && $oYKoord.val()) {
        // Wenn Koordinaten und beide erfasst
        window.localStorage.oXKoord = $oXKoord.val()
        window.localStorage.oYKoord = $oYKoord.val()
        // Längen- und Breitengrade berechnen
        window.localStorage.oLongitudeDecDeg = ChToWgsLng(window.localStorage.oYKoord, window.localStorage.oXKoord)
        window.localStorage.oLatitudeDecDeg = ChToWgsLat(window.localStorage.oYKoord, window.localStorage.oXKoord)
        window.localStorage.oLagegenauigkeit = null
        // und Koordinaten speichern
        window.em.speichereKoordinaten(window.localStorage.OrtId, 'hOrt')
      } else {
        window.em.speichereHOrtEdit(this)
      }
    }

    // wenn in hOrtEdit.html .speichernAnhang ändert
    window.em.handleHOrtEditSpeichernAnhangChange = function () {
      'use strict'
      var _attachments = $('#_attachmentshOE').val()
      if (_attachments && _attachments.length !== 0) {
        window.em.speichereAnhänge(window.localStorage.OrtId, window.em.hOrt, 'hOE')
      }
    }

    // wenn in hOrtEdit.html #waehleFelderOrtEdit geklickt wird
    window.em.handleHOrtEditWähleFelderClick = function () {
      'use strict'
      window.localStorage.AufrufendeSeiteFW = 'hOrtEdit'
      $.mobile.navigate('FelderWaehlen.html')
    }

    // wenn in hOrtEdit.html #LoescheOrtOrtEdit geklickt wird
    window.em.handleHOrtEditLöscheOrtClick = function () {
      'use strict'
      // Anzahl Zeiten von Ort zählen
      var $db = $.couch.db('evab')
      $db.view('evab/hZeitIdVonOrt?startkey=["' + window.localStorage.OrtId + '"]&endkey=["' + window.localStorage.OrtId + '",{},{}]', {
        success: function (Zeiten) {
          var anzZeiten = Zeiten.rows.length
          $db.view('evab/hArtIdVonOrt?startkey=["' + window.localStorage.OrtId + '"]&endkey=["' + window.localStorage.OrtId + '",{},{}]', {
            success: function (Arten) {
              var anzArten = Arten.rows.length,
                $hoe_löschen_meldung = $('#hoe_löschen_meldung'),
                zeiten_text = (anzZeiten === 1 ? ' Zeit und ' : ' Zeiten und '),
                arten_text = (anzArten === 1 ? ' Art' : ' Arten'),
                meldung = 'Ort inklusive ' + anzZeiten + zeiten_text + anzArten + arten_text + ' löschen?'
              $('#hoe_löschen_meldung_meldung').html(meldung)
              // Listen anhängen, damit ohne DB-Abfrage gelöscht werden kann
              $hoe_löschen_meldung.data('Arten', Arten)
              $hoe_löschen_meldung.data('Zeiten', Zeiten)
              // popup öffnen
              $hoe_löschen_meldung.popup('open')
            }
          })
        }
      })
    }

    // wenn in hOrtEdit.html #hoe_löschen_meldung_ja_loeschen geklickt wird
    window.em.handleHOrtEditLöschenMeldungJaClick = function () {
      'use strict'
      var $hoe_löschen_meldung = $('#hoe_löschen_meldung')[0]
      window.em.löscheOrt($.data($hoe_löschen_meldung, 'Arten'), $.data($hoe_löschen_meldung, 'Zeiten'))
    }

    // wenn in hOrtEdit.html #KarteOeffnenOrtEdit geklickt wird
    window.em.handleHOrtEditKarteÖffnenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hOrtEdit'
      $.mobile.navigate('Karte.html')
    }

    // wenn in hOrtEdit.html #OrtEditContent nach links gewischt wird
    window.em.handleHOrtEditContentSwipeleft = function () {
      'use strict'
      if (!$('*:focus').attr('aria-valuenow')) {
        // kein slider
        window.em.nächsterVorigerOrt('nächster')
      }
    }

    // wenn in hOrtEdit.html #OrtEditContent nach rechts gewischt wird
    window.em.handleHOrtEditContentSwiperight = function () {
      'use strict'
      if (!$('*:focus').attr('aria-valuenow')) {
        // kein slider
        window.em.nächsterVorigerOrt('voriger')
      }
    }

    // wenn in hOrtEdit.html .menu_einfacher_modus geklickt wird
    window.em.handleHOrtEditMenuEinfacherModusClick = function () {
      'use strict'
      window.em.leereStorageOrtEdit()
      window.em.leereStorageOrtListe()
      window.em.leereStorageRaumEdit()
      window.em.leereStorageRaumListe()
      window.em.leereStorageProjektEdit()
      $.mobile.navigate('BeobListe.html')
    }

    // wenn in hOrtEdit.html .menu_felder_verwalten geklickt wird
    window.em.handleHOrtEditMenuFelderVerwaltenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hOrtEdit.html'
      $.mobile.navigate('FeldListe.html')
    }

    // wenn in hOrtEdit.html .menu_orte_exportieren geklickt wird
    window.em.handleHOrtEditMenuOrteExportierenClick = function () {
      'use strict'
      window.open('_list/ExportOrt/ExportOrt?startkey=["' + window.localStorage.Email + '"]&endkey=["' + window.localStorage.Email + '",{},{}]&include_docs=true')
      $('#MenuOrtEdit')
        // völlig unlogisch: das bereits offene popup muss zuerst initialisiert werden...
        .popup()
        // ...bevor es geschlossen werden muss, weil es sonst offen bleibt
        .popup('close')
    }

    // wenn in hOrtEdit.html .menu_einstellungen geklickt wird
    window.em.handleHOrtEditMenuEinstellungenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hOrtEdit.html'
      window.em.öffneMeineEinstellungen()
    }

    // wenn hOrtListe.html erscheint
    window.em.handleHOrtListePageshow = function () {
      'use strict'
      // Sollte keine id vorliegen, zu hProjektListe.html wechseln
      // das kommt im Normalfall nur vor, wenn der Cache des Browsers geleert wurde
      // oder in der Zwischenzeit auf einem anderen Browser dieser Datensatz gelöscht wurde
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if (!window.localStorage.RaumId || window.localStorage.RaumId === 'undefined') {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
        return
      }
      window.em.initiiereOrtListe()
    }

    // wenn hOrtListe.html initiiert wird
    window.em.handleHOrtListePageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if (!window.localStorage.RaumId || window.localStorage.RaumId === 'undefined') {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
        return
      }

      // inaktive tabs inaktivieren
      $(document)
        .on('click', '.tab_inaktiv', function (event) {
          event.preventDefault()
          event.stopPropagation()
        })

      $('#hOrtListePageHeader')
        // Link zu Raum in Navbar und Titelleiste
        .on('click', "[name='OeffneRaumOrtListe']", function (event) {
          event.preventDefault()
          window.em.handleHOrtListeÖffneRaumClick()
        })
        .on('click', '#OeffneProjektOrtListe', function (event) {
          event.preventDefault()
          window.em.handleHOrtListeÖffneProjektClick()
        })

      $('#hOrtListe')
        // neuen Ort erstellen
        .on('click', '.NeuerOrtOrtListe', function (event) {
          event.preventDefault()
          window.em.erstelleNeuenOrt()
        })
        .on('swiperight', '#hOrtListePageContent', window.em.handleHOrtListePageContentSwiperight)

      $('#OrtlistehOL')
        .on('swipeleft', '.Ort', window.em.handleHOrtListeSwipeleft)
        .on('click', '.Ort', function (event) {
          event.preventDefault()
          window.em.handleHOrtListeOrtClick(this)
        })
        .on('swipeleft', '.erste', window.em.erstelleNeuenOrt)

      $('#hOrtListePageFooter')
        .on('click', '#OeffneKarteOrtListe', function (event) {
          event.preventDefault()
          window.em.handleHOrtListeÖffneKarteClick()
        })

      $('#MenuOrtListe')
        .on('click', '.menu_einfacher_modus', window.em.handleHOrtListeMenuEinfacherModusClick)
        .on('click', '.menu_felder_verwalten', window.em.handleHOrtListeMenuFelderVerwaltenClick)
        .on('click', '.menu_orte_exportieren', window.em.handleHOrtListeMenuOrteExportierenClick)
        .on('click', '.menu_einstellungen', window.em.handleHOrtListeMenuEinstellungenClick)
        .on('click', '.menu_neu_anmelden', window.em.meldeNeuAn)
        .on('click', '.menu_artengruppen_importieren', window.em.öffneArtengruppenImportieren)
        .on('click', '.menu_admin', window.em.öffneAdmin)
    }

    // wenn in hOrtListe.html [name='OeffneRaumOrtListe'] geklickt wird
    window.em.handleHOrtListeÖffneRaumClick = function () {
      'use strict'
      window.em.leereStorageOrtListe()
      $.mobile.navigate('hRaumEdit.html')
    }

    // wenn in hOrtListe.html #OeffneProjektOrtListe geklickt wird
    window.em.handleHOrtListeÖffneProjektClick = function () {
      'use strict'
      window.em.leereStorageOrtListe()
      window.em.leereStorageRaumEdit()
      window.em.leereStorageRaumListe()
      $.mobile.navigate('hProjektEdit.html')
    }

    // wenn in hOrtListe.html nach links gewischt wird
    window.em.handleHOrtListeSwipeleft = function () {
      'use strict'
      window.localStorage.OrtId = $(this).attr('OrtId')
      $.mobile.navigate('hZeitListe.html')
    }

    // wenn in hOrtListe.html .Ort geklickt wird
    window.em.handleHOrtListeOrtClick = function (that) {
      'use strict'
      window.localStorage.OrtId = $(that).attr('OrtId')
      $.mobile.navigate('hOrtEdit.html')
    }

    // wenn in hOrtListe.html #hOrtListePageContent nach rechts gewischt wird
    window.em.handleHOrtListePageContentSwiperight = function () {
      'use strict'
      window.em.leereStorageOrtListe()
      window.em.leereStorageRaumEdit()
      $.mobile.navigate('hRaumListe.html')
    }

    // wenn in hOrtListe.html #OeffneKarteOrtListe geklickt wird
    window.em.handleHOrtListeÖffneKarteClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hOrtListe'
      $.mobile.navigate('Karte.html')
    }

    // wenn in hOrtListe.html .menu_einfacher_modus geklickt wird
    window.em.handleHOrtListeMenuEinfacherModusClick = function () {
      'use strict'
      window.em.leereStorageOrtListe()
      window.em.leereStorageRaumEdit()
      window.em.leereStorageRaumListe()
      window.em.leereStorageProjektEdit()
      $.mobile.navigate('BeobListe.html')
    }

    // wenn in hOrtListe.html .menu_felder_verwalten geklickt wird
    window.em.handleHOrtListeMenuFelderVerwaltenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hOrtListe.html'
      $.mobile.navigate('FeldListe.html')
    }

    // wenn in hOrtListe.html .menu_orte_exportieren geklickt wird
    window.em.handleHOrtListeMenuOrteExportierenClick = function () {
      'use strict'
      window.open('_list/ExportOrt/ExportOrt?startkey=["' + window.localStorage.Email + '"]&endkey=["' + window.localStorage.Email + '",{},{}]&include_docs=true')
      $('#MenuOrtListe')
        // völlig unlogisch: das bereits offene popup muss zuerst initialisiert werden...
        .popup()
        // ...bevor es geschlossen werden muss, weil es sonst offen bleibt
        .popup('close')
    }

    // wenn in hOrtListe.html .menu_einstellungen geklickt wird
    window.em.handleHOrtListeMenuEinstellungenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hOrtListe.html'
      window.em.öffneMeineEinstellungen()
    }

    // wenn hProjektEdit.html angezeigt wird
    window.em.handleHProjektEditPageshow = function () {
      'use strict'
      // Sollte keine id vorliegen, zu hProjektListe.html wechseln
      // das kommt im Normalfall nur vor, wenn der Cache des Browsers geleert wurde
      // oder in der Zwischenzeit auf einem anderen Browser dieser Datensatz gelöscht wurde
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if ((!window.localStorage.Status || window.localStorage.Status === 'undefined') && (!window.localStorage.ProjektId || window.localStorage.ProjektId === 'undefined')) {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
        return
      }
      window.em.initiiereProjektEdit()
    }

    // wenn hProjektEdit.html initiiert wird
    window.em.handleHProjektEditPageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if ((!window.localStorage.Status || window.localStorage.Status === 'undefined') && (!window.localStorage.ProjektId || window.localStorage.ProjektId === 'undefined')) {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
        return
      }

      $(document)
        // inaktive tabs inaktivieren
        .on('click', '.tab_inaktiv', function (event) {
          event.preventDefault()
          event.stopPropagation()
        })

      $('#hProjektEditHeader')
        .on('click', "[name='OeffneProjektListeProjektEdit']", function (event) {
          event.preventDefault()
          window.em.handleHProjektEditÖffneProjektListeClick()
        })
        .on('click', '#OeffneRaumListeProjektEdit', function (event) {
          event.preventDefault()
          $.mobile.navigate('hRaumListe.html')
        })

      $('#hProjektEditForm')
        // Für jedes Feld bei Änderung speichern
        .on('change', '.speichern', window.em.speichereHProjektEdit)
        // Eingabe im Zahlenfeld abfangen
        // Ende des Schiebens abfangen
        .on('blur slidestop', '.speichernSlider', window.em.speichereHProjektEdit)
        // Klicken auf den Pfeilen im Zahlenfeld abfangen
        .on('mouseup', '.ui-slider-input', window.em.speichereHProjektEdit)

      $('#FormAnhängehPE')
        // Änderungen im Formular für Anhänge speichern
        .on('change', '.speichernAnhang', window.em.handleHProjektEditSpeichernAnhangChange)
        .on('click', "[name='LöscheAnhang']", function (event) {
          event.preventDefault()
          window.em.löscheAnhang(this, window.em.hProjekt, window.localStorage.ProjektId)
        })

      $('#hProjektEdit')
        .on('swipeleft', '#hProjektEditContent', window.em.handleHProjektEditContentSwipeleft)
        .on('swiperight', '#hProjektEditContent', window.em.handleHProjektEditContentSwiperight)
        // Pagination Pfeil voriger initialisieren
        .on('vclick', '.ui-pagination-prev', function (event) {
          event.preventDefault()
          window.em.nächstesVorigesProjekt('voriges')
        })
        // Pagination Pfeil nächster initialisieren
        .on('vclick', '.ui-pagination-next', function (event) {
          event.preventDefault()
          window.em.nächstesVorigesProjekt('nächstes')
        })
        // Pagination Pfeiltasten initialisieren
        .on('keyup', function (event) {
          'use strict'
          // nur reagieren, wenn hProjektEdit sichtbar und Fokus nicht in einem Feld
          if (!$(event.target).is('input, textarea, select, button') && $('#hProjektEdit').is(':visible')) {
            // Left arrow
            if (event.keyCode === $.mobile.keyCode.LEFT) {
              window.em.nächstesVorigesProjekt('voriges')
              event.preventDefault()
            }
            // Right arrow
            else if (event.keyCode === $.mobile.keyCode.RIGHT) {
              window.em.nächstesVorigesProjekt('nächstes')
              event.preventDefault()
            }
          }
        })

      $('#hProjektEditFooter')
        // Code für den Projekt-Löschen-Dialog
        .on('click', '#LöscheProjektProjektEdit', function (event) {
          event.preventDefault()
          window.em.handleHProjektEditLöscheProjektClick(this)
        })
        // neues Projekt erstellen
        .on('click', '#NeuesProjektProjektEdit', function (event) {
          event.preventDefault()
          window.em.erstelleNeuesProjekt()
        })
        // sichtbare Felder wählen
        .on('click', '#waehleFelderProjektEdit', function (event) {
          event.preventDefault()
          window.em.handleHProjektEditWähleFelderClick()
        })
        .on('click', '#KarteOeffnenProjektEdit', function (event) {
          event.preventDefault()
          window.em.handleHProjektEditKarteÖffnenClick()
        })

      $('#hpe_löschen_meldung')
        .on('click', '#hpe_löschen_meldung_ja_loeschen', window.em.handleHProjektEditLöschenMeldungJaClick)

      $('#MenuProjektEdit')
        .on('click', '.menu_einfacher_modus', window.em.handleHProjektEditMenuEinfacherModusClick)
        .on('click', '.menu_felder_verwalten', window.em.handleHProjektEditMenuFelderVerwaltenClick)
        .on('click', '.menu_projekte_exportieren', window.em.handleHProjektEditMenuProjekteExportierenClick)
        .on('click', '.menu_einstellungen', window.em.handleHProjektEditMenuEinstellungenClick)
        .on('click', '.menu_neu_anmelden', window.em.meldeNeuAn)
        .on('click', '.menu_artengruppen_importieren', window.em.öffneArtengruppenImportieren)
        .on('click', '.menu_admin', window.em.öffneAdmin)
    }

    // wenn in hProjektEdit.html [name='OeffneProjektListeProjektEdit'] geklickt wird
    window.em.handleHProjektEditÖffneProjektListeClick = function () {
      'use strict'
      window.em.leereStorageProjektEdit()
      $.mobile.navigate('hProjektListe.html')
    }

    // wenn in hProjektEdit.html .speichernAnhang geändert wird
    window.em.handleHProjektEditSpeichernAnhangChange = function () {
      'use strict'
      var _attachments = $('#_attachmentshPE').val()
      if (_attachments && _attachments.length > 0) {
        window.em.speichereAnhänge(window.localStorage.ProjektId, window.em.hProjekt, 'hPE')
      }
    }

    // wenn in hProjektEdit.html #LöscheProjektProjektEdit geklickt wird
    window.em.handleHProjektEditLöscheProjektClick = function () {
      'use strict'
      // Anzahl Räume des Projekts zählen
      // die Abfrage verwenden, um die Datensätze später direkt zu löschen, ohne weitere DB-Abfrage
      var $db = $.couch.db('evab')
      $db.view('evab/hRaumIdVonProjekt?startkey=["' + window.localStorage.ProjektId + '"]&endkey=["' + window.localStorage.ProjektId + '",{},{}]', {
        success: function (Raeume) {
          var anzRaeume = Raeume.rows.length
          // Anzahl Orte des Projekts zählen
          $db.view('evab/hOrtIdVonProjekt?startkey=["' + window.localStorage.ProjektId + '"]&endkey=["' + window.localStorage.ProjektId + '",{},{}]', {
            success: function (Orte) {
              var anzOrte = Orte.rows.length
              // Anzahl Zeiten des Projekts zählen
              $db.view('evab/hZeitIdVonProjekt?startkey=["' + window.localStorage.ProjektId + '"]&endkey=["' + window.localStorage.ProjektId + '",{},{}]', {
                success: function (Zeiten) {
                  var anzZeiten = Zeiten.rows.length
                  // Anzahl Arten des Projekts zählen
                  $db.view('evab/hArtIdVonProjekt?startkey=["' + window.localStorage.ProjektId + '"]&endkey=["' + window.localStorage.ProjektId + '",{},{}]', {
                    success: function (Arten) {
                      var anzArten = Arten.rows.length,
                        $hoe_löschen_meldung = $('#hoe_löschen_meldung'),
                        räume_text = (anzRaeume === 1 ? ' Raum, ' : ' Räume, '),
                        orte_text = (anzOrte === 1 ? ' Ort, ' : ' Orte, '),
                        zeiten_text = (anzZeiten === 1 ? ' Zeit und ' : ' Zeiten und '),
                        arten_text = (anzArten === 1 ? ' Art' : ' Arten'),
                        meldung = 'Projekt inklusive ' + anzRaeume + räume_text + anzOrte + orte_text + anzZeiten + zeiten_text + anzArten + arten_text + ' löschen?'
                      $('#hpe_löschen_meldung_meldung').html(meldung)
                      // Listen anhängen, damit ohne DB-Abfrage gelöscht werden kann
                      $hoe_löschen_meldung.data('Arten', Arten)
                      $hoe_löschen_meldung.data('Zeiten', Zeiten)
                      $hoe_löschen_meldung.data('Orte', Orte)
                      $hoe_löschen_meldung.data('Raeume', Raeume)
                      // popup öffnen
                      $('#hpe_löschen_meldung').popup('open')
                    }
                  })
                }
              })
            }
          })
        }
      })
    }

    // wenn in hProjektEdit.html #hpe_löschen_meldung_ja_loeschen geklickt wird
    window.em.handleHProjektEditLöschenMeldungJaClick = function () {
      'use strict'
      var $hpe_löschen_meldung = $('#hpe_löschen_meldung')[0]
      window.em.löscheProjekt(jQuery.data($hpe_löschen_meldung, 'Arten'), jQuery.data($hpe_löschen_meldung, 'Zeiten'), jQuery.data($hpe_löschen_meldung, 'Orte'), jQuery.data($hpe_löschen_meldung, 'Raeume'))
    }

    // wenn in hProjektEdit.html #waehleFelderProjektEdit geklickt wird
    window.em.handleHProjektEditWähleFelderClick = function () {
      'use strict'
      window.localStorage.AufrufendeSeiteFW = 'hProjektEdit'
      $.mobile.navigate('FelderWaehlen.html')
    }

    // wenn in hProjektEdit.html #hProjektEditContent nach links gewischt wird
    window.em.handleHProjektEditContentSwipeleft = function () {
      'use strict'
      if (!$('*:focus').attr('aria-valuenow')) {
        // kein slider
        window.em.nächstesVorigesProjekt('nächstes')
      }
    }

    // wenn in hProjektEdit.html #hProjektEditContent nach rechts gewischt wird
    window.em.handleHProjektEditContentSwiperight = function () {
      'use strict'
      if (!$('*:focus').attr('aria-valuenow')) {
        // kein slider
        window.em.nächstesVorigesProjekt('voriges')
      }
    }

    // wenn in hProjektEdit.html #KarteOeffnenProjektEdit geklickt wird
    window.em.handleHProjektEditKarteÖffnenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hProjektEdit'
      $.mobile.navigate('Karte.html')
    }

    // wenn in hProjektEdit.html .menu_einfacher_modus geklickt wird
    window.em.handleHProjektEditMenuEinfacherModusClick = function () {
      'use strict'
      window.em.leereStorageProjektEdit()
      $.mobile.navigate('BeobListe.html')
    }

    // wenn in hProjektEdit.html .menu_felder_verwalten geklickt wird
    window.em.handleHProjektEditMenuFelderVerwaltenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hProjektEdit.html'
      $.mobile.navigate('FeldListe.html')
    }

    // wenn in hProjektEdit.html .menu_projekte_exportieren geklickt wird
    window.em.handleHProjektEditMenuProjekteExportierenClick = function () {
      'use strict'
      window.open('_list/ExportProjekt/ExportProjekt?startkey=["' + window.localStorage.Email + '",{},{},{},{},{}]&endkey=["' + window.localStorage.Email + '"]&descending=true&include_docs=true')
      $('#MenuProjektEdit')
        // völlig unlogisch: das bereits offene popup muss zuerst initialisiert werden...
        .popup()
        // ...bevor es geschlossen werden muss, weil es sonst offen bleibt
        .popup('close')
    }

    // wenn in hProjektEdit.html .menu_einstellungen geklickt wird
    window.em.handleHProjektEditMenuEinstellungenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hProjektEdit.html'
      window.em.öffneMeineEinstellungen()
    }

    // Öffnet das vorige oder nächste Projekt
    // voriges des ersten => hProjektListe.html
    // nächstes des letzten => melden
    // erwartet die ID des aktuellen Datensatzes und ob nächster oder voriger gesucht wird
    // wird benutzt in hProjektEdit.html
    window.em.nächstesVorigesProjekt = function (NächstesOderVoriges) {
      'use strict'
      // prüfen, ob Projektliste schon existiert
      // nur abfragen, wenn sie noch nicht existiert
      if (window.em.Projektliste) {
        // globale Variable Projektliste existiert noch
        window.em.nächstesVorigesProjekt_2(NächstesOderVoriges)
      } else {
        // keine Projektliste übergeben
        // neu aus DB erstellen
        var $db = $.couch.db('evab')
        $db.view('evab/hProjListe?startkey=["' + window.localStorage.Email + '"]&endkey=["' + window.localStorage.Email + '",{}]&include_docs=true', {
          success: function (data) {
            // Projektliste bereitstellen
            window.em.Projektliste = data
            window.em.nächstesVorigesProjekt_2(NächstesOderVoriges)
          }
        })
      }
    }

    window.em.nächstesVorigesProjekt_2 = function (NächstesOderVoriges) {
      'use strict'
      var i,
        ProjIdAktuell,
        AnzProj
      for (i = 0; window.em.Projektliste.rows.length; i++) {
        ProjIdAktuell = window.em.Projektliste.rows[i].doc._id
        AnzProj = window.em.Projektliste.rows.length - 1  // vorsicht: Objekte zählen Elemente ab 1, Arrays ab 0!
        if (ProjIdAktuell === window.localStorage.ProjektId) {
          switch (NächstesOderVoriges) {
            case 'nächstes':
              if (i < AnzProj) {
                window.localStorage.ProjektId = window.em.Projektliste.rows[i + 1].doc._id
                window.em.leereStorageProjektEdit('mitLatLngListe', 'ohneId')
                window.em.initiiereProjektEdit()
                return
              } else {
                window.em.melde('Das ist das letzte Projekt')
                return
              }
              break
            case 'voriges':
              if (i > 0) {
                window.localStorage.ProjektId = window.em.Projektliste.rows[i - 1].doc._id
                window.em.leereStorageProjektEdit('mitLatLngListe', 'ohneId')
                window.em.initiiereProjektEdit()
                return
              } else {
                window.em.leereStorageProjektEdit()
                $.mobile.navigate('hProjektListe.html')
                return
              }
              break
          }
        }
      }
    }

    // wird benutzt in hProjektEdit.html
    window.em.löscheProjekt = function (Arten, Zeiten, Orte, Raeume) {
      'use strict'
      // nur löschen, wo Datensätze vorkommen
      if (Raeume.rows.length > 0) {
        window.em.loescheIdIdRevListe(Raeume)
      }
      if (Orte.rows.length > 0) {
        window.em.loescheIdIdRevListe(Orte)
      }
      if (Zeiten.rows.length > 0) {
        window.em.loescheIdIdRevListe(Zeiten)
      }
      if (Arten.rows.length > 0) {
        window.em.loescheIdIdRevListe(Arten)
      }
      // zuletzt das Projekt
      if (window.em.hProjekt) {
        // Objekt verwenden
        window.em.löscheProjekt_2()
      } else {
        // Objekt aus DB holen
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.ProjektId, {
          success: function (data) {
            window.em.hProjekt = data
            window.em.löscheProjekt_2()
          },
          error: function () {
            window.em.melde('Fehler: Projekt nicht gelöscht')
          }
        })
      }
    }

    window.em.löscheProjekt_2 = function () {
      'use strict'
      var $db = $.couch.db('evab')
      $db.removeDoc(window.em.hProjekt, {
        success: function (data) {
          // Liste anpassen. Vorsicht: Bei refresh kann sie fehlen
          if (window.em.Projektliste && window.em.Projektliste.rows) {
            window.em.Projektliste.rows = _.reject(window.em.Projektliste.rows, function (row) {
              return row.doc._id === data.id
            })
          } else {
            // Keine Projektliste mehr. Storage löschen
            window.em.leereStorageProjektListe('mitLatLngListe')
          }
          // Projektedit zurücksetzen
          window.em.leereStorageProjektEdit('mitLatLngListe')
          $.mobile.navigate('hProjektListe.html')
        // $(":mobile-pagecontainer").pagecontainer("change", "hProjektListe.html")
        // $(":mobile-pagecontainer").pagecontainer("change", "hProjektListe.html", {reload: true})
        },
        error: function () {
          window.em.melde('Fehler: Projekt nicht gelöscht')
        }
      })
    }

    // wird benutzt in hProjektEdit.html
    window.em.validierehProjektEdit = function () {
      'use strict'
      if (!$("[name='pName']").val()) {
        window.em.melde('Bitte Projektnamen eingeben')
        setTimeout(function () {
          $("[name='pName']").focus()
        }, 50)  // need to use a timer so that .blur() can finish before you do .focus()
        return false
      }
      return true
    }

    // wird benutzt in hProjektEdit.html
    window.em.speichereHProjektEdit = function () {
      'use strict'
      var that = this
      if (window.em.hProjekt) {
        window.em.speichereHProjektEdit_2(that)
      } else {
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.ProjektId, {
          success: function (data) {
            window.em.hProjekt = data
            window.em.speichereHProjektEdit_2(that)
          },
          error: function () {
            window.em.melde('Fehler: Änderung in ' + that.name + ' nicht gespeichert')
          }
        })
      }
    }

    window.em.speichereHProjektEdit_2 = function (that) {
      'use strict'
      var FeldnameDb,
        Feldwert,
        feldinfos
      // Feldname und -wert ermitteln
      feldinfos = window.em.holeFeldInfosVonElement(that)
      FeldnameDb = feldinfos.feldname_db
      Feldwert = feldinfos.feldwert
      if (window.em.validierehProjektEdit()) {
        if (FeldnameDb === 'pName') {
          // Variablen für Projektliste zurücksetzen, damit sie beim nächsten Aufruf neu aufgebaut wird
          window.em.leereStorageProjektListe('mitLatLngListe')
        }
        if (Feldwert) {
          if (window.em.myTypeOf(Feldwert) === 'float') {
            window.em.hProjekt[FeldnameDb] = parseFloat(Feldwert)
          } else if (window.em.myTypeOf(Feldwert) === 'integer') {
            window.em.hProjekt[FeldnameDb] = parseInt(Feldwert)
          } else {
            window.em.hProjekt[FeldnameDb] = Feldwert
          }
        } else if (window.em.hProjekt[FeldnameDb]) {
          delete window.em.hProjekt[FeldnameDb]
        }
        // alles speichern
        var $db = $.couch.db('evab')
        $db.saveDoc(window.em.hProjekt, {
          success: function (data) {
            window.em.hProjekt._rev = data.rev
            // window.ZuletztGespeicherteProjektId wird benutzt, damit auch nach einem
            // Datensatzwechsel die Listen nicht (immer) aus der DB geholt werden müssen
            // Zuletzt gespeicherte ProjektId NACH dem speichern setzen
            // sicherstellen, dass bis dahin nicht schon eine nächste vewendet wird
            // darum zwischenspeichern
            window.em.hProjektIdZwischenspeicher = window.localStorage.ProjektId
            // setTimeout("window.ZuletztGespeicherteProjektId = window.em.hProjektIdZwischenspeicher", 1000)	AUSGESCHALTET, DA ZuletztGespeicherteProjektId NIRGENDS VERWENDET WIRD
            setTimeout('delete window.em.hProjektIdZwischenspeicher', 1500)
            // nicht aktualisierte hierarchisch tiefere Listen löschen
            delete window.em.OrteVonRaum
            delete window.em.ZeitenVonRaum
            delete window.em.ZeitenVonOrt
            delete window.em.ArtenVonRaum
            delete window.em.ArtenVonOrt
            delete window.em.ArtenVonZeit
          },
          error: function () {
            console.log('Fehler in function speichereHProjektEdit_2(that)')
          // melde("Fehler: Änderung in " + FeldnameDb + " nicht gespeichert")
          }
        })
      }
    }

    // Öffnet den vorigen oder nächsten Ort
    // voriger des ersten => OrtListe
    // nächster des letzten => melden
    // erwartet die ID des aktuellen Datensatzes und ob nächster oder voriger gesucht wird
    // wird benutzt in hOrtEdit.html
    window.em.nächsterVorigerOrt = function (NächsterOderVoriger) {
      'use strict'
      // prüfen, ob OrtListe schon existiert
      // nur abfragen, wenn sie noch nicht existiert
      if (window.em.OrtListe) {
        // Ortliste liegt als Variable vor
        window.em.nächsterVorigerOrt_2(NächsterOderVoriger)
      } else {
        // keine Ortliste vorhanden
        // neu aus DB erstellen
        var $db = $.couch.db('evab')
        $db.view('evab/hOrtListe?startkey=["' + window.localStorage.Email + '", "' + window.localStorage.RaumId + '"]&endkey=["' + window.localStorage.Email + '", "' + window.localStorage.RaumId + '" ,{}]&include_docs=true', {
          success: function (data) {
            // OrtListe für hOrtListe.html bereitstellen
            window.em.OrtListe = data
            window.em.nächsterVorigerOrt_2(NächsterOderVoriger)
          }
        })
      }
    }

    window.em.nächsterVorigerOrt_2 = function (NächsterOderVoriger) {
      'use strict'
      var i,
        OrtIdAktuell,
        AnzOrt
      for (i = 0; window.em.OrtListe.rows.length; i++) {
        OrtIdAktuell = window.em.OrtListe.rows[i].doc._id
        AnzOrt = window.em.OrtListe.rows.length - 1  // vorsicht: Objekte zählen Elemente ab 1, Arrays ab 0!
        if (OrtIdAktuell === window.localStorage.OrtId) {
          switch (NächsterOderVoriger) {
            case 'nächster':
              if (i < AnzOrt) {
                window.localStorage.OrtId = window.em.OrtListe.rows[i + 1].doc._id
                window.em.leereStorageOrtEdit('ohneId')
                window.em.initiiereOrtEdit()
                return
              } else {
                window.em.melde('Das ist der letzte Ort')
                return
              }
              break
            case 'voriger':
              if (i > 0) {
                window.localStorage.OrtId = window.em.OrtListe.rows[i - 1].doc._id
                window.em.leereStorageOrtEdit('ohneId')
                window.em.initiiereOrtEdit()
                return
              } else {
                window.em.leereStorageOrtEdit()
                $.mobile.navigate('hOrtListe.html')
                return
              }
              break
          }
        }
      }
    }

    // wird benutzt in hOrtEdit.html
    window.em.validatehOrtEdit = function () {
      'use strict'
      if (!$("[name='oName']").val()) {
        window.em.melde('Bitte Ortnamen eingeben')
        setTimeout(function () {
          $("[name='oName']").focus()
        }, 50)  // need to use a timer so that .blur() can finish before you do .focus()
        return false
      }
      return true
    }

    // wird benutzt in hOrtEdit.html
    window.em.speichereHOrtEdit = function (that) {
      'use strict'
      // die eventhandler übergeben this nicht über die Klammer
      var _this = that || this
      // prüfen, ob Ort existiert
      if (window.em.hOrt) {
        // bestehedes Objekt verwenden
        window.em.speichereHOrtEdit_2(_this)
      } else {
        // kein Ort > aus DB holen
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.OrtId, {
          success: function (data) {
            window.em.hOrt = data
            window.em.speichereHOrtEdit_2(_this)
          },
          error: function () {
            console.log('Fehler in function speichereHOrtEdit')
          // melde("Fehler: Änderung in " + Feldname + " nicht gespeichert")
          }
        })
      }
    }

    window.em.speichereHOrtEdit_2 = function (that) {
      'use strict'
      var FeldnameDb,
        Feldwert,
        feldinfos
      // Feldname und -wert ermitteln
      feldinfos = window.em.holeFeldInfosVonElement(that)
      FeldnameDb = feldinfos.feldname_db
      Feldwert = feldinfos.feldwert
      if (window.em.validatehOrtEdit()) {
        if (FeldnameDb === 'oName') {
          // Variablen für OrtListe zurücksetzen, damit die Liste beim nächsten Aufruf neu aufgebaut wird
          window.em.leereStorageOrtListe('mitLatLngListe')
        }
        // Werte aus dem Formular aktualisieren
        if (Feldwert) {
          if (window.em.myTypeOf(Feldwert) === 'float') {
            window.em.hOrt[FeldnameDb] = parseFloat(Feldwert)
          } else if (window.em.myTypeOf(Feldwert) === 'integer') {
            window.em.hOrt[FeldnameDb] = parseInt(Feldwert)
          } else {
            window.em.hOrt[FeldnameDb] = Feldwert
          }
        } else if (window.em.hOrt[FeldnameDb]) {
          delete window.em.hOrt[FeldnameDb]
        }
        // alles speichern
        var $db = $.couch.db('evab')
        $db.saveDoc(window.em.hOrt, {
          success: function (data) {
            window.em.hOrt._rev = data.rev
            // window.ZuletztGespeicherteOrtId wird benutzt, damit auch nach einem
            // Datensatzwechsel die Listen nicht (immer) aus der DB geholt werden müssen
            // Zuletzt gespeicherte OrtId NACH dem speichern setzen
            // sicherstellen, dass bis dahin nicht schon eine nächste vewendet wird
            // darum zwischenspeichern
            window.em.OrtIdZwischenspeicher = window.localStorage.OrtId
            // setTimeout("window.ZuletztGespeicherteOrtId = window.em.OrtIdZwischenspeicher", 1000)	AUSGESCHALTET, DA ZuletztGespeicherteOrtId NIRGENDS BENUTZT WIRD
            setTimeout('delete window.em.OrtIdZwischenspeicher', 1500)
            // nicht aktualisierte hierarchisch tiefere Listen löschen
            delete window.em.ZeitenVonProjekt
            delete window.em.ZeitenVonRaum
            delete window.em.ArtenVonProjekt
            delete window.em.ArtenVonRaum
            delete window.em.ArtenVonZeit
          },
          error: function () {
            console.log('Fehler in function speichereHOrtEdit_2(that)')
          // melde("Fehler: Änderung in " + FeldnameDb + " nicht gespeichert")
          }
        })
      }
    }

    // wird benutzt in hOrtEdit.html
    window.em.löscheOrt = function (Arten, Zeiten) {
      'use strict'
      // nur löschen, wo Datensätze vorkommen
      if (Zeiten.rows.length > 0) {
        window.em.loescheIdIdRevListe(Zeiten)
      }
      if (Arten.rows.length > 0) {
        window.em.loescheIdIdRevListe(Arten)
      }
      // zuletzt den Ort löschen
      if (window.em.hOrt) {
        // Objekt nutzen
        window.em.löscheOrt_2()
      } else {
        // Objekt aus DB holen
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.OrtId, {
          success: function (data) {
            window.em.hOrt = data
            window.em.löscheOrt_2()
          },
          error: function () {
            window.em.melde('Fehler: Der Ort wurde nicht gelöscht')
          }
        })
      }
    }

    window.em.löscheOrt_2 = function () {
      'use strict'
      var $db = $.couch.db('evab')
      $db.removeDoc(window.em.hOrt, {
        success: function (data) {
          // Liste anpassen. Vorsicht: Bei refresh kann sie fehlen
          if (window.em.OrtListe && window.em.OrtListe.rows) {
            window.em.OrtListe.rows = _.reject(window.em.OrtListe.rows, function (row) {
              return row.doc._id === data.id
            })
          } else {
            // Keine Ortliste mehr. Storage löschen
            window.em.leereStorageOrtListe('mitLatLngListe')
          }
          window.em.leereStorageOrtEdit('mitLatLngListe')
          $.mobile.navigate('hOrtListe.html')
        },
        error: function () {
          window.em.melde('Fehler: Der Ort wurde nicht gelöscht')
        }
      })
    }

    // wird verwendet in hArtListe.html
    window.em.öffneArtgruppenliste_hal = function () {
      'use strict'
      // Globale Variablen für hArtListe zurücksetzen, damit die Liste beim nächsten Aufruf neu aufgebaut wird
      // window.em.leereStoragehArtListe()
      window.localStorage.Status = 'neu'
      window.localStorage.Von = 'hArtListe'
      delete window.localStorage.aArtGruppe	// verhindern, dass eine Artgruppe übergeben wird
      $.mobile.navigate('Artgruppenliste.html')
    }

    // wenn in hArtEdit.html auf [name='OeffneArtListehArtEdit'] geklickt wird
    window.em.handleHArtEditÖffneArtListehArtEditClick = function () {
      'use strict'
      window.em.leereStoragehArtEdit()
      $.mobile.navigate('hArtListe.html')
    }

    // wenn in hArtEdit.html auf .OeffneZeithArtEdit geklickt wird
    window.em.handleHArtEditÖffneZeithArtEditClick = function () {
      'use strict'
      window.em.leereStoragehArtEdit()
      window.em.leereStoragehArtListe()
      $.mobile.navigate('hZeitEdit.html')
    }

    // wenn in hArtEdit.html .OeffneOrthArtEdit geklickt wird
    window.em.handleHArtEditÖffneOrthArtEditClick = function () {
      'use strict'
      window.em.leereStoragehArtEdit()
      window.em.leereStoragehArtListe()
      window.em.leereStorageZeitEdit()
      window.em.leereStorageZeitListe()
      $.mobile.navigate('hOrtEdit.html')
    }

    // wenn in hArtEdit.html .OeffneRaumhArtEdit geklickt wird
    window.em.handleHArtEditÖffneRaumhArtEditClick = function () {
      'use strict'
      window.em.leereStoragehArtEdit()
      window.em.leereStoragehArtListe()
      window.em.leereStorageZeitEdit()
      window.em.leereStorageZeitListe()
      window.em.leereStorageOrtEdit()
      window.em.leereStorageOrtListe()
      $.mobile.navigate('hRaumEdit.html')
    }

    // wenn in hArtEdit.html .OeffneProjekthArtEdit geklickt wird
    window.em.handleHArtEditÖffneProjekthArtEditClick = function () {
      'use strict'
      window.em.leereStoragehArtEdit()
      window.em.leereStoragehArtListe()
      window.em.leereStorageZeitEdit()
      window.em.leereStorageZeitListe()
      window.em.leereStorageOrtEdit()
      window.em.leereStorageOrtListe()
      window.em.leereStorageRaumEdit()
      window.em.leereStorageRaumListe()
      $.mobile.navigate('hProjektEdit.html')
    }

    // wenn in hArtEdit.html .speichernAnhang geändert wird
    window.em.handleHArtEditSpeichernAnhangChange = function () {
      'use strict'
      var _attachments = $('#_attachmentshAE').val()
      if (_attachments && _attachments.length !== 0) {
        window.em.speichereAnhänge(window.localStorage.hArtId, window.em.hArt, 'hAE')
      }
    }

    // wenn in hArtEdit.html #NeueBeobhArtEdit geklickt wird
    window.em.handleHArtEditNeueBeobhArtEditClick = function () {
      'use strict'
      window.localStorage.Status = 'neu'
      window.em.zuArtgruppenliste()
    }

    // wenn in hArtEdit.html #waehleFelderhArtEdit geklickt wird
    window.em.handleHArtEditWähleFelderClick = function () {
      'use strict'
      window.localStorage.AufrufendeSeiteFW = 'hArtEdit'
      $.mobile.navigate('FelderWaehlen.html')
    }

    // wenn in hArtEdit.html nach links gewischt wird
    window.em.handleHArtEditSwipeleft = function () {
      'use strict'
      if (!$('*:focus').attr('aria-valuenow')) {
        // kein slider
        window.em.nächsteVorigeArt('nächste')
      }
    }

    // wenn in hArtEdit.html nach rechts gewischt wird
    window.em.handleHArtEditSwiperight = function () {
      'use strict'
      if (!$('*:focus').attr('aria-valuenow')) {
        // kein slider
        window.em.nächsteVorigeArt('vorige')
      }
    }

    // wenn in hArtEdit.html [name='LöscheAnhang'] geklickt wird
    window.em.handleHArtEditLöscheAnhangClick = function (that) {
      'use strict'
      window.em.löscheAnhang(that, window.em.hArt, window.localStorage.hArtId)
    }

    // wenn in hArtEdit.html .menu_arteigenschaften geklickt wird
    window.em.handleHArtEditMenuArteigenschaftenClick = function () {
      'use strict'
      window.em.öffneEigenschaftenVonArt(window.em.hArt.aArtId)
    }

    // wenn in hArtEdit.html .menu_einfacher_modus geklickt wird
    window.em.handleHArtEditMenuEinfacherModusClick = function () {
      'use strict'
      window.em.leereStoragehArtEdit()
      window.em.leereStoragehArtListe()
      window.em.leereStorageZeitEdit()
      window.em.leereStorageZeitListe()
      window.em.leereStorageOrtEdit()
      window.em.leereStorageOrtListe()
      window.em.leereStorageRaumEdit()
      window.em.leereStorageRaumListe()
      window.em.leereStorageProjektEdit()
      $.mobile.navigate('BeobListe.html')
    }

    // wenn in hArtEdit.html .menu_felder_verwalten geklickt wird
    window.em.handleHArtEditMenuFelderVerwaltenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hArtEdit.html'
      $.mobile.navigate('FeldListe.html')
    }

    // wenn in hArtEdit.html .menu_beob_exportieren geklickt wird
    window.em.handleHArtEditMenuBeobExportierenClick = function () {
      'use strict'
      window.open('_list/ExportBeob/ExportBeob?startkey=["' + window.localStorage.Email + '"]&endkey=["' + window.localStorage.Email + '",{},{}]&include_docs=true')
      $('#MenuhArtEdit')
        // völlig unlogisch: das bereits offene popup muss zuerst initialisiert werden...
        .popup()
        // ...bevor es geschlossen werden muss, weil es sonst offen bleibt
        .popup('close')
    }

    // wenn in hArtEdit.html .menu_einstellungen geklickt wird
    window.em.handleHArtEditMenuEinstellungenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hArtEdit.html'
      window.em.öffneMeineEinstellungen()
    }

    // wenn hProjektListe erscheint
    window.em.handleHProjektListePageshow = function () {
      'use strict'
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      }
      window.em.initiiereProjektliste()
    }

    // wenn hProjektListe initiiert wird
    window.em.handleHProjektListePageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      }

      $(document)
        // inaktive tabs inaktivieren
        // BEZUG AUF DOCUMENT, WEIL ES MIT BEZUG AUF id des header NICHT FUNKTIONIERTE!!!???
        .on('click', '.tab_inaktiv', function (event) {
          event.preventDefault()
          event.stopPropagation()
        })

      $('#hProjektListePageHeader')
        .on('click', '#OeffneProjektListeProjektListe', function (event) {
          event.preventDefault()
          event.stopPropagation()
        })
        .on('click', '#OeffneBeobListeProjektListe', function (event) {
          event.preventDefault()
          $.mobile.navigate('BeobListe.html')
        })

      $('#hProjektListe')
        // neues Projekt erstellen
        .on('click', '.NeuesProjektProjektListe', function (event) {
          event.preventDefault()
          window.em.erstelleNeuesProjekt()
        })
        .on('swiperight', window.em.handleProjektListeSwiperight)

      $('#ProjektlistehPL')
        .on('swipeleft', '.Projekt', window.em.handleProjektListeSwipeleft)
        .on('click', '.Projekt', function (event) {
          event.preventDefault()
          window.em.handleProjektListeProjektClick(this)
        })
        .on('swipeleft', '.erste', window.em.erstelleNeuesProjekt)

      $('#ProjektListePageFooter')
        .on('click', '#OeffneKarteProjektListe', function (event) {
          event.preventDefault()
          window.em.handleProjektListeÖffneKarteClick()
        })

      $('#MenuProjektListe')
        .on('click', '.menu_einfacher_modus', window.em.handleProjektListeMenuEinfacherModusClick)
        .on('click', '.menu_felder_verwalten', window.em.handleProjektListeMenuFelderVerwaltenClick)
        .on('click', '.menu_projekte_exportieren', window.em.handleHProjektListeMenuProjekteExportierenClick)
        .on('click', '.menu_einstellungen', window.em.handleProjektListeMenuEinstellungenClick)
        .on('click', '.menu_neu_anmelden', window.em.meldeNeuAn)
        .on('click', '.menu_artengruppen_importieren', window.em.öffneArtengruppenImportieren)
        .on('click', '.menu_arten_importieren', window.em.öffneArtenImportieren)
        .on('click', '.menu_admin', window.em.öffneAdmin)
    }

    window.em.handleProjektListeSwipeleft = function () {
      'use strict'
      window.localStorage.ProjektId = $(this).attr('ProjektId')
      $.mobile.navigate('hRaumListe.html')
    }

    window.em.handleProjektListeProjektClick = function (that) {
      'use strict'
      window.localStorage.ProjektId = $(that).attr('ProjektId')
      $.mobile.navigate('hProjektEdit.html')
    }

    window.em.handleProjektListeSwiperight = function () {
      'use strict'
      $.mobile.navigate('BeobListe.html')
    }

    window.em.handleProjektListeÖffneKarteClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hProjektListe'
      $.mobile.navigate('Karte.html')
    }

    window.em.handleProjektListeMenuEinfacherModusClick = function () {
      'use strict'
      $.mobile.navigate('BeobListe.html')
    }

    window.em.handleProjektListeMenuFelderVerwaltenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hProjektListe.html'
      $.mobile.navigate('FeldListe.html')
    }

    // wenn in hProjektListe.html .menu_projekte_exportieren geklickt wird
    window.em.handleHProjektListeMenuProjekteExportierenClick = function () {
      'use strict'
      window.open('_list/ExportProjekt/ExportProjekt?startkey=["' + window.localStorage.Email + '",{},{},{},{},{}]&endkey=["' + window.localStorage.Email + '"]&descending=true&include_docs=true')
      $('#MenuProjektListe')
        // völlig unlogisch: das bereits offene popup muss zuerst initialisiert werden...
        .popup()
        // ...bevor es geschlossen werden muss, weil es sonst offen bleibt
        .popup('close')
    }

    window.em.handleProjektListeMenuEinstellungenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hProjektListe.html'
      window.em.öffneMeineEinstellungen()
    }

    // wenn hRaumEdit erscheint
    window.em.handleRaumEditPageshow = function () {
      'use strict'
      // Sollte keine id vorliegen, zu hProjektListe.html wechseln
      // das kommt im Normalfall nur vor, wenn der Cache des Browsers geleert wurde
      // oder in der Zwischenzeit auf einem anderen Browser dieser Datensatz gelöscht wurde
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if ((!window.localStorage.Status || window.localStorage.Status === 'undefined') && (!window.localStorage.RaumId || window.localStorage.RaumId === 'undefined')) {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
        return
      }
      window.em.initiiereRaumEdit()
    }

    // wenn hRaumEdit initiiert wird
    window.em.handleRaumEditPageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if ((!window.localStorage.Status || window.localStorage.Status === 'undefined') && (!window.localStorage.RaumId || window.localStorage.RaumId === 'undefined')) {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
        return
      }

      $('#RaumEditHeader')
        .on('click', "[name='OeffneRaumListeRaumEdit']", function (event) {
          event.preventDefault()
          window.em.handleRaumEditÖffneRaumListeClick()
        })
        // Link zu Projekt in Navbar und Titelleiste
        .on('click', '#ProjektOeffnenRaumEdit', function (event) {
          event.preventDefault()
          window.em.handleRaumEditProjektÖffnenClick()
        })
        // Link zu Ortliste in Navbar
        .on('click', '#OrtListeOeffnenRaumEdit', function (event) {
          event.preventDefault()
          $.mobile.navigate('hOrtListe.html')
        })

      $('#hRaumEditForm')
        // Für jedes Feld bei Änderung speichern
        .on('change', '.speichern', window.em.speichereRaum)
        // Eingabe im Zahlenfeld abfangen
        .on('blur', '.speichernSlider', window.em.speichereRaum)
        // Klicken auf den Pfeilen im Zahlenfeld abfangen
        .on('mouseup', '.ui-slider-input', window.em.speichereRaum)
        // Ende des Schiebens abfangen
        .on('slidestop', '.speichernSlider', window.em.speichereRaum)

      $('#hRaumEditFooter')
        // Code für den Raum-Löschen-Dialog
        .on('click', '#LoescheRaumRaumEdit', function (event) {
          event.preventDefault()
          window.em.handleRaumEditLöscheRaumClick()
        })

      $('#hre_löschen_meldung')
        .on('click', '#hre_löschen_meldung_ja_loeschen', function () {
          var $hre_löschen_meldung = $('#hre_löschen_meldung')[0]
          window.em.löscheRaum(jQuery.data($hre_löschen_meldung, 'Arten'), jQuery.data($hre_löschen_meldung, 'Zeiten'), jQuery.data($hre_löschen_meldung, 'Orte'))
        })

      $(document)
        // inaktive tabs inaktivieren
        .on('click', '.tab_inaktiv', function (event) {
          event.preventDefault()
          event.stopPropagation()
        })

      $('#hRaumEdit')
        .on('swipeleft', '#hRaumEditContent', window.em.handleRaumEditContentSwipreleft)
        .on('swiperight', '#hRaumEditContent', window.em.handleRaumEditContentSwiperight)
        // Pagination Pfeil voriger initialisieren
        .on('vclick', '.ui-pagination-prev', function (event) {
          event.preventDefault()
          window.em.nächsterVorigerRaum('voriger')
        })
        // Pagination Pfeil nächster initialisieren
        .on('vclick', '.ui-pagination-next', function (event) {
          event.preventDefault()
          window.em.nächsterVorigerRaum('nächster')
        })
        // Pagination Pfeiltasten initialisieren
        .on('keyup', function (event) {
          'use strict'
          // nur reagieren, wenn hProjektEdit sichtbar und Fokus nicht in einem Feld
          if (!$(event.target).is('input, textarea, select, button') && $('#hRaumEdit').is(':visible')) {
            // Left arrow
            if (event.keyCode === $.mobile.keyCode.LEFT) {
              window.em.nächsterVorigerRaum('voriger')
              event.preventDefault()
            }
            // Right arrow
            else if (event.keyCode === $.mobile.keyCode.RIGHT) {
              window.em.nächsterVorigerRaum('nächster')
              event.preventDefault()
            }
          }
        })

      // Änderungen im Formular für Anhänge speichern
      $('#FormAnhängehRE')
        .on('change', '.speichernAnhang', window.em.handleRaumEditSpeichernAnhangChange)
        .on('click', "[name='LöscheAnhang']", function (event) {
          event.preventDefault()
          window.em.löscheAnhang(this, window.em.hRaum, window.localStorage.RaumId)
        })

      $('#hRaumEditFooter')
        // neuen Raum erstellen
        .on('click', '#NeuerRaumRaumEdit', function (event) {
          event.preventDefault()
          window.em.erstelleNeuenRaum()
        })
        // sichtbare Felder wählen
        .on('click', '#waehleFelderRaumEdit', function (event) {
          event.preventDefault()
          window.em.handleRaumEditWähleFelderClick()
        })
        .on('click', '#KarteOeffnenRaumEdit', function (event) {
          event.preventDefault()
          window.em.handleRaumEditÖffneKarteClick()
        })

      $('#MenuRaumEdit')
        .on('click', '.menu_einfacher_modus', window.em.handleRaumEditMenuEinfacherModusClick)
        .on('click', '.menu_felder_verwalten', window.em.handleRaumEditMenuFelderVerwaltenClick)
        .on('click', '.menu_raeume_exportieren', window.em.handleRaumEditMenuExportierenClick)
        .on('click', '.menu_einstellungen', window.em.handleRaumEditMenuEinstellungenClick)
        .on('click', '.menu_neu_anmelden', window.em.meldeNeuAn)
        .on('click', '.menu_artengruppen_importieren', window.em.öffneArtengruppenImportieren)
        .on('click', '.menu_arten_importieren', window.em.öffneArtenImportieren)
        .on('click', '.menu_admin', window.em.öffneAdmin)
    }

    window.em.handleRaumEditÖffneRaumListeClick = function () {
      'use strict'
      window.em.leereStorageRaumEdit()
      $.mobile.navigate('hRaumListe.html')
    }

    window.em.handleRaumEditSpeichernAnhangChange = function () {
      'use strict'
      var _attachments = $('#_attachmentshRE').val()
      if (_attachments && _attachments.length > 0) {
        window.em.speichereAnhänge(window.localStorage.RaumId, window.em.hRaum, 'hRE')
      }
    }

    window.em.handleRaumEditLöscheRaumClick = function () {
      'use strict'
      // Anzahl Orte des Raums zählen
      var $db = $.couch.db('evab')
      $db.view('evab/hOrtIdVonRaum?startkey=["' + window.localStorage.RaumId + '"]&endkey=["' + window.localStorage.RaumId + '",{},{}]', {
        success: function (Orte) {
          var anzOrte = Orte.rows.length
          // Anzahl Zeiten des Raums zählen
          $db.view('evab/hZeitIdVonRaum?startkey=["' + window.localStorage.RaumId + '"]&endkey=["' + window.localStorage.RaumId + '",{},{}]', {
            success: function (Zeiten) {
              var anzZeiten = Zeiten.rows.length
              // Anzahl Arten des Raums zählen
              $db.view('evab/hArtIdVonRaum?startkey=["' + window.localStorage.RaumId + '"]&endkey=["' + window.localStorage.RaumId + '",{},{}]', {
                success: function (Arten) {
                  var anzArten = Arten.rows.length,
                    $hre_löschen_meldung = $('#hre_löschen_meldung'),
                    orte_text = (anzOrte === 1 ? ' Ort, ' : ' Orte, '),
                    zeiten_text = (anzZeiten === 1 ? ' Zeit und ' : ' Zeiten und '),
                    arten_text = (anzArten === 1 ? ' Art' : ' Arten'),
                    meldung = 'Raum inklusive ' + anzOrte + orte_text + anzZeiten + zeiten_text + anzArten + arten_text + ' löschen?'
                  $('#hre_löschen_meldung_meldung').html(meldung)
                  // Listen anhängen, damit ohne DB-Abfrage gelöscht werden kann
                  $hre_löschen_meldung.data('Arten', Arten)
                  $hre_löschen_meldung.data('Zeiten', Zeiten)
                  $hre_löschen_meldung.data('Orte', Orte)
                  // popup öffnen
                  $hre_löschen_meldung.popup('open')
                }
              })
            }
          })
        }
      })
    }

    window.em.handleRaumEditProjektÖffnenClick = function () {
      'use strict'
      window.em.leereStorageRaumListe('mitLatLngListe')
      $.mobile.navigate('hProjektEdit.html')
    }

    window.em.handleRaumEditWähleFelderClick = function () {
      'use strict'
      window.localStorage.AufrufendeSeiteFW = 'hRaumEdit'
      $.mobile.navigate('FelderWaehlen.html')
    }

    window.em.handleRaumEditContentSwipreleft = function () {
      'use strict'
      if (!$('*:focus').attr('aria-valuenow')) {
        // kein slider
        window.em.nächsterVorigerRaum('nächster')
      }
    }

    window.em.handleRaumEditContentSwiperight = function () {
      'use strict'
      if (!$('*:focus').attr('aria-valuenow')) {
        // kein slider
        window.em.nächsterVorigerRaum('voriger')
      }
    }

    window.em.handleRaumEditÖffneKarteClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hRaumEdit'
      $.mobile.navigate('Karte.html')
    }

    window.em.handleRaumEditMenuEinfacherModusClick = function () {
      'use strict'
      window.em.leereStorageRaumEdit()
      window.em.leereStorageRaumListe()
      window.em.leereStorageProjektEdit()
      $.mobile.navigate('BeobListe.html')
    }

    window.em.handleRaumEditMenuFelderVerwaltenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hRaumEdit.html'
      $.mobile.navigate('FeldListe.html')
    }

    window.em.handleRaumEditMenuExportierenClick = function () {
      'use strict'
      window.open('_list/ExportRaum/ExportRaum?startkey=["' + window.localStorage.Email + '"]&endkey=["' + window.localStorage.Email + '",{},{}]&include_docs=true')
      $('#MenuRaumEdit')
        // völlig unlogisch: das bereits offene popup muss zuerst initialisiert werden...
        .popup()
        // ...bevor es geschlossen werden muss, weil es sonst offen bleibt
        .popup('close')
    }

    window.em.handleRaumEditMenuEinstellungenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hRaumEdit.html'
      window.em.öffneMeineEinstellungen()
    }

    window.em.löscheRaum = function (Arten, Zeiten, Orte) {
      'use strict'
      // nur löschen, wo Datensätze vorkommen
      if (Orte.rows.length > 0) {
        window.em.loescheIdIdRevListe(Orte)
      }
      if (Zeiten.rows.length > 0) {
        window.em.loescheIdIdRevListe(Zeiten)
      }
      if (Arten.rows.length > 0) {
        window.em.loescheIdIdRevListe(Arten)
      }
      if (window.em.hRaum) {
        // Objekt benutzen
        window.em.löscheRaum_2()
      } else {
        // Objekt aus DB holen
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.RaumId, {
          success: function (data) {
            window.em.hRaum = data
            window.em.löscheRaum_2()
          },
          error: function () {
            window.em.melde('Fehler: Raum nicht gelöscht')
          }
        })
      }
    }

    window.em.löscheRaum_2 = function () {
      'use strict'
      var $db = $.couch.db('evab')
      $db.removeDoc(window.em.hRaum, {
        success: function (data) {
          // Liste anpassen. Vorsicht: Bei refresh kann sie fehlen
          if (window.em.RaumListe) {
            window.em.RaumListe.rows = _.reject(window.em.RaumListe.rows, function (row) {
              return row.doc._id === data.id
            })
          } else {
            // Keine Raumliste mehr. Storage löschen
            window.em.leereStorageRaumListe('mitLatLngListe')
          }
          // RaumListe zurücksetzen, damit sie beim nächsten Aufruf neu aufgebaut wird
          window.em.leereStorageRaumEdit('mitLatLngListe')
          $.mobile.navigate('hRaumListe.html')
        },
        error: function () {
          window.em.melde('Fehler: Raum nicht gelöscht')
        }
      })
    }

    window.em.validierehRaumEdit = function () {
      'use strict'
      if (!$('#rName').val()) {
        window.em.melde('Bitte Raumnamen eingeben')
        setTimeout(function () {
          $('#rName').focus()
        }, 50)  // need to use a timer so that .blur() can finish before you do .focus()
        return false
      }
      return true
    }

    window.em.speichereRaum = function () {
      'use strict'
      var that = this
      // prüfen, ob Objekt Raum existiert
      // fehlt z.B. nach refresh
      if (window.em.hRaum) {
        window.em.speichereRaum_2(that)
      } else {
        // kein Raum > aus DB holen
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.RaumId, {
          success: function (data) {
            window.em.hRaum = data
            window.em.speichereRaum_2(that)
          },
          error: function () {
            window.em.melde('Fehler: Änderung in ' + that.name + ' nicht gespeichert')
          }
        })
      }

    }

    window.em.speichereRaum_2 = function (that) {
      'use strict'
      var FeldnameDb,
        Feldwert,
        feldinfos
      // Feldname und -wert ermitteln
      feldinfos = window.em.holeFeldInfosVonElement(that)
      FeldnameDb = feldinfos.feldname_db
      Feldwert = feldinfos.feldwert
      if (window.em.validierehRaumEdit()) {
        if (FeldnameDb === 'rName') {
          // RaumListe zurücksetzen, damit sie beim nächsten Aufruf neu aufgebaut wird
          window.em.leereStorageRaumListe('mitLatLngListe')
        }
        if (Feldwert) {
          if (window.em.myTypeOf(Feldwert) === 'float') {
            window.em.hRaum[FeldnameDb] = parseFloat(Feldwert)
          } else if (window.em.myTypeOf(Feldwert) === 'integer') {
            window.em.hRaum[FeldnameDb] = parseInt(Feldwert)
          } else {
            window.em.hRaum[FeldnameDb] = Feldwert
          }
        } else if (window.em.hRaum[FeldnameDb]) {
          delete window.em.hRaum[FeldnameDb]
        }
        // alles speichern
        var $db = $.couch.db('evab')
        $db.saveDoc(window.em.hRaum, {
          success: function (data) {
            window.em.hRaum._rev = data.rev
            // window.ZuletztGespeicherteRaumId wird benutzt, damit auch nach einem
            // Datensatzwechsel die Listen nicht (immer) aus der DB geholt werden müssen
            // Zuletzt gespeicherte RaumId NACH dem speichern setzen
            // sicherstellen, dass bis dahin nicht schon eine nächste vewendet wird
            // darum zwischenspeichern
            window.em.RaumIdZwischenspeicher = window.localStorage.RaumId
            // setTimeout("window.ZuletztGespeicherteRaumId = window.em.RaumIdZwischenspeicher", 1000)	AUSGESCHALTET, DA ZuletztGespeicherteRaumId NIRGENDS GEBRAUCHT
            setTimeout('delete window.em.RaumIdZwischenspeicher', 1500)
            // nicht aktualisierte hierarchisch tiefere Listen löschen
            delete window.em.OrteVonProjekt
            delete window.em.ZeitenVonProjekt
            delete window.em.ZeitenVonOrt
            delete window.em.ArtenVonProjekt
            delete window.em.ArtenVonOrt
            delete window.em.ArtenVonZeit
          },
          error: function () {
            console.log('Fehler in function speichereRaum_2(that)')
          }
        })
      }
    }

    // Öffnet den vorigen oder nächsten Raum
    // voriger des ersten => RaumListe
    // nächster des letzten => melden
    // erwartet die ID des aktuellen Datensatzes und ob nächster oder voriger gesucht wird
    window.em.nächsterVorigerRaum = function (NächsterOderVoriger) {
      'use strict'
      // prüfen, ob RaumListe schon existiert
      // nur abfragen, wenn sie noch nicht existiert
      if (window.em.RaumListe) {
        // globale Variable RaumListe existiert noch
        window.em.nächsterVorigerRaum_2(NächsterOderVoriger)
      } else {
        // keine Raumliste übergeben
        // neu aus DB erstellen
        var $db = $.couch.db('evab')
        $db.view('evab/hRaumListe?startkey=["' + window.localStorage.Email + '", "' + window.localStorage.ProjektId + '"]&endkey=["' + window.localStorage.Email + '", "' + window.localStorage.ProjektId + '" ,{}]&include_docs=true', {
          success: function (data) {
            // RaumListe bereitstellen
            window.em.RaumListe = data
            window.em.nächsterVorigerRaum_2(NächsterOderVoriger)
          }
        })
      }
    }

    window.em.nächsterVorigerRaum_2 = function (NächsterOderVoriger) {
      'use strict'
      var i,
        RaumIdAktuell,
        AnzRaum
      for (i = 0; window.em.RaumListe.rows.length; i++) {
        RaumIdAktuell = window.em.RaumListe.rows[i].doc._id
        AnzRaum = window.em.RaumListe.rows.length - 1  // vorsicht: Objekte zählen Elemente ab 1, Arrays ab 0!
        if (RaumIdAktuell === window.localStorage.RaumId) {
          switch (NächsterOderVoriger) {
            case 'nächster':
              if (i < AnzRaum) {
                window.localStorage.RaumId = window.em.RaumListe.rows[i + 1].doc._id
                window.em.leereStorageRaumEdit('mitLatLngListe', 'ohneId')
                window.em.initiiereRaumEdit()
                return
              } else {
                window.em.melde('Das ist der letzte Raum')
                return
              }
              break
            case 'voriger':
              if (i > 0) {
                window.localStorage.RaumId = window.em.RaumListe.rows[i - 1].doc._id
                window.em.leereStorageRaumEdit('mitLatLngListe', 'ohneId')
                window.em.initiiereRaumEdit()
                return
              } else {
                window.em.leereStorageRaumEdit()
                $.mobile.navigate('hRaumListe.html')
                return
              }
              break
          }
        }
      }
    }

    // wenn hRaumListe erscheint
    window.em.handleHRaumListePageshow = function () {
      'use strict'
      // Sollte keine id vorliegen, zu hProjektListe.html wechseln
      // das kommt im Normalfall nur vor, wenn der Cache des Browsers geleert wurde
      // oder in der Zwischenzeit auf einem anderen Browser dieser Datensatz gelöscht wurde
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if (!window.localStorage.ProjektId || window.localStorage.ProjektId === 'undefined') {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
        return
      }
      window.em.initiiereRaumListe()
    }

    // wenn hRaumListe initiiert wird
    window.em.handleHRaumListePageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if (!window.localStorage.ProjektId || window.localStorage.ProjektId === 'undefined') {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
        return
      }

      $(document)
        // inaktive tabs inaktivieren
        // BEZUG AUF DOCUMENT, WEIL ES MIT BEZUG AUF id des header NICHT FUNKTIONIERTE!!!???
        .on('click', '.tab_inaktiv', function (event) {
          event.preventDefault()
          event.stopPropagation()
        })

      $('#hRaumListePageHeader')
        // Link zu Projekt in Navbar und Titelleiste
        .on('click', "[name='ProjektEditOeffnenRaumListe']", function (event) {
          event.preventDefault()
          window.em.handleRaumListeÖffneProjektEditClick()
        })

      $('#hRaumListe')
        // neuen Raum erstellen
        .on('click', "[name='NeuerRaumRaumListe']", function (event) {
          event.preventDefault()
          window.em.erstelleNeuenRaum()
        })
        .on('swiperight', '#hRaumListePageContent', window.em.handleRaumListeContentSwiperight)

      $('#RaumlistehRL')
        .on('swipeleft', '.Raum', window.em.handleRaumListeSwipeleft)
        .on('click', '.Raum', function (event) {
          event.preventDefault()
          window.em.handleRaumListeRaumClick(this)
        })
        .on('swipeleft', '.erste', window.em.erstelleNeuenRaum)

      $('#hRaumListePageFooter')
        .on('click', '#KarteOeffnenRaumListe', function (event) {
          event.preventDefault()
          window.em.handleRaumListeÖffneKarteClick()
        })

      $('#MenuRaumListe')
        .on('click', '.menu_einfacher_modus', window.em.handleHRaumListeMenuEinfacherModusClick)
        .on('click', '.menu_felder_verwalten', window.em.handleRaumListeMenuFelderVerwaltenClick)
        .on('click', '.menu_raeume_exportieren', window.em.handleHRaumListeMenuExportierenClick)
        .on('click', '.menu_einstellungen', window.em.handleRaumListeMenuEinstellungenClick)
        .on('click', '.menu_neu_anmelden', window.em.meldeNeuAn)
        .on('click', '.menu_artengruppen_importieren', window.em.öffneArtengruppenImportieren)
        .on('click', '.menu_arten_importieren', window.em.öffneArtenImportieren)
        .on('click', '.menu_admin', window.em.öffneAdmin)
    }

    window.em.handleRaumListeÖffneProjektEditClick = function () {
      'use strict'
      window.em.leereStorageRaumListe()
      $.mobile.navigate('hProjektEdit.html')
    }

    window.em.handleRaumListeSwipeleft = function () {
      'use strict'
      window.localStorage.RaumId = $(this).attr('RaumId')
      $.mobile.navigate('hOrtListe.html')
    }

    window.em.handleRaumListeRaumClick = function (that) {
      'use strict'
      window.localStorage.RaumId = $(that).attr('RaumId')
      $.mobile.navigate('hRaumEdit.html')
    }

    window.em.handleRaumListeContentSwiperight = function () {
      window.em.leereStorageRaumListe()
      $.mobile.navigate('hProjektListe.html')
    }

    window.em.handleRaumListeÖffneKarteClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hRaumListe'
      $.mobile.navigate('Karte.html')
    }

    window.em.handleHRaumListeMenuEinfacherModusClick = function () {
      'use strict'
      window.em.leereStorageRaumListe()
      window.em.leereStorageProjektEdit()
      $.mobile.navigate('BeobListe.html')
    }

    window.em.handleRaumListeMenuFelderVerwaltenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hRaumListe.html'
      $.mobile.navigate('FeldListe.html')
    }

    window.em.handleRaumListeMenuEinstellungenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hRaumListe.html'
      window.em.öffneMeineEinstellungen()
    }

    window.em.handleHRaumListeMenuExportierenClick = function () {
      'use strict'
      window.open('_list/ExportRaum/ExportRaum?startkey=["' + window.localStorage.Email + '"]&endkey=["' + window.localStorage.Email + '",{},{}]&include_docs=true')
      $('#MenuRaumListe')
        // völlig unlogisch: das bereits offene popup muss zuerst initialisiert werden...
        .popup()
        // ...bevor es geschlossen werden muss, weil es sonst offen bleibt
        .popup('close')
    }

    // wenn hZeitEdit.html erscheint
    window.em.handleHZeitEditPageshow = function () {
      'use strict'
      // Sollte keine id vorliegen, zu hProjektListe.html wechseln
      // das kommt im Normalfall nur vor, wenn der Cache des Browsers geleert wurde
      // oder in der Zwischenzeit auf einem anderen Browser dieser Datensatz gelöscht wurde
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
      } else if ((!window.localStorage.Status || window.localStorage.Status === 'undefined') && (!window.localStorage.ZeitId || window.localStorage.ZeitId === 'undefined')) {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
      }
      window.em.initiiereZeitEdit()
    }

    // wenn hZeitEdit.html initiiert wird
    window.em.handleHZeitEditPageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
      } else if ((!window.localStorage.Status || window.localStorage.Status === 'undefined') && (!window.localStorage.ZeitId || window.localStorage.ZeitId === 'undefined')) {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
      }

      $(document)
        // inaktive tabs inaktivieren
        // BEZUG AUF DOCUMENT, WEIL ES MIT BEZUG AUF hZeitListePageHeader NICHT FUNKTIONIERTE!!!???
        .on('click', '.tab_inaktiv', function (event) {
          event.preventDefault()
          event.stopPropagation()
        })

      $('#ZeitEditPageHeader')
        .on('click', "[name='OeffneZeitListeZeitEdit']", function (event) {
          event.preventDefault()
          window.em.leereStorageZeitEdit()
          $.mobile.navigate('hZeitListe.html')
        })
        .on('click', '#OeffneOrtZeitEdit', function (event) {
          event.preventDefault()
          window.em.handleZeitEditÖffneOrtClick()
        })
        .on('click', '#OeffneArtListeZeitEdit', function (event) {
          event.preventDefault()
          $.mobile.navigate('hArtListe.html')
        })
        .on('click', '#OeffneRaumZeitEdit', function (event) {
          event.preventDefault()
          window.em.handleZeitEditÖffneRaumClick()
        })
        .on('click', '#OeffneProjektZeitEdit', function (event) {
          event.preventDefault()
          window.em.handleZeitEditÖffneProjektClick()
        })

      $('#hZeitEditForm')
        // Für jedes Feld bei Änderung speichern
        .on('change', '.speichern', window.em.speichereHZeitEdit)
        // Eingabe im Zahlenfeld abfangen
        .on('blur', '.speichernSlider', window.em.speichereHZeitEdit)
        // Klicken auf den Pfeilen im Zahlenfeld abfangen
        .on('mouseup', '.ui-slider-input', window.em.speichereHZeitEdit)
        // Ende des Schiebens abfangen
        .on('slidestop', '.speichernSlider', window.em.speichereHZeitEdit)

      $('#FormAnhängehZE')
        // Änderungen im Formular für Anhänge speichern
        .on('change', '.speichernAnhang', window.em.handleZeitEditSpeichernAnhangChange)
        .on('click', "[name='LöscheAnhang']", function (event) {
          event.preventDefault()
          window.em.löscheAnhang(this, window.em.hZeit, window.localStorage.ZeitId)
        })

      $('#hZeitEdit')
        .on('swipeleft', '#ZeitEditPageContent', window.em.handleZeitEditContentSwipeleft)
        .on('swiperight', '#ZeitEditPageContent', window.em.handleZeitEditContentSwiperight)
        // Pagination Pfeil voriger initialisieren
        .on('vclick', '.ui-pagination-prev', function (event) {
          event.preventDefault()
          window.em.nächsteVorigeZeit('vorige')
        })
        // Pagination Pfeil nächster initialisieren
        .on('vclick', '.ui-pagination-next', function (event) {
          event.preventDefault()
          window.em.nächsteVorigeZeit('nächste')
        })
        // Pagination Pfeiltasten initialisieren
        .on('keyup', function (event) {
          // nur reagieren, wenn hProjektEdit sichtbar und Fokus nicht in einem Feld
          if (!$(event.target).is('input, textarea, select, button') && $('#hZeitEdit').is(':visible')) {
            // Left arrow
            if (event.keyCode === $.mobile.keyCode.LEFT) {
              window.em.nächsteVorigeZeit('vorige')
              event.preventDefault()
            }
            // Right arrow
            else if (event.keyCode === $.mobile.keyCode.RIGHT) {
              window.em.nächsteVorigeZeit('nächste')
              event.preventDefault()
            }
          }
        })

      $('#ZeitEditPageFooter')
        // Neue Zeit erstellen
        .on('click', '#NeueZeitZeitEdit', function (event) {
          event.preventDefault()
          window.em.handleZeitEditNeuClick()
        })
        // sichtbare Felder wählen
        .on('click', '#waehleFelderZeitEdit', function (event) {
          event.preventDefault()
          window.em.handleZeitEditWähleFelderClick()
        })
        // Code für den Zeit-Löschen-Dialog
        .on('click', '#LoescheZeitZeitEdit', function (event) {
          event.preventDefault()
          window.em.handleZeitEditLöscheClick()
        })

      $('#hze_löschen_meldung')
        .on('click', '#hze_löschen_meldung_ja_loeschen', window.em.handleZeitEditLöschenMeldungJaClick)

      $('#MenuZeitEdit')
        .on('click', '.menu_einfacher_modus', window.em.handleZeitEditMenuEinfacherModusClick)
        .on('click', '.menu_felder_verwalten', window.em.handleZeitEditMenuFelderVerwaltenClick)
        .on('click', '.menu_zeiten_exportieren', window.em.handleZeitEditMenuExportierenClick)
        .on('click', '.menu_einstellungen', window.em.handleZeitEditMenuEinstellungenClick)
        .on('click', '.menu_neu_anmelden', window.em.meldeNeuAn)
        .on('click', '.menu_artengruppen_importieren', window.em.öffneArtengruppenImportieren)
        .on('click', '.menu_admin', window.em.öffneAdmin)
    }

    window.em.handleZeitEditÖffneOrtClick = function () {
      'use strict'
      window.em.leereStorageZeitEdit()
      window.em.leereStorageZeitListe()
      $.mobile.navigate('hOrtEdit.html')
    }

    window.em.handleZeitEditÖffneRaumClick = function () {
      'use strict'
      window.em.leereStorageZeitEdit()
      window.em.leereStorageZeitListe()
      window.em.leereStorageOrtEdit()
      window.em.leereStorageOrtListe()
      $.mobile.navigate('hRaumEdit.html')
    }

    window.em.handleZeitEditÖffneProjektClick = function () {
      'use strict'
      window.em.leereStorageZeitEdit()
      window.em.leereStorageZeitListe()
      window.em.leereStorageOrtEdit()
      window.em.leereStorageOrtListe()
      window.em.leereStorageRaumEdit()
      window.em.leereStorageRaumListe()
      $.mobile.navigate('hProjektEdit.html')
    }

    window.em.handleZeitEditSpeichernAnhangChange = function () {
      'use strict'
      var _attachments = $('#_attachmentshZE').val()
      if (_attachments && _attachments.length > 0) {
        window.em.speichereAnhänge(window.localStorage.ZeitId, window.em.hZeit, 'hZE')
      }
    }

    window.em.handleZeitEditNeuClick = function () {
      'use strict'
      // Globale Variablen für ZeitListe zurücksetzen, damit die Liste neu aufgebaut wird
      window.em.leereStorageZeitListe()
      window.em.erstelleNeueZeit()
    }

    window.em.handleZeitEditWähleFelderClick = function () {
      'use strict'
      window.localStorage.AufrufendeSeiteFW = 'hZeitEdit'
      $.mobile.navigate('FelderWaehlen.html')
    }

    window.em.handleZeitEditLöscheClick = function () {
      'use strict'
      // Anzahl Zeiten von Ort zählen
      var $db = $.couch.db('evab')
      $db.view('evab/hArtIdVonZeit?startkey=["' + window.localStorage.ZeitId + '"]&endkey=["' + window.localStorage.ZeitId + '",{},{}]', {
        success: function (Arten) {
          var anzArten = Arten.rows.length,
            $hze_löschen_meldung = $('#hze_löschen_meldung'),
            arten_text = (anzArten === 1 ? ' Art' : ' Arten'),
            meldung = 'Zeit inklusive ' + anzArten + arten_text + ' löschen?'
          $('#hze_löschen_meldung_meldung').html(meldung)
          // Listen anhängen, damit ohne DB-Abfrage gelöscht werden kann
          $hze_löschen_meldung.data('Arten', Arten)
          // popup öffnen
          $hze_löschen_meldung.popup('open')
        }
      })
    }

    window.em.handleZeitEditLöschenMeldungJaClick = function () {
      'use strict'
      var $hze_löschen_meldung = $('#hze_löschen_meldung')[0]
      window.em.löscheZeit(jQuery.data($hze_löschen_meldung, 'Arten'))
    }

    window.em.handleZeitEditContentSwipeleft = function () {
      'use strict'
      if (!$('*:focus').attr('aria-valuenow')) {
        // kein slider
        window.em.nächsteVorigeZeit('nächste')
      }
    }

    window.em.handleZeitEditContentSwiperight = function () {
      'use strict'
      if (!$('*:focus').attr('aria-valuenow')) {
        // kein slider
        window.em.nächsteVorigeZeit('vorige')
      }
    }

    window.em.handleZeitEditMenuEinfacherModusClick = function () {
      'use strict'
      window.em.leereStorageZeitEdit()
      window.em.leereStorageZeitListe()
      window.em.leereStorageOrtEdit()
      window.em.leereStorageOrtListe()
      window.em.leereStorageRaumEdit()
      window.em.leereStorageRaumListe()
      window.em.leereStorageProjektEdit()
      $.mobile.navigate('BeobListe.html')
    }

    window.em.handleZeitEditMenuFelderVerwaltenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hZeitEdit.html'
      $.mobile.navigate('FeldListe.html')
    }

    window.em.handleZeitEditMenuExportierenClick = function () {
      'use strict'
      window.open('_list/ExportZeit/ExportZeit?startkey=["' + window.localStorage.Email + '"]&endkey=["' + window.localStorage.Email + '",{},{}]&include_docs=true')
      $('#MenuZeitEdit')
        // völlig unlogisch: das bereits offene popup muss zuerst initialisiert werden...
        .popup()
        // ...bevor es geschlossen werden muss, weil es sonst offen bleibt
        .popup('close')
    }

    window.em.handleZeitEditMenuEinstellungenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hZeitEdit.html'
      window.em.öffneMeineEinstellungen()
    }

    window.em.löscheZeit = function (Arten) {
      'use strict'
      // nur löschen, wo Datensätze vorkommen
      if (Arten.rows.length > 0) {
        window.em.loescheIdIdRevListe(Arten)
      }
      // dann die Zeit
      if (window.em.hZeit) {
        // Objekt nutzen
        window.em.löscheZeit_2()
      } else {
        // Objekt aus DB holen
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.ZeitId, {
          success: function (data) {
            window.em.hZeit = data
            window.em.löscheZeit_2()
          },
          error: function () {
            window.em.melde('Fehler: Zeit nicht gelöscht')
          }
        })
      }
    }

    window.em.löscheZeit_2 = function () {
      'use strict'
      var $db = $.couch.db('evab')
      $db.removeDoc(window.em.hZeit, {
        success: function (data) {
          // Liste anpassen. Vorsicht: Bei refresh kann sie fehlen
          if (window.em.ZeitListe) {
            window.em.ZeitListe.rows = _.reject(window.em.ZeitListe.rows, function (row) {
              return row.doc._id === data.id
            })
          } else {
            // Keine ZeitListe mehr. Storage löschen
            window.em.leereStorageZeitListe()
          }
          window.em.leereStorageZeitEdit()
          $.mobile.navigate('hZeitListe.html')
        },
        error: function () {
          window.em.melde('Fehler: Zeit nicht gelöscht')
        }
      })
    }

    window.em.validierehZeitEdit = function () {
      'use strict'
      if (!$("[name='zDatum']").val()) {
        window.em.melde('Bitte Datum erfassen')
        setTimeout(function () {
          $("[name='zDatum']").focus()
        }, 50)  // need to use a timer so that .blur() can finish before you do .focus()
        return false
      }
      if (!$("[name='zUhrzeit']").val()) {
        window.em.melde('Bitte Zeit erfassen')
        setTimeout(function () {
          $("[name='zUhrzeit']").focus()
        }, 50)  // need to use a timer so that .blur() can finish before you do .focus()
        return false
      }
      return true
    }

    // speichert nach jedem change event in einem Feld mit Class speichern
    // den Wert in die DB
    // erwartet das Feld als Objekt
    window.em.speichereHZeitEdit = function () {
      'use strict'
      var that = this
      // prüfen, ob die Zeit als Objekt vorliegt
      if (window.em.hZeit) {
        // dieses verwenden
        window.em.speichereHZeitEdit_2(that)
      } else {
        // Objekt aus DB holen
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.ZeitId, {
          success: function (data) {
            window.em.hZeit = data
            window.em.speichereHZeitEdit_2(that)
          },
          error: function () {
            console.log('Fehler in function speichereHZeitEdit(that)')
          // window.em.melde("Fehler: Änderung in " + Feldname + " nicht gespeichert")
          }
        })
      }

    }

    window.em.speichereHZeitEdit_2 = function (that) {
      'use strict'
      var FeldnameDb,
        Feldwert,
        feldinfos
      // Feldname und -wert ermitteln
      feldinfos = window.em.holeFeldInfosVonElement(that)
      FeldnameDb = feldinfos.feldname_db
      Feldwert = feldinfos.feldwert
      if (window.em.validierehZeitEdit()) {
        if (FeldnameDb === 'zDatum' || FeldnameDb === 'zUhrzeit') {
          // Variablen für ZeitListe zurücksetzen, damit die Liste beim nächsten Aufruf neu aufgebaut wird
          window.em.leereStorageZeitListe()
        }
        // Werte aus dem Formular aktualisieren
        if (Feldwert) {
          if (window.em.myTypeOf(Feldwert) === 'float') {
            window.em.hZeit[FeldnameDb] = parseFloat(Feldwert)
          } else if (window.em.myTypeOf(Feldwert) === 'integer') {
            window.em.hZeit[FeldnameDb] = parseInt(Feldwert)
          } else {
            window.em.hZeit[FeldnameDb] = Feldwert
          }
        } else if (window.em.hZeit[FeldnameDb]) {
          delete window.em.hZeit[FeldnameDb]
        }
        // alles speichern
        var $db = $.couch.db('evab')
        $db.saveDoc(window.em.hZeit, {
          success: function (data) {
            window.em.hZeit._rev = data.rev
            // window.ZuletztGespeicherteZeitId wird benutzt, damit auch nach einem
            // Datensatzwechsel die Listen nicht (immer) aus der DB geholt werden müssen
            // Zuletzt gespeicherte ZeitId NACH dem speichern setzen
            // sicherstellen, dass bis dahin nicht schon eine nächste vewendet wird
            // darum zwischenspeichern
            window.em.ZeitIdZwischenspeicher = window.localStorage.ZeitId
            // setTimeout("window.ZuletztGespeicherteZeitId = window.em.ZeitIdZwischenspeicher", 1000)	AUSGESCHALTET, DA ZuletztGespeicherteZeitId NIRGENDS BENUTZT
            setTimeout('delete window.em.ZeitIdZwischenspeicher', 1500)
            // nicht aktualisierte hierarchisch tiefere Listen löschen
            delete window.em.ArtenVonProjekt
            delete window.em.ArtenVonRaum
            delete window.em.ArtenVonOrt
          },
          error: function () {
            console.log('Fehler in function speichereHZeitEdit_2(that)')
          // window.em.melde("Fehler: Änderung in " + FeldnameDb + " nicht gespeichert")
          }
        })
      }
    }

    // Öffnet die vorige oder nächste Zeit
    // vorige der ersten => ZeitListe
    // nächste der letzten => melden
    // erwartet die ID des aktuellen Datensatzes und ob nächster oder voriger gesucht wird
    window.em.nächsteVorigeZeit = function (NächsteOderVorige) {
      'use strict'
      // prüfen, ob ZeitListe schon existiert
      // nur abfragen, wenn sie noch nicht existiert
      if (window.em.ZeitListe) {
        window.em.nächsteVorigeZeit_2(NächsteOderVorige)
      } else {
        var $db = $.couch.db('evab')
        $db.view('evab/hZeitListe?startkey=["' + window.localStorage.Email + '", "' + window.localStorage.OrtId + '"]&endkey=["' + window.localStorage.Email + '", "' + window.localStorage.OrtId + '" ,{}]&include_docs=true', {
          success: function (data) {
            window.em.ZeitListe = data
            window.em.nächsteVorigeZeit_2(NächsteOderVorige)
          }
        })
      }
    }

    window.em.nächsteVorigeZeit_2 = function (NächsteOderVorige) {
      'use strict'
      var i,
        ZeitIdAktuell,
        AnzZeit
      for (i = 0; window.em.ZeitListe.rows.length; i++) {
        ZeitIdAktuell = window.em.ZeitListe.rows[i].doc._id
        AnzZeit = window.em.ZeitListe.rows.length - 1  // vorsicht: Objekte zählen Elemente ab 1, Arrays ab 0!
        if (ZeitIdAktuell === window.localStorage.ZeitId) {
          switch (NächsteOderVorige) {
            case 'nächste':
              if (i < AnzZeit) {
                window.localStorage.ZeitId = window.em.ZeitListe.rows[i + 1].doc._id
                window.em.leereStorageZeitEdit('ohneId')
                window.em.initiiereZeitEdit()
                return
              } else {
                window.em.melde('Das ist die letzte Zeit')
                return
              }
              break
            case 'vorige':
              if (i > 0) {
                window.localStorage.ZeitId = window.em.ZeitListe.rows[i - 1].doc._id
                window.em.leereStorageZeitEdit('ohneId')
                window.em.initiiereZeitEdit()
                return
              } else {
                window.em.leereStorageZeitEdit()
                $.mobile.navigate('hZeitListe.html')
                return
              }
              break
          }
        }
      }
    }

    window.em.handleZeitListePageshow = function () {
      'use strict'
      // Sollte keine id vorliegen, zu hProjektListe.html wechseln
      // das kommt im Normalfall nur vor, wenn der Cache des Browsers geleert wurde
      // oder in der Zwischenzeit auf einem anderen Browser dieser Datensatz gelöscht wurde
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if (!window.localStorage.OrtId || window.localStorage.OrtId === 'undefined') {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
        return
      }
      window.em.initiiereZeitListe()
    }

    window.em.handleZeitListePageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
        return
      } else if (!window.localStorage.OrtId || window.localStorage.OrtId === 'undefined') {
        window.em.leereAlleVariabeln('ohneClear')
        $.mobile.navigate('hProjektListe.html')
        return
      }

      $(document)
        // inaktive tabs inaktivieren
        // BEZUG AUF DOCUMENT, WEIL ES MIT BEZUG AUF hZeitListePageHeader NICHT FUNKTIONIERTE!!!???
        .on('click', '.tab_inaktiv', function (event) {
          event.preventDefault()
          event.stopPropagation()
        })

      $('#hZeitListePageHeader')
        // Link zu Raum in Navbar und Titelleiste
        .on('click', "[name='OeffneOrtZeitListe']", function (event) {
          event.preventDefault()
          window.em.handleZeitListeÖffneOrtClick()
        })
        .on('click', '#OeffneRaumZeitListe', function (event) {
          event.preventDefault()
          window.em.handleZeitListeÖffneRaumClick()
        })
        .on('click', '#OeffneProjektZeitListe', function (event) {
          event.preventDefault()
          window.em.handleZeitListeÖffneProjektClick()
        })

      $('#hZeitListe')
        // Neue Zeit erstellen, erste Zeit und fixer button
        .on('click', '.NeueZeitZeitListe', function (event) {
          event.preventDefault()
          window.em.erstelleNeueZeit()
        })
        .on('swiperight', window.em.handleZeitListeSwiperight)

      $('#ZeitlistehZL')
        .on('swipeleft', '.Zeit', window.em.handleZeitListeSwipeleftZeit)
        .on('click', '.Zeit', function (event) {
          event.preventDefault()
          window.em.handleZeitListeZeitClick(this)
        })
        .on('swipeleft', '.erste', window.em.erstelleNeueZeit)

      $('#MenuZeitListe')
        .on('click', '.menu_einfacher_modus', window.em.handleZeitListeMenuEinfacherModusClick)
        .on('click', '.menu_felder_verwalten', window.em.handleZeitListeMenuFelderVerwaltenClick)
        .on('click', '.menu_zeiten_exportieren', window.em.handleZeitListeMenuZeitenExportierenClick)
        .on('click', '.menu_einstellungen', window.em.handleZeitListeMenuEinstellungenClick)
        .on('click', '.menu_neu_anmelden', window.em.meldeNeuAn)
        .on('click', '.menu_artengruppen_importieren', window.em.öffneArtengruppenImportieren)
        .on('click', '.menu_admin', window.em.öffneAdmin)
    }

    window.em.handleZeitListeÖffneOrtClick = function () {
      'use strict'
      window.em.leereStorageZeitListe()
      $.mobile.navigate('hOrtEdit.html')
    }

    window.em.handleZeitListeÖffneRaumClick = function () {
      'use strict'
      window.em.leereStorageZeitListe()
      window.em.leereStorageOrtEdit()
      window.em.leereStorageOrtListe()
      $.mobile.navigate('hRaumEdit.html')
    }

    window.em.handleZeitListeÖffneProjektClick = function () {
      'use strict'
      window.em.leereStorageZeitListe()
      window.em.leereStorageOrtEdit()
      window.em.leereStorageOrtListe()
      window.em.leereStorageRaumEdit()
      window.em.leereStorageRaumListe()
      $.mobile.navigate('hProjektEdit.html')
    }

    window.em.handleZeitListeSwipeleftZeit = function () {
      'use strict'
      window.localStorage.ZeitId = $(this).attr('ZeitId')
      $.mobile.navigate('hArtListe.html')
    }

    window.em.handleZeitListeZeitClick = function (that) {
      'use strict'
      window.localStorage.ZeitId = $(that).attr('ZeitId')
      $.mobile.navigate('hZeitEdit.html')
    }

    window.em.handleZeitListeSwiperight = function () {
      'use strict'
      $.mobile.navigate('hOrtListe.html')
    }

    window.em.handleZeitListeMenuEinfacherModusClick = function () {
      'use strict'
      window.em.leereStorageZeitListe()
      window.em.leereStorageOrtEdit()
      window.em.leereStorageOrtListe()
      window.em.leereStorageRaumEdit()
      window.em.leereStorageRaumListe()
      window.em.leereStorageProjektEdit()
      window.em.leereStorageOrtListe()
      $.mobile.navigate('BeobListe.html')
    }

    window.em.handleZeitListeMenuFelderVerwaltenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hZeitListe.html'
      $.mobile.navigate('FeldListe.html')
    }

    window.em.handleZeitListeMenuZeitenExportierenClick = function () {
      'use strict'
      window.open('_list/ExportZeit/ExportZeit?startkey=["' + window.localStorage.Email + '"]&endkey=["' + window.localStorage.Email + '",{},{}]&include_docs=true')
      $('#MenuZeitListe')
        // völlig unlogisch: das bereits offene popup muss zuerst initialisiert werden...
        .popup()
        // ...bevor es geschlossen werden muss, weil es sonst offen bleibt
        .popup('close')
    }

    window.em.handleZeitListeMenuEinstellungenClick = function () {
      'use strict'
      window.localStorage.zurueck = 'hZeitListe.html'
      window.em.öffneMeineEinstellungen()
    }

    window.em.handleIndexPageshow = function () {
      'use strict'
      // Wenn möglich window.localStorage.Email für die Anmeldung verwenden
      // ausser User hat via Menü bewusst neu anmelden wollen
      // window.localStorage muss bei Neuanmeldung geleert werden, sonst werden die Beobachtungen des alten Users gezeigt
      if (window.localStorage.length > 0) {
        if (window.localStorage.Email) {
          if (window.localStorage.UserStatus !== 'neu') {
            if (window.localStorage.Email && window.localStorage.Autor) {
              window.em.öffneZuletztBenutzteSeite()
              return
            } else {
              // Userdaten bereitstellen und danach die zuletzt benutzte Seite öffnen
              window.em.stelleUserDatenBereit()
              return
            }
          }
        }
      }
      // Wenn window.localStorage.UserStatus neu ist, müssen alle Variabeln entfernt werden, inkl. Username
      window.em.leereAlleVariabeln()

      if (!('autofocus' in document.createElement('input'))) {
        $('#Email').focus()
      }
    }

    window.em.handleIndexPageinit = function () {
      'use strict'
      $('#indexForm')
        // Reaktion auf Enter-Taste
        .on('keydown', '#Passwort', function (event) {
          if (event.keyCode === 13) {
            window.em.meldeUserAn()
            event.preventDefault()
          }
        })

      $('#indexFooter')
        .on('click', '#index_submit_button', function (event) {
          event.preventDefault()
          window.em.meldeUserAn()
        })
        .on('click', '#index_signup_button', function (event) {
          'use strict'
          var email = $('#Email').val(),
            passwort = $('#Passwort').val()
          if (email) {
            sessionStorage.prov_email = email
          }
          if (passwort) {
            sessionStorage.prov_passwort = passwort
          }
          event.preventDefault()
          $.mobile.navigate('Signup.html')
        })
    }

    window.em.validiereUserIndex = function () {
      'use strict'
      var Email = $('input[name=Email]').val(),
        Passwort = $('input[name=Passwort]').val()
      if (!Email) {
        setTimeout(function () {
          $('#Email').focus()
        }, 50)  // need to use a timer so that .blur() can finish before you do .focus()
        window.em.melde('Bitte Benutzernamen eingeben')
        return false
      } else if (!Passwort) {
        setTimeout(function () {
          $('#Passwort').focus()
        }, 50)  // need to use a timer so that .blur() can finish before you do .focus()
        window.em.melde('Bitte Passwort eingeben')
        return false
      }
      return true
    }

    window.em.meldeUserAn = function () {
      'use strict'
      var Email = $('input[name=Email]').val(),
        Passwort = $('input[name=Passwort]').val()
      // sicherstellen, dass die window.localStorage leer ist
      window.em.leereAlleVariabeln()
      if (window.em.validiereUserIndex) {
        $.couch.login({
          name: Email,
          password: Passwort,
          success: function (r) {
            window.localStorage.Email = Email
            if (r.roles.indexOf('_admin') !== -1) {
              // das ist ein admin
              console.log('hallo admin')
              window.localStorage.admin = true
            } else {
              delete window.localStorage.admin
            }
            window.em.blendeMenus()
            // Userdaten bereitstellen und an die zuletzt benutzte Seite weiterleiten
            window.em.stelleUserDatenBereit()
            delete window.localStorage.UserStatus
          },
          error: function () {
            window.em.melde('Anmeldung gescheitert.<br>Sie müssen ev. ein Konto erstellen?')
          }
        })
      }
    }

    window.em.blendeMenus = function () {
      'use strict'
      if (window.localStorage.admin) {
        $('.popup')
          .find('.admin')
          .show()
      } else {
        $('.popup')
          .find('.admin')
          .hide()
      }
    }

    window.em.handleKartePageshow = function () {
      'use strict'
      // Karten müssen in pageshow erstellt werden, weil sie sonst in Chrome nicht erscheinen
      var viewname
      // In diesem Array werden alle Marker gespeichert, damit sie gelöscht werden können
      // wird benutzt von: hOrtEdit.html, BeobEdit.html
      window.em.markersArray = []
      window.em.InfoWindowArray = []

      // sicherstellen, dass window.localStorage.zurueck existiert (gibt sonst später Fehler)
      if (!window.localStorage.zurueck) {
        $.mobile.navigate('BeobListe.html')
      }

      // Je nachdem, welche Seite die Karte aufruft, muss unterschiedlich vorgegangen werden
      switch (window.localStorage.zurueck) {
        case 'hProjektListe':
          viewname = 'evab/hProjektlisteOrteFuerKarte?key="' + window.localStorage.Email + '"&include_docs=true'
          window.em.KeinOrtMeldung = 'Es gibt keine Orte mit Koordinaten'
          window.em.erstelleKarteH(viewname)
          break
        case 'hProjektEdit':	// gleich wie hRaumListe
        case 'hRaumListe':
          viewname = 'evab/hProjektOrteFuerKarte?startkey=["' + window.localStorage.Email + '", "' + window.localStorage.ProjektId + '"]&endkey=["' + window.localStorage.Email + '", "' + window.localStorage.ProjektId + '" ,{}]&include_docs=true'
          window.em.KeinOrtMeldung = 'Es gibt keine Orte mit Koordinaten'
          window.em.erstelleKarteH(viewname)
          break
        case 'hRaumEdit':	// gleich wie hOrtListe
        case 'hOrtListe':
          viewname = 'evab/hRaumOrteFuerKarte?startkey=["' + window.localStorage.Email + '", "' + window.localStorage.RaumId + '"]&endkey=["' + window.localStorage.Email + '", "' + window.localStorage.RaumId + '" ,{}]&include_docs=true'
          window.em.KeinOrtMeldung = 'Es gibt keine Orte mit Koordinaten'
          window.em.erstelleKarteH(viewname)
          break
        case 'hOrtEdit':
          window.localStorage.OrtOderBeob = 'Ort'
          window.em.erstelleKartehOrtEdit()
          break
        case 'BeobListe':
          window.em.erstelleKarteBeobListe()
          break
        case 'BeobEdit':
          window.em.erstelleKarteBeobEdit()
          break
      }
    }

    window.em.handleKartePageinit = function () {
      'use strict'
      $('#KarteHeader')
        // zurück-Button steuern
        .on('click', '#ZurueckKarte', function (event) {
          event.preventDefault()
          window.em.handleKarteZurückClick()
        })
    }

    window.em.handleKartePagehide = function () {
      'use strict'
      // leeren, damit bei erneuten Öffnen die Karte nicht zweimal aufgebaut wird
      $('#MapCanvas').html('')
    }

    window.em.handleKarteZurückClick = function () {
      'use strict'
      var zurueck
      if (window.localStorage.zurueck) {
        zurueck = window.localStorage.zurueck + '.html'
      } else {
        zurueck = 'BeobListe.html'
      }
      $.mobile.navigate(zurueck)
      delete window.localStorage.zurueck
    }

    // erstellt Karten für hProjektListe bis hOrtListe
    // im ersten Teil wird die Liste aller Orte erstellt und an den zweiten Teil übergeben
    window.em.erstelleKarteH = function (viewname) {
      'use strict'

      // Seitenhöhe korrigieren, weil sonst GoogleMap weiss bleibt
      var contentHeight = $(window).height() - 44,
        hOrtLatLngListe

      $('#MapCanvas').css('height', contentHeight + 'px')
      // zuständige hOrtLatLngListe ermitteln
      switch (window.localStorage.zurueck) {
        case 'hProjektListe':
          hOrtLatLngListe = 'hOrteLatLngProjektliste'
          break
        case 'hProjektEdit':
        case 'hRaumListe':
          hOrtLatLngListe = 'hOrteLatLngProjekt'
          break
        case 'hRaumEdit':
        case 'hOrtListe':
          hOrtLatLngListe = 'hOrteLatLngRaum'
          break
      }

      // Liste der Orte holen. Prüfen, ob sie noch als Variable vorliegt
      if (window.em[hOrtLatLngListe]) {
        window.em.erstelleKarteH_2(window.em[hOrtLatLngListe])
      } else {
        var $db = $.couch.db('evab')
        $db.view(viewname, {
          success: function (data) {
            window.em[hOrtLatLngListe] = data
            window.em.erstelleKarteH_2(data)
          }
        })
      }
    }

    // alle benötigten Projekte holen
    window.em.erstelleKarteH_2 = function (hOrteLatLng) {
      'use strict'
      if (!window.em.hProjekt && !window.em.hProjektListe) {
        var $db = $.couch.db('evab')
        $db.view('evab/hProjListe?include_docs=true', {
          success: function (data) {
            window.em.hProjektListe = data
            window.em.erstelleKarteH_3(hOrteLatLng, data)
          }
        })
      } else {
        window.em.erstelleKarteH_3(hOrteLatLng, window.em.hProjektListe)
      }
    }

    // alle benötigten Räume holen
    window.em.erstelleKarteH_3 = function (hOrteLatLng, hProjektListe) {
      'use strict'
      if (!window.em.hRaum && !window.em.hRaumListe) {
        var $db = $.couch.db('evab')
        $db.view('evab/hRaumListe?include_docs=true', {
          success: function (data) {
            // window.em.hRaumListe nicht aktualisieren
            window.em.erstelleKarteH_4(hOrteLatLng, hProjektListe, data)
          }
        })
      } else {
        window.em.erstelleKarteH_4(hOrteLatLng, hProjektListe, window.em.hRaumListe)
      }
    }

    window.em.erstelleKarteH_4 = function (hOrteLatLng, hProjektListe, hRaumListe) {
      'use strict'
      var anzOrt = 0,
        Ort,
        lat,
        lng,
        latlng_mapcenter,
        options,
        map,
        projekt_row,
        pName,
        raum_row,
        rName,
        bounds,
        markers,
        hOrtId,
        latlng_ort,
        marker,
        contentString,
        mcOptions,
        markerCluster

      // Orte zählen
      if (hOrteLatLng.rows) {
        anzOrt = hOrteLatLng.rows.length
      }

      if (anzOrt === 0) {
        // Keine Orte: Hinweis
        window.em.melde(window.em.KeinOrtMeldung)
      } else {
        // Orte vorhanden: Karte aufbauen
        // mal auf Zürich zentrieren, falls in den hOrteLatLng.rows keine Koordinaten kommen
        // auf die die Karte ausgerichtet werden kann
        lat = 47.383333
        lng = 8.533333
        latlng_mapcenter = new google.maps.LatLng(lat, lng)
        options = {
          zoom: 15,
          center: latlng_mapcenter,
          streetViewControl: false,
          mapTypeId: google.maps.MapTypeId.HYBRID
        }
        map = new google.maps.Map(document.getElementById('MapCanvas'), options)
        // google.maps.event.trigger(map,'resize')
        bounds = new google.maps.LatLngBounds()
        // für alle Orte Marker erstellen
        markers = []

        _.each(hOrteLatLng.rows, function (row) {
          Ort = row.doc
          hOrtId = Ort._id

          // Infos für Infowindow holen
          pName = ''
          rName = ''
          if (window.em.hProjekt && window.em.hProjekt.pName) {
            pName = window.em.hProjekt.pName
          } else {
            // pName aus hProjektListe holen
            projekt_row = _.find(hProjektListe.rows, function (row) {
              return row.doc._id === Ort.hProjektId
            })
            pName = projekt_row.doc.pName
          }
          if (window.em.hRaum && window.em.hRaum.rName) {
            rName = window.em.hRaum.rName
          } else {
            // rName aus hRaumListe holen
            raum_row = _.find(hRaumListe.rows, function (row) {
              return row.doc._id === Ort.hRaumId
            })
            rName = raum_row.doc.rName
          }
          latlng_ort = new google.maps.LatLng(Ort.oLatitudeDecDeg, Ort.oLongitudeDecDeg)
          if (anzOrt === 1) {
            // map.fitbounds setzt zu hohen zoom, wenn nur eine Beobachtung erfasst wurde > verhindern
            latlng_mapcenter = latlng_ort
          } else {
            // Kartenausschnitt um diese Koordinate erweitern
            bounds.extend(latlng_ort)
          }
          marker = new MarkerWithLabel({
            map: map,
            position: latlng_ort,
            // title muss String sein
            title: Ort.oName.toString() || '',
            labelContent: Ort.oName,
            labelAnchor: new google.maps.Point(75, -5),
            labelClass: 'MapLabel' // the CSS class for the label
          })
          markers.push(marker)
          contentString = '<table class="kartenlegende_tabelle">'
          contentString += '<tr><td>Projekt:</td><td>' + pName + '</td></tr>'
          contentString += '<tr><td>Raum:</td><td>' + rName + '</td></tr>'
          contentString += '<tr><td>Ort:</td><td>' + Ort.oName + '</td></tr>'
          contentString += '<tr><td>Koordinaten:</td><td>' + Ort.oXKoord + '/' + Ort.oYKoord + '</td></tr>'
          contentString += "<tr><td><a href='#' onclick='window.em.öffneOrt('" + hOrtId + "')'>bearbeiten<\/a></td><td></td></tr>"
          contentString += '</table>'
          window.em.makeMapListener(map, marker, contentString)
        })
        mcOptions = {maxZoom: 17}
        markerCluster = new MarkerClusterer(map, markers, mcOptions)
        if (anzOrt === 1) {
          // map.fitbounds setzt zu hohen zoom, wenn nur eine Beobachtung erfasst wurde > verhindern
          map.setCenter(latlng_mapcenter)
          map.setZoom(18)
        } else {
          // Karte auf Ausschnitt anpassen
          map.fitBounds(bounds)
        }
      }
    }

    window.em.makeMapListener = function (map, marker, contentString) {
      'use strict'
      var infowindow = new google.maps.InfoWindow()
      google.maps.event.addListener(marker, 'click', function () {
        infowindow.setContent(contentString)
        infowindow.open(map, marker)
      })
    }

    // wenn nötig Ort holen
    window.em.erstelleKartehOrtEdit = function () {
      'use strict'
      if (!window.em.hOrt) {
        if (window.localStorage.OrtId) {
          var $db = $.couch.db('evab')
          $db.openDoc(window.localStorage.OrtId, {
            success: function (doc) {
              window.em.hOrt = doc
              window.em.erstelleKartehOrtEdit_2(doc)
            }
          })
        } else {
          window.em.melde('Fehler: Kein Ort verfügbar')
        // return ist hier nicht nötig
        }
      } else {
        window.em.erstelleKartehOrtEdit_2(window.em.hOrt)
      }
    }

    // alle benötigten Projekte holen
    window.em.erstelleKartehOrtEdit_2 = function (ort) {
      'use strict'
      if (!window.em.hProjekt && !window.em.hProjektListe) {
        var $db = $.couch.db('evab')
        $db.view('evab/hProjListe?include_docs=true', {
          success: function (data) {
            window.em.hProjektListe = data
            window.em.erstelleKartehOrtEdit_3(ort, data)
          }
        })
      } else {
        window.em.erstelleKartehOrtEdit_3(ort, window.em.hProjektListe)
      }
    }

    // alle benötigten Räume holen
    window.em.erstelleKartehOrtEdit_3 = function (ort, hProjektListe) {
      'use strict'
      if (!window.em.hRaum && !window.em.hRaumListe) {
        var $db = $.couch.db('evab')
        $db.view('evab/hRaumListe?include_docs=true', {
          success: function (data) {
            // window.em.hRaumListe nicht aktualisieren
            window.em.erstelleKartehOrtEdit_4(ort, hProjektListe, data)
          }
        })
      } else {
        window.em.erstelleKartehOrtEdit_4(ort, hProjektListe, window.em.hRaumListe)
      }
    }

    // wird benutzt in hOrtEdit.html
    window.em.erstelleKartehOrtEdit_4 = function (ort, hProjektListe, hRaumListe) {
      'use strict'
      var map,
        verorted,
        lat,
        lng,
        ZoomLevel,
        latlng_mapcenter,
        options,
        // title muss String sein
        title = '',
        projekt_row,
        pName = '',
        raum_row,
        rName = '',
        oName = '',
        marker,
        contentString,
        infowindow,
        // Seitenhöhe korrigieren, weil sonst GoogleMap weiss bleibt
        contentHeight = $(window).height() - 44
      // Fehlermeldung verhindern, falls kein window.em.hOrt existiert
      if (window.em.hOrt) {
        if (window.em.hOrt.oName) {
          title = window.em.hOrt.oName.toString()
          oName = window.em.hOrt.oName
        }
      }
      if (window.em.hProjekt && window.em.hProjekt.pName) {
        pName = window.em.hProjekt.pName
      } else if (window.localStorage.ProjektId) {
        // pName aus hProjektListe holen
        projekt_row = _.find(hProjektListe.rows, function (row) {
          return row.doc._id === window.localStorage.ProjektId
        })
        pName = projekt_row.doc.pName
      }
      if (window.em.hRaum && window.em.hRaum.rName) {
        rName = window.em.hRaum.rName
      } else if (window.localStorage.RaumId) {
        // rName aus hRaumListe holen
        raum_row = _.find(hRaumListe.rows, function (row) {
          return row.doc._id === window.localStorage.RaumId
        })
        rName = raum_row.doc.rName
      }
      $('#MapCanvas').css('height', contentHeight + 'px')
      if (window.localStorage.oLatitudeDecDeg && window.localStorage.oLongitudeDecDeg) {
        lat = window.localStorage.oLatitudeDecDeg
        lng = window.localStorage.oLongitudeDecDeg
        ZoomLevel = 15
        verorted = true
      } else {
        lat = 47.360566
        lng = 8.542829
        ZoomLevel = 12
        verorted = false
      }
      latlng_mapcenter = new google.maps.LatLng(lat, lng)
      options = {
        zoom: ZoomLevel,
        center: latlng_mapcenter,
        streetViewControl: false,
        mapTypeId: google.maps.MapTypeId.HYBRID
      }
      map = new google.maps.Map(document.getElementById('MapCanvas'), options)
      if (verorted === true) {
        marker = new google.maps.Marker({
          position: latlng_mapcenter,
          map: map,
          title: title,
          draggable: true
        })
        // Marker in Array speichern, damit er gelöscht werden kann
        window.em.markersArray.push(marker)
        contentString = '<table class="kartenlegende_tabelle">'
        contentString += '<tr><td>Projekt:</td><td>' + pName + '</td></tr>'
        contentString += '<tr><td>Raum:</td><td>' + rName + '</td></tr>'
        contentString += '<tr><td>Ort:</td><td>' + oName + '</td></tr>'
        contentString += '<tr><td>Koordinaten:</td><td>' + window.localStorage.oXKoord + '/' + window.localStorage.oYKoord + '</td></tr>'
        contentString += '</table>'
        infowindow = new google.maps.InfoWindow({
          content: contentString
        })
        window.em.InfoWindowArray.push(infowindow)
        google.maps.event.addListener(marker, 'click', function () {
          infowindow.open(map, marker)
        })
        google.maps.event.addListener(marker, 'dragend', function (event) {
          window.em.SetLocationhOrtEdit(event.latLng, map, marker)
        })
      }
      google.maps.event.addListener(map, 'click', function (event) {
        window.em.placeMarkerhOrtEdit(event.latLng, map, marker)
      })
    }

    // wird benutzt in BeobListe.html
    window.em.erstelleKarteBeobListe = function () {
      'use strict'
      // Seitenhöhe korrigieren, weil sonst GoogleMap weiss bleibt
      var contentHeight = $(window).height() - 44
      $('#MapCanvas').css('height', contentHeight + 'px')
      // Beobachtungen holen. Prüfen, ob die Liste noch da ist
      if (window.em.BeobListeLatLng) {
        window.em.erstelleKarteBeobListe_2()
      } else {
        var $db = $.couch.db('evab')
        $db.view('evab/BeobListeLatLng?key="' + window.localStorage.Email + '"&include_docs=true', {
          success: function (data) {
            window.em.BeobListeLatLng = data
            window.em.erstelleKarteBeobListe_2()
          }
        })
      }
    }

    window.em.erstelleKarteBeobListe_2 = function () {
      'use strict'
      var anzBeob = window.em.BeobListeLatLng.rows.length,
        beob,
        image,
        lat,
        lng,
        latlng_mapcenter,
        latlng_beob,
        options,
        map,
        bounds,
        marker,
        markers,
        contentString,
        mcOptions,
        markerCluster,
        artgruppenname
      if (anzBeob === 0) {
        // Keine Beobachtungen: Hinweis und zurück
        window.em.melde('Es wurden noch keine Beobachtungen mit Koordinaten erfasst')
        $.mobile.navigate('BeobListe.html')
      } else {
        // Beobachtungen vorhanden: Karte aufbauen
        lat = 47.383333
        lng = 8.533333
        latlng_mapcenter = new google.maps.LatLng(lat, lng)
        options = {
          zoom: 15,
          center: latlng_mapcenter,
          streetViewControl: false,
          mapTypeId: google.maps.MapTypeId.HYBRID
        }
        map = new google.maps.Map(document.getElementById('MapCanvas'), options)
        // google.maps.event.trigger(map,'resize')
        bounds = new google.maps.LatLngBounds()
        // für alle Beobachtungen Marker erstellen
        markers = []
        _.each(window.em.BeobListeLatLng.rows, function (row) {
          beob = row.doc
          artgruppenname = encodeURIComponent(beob.aArtGruppe.replace('ü', 'ue').replace('ä', 'ae').replace('ö', 'oe')) + '.png'
          if (beob.aArtGruppe === 'DiverseInsekten') {
            artgruppenname = 'unbenannt.png'
          }
          image = 'Artgruppenbilder/' + artgruppenname
          latlng_beob = new google.maps.LatLng(beob.oLatitudeDecDeg, beob.oLongitudeDecDeg)
          if (anzBeob === 1) {
            // map.fitbounds setzt zu hohen zoom, wenn nur eine Beobachtung erfasst wurde > verhindern
            latlng_mapcenter = latlng_beob
          } else {
            // Kartenausschnitt um diese Koordinate erweitern
            bounds.extend(latlng_beob)
          }
          marker = new MarkerWithLabel({
            map: map,
            position: latlng_beob,
            // title muss String sein
            title: beob.aArtName.toString() || '',
            // icon: image,
            labelContent: beob.aArtName,
            labelAnchor: new google.maps.Point(75, -5),
            labelClass: 'MapLabel' // the CSS class for the label
          })
          markers.push(marker)
          contentString = '<h4 class="map_infowindow_title">' + beob.aArtName + '</h4>'
          contentString += '<table class="kartenlegende_tabelle">'
          contentString += '<tr><td>Art-Gruppe:</td><td>' + beob.aArtGruppe + '</td></tr>'
          if (beob.aAutor) {
            contentString += '<tr><td>Autor:</td><td>' + beob.aAutor + '</td></tr>'
          }
          contentString += '<tr><td>Datum:</td><td>' + beob.zDatum + '</td></tr>'
          contentString += '<tr><td>Zeit:</td><td>' + beob.zUhrzeit + '</td></tr>'
          contentString += '<tr><td>Koordinaten:</td><td>' + beob.oXKoord + '/' + beob.oYKoord + '</td></tr>'
          contentString += '</table>'
          window.em.makeMapListener(map, marker, contentString)
        })
        mcOptions = {maxZoom: 17}
        markerCluster = new MarkerClusterer(map, markers, mcOptions)
        if (anzBeob === 1) {
          // map.fitbounds setzt zu hohen zoom, wenn nur eine Beobachtung erfasst wurde > verhindern
          map.setCenter(latlng_mapcenter)
          map.setZoom(18)
        } else {
          // Karte auf Ausschnitt anpassen
          map.fitBounds(bounds)
        }
      }
    }

    // sicherstellen, dass window.em.Beobachtung existiert
    window.em.erstelleKarteBeobEdit = function () {
      'use strict'
      if (!window.em.Beobachtung) {
        if (window.localStorage.BeobId) {
          var $db = $.couch.db('evab')
          $db.openDoc(window.localStorage.BeobId, {
            success: function (doc) {
              window.em.Beobachtung = doc
              window.em.erstelleKarteBeobEdit_2(doc)
            }
          })
        } else {
          window.em.melde('Fehler: Keine Beobachtung verfügbar')
        // return ist hier nicht nötig
        }
      } else {
        window.em.erstelleKarteBeobEdit_2(window.em.Beobachtung)
      }
    }

    window.em.erstelleKarteBeobEdit_2 = function (beob) {
      'use strict'
      var map,
        verorted,
        lat,
        lng,
        ZoomLevel,
        latlng_mapcenter,
        options,
        mapcanvas,
        image,
        marker,
        contentString,
        infowindow,
        // Seitenhöhe korrigieren, weil sonst GoogleMap weiss bleibt
        contentHeight = $(window).height() - 44,
        artgruppenname
      $('#MapCanvas').css('height', contentHeight + 'px')
      if (window.localStorage.oLatitudeDecDeg && window.localStorage.oLongitudeDecDeg) {
        lat = window.localStorage.oLatitudeDecDeg
        lng = window.localStorage.oLongitudeDecDeg
        ZoomLevel = 15
        verorted = true
      } else {
        lat = 47.360566
        lng = 8.542829
        ZoomLevel = 12
        verorted = false
      }
      latlng_mapcenter = new google.maps.LatLng(lat, lng)
      options = {
        zoom: ZoomLevel,
        center: latlng_mapcenter,
        streetViewControl: false,
        mapTypeId: google.maps.MapTypeId.HYBRID
      }
      mapcanvas = $('#MapCanvas')
      map = new google.maps.Map(mapcanvas[0], options)
      // google.maps.event.trigger(map,'resize')
      artgruppenname = encodeURIComponent(window.localStorage.aArtGruppe.replace('ü', 'ue').replace('ä', 'ae').replace('ö', 'oe')) + '.png'
      if (window.localStorage.aArtGruppe === 'DiverseInsekten') {
        artgruppenname = 'unbenannt.png'
      }
      image = 'Artgruppenbilder/' + artgruppenname
      if (verorted === true) {
        marker = new google.maps.Marker({
          position: latlng_mapcenter,
          map: map,
          // title muss String sein
          title: window.localStorage.aArtName.toString() || '',
          // icon: image,
          draggable: true
        })
        // Marker in Array speichern, damit er gelöscht werden kann
        window.em.markersArray.push(marker)
        contentString = '<h4 class="map_infowindow_title">' + window.localStorage.aArtName + '</h4>'
        contentString += '<table class="kartenlegende_tabelle">'
        contentString += '<tr><td>Art-Gruppe:</td><td>' + window.localStorage.aArtGruppe + '</td></tr>'
        if (beob.aAutor) {
          contentString += '<tr><td>Autor:</td><td>' + beob.aAutor + '</td></tr>'
        }
        contentString += '<tr><td>Datum:</td><td>' + beob.zDatum + '</td></tr>'
        contentString += '<tr><td>Zeit:</td><td>' + beob.zUhrzeit + '</td></tr>'
        contentString += '<tr><td>Koordinaten:</td><td>' + window.localStorage.oXKoord + '/' + window.localStorage.oYKoord + '</td></tr>'
        contentString += '</table>'
        infowindow = new google.maps.InfoWindow({
          content: contentString
        })
        window.em.InfoWindowArray.push(infowindow)
        google.maps.event.addListener(marker, 'click', function () {
          infowindow.open(map, marker)
        })
        google.maps.event.addListener(marker, 'dragend', function (event) {
          window.em.SetLocationBeobEdit(event.latLng, map, marker)
        })
      }
      google.maps.event.addListener(map, 'click', function (event) {
        window.em.placeMarkerBeobEdit(event.latLng, map, marker, image)
      })
    }

    // wird benutzt in hOrtEdit.html
    window.em.placeMarkerhOrtEdit = function (location, map, marker) {
      'use strict'
      // zuerst bisherige Marker löschen
      // window.em.clearMarkers()
      marker = new google.maps.Marker({
        position: location,
        map: map,
        // title muss String sein
        title: window.em.hOrt.oName.toString() || '',
        draggable: true
      })
      // Marker in Array speichern, damit er gelöscht werden kann
      // zuerst bisherige löschen, sonst gibt es pro Klick einen Marker...
      window.em.clearMarkers()
      window.em.markersArray.push(marker)
      google.maps.event.addListener(marker, 'dragend', function (event) {
        window.em.SetLocationhOrtEdit(event.latLng, map, marker)
      })
      window.em.SetLocationhOrtEdit(location, map, marker)
    }

    window.em.placeMarkerBeobEdit = function (location, map, marker, image) {
      'use strict'
      // zuerst bisherigen Marker löschen
      // window.em.clearMarkers()
      marker = new google.maps.Marker({
        position: location,
        map: map,
        // title muss String sein
        title: window.localStorage.aArtName.toString() || '',
        // icon: image,
        draggable: true
      })
      // Marker in Array speichern, damit er gelöscht werden kann
      // zuerst bisherige löschen, sonst gibt es pro Klick einen Marker...
      window.em.clearMarkers()
      window.em.markersArray.push(marker)
      google.maps.event.addListener(marker, 'dragend', function (event) {
        window.em.SetLocationBeobEdit(event.latLng, map, marker)
      })
      window.em.SetLocationBeobEdit(location, map, marker)
    }

    // GoogleMap: alle Marker löschen
    // benutzt wo in GoogleMaps Marker gesetzt und verschoben werden
    window.em.clearMarkers = function () {
      'use strict'
      _.each(window.em.markersArray, function (marker) {
        marker.setMap(null)
      })
      window.em.markersArray = []
    }

    // wird benutzt in hOrtEdit.html
    window.em.SetLocationhOrtEdit = function (LatLng, map, marker) {
      'use strict'
      var lat = LatLng.lat(),
        lng = LatLng.lng(),
        contentString,
        infowindow,
        DdInChX = require('./util/ddInChX'),
        DdInChY = require('./util/ddInChY')
      window.localStorage.oLatitudeDecDeg = lat
      window.localStorage.oLongitudeDecDeg = lng
      window.localStorage.oXKoord = DdInChX(lat, lng)
      window.localStorage.oYKoord = DdInChY(lat, lng)
      window.localStorage.oLagegenauigkeit = 'Auf Luftbild markiert'
      window.em.clearInfoWindows()
      contentString = '<table class="kartenlegende_tabelle">'
      contentString += '<tr><td>Projekt:</td><td>' + window.em.hOrt.pName + '</td></tr>'
      contentString += '<tr><td>Raum:</td><td>' + window.em.hOrt.rName + '</td></tr>'
      contentString += '<tr><td>Ort:</td><td>' + window.em.hOrt.oName + '</td></tr>'
      contentString += '<tr><td>Koordinaten:</td><td>' + window.localStorage.oXKoord + '/' + window.localStorage.oYKoord + '</td></tr>'
      contentString += '</table>'
      infowindow = new google.maps.InfoWindow({
        content: contentString
      })
      window.em.InfoWindowArray.push(infowindow)
      google.maps.event.addListener(marker, 'click', function () {
        infowindow.open(map, marker)
      })
      window.em.speichereKoordinaten(window.localStorage.OrtId, 'hOrt')
    }

    // wird benutzt in BeobEdit.html
    window.em.SetLocationBeobEdit = function (LatLng, map, marker) {
      'use strict'
      var lat = LatLng.lat(),
        lng = LatLng.lng(),
        contentString,
        infowindow,
        DdInChX = require('./util/ddInChX'),
        DdInChY = require('./util/ddInChY')
      window.localStorage.oLatitudeDecDeg = lat
      window.localStorage.oLongitudeDecDeg = lng
      window.localStorage.oXKoord = DdInChX(lat, lng)
      window.localStorage.oYKoord = DdInChY(lat, lng)
      window.localStorage.oLagegenauigkeit = 'Auf Luftbild markiert'
      window.em.clearInfoWindows()
      contentString = '<h4 class="map_infowindow_title">' + window.localStorage.aArtName + '</h4>'
      contentString += '<table class="kartenlegende_tabelle">'
      contentString += '<tr><td>Art-Gruppe:</td><td>' + window.localStorage.aArtGruppe + '</td></tr>'
      if (window.em.Beobachtung.aAutor) {
        contentString += '<tr><td>Autor:</td><td>' + window.em.Beobachtung.aAutor + '</td></tr>'
      }
      if (window.em.Beobachtung.zDatum) {
        contentString += '<tr><td>Datum:</td><td>' + window.em.Beobachtung.zDatum + '</td></tr>'
      }
      if (window.em.Beobachtung.zUhrzeit) {
        contentString += '<tr><td>Zeit:</td><td>' + window.em.Beobachtung.zUhrzeit + '</td></tr>'
      }
      contentString += '<tr><td>Koordinaten:</td><td>' + window.localStorage.oXKoord + '/' + window.localStorage.oYKoord + '</td></tr>'
      contentString += '</table>'
      infowindow = new google.maps.InfoWindow({
        content: contentString
      })
      window.em.InfoWindowArray.push(infowindow)
      google.maps.event.addListener(marker, 'click', function () {
        infowindow.open(map, marker)
      })
      window.em.speichereKoordinaten(window.localStorage.BeobId, 'Beobachtung')
    }

    // GoogleMap: alle InfoWindows löschen
    // benutzt wo in GoogleMaps Infowindows neu gesetzt werden müssen, weil die Daten verändert wurden
    window.em.clearInfoWindows = function () {
      'use strict'
      _.each(window.em.InfoWindowArray, function (infowindow) {
        infowindow.setMap(null)
      })
      window.em.InfoWindowArray = []
    }

    window.em.handleSignupPageshow = function () {
      'use strict'
      // sicherstellen, dass nichts vom letzten User übrig bleibt
      window.em.leereAlleVariabeln()
      // Datenverwendung managen: Wenn der User nichts angibt, jaAber setzen
      window.localStorage.Datenverwendung = 'JaAber'
      // wenn der Benutzer vom Login her kommt und bereits Benutzername und Passwort erfasst hat: übernehmen
      if (sessionStorage.prov_email) {
        $('#su_Email').val(sessionStorage.prov_email)
        delete sessionStorage.prov_email
        if (sessionStorage.prov_passwort) {
          $('#su_Passwort').val(sessionStorage.prov_passwort)
          delete sessionStorage.prov_passwort
          $('#su_Passwort2').focus()
        } else {
          $('#su_Passwort').focus()
        }
      }
    }

    window.em.handleSignupPageinit = function () {
      'use strict'
      $('#SignupForm')
        .on('change', "[name='Datenverwendung']", function () {
          window.localStorage.Datenverwendung = $(this).attr('id')
        })

      $('#SignupFooter')
        .on('click', '#SubmitButton', function (event) {
          event.preventDefault()
          window.em.handleSignupSubmitButtonClick()
        })
    }

    window.em.handleSignupSubmitButtonClick = function () {
      'use strict'
      if (window.em.validiereUserSignup()) {
        window.em.erstelleKonto()
      }
    }

    // kontrollierren, ob die erforderlichen Felder etwas enthalten
    // wenn ja wird true retourniert, sonst false
    window.em.validiereUserSignup = function () {
      'use strict'
      var Email = $('#su_Email').val(),
        Passwort = $('#su_Passwort').val(),
        su_Passwort2 = $('#su_Passwort2').val(),
        Autor = $('#Autor').val()
      if (!Email) {
        window.em.melde('Bitte Email eingeben')
        setTimeout(function () {
          $('#su_Email').focus()
        }, 50)  // need to use a timer so that .blur() can finish before you do .focus()
        return false
      } else if (!window.em.validateEmail(Email)) {
        window.em.melde('Bitte gültige Email-Adresse eingeben')
        setTimeout(function () {
          $('#su_Email').focus()
        }, 50)  // need to use a timer so that .blur() can finish before you do .focus()
        return false
      } else if (!Passwort) {
        window.em.melde('Bitte Passwort eingeben')
        setTimeout(function () {
          $('#su_Passwort').focus()
        }, 50)  // need to use a timer so that .blur() can finish before you do .focus()
        return false
      } else if (!su_Passwort2) {
        window.em.melde('Bitte Passwort bestätigen')
        setTimeout(function () {
          $('#su_Passwort2').focus()
        }, 50)  // need to use a timer so that .blur() can finish before you do .focus()
        return false
      } else if (Passwort !== su_Passwort2) {
        window.em.melde('Passwort ist falsch bestätigt')
        setTimeout(function () {
          $('#su_Passwort2').focus()
        }, 50)  // need to use a timer so that .blur() can finish before you do .focus()
        return false
      } else if (!Autor) {
        window.em.melde('Bitte Autor eingeben')
        setTimeout(function () {
          $('#Autor').focus()
        }, 50)  // need to use a timer so that .blur() can finish before you do .focus()
        return false
      }
      return true
    }

    window.em.erstelleKonto = function () {
      'use strict'
      // User in _user eintragen
      $.couch.signup({
        name: $('#su_Email').val(),
        Datenverwendung: window.localStorage.Datenverwendung || 'JaAber'
      }, $('#su_Passwort').val(), {
        success: function () {
          window.localStorage.Email = $('#su_Email').val()
          window.localStorage.Autor = $('#Autor').val()
          window.em.speichereAutorAlsStandardwert()
        },
        error: function () {
          window.em.melde('Fehler: Das Konto wurde nicht erstellt')
        }
      })
    }

    window.em.handleUserEditPageshow = function () {
      'use strict'
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
      }
      window.em.initiiereUserEdit()
    }

    window.em.handleUserEditPageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
      }

      $('#UserEditHeader')
        // zurück-Button steuern
        .on('click', '#zurückUserEdit', function (event) {
          event.preventDefault()
          window.em.handleUserEditZurückClick()
        })

      $('#UserEditForm')
        // jedes Feld bei Änderung speichern
        .on('change', '.Feld', window.em.handleUserEditFeldChange)
        .on('change', "[name='Datenverwendung']", function () {
          window.localStorage.Datenverwendung = $(this).attr('id')
        })
        // Autor bei Änderung speichern
        .on('change', '#Autor', window.em.handleUserEditAutorChange)
    }

    window.em.handleUserEditZurückClick = function () {
      'use strict'
      // sicherstellen, dass er immer ein zurück kennt
      if (!window.localStorage.zurueck) {
        window.localStorage.zurueck = 'BeobListe.html'
      }
      if (window.localStorage.hArtSicht === 'liste' && window.localStorage.zurueck === 'hArtEdit.html') {
        $.mobile.navigate('hArtEditListe.html')
      } else {
        $.mobile.navigate(window.localStorage.zurueck)
      }
      delete window.localStorage.zurueck
    }

    window.em.handleUserEditFeldChange = function () {
      'use strict'
      var Feldname = this.name,
        // nötig, damit Arrays richtig kommen
        Feldjson = $("[name='" + Feldname + "']").serializeObject(),
        Feldwert = Feldjson[Feldname]
      if (window.em.validiereUserUserEdit()) {
        window.em.speichereUser(Feldname, Feldwert)
      }
    }

    window.em.handleUserEditAutorChange = function () {
      'use strict'
      var $Autor = $('#Autor'),
        $db = $.couch.db('evab')
      $db.openDoc('f19cd49bd7b7a150c895041a5d02acb0', {
        success: function (doc) {
          if ($Autor.val()) {
            // Wenn Autor erfasst ist, speichern
            // Falls Standardwert noch nicht existiert, 
            // uss zuerst das Objekt geschaffen werden
            if (!doc.Standardwert) {
              doc.Standardwert = {}
            }
            doc.Standardwert[window.localStorage.Email] = $Autor.val()
          } else {
            // Wenn kein Autor erfasst ist, einen allfälligen löschen
            if (doc.Standardwert) {
              delete doc.Standardwert[window.localStorage.Email]
            }
          }
          $db.saveDoc(doc, {
            success: function () {
              // Feldliste soll neu aufgebaut werden
              window.em.leereStorageFeldListe()
              window.localStorage.Autor = $Autor.val()
            },
            error: function () {
              window.em.melde('Fehler: Änderung am Autor nicht gespeichert')
            }
          })
        },
        error: function () {
          window.em.melde('Fehler: Änderung am Autor nicht gespeichert')
        }
      })
    }

    // kontrollierren, ob die erforderlichen Felder etwas enthalten
    // wenn ja wird true retourniert, sonst false
    window.em.validiereUserUserEdit = function () {
      'use strict'
      var $Autor = $('#Autor')
      if (!$Autor.val()) {
        window.em.melde('Bitte Autor eingeben')
        setTimeout(function () {
          $Autor.focus()
        }, 50)  // need to use a timer so that .blur() can finish before you do .focus()
        return false
      }
      return true
    }

    window.em.speichereUser = function (Feldname, Feldwert) {
      'use strict'
      if (window.localStorage.Datenverwendung) {
        $.couch.userDb(function (db) {
          db.openDoc('org.couchdb.user:' + window.localStorage.Email, {
            success: function (doc) {
              if (Feldwert) {
                doc[Feldname] = Feldwert
              } else if (doc[Feldname]) {
                delete doc[Feldname]
              }
              db.saveDoc(doc, {
                error: function () {
                  console.log('Fehler in function window.em.speichereUser: Datenverwendung nicht gespeichert");')
                }
              })
            },
            error: function () {
              console.log('Fehler in function window.em.speichereUser: Datenverwendung nicht gespeichert");')
            }
          })
        })
      } else {
        // es gibt noch keine User-Doc
        // vielleicht hatte der User ein Konto bei ArtenDb erstellt und ist das erste mal in Evab
        console.log('Fehler: Datenverwendung nicht gespeichert')
      }
    }

    // wird in hArtEdit.html verwendet
    window.em.zuArtgruppenliste = function () {
      'use strict'
      // Globale Variablen für hArtListe zurücksetzen, damit die Liste beim nächsten Aufruf neu aufgebaut wird
      // window.em.leereStoragehArtListe()
      window.localStorage.Von = 'hArtEdit'
      if (window.em.gruppe_merken) {
        // Artgruppenliste auslassen
        // window.localStorage.aArtGruppe ist schon gesetzt
        $.mobile.navigate('Artenliste.html')
      } else {
        $.mobile.navigate('Artgruppenliste.html')
      }
    }

    // wird in hArtEdit.html verwendet
    window.em.zuArtliste = function () {
      'use strict'
      window.localStorage.Von = 'hArtEdit'
      $.mobile.navigate('Artenliste.html')
    }

    // Speichert alle Daten
    // wird in hArtEdit.html verwendet
    window.em.speichereHArt = function () {
      'use strict'
      var that = this,
        hartid
      // Achtung: in hArtEditListe kann es sein, dass window.em.hArt erst gerade aktualisiert wird und momentan nicht aktuell ist!
      // Lösung: hartid aus höher liegender tr holen und vergleichen, ob window.em.hArt dieselbe id hat
      if ($('body').pagecontainer('getActivePage').attr('id') === 'hArtEditListe') {
        hartid = $(that).closest('tr').attr('hartid')
        window.localStorage.hArtId = hartid
      }
      // prüfen, ob hArt als Objekt vorliegt
      if ((window.em.hArt && !hartid) || (window.em.hArt && hartid === window.em.hArt._id)) {
        // dieses verwenden
        window.em.speichereHArt_2(that)
      } else {
        // Objekt aud DB holen
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.hArtId, {
          success: function (data) {
            window.em.hArt = data
            window.em.speichereHArt_2(that)
            window.localStorage.aArtId = window.em.hArt.aArtId
            window.localStorage.aArtName = window.em.hArt.aArtName
            window.localStorage.aArtGruppe = window.em.hArt.aArtGruppe
          },
          error: function () {
            console.log('Fehler in function speichereHArt')
          }
        })
      }
    }

    window.em.speichereHArt_2 = function (that) {
      'use strict'
      var FeldnameDb,
        Feldwert,
        feldinfos
      // Feldname und -wert ermitteln
      feldinfos = window.em.holeFeldInfosVonElement(that)
      FeldnameDb = feldinfos.feldname_db
      Feldwert = feldinfos.feldwert
      // window.em.hArt aktualisieren
      if (Feldwert) {
        if (window.em.myTypeOf(Feldwert) === 'float') {
          window.em.hArt[FeldnameDb] = parseFloat(Feldwert)
        } else if (window.em.myTypeOf(Feldwert) === 'integer') {
          window.em.hArt[FeldnameDb] = parseInt(Feldwert)
        } else {
          window.em.hArt[FeldnameDb] = Feldwert
        }
      } else if (window.em.hArt[FeldnameDb]) {
        delete window.em.hArt[FeldnameDb]
      }
      // Werte aktualisieren, die nicht durch .speichern erfasst werden
      window.em.hArt.aArtId = window.localStorage.aArtId
      window.em.hArt.aArtName = window.localStorage.aArtName
      window.em.hArt.aArtGruppe = window.localStorage.aArtGruppe
      // Datenbank aktualisieren
      var $db = $.couch.db('evab')
      $db.saveDoc(window.em.hArt, {
        success: function (data) {
          window.em.hArt._rev = data.rev
          window.localStorage.hArtId = data.id
        },
        error: function () {
          console.log('Fehler in function speichereHArt_2')
        }
      })
    }

    window.em.holeFeldInfosVonElement = function (that) {
      'use strict'
      var feldinfos = {},
        feldjson
      // Feldname und -wert ermitteln
      if (window.em.myTypeOf($(that).attr('aria-valuenow')) !== 'string') {
        // slider
        feldinfos.feldname_dom = feldinfos.feldname_db = $(that).attr('aria-labelledby').slice(0, ($(that).attr('aria-labelledby').length - 6))
        feldinfos.feldwert = $(that).attr('aria-valuenow')
      } else {
        // alle anderen Feldtypen
        if (that.type === 'radio') {
          // in hArtEditListe zeigen radios ihre Werte nur an, wenn die radios desselben Felds unterschiedliche Namen haben
          // darum wird _ und eine id hintangestellt
          feldinfos.feldname_dom = that.name
          feldinfos.feldname_db = that.name.substring(0, that.name.lastIndexOf('_'))
        } else {
          feldinfos.feldname_db = feldinfos.feldname_dom = that.name
        }
        // nötig, damit Arrays richtig kommen
        // if ($("body").pagecontainer("getActivePage").attr("id") === "hArtEditListe") { // Funktioniert nicht, weil z.B. ein select ein eigenes Fenster öffnet!
        if (window.localStorage.hArtId && window.localStorage.hArtSicht === 'liste') {
          // hier gibt es pro Tabellenzeile ein Feld mit diesem Namen!
          if (['checkbox'].indexOf(that.type) >= 0) {
            feldjson = $(that).parents('fieldset').serializeObject()
          } else {
            feldjson = $(that).serializeObject()
          }
        } else {
          feldjson = $("[name='" + feldinfos.feldname_dom + "']").serializeObject()
        }
        feldinfos.feldwert = feldjson[feldinfos.feldname_dom]
      }
      return feldinfos
    }

    // Öffnet die vorige oder nächste Art
    // vorige der ersten => ArtListe
    // nächste der letzten => melden
    // erwartet die ID des aktuellen Datensatzes und ob nächster oder voriger gesucht wird
    // wird in hArtEdit.html verwendet
    window.em.nächsteVorigeArt = function (NächsteOderVorige) {
      'use strict'
      // prüfen, ob hArtListe schon existiert
      // nur abfragen, wenn sie noch nicht existiert
      if (window.em.hArtListe) {
        // hArtListe liegt als Variable vor
        window.em.nächsteVorigeArt_2(NächsteOderVorige)
      } else {
        // keine Ortliste vorhanden, neu aus DB erstellen
        var $db = $.couch.db('evab')
        $db.view('evab/hArtListe?startkey=["' + window.localStorage.Email + '", "' + window.localStorage.ZeitId + '"]&endkey=["' + window.localStorage.Email + '", "' + window.localStorage.ZeitId + '" ,{}]&include_docs=true', {
          success: function (data) {
            // Liste bereitstellen, um Datenbankzugriffe zu reduzieren
            window.em.hArtListe = data
            window.em.nächsteVorigeArt_2(NächsteOderVorige)
          }
        })
      }
    }

    window.em.nächsteVorigeArt_2 = function (NächsteOderVorige) {
      'use strict'
      var i,
        ArtIdAktuell,
        AnzArt
      for (i = 0; window.em.hArtListe.rows.length; i++) {
        ArtIdAktuell = window.em.hArtListe.rows[i].doc._id
        AnzArt = window.em.hArtListe.rows.length - 1  // vorsicht: Objekte zählen Elemente ab 1, Arrays ab 0!
        if (ArtIdAktuell === window.localStorage.hArtId) {
          switch (NächsteOderVorige) {
            case 'nächste':
              if (i < AnzArt) {
                window.localStorage.hArtId = window.em.hArtListe.rows[i + 1].doc._id
                window.em.leereStoragehArtEdit('ohneId')
                window.em.initiierehArtEdit()
                return
              } else {
                window.em.melde('Das ist die letzte Art')
                return
              }
              break
            case 'vorige':
              if (i > 0) {
                window.localStorage.hArtId = window.em.hArtListe.rows[i - 1].doc._id
                window.em.leereStoragehArtEdit('ohneId')
                window.em.initiierehArtEdit()
                return
              } else {
                window.em.leereStoragehArtEdit()
                $.mobile.navigate('hArtListe.html')
                return
              }
              break
          }
        }
      }
    }

    // wird in hArtEdit.html benutzt
    // löscht eine Beobachtung
    window.em.löscheHArt = function () {
      'use strict'
      if (window.em.hArt) {
        // vorhandenes Objekt nutzen
        window.em.löscheHArt_2()
      } else {
        // Objekt aus DB holen
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.hArtId, {
          success: function (data) {
            window.em.hArt = data
            window.em.löscheHArt_2()
          },
          error: function () {
            window.em.melde('Fehler: Art nicht gelöscht')
          }
        })
      }
    }

    window.em.löscheHArt_2 = function () {
      'use strict'
      var $db = $.couch.db('evab')
      $db.removeDoc(window.em.hArt, {
        success: function (data) {
          // Liste anpassen. Vorsicht: Bei refresh kann sie fehlen
          if (window.em.hArtListe) {
            window.em.hArtListe.rows = _.reject(window.em.hArtListe.rows, function (row) {
              return row.doc._id === data.id
            })
          } else {
            // Keine Beobliste mehr. Storage löschen
            window.em.leereStoragehArtListe()
          }
          window.em.leereStoragehArtEdit()
          $.mobile.navigate('hArtListe.html')
        },
        error: function () {
          window.em.melde('Fehler: Art nicht gelöscht')
        }
      })
    }

    // prüft neue oder umbenannte Feldnamen
    // prüft, ob der neue Feldname schon existiert
    // wenn ja: melden, zurückstellen
    // wenn nein: speichern
    // wird in FeldEdit.html verwendet
    window.em.prüfeFeldNamen = function () {
      'use strict'
      var $db = $.couch.db('evab')
      $db.view('evab/FeldNamen?key="' + window.localStorage.FeldWert + '"&include_docs=true', {
        success: function (data) {
          var tempFeld,
            AnzEigeneOderOffizielleFelderMitSelbemNamen = 0
          // durch alle Felder mit demselben Artnamen laufen
          // prüfen, ob sie eigene oder offielle sind
          if (data.rows) {
            _.each(data.rows, function (row) {
              if (row.doc) {
                tempFeld = row.doc
                // ist es ein eigenes oder ein offizielles?
                if (tempFeld.User === window.localStorage.Email || tempFeld.User === 'ZentrenBdKt') {
                  // ja > dieser Name ist nicht zulässig
                  AnzEigeneOderOffizielleFelderMitSelbemNamen++
                }
              }
            })
          }
          if (AnzEigeneOderOffizielleFelderMitSelbemNamen === 0) {
            // Feldname ist neu, somit zulässig > speichern
            // und alten FeldNamen aus der Liste der anzuzeigenden Felder entfernen
            $('#SichtbarImModusHierarchisch')
              .val('ja')
              .parent().addClass('ui-flipswitch-active')
            window.em.speichereFeldeigenschaften()
          } else {
            // Feldname kommt bei diesem User schon vor
            // Wert im Feld zurücksetzen
            if (window.localStorage.AlterFeldWert && window.localStorage.AlterFeldWert !== undefined) {
              $('#FeldName').val(window.localStorage.AlterFeldWert)
            } else {
              $('#FeldName').val('')
            }
            setTimeout(function () {
              $('#FeldName').focus()
            }, 50)  // need to use a timer so that .blur() can finish before you do .focus()
            window.em.melde('Feldname ' + window.localStorage.FeldWert + ' existiert schon<br>Wählen Sie einen anderen')
            delete window.localStorage.FeldName
            delete window.localStorage.FeldWert
            delete window.localStorage.AlterFeldWert
          }
        },
        error: function () {
          // Wert im Feld zurücksetzen
          if (window.localStorage.AlterFeldWert) {
            $('#FeldName').val(window.localStorage.AlterFeldWert)
          } else {
            $('#FeldName').val('')
          }
          window.em.melde('Fehler: Änderung in ' + window.localStorage.FeldName + ' nicht gespeichert')
          delete window.localStorage.FeldName
          delete window.localStorage.FeldWert
          delete window.localStorage.AlterFeldWert
        }
      })
    }

    // löscht Felder
    // wird in FeldEdit.html verwendet
    window.em.löscheFeld = function () {
      'use strict'
      if (window.em.Feld) {
        // Objekt nutzen
        window.em.löscheFeld_2()
      } else {
        // Feld aus DB holen
        var $db = $.couch.db('evab')
        $db.openDoc(window.em.Feld._id, {
          success: function (data) {
            window.em.Feld = data
            window.em.löscheFeld_2()
          },
          error: function () {
            window.em.melde('Fehler: nicht gelöscht')
          }
        })
      }
    }

    window.em.löscheFeld_2 = function () {
      'use strict'
      var $db = $.couch.db('evab')
      $db.removeDoc(window.em.Feld, {
        success: function (data) {
          // Liste anpassen. Vorsicht: Bei refresh kann sie fehlen
          if (window.em.Feldliste) {
            window.em.Feldliste.rows = _.reject(window.em.Feldliste.rows, function (row) {
              return row.doc._id === data.id
            })
          } else {
            // Keine Feldliste mehr. Storage löschen
            window.em.leereStorageFeldListe()
          }
          window.em.leereStorageFeldEdit()
          $.mobile.navigate('FeldListe.html')
        },
        error: function () {
          window.em.melde('Fehler: nicht gelöscht')
        }
      })
    }

    // Öffnet das nächste Feld
    // nächstes des letzten => melden
    // erwartet die ID des aktuellen Datensatzes
    // wird in FeldEdit.html verwendet
    window.em.geheZumNächstenFeld = function () {
      'use strict'
      if (window.em.Feldliste) {
        // Feldliste aus globaler Variable verwenden - muss nicht geparst werden
        window.em.geheZumNächstenFeld_2()
      } else {
        var $db = $.couch.db('evab')
        $db.view('evab/FeldListe?include_docs=true', {
          success: function (data) {
            window.em.Feldliste = data
            window.em.geheZumNächstenFeld_2()
          }
        })
      }
    }

    window.em.geheZumNächstenFeld_2 = function () {
      'use strict'
      var i,
        y,
        FeldIdAktuell,
        AnzFelder = window.em.Feldliste.rows.length - 1,
        AktFeld_i,
        AktFeld_y
      for (i = 0; window.em.Feldliste.rows.length; i++) {
        // alle Felder durchlaufen, aktuelles eigenes oder offizielles suchen
        AktFeld_i = window.em.Feldliste.rows[i].doc
        // vorsicht: Objekte zählen Elemente ab 1, Arrays ab 0!
        if (AktFeld_i.User === window.localStorage.Email || AktFeld_i.User === 'ZentrenBdKt') {
          // Nur eigene und offizielle Felder berücksichtigen
          FeldIdAktuell = window.em.Feldliste.rows[i].doc._id
          if (FeldIdAktuell === window.localStorage.FeldId) {
            // das ist das aktuelle Feld
            // von hier aus vorwärts das nächste eigene oder offizielle suchen
            if (i < AnzFelder) {
              // das aktuelle Feld ist nicht das letzte
              for (y = i + 1; y <= AnzFelder; y++) {
                // alle verbleibenden Felder durchlaufen, eigenes suchen
                AktFeld_y = window.em.Feldliste.rows[y].doc
                // Nur eigene Felder und offizielle berücksichtigen
                if (AktFeld_y.User === window.localStorage.Email || AktFeld_y.User === 'ZentrenBdKt') {
                  // das ist das nächste eigene Feld > öffnen
                  window.localStorage.FeldId = window.em.Feldliste.rows[i + 1].doc._id
                  window.em.leereStorageFeldEdit('ohneId')
                  window.em.initiiereFeldEdit()
                  return
                } else {
                  if (y === AnzFelder) {
                    // am letzten Feld angelangt und es ist kein eigenes
                    window.em.melde('Das ist das letzte Feld')
                    return
                  }
                }
              }
            } else {
              // das aktuelle Feld ist das letzte
              window.em.melde('Das ist das letzte Feld')
              return
            }
          }
        }
      }
    }

    // Öffnet das vorige Feld
    // voriges des ersten => FeldListe
    // erwartet die ID des aktuellen Datensatzes
    // wird in FeldEdit.html verwendet
    window.em.geheZumVorigenFeld = function () {
      'use strict'
      if (window.em.Feldliste) {
        // Feldliste aus globaler Variable verwenden - muss nicht geparst werden
        window.em.geheZumVorigenFeld_2()
      } else {
        var $db = $.couch.db('evab')
        $db.view('evab/FeldListe?include_docs=true', {
          success: function (data) {
            window.em.Feldliste = data
            window.em.geheZumVorigenFeld_2()
          }
        })
      }
    }

    window.em.geheZumVorigenFeld_2 = function () {
      'use strict'
      var i,
        y,
        FeldIdAktuell,
        FeldIdVoriges,
        AktFeld_i,
        AktFeld_y
      for (i = 0; window.em.Feldliste.rows.length; i++) {
        // alle Felder durchlaufen, aktuelles eigenes oder offizielles suchen
        AktFeld_i = window.em.Feldliste.rows[i].doc
        // vorsicht: Objekte zählen Elemente ab 1, Arrays ab 0!
        if (AktFeld_i.User === window.localStorage.Email || AktFeld_i.User === 'ZentrenBdKt') {
          // Nur eigene und offizielle Felder berücksichtigen
          FeldIdAktuell = window.em.Feldliste.rows[i].doc._id
          if (FeldIdAktuell === window.localStorage.FeldId) {
            // das ist das aktuelle Feld
            // von hier aus rückwärts das nächste eigene oder offizielle suchen
            if (i > 0) {
              // das aktuelle Feld ist nicht das erste 
              for (y = i - 1; y >= 0; y--) {
                // alle vorhergehenden Felder durchlaufen, eigenes suchen
                AktFeld_y = window.em.Feldliste.rows[y].doc
                // Nur eigene Felder und offizielle berücksichtigen
                if (AktFeld_y.User === window.localStorage.Email || AktFeld_y.User === 'ZentrenBdKt') {
                  // das ist das nächstvorherige eigene Feld > öffnen
                  FeldIdVoriges = window.em.Feldliste.rows[i - 1].doc._id
                  window.localStorage.FeldId = FeldIdVoriges
                  window.em.leereStorageFeldEdit('ohneId')
                  window.em.initiiereFeldEdit()
                  return
                } else {
                  if (y === 1) {
                    // am ersten Feld angelangt und es ist kein eigenes
                    // wir gehen zur Feldliste
                    window.em.geheZurueckFE()
                    return
                  }
                }
              }
            } else {
              // das aktuelle Feld ist das erste
              // wir gehen zur Feldliste
              window.em.geheZurueckFE()
              return
            }
          }
        }
      }
    }

    // empfängt den Feldnamen des gewählten Vorgängers
    // ermittelt dessen Reihenfolge
    // sucht das nächste eigene Feld und setzt als Reihenfolge den Mittelwert der zwei Reihenfolgen
    // Wenn kein weiteres eigenes Feld kommt, wird als Reihenfolge der nächste um mindestens 1 höhere ganzzahlige Wert gesetzt
    // wird in FeldEdit.html verwendet
    window.em.setzeReihenfolgeMitVorgänger = function (FeldNameVorgänger) {
      'use strict'
      var viewname = 'evab/FeldListeFeldName?key="' + FeldNameVorgänger + '"&include_docs=true',
        $db = $.couch.db('evab')
      $db.view(viewname, {
        success: function (data) {
          var ReihenfolgeVorgaenger = data.rows[0].doc.Reihenfolge
          $('#Reihenfolge').val(Math.floor(ReihenfolgeVorgaenger + 1))
          window.em.speichereFeldeigenschaften()
        }
      })
    }

    // speichert, dass ein Wert als Standardwert verwendet werden soll
    // wird in FeldEdit.html verwendet
    window.em.speichereStandardwert = function () {
      'use strict'
      // Prüfen, ob Feld als Objekt vorliegt
      if (window.em.Feld) {
        // dieses verwenden
        window.em.speichereStandardwert_2()
      } else {
        // aus DB holen
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.FeldId, {
          success: function (doc) {
            window.em.Feld = doc
            window.em.speichereStandardwert_2()
          },
          error: function () {
            window.em.melde('Fehler: Feld nicht gespeichert')
          }
        })
      }

    }

    window.em.speichereStandardwert_2 = function () {
      'use strict'
      var Feldwert = $('#Standardwert').val()
      // Standardwert managen
      // Standardwert ist Objekt, in dem die Werte für jeden User gespeichert werden
      // darum manuell für diesen User updaten
      if (window.em.Feld.Standardwert) {
        // Standardwert existierte
        if (Feldwert) {
          // neuen Standardwert setzen
          window.em.Feld.Standardwert[window.localStorage.Email] = Feldwert
        } else {
          // Standardwert ist leer
          if (window.em.Feld.Standardwert[window.localStorage.Email]) {
            // bisherigen Standardwert löschen
            delete window.em.Feld.Standardwert[window.localStorage.Email]
          }
        }
      } else {
        // Bisher gab es noch keinen Standardwert
        if (Feldwert) {
          // Objekt für Standardwert schaffen und neuen Wert setzen
          window.em.Feld.Standardwert = {}
          window.em.Feld.Standardwert[window.localStorage.Email] = Feldwert
        }
      }
      var $db = $.couch.db('evab')
      $db.saveDoc(window.em.Feld, {
        success: function (data) {
          window.em.Feld._rev = data.rev
          window.localStorage.FeldId = data.id
          // Feldlisten leeren, damit Standardwert sofort verwendet werden kann!
          window.em.leereStorageFeldListe()
        },
        error: function () {
          window.em.melde('Fehler: Feld nicht gespeichert')
        }
      })
    }

    // speichert Feldeigenschaften
    // wird in FeldEdit.html verwendet
    window.em.speichereFeldeigenschaften = function () {
      'use strict'
      // prüfen, ob das Feld als Objekt vorliegt
      if (window.em.Feld) {
        // bestehendes Objekt verwenden
        window.em.speichereFeldeigenschaften_2()
      } else {
        // Objekt aus der DB holen
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.FeldId, {
          success: function (data) {
            window.em.Feld = data
            window.em.speichereFeldeigenschaften_2()
          },
          error: function () {
            window.em.melde('Fehler: Die letzte Änderung wurde nicht gespeichert')
          }
        })
      }
    }

    window.em.speichereFeldeigenschaften_2 = function () {
      'use strict'
      var Formularfelder = $('#FeldEditForm').serializeObjectNull()
      // Felder mit Arrays: Kommagetrennte Werte in Arrays verwandeln
      if (Formularfelder.Optionen) {
        Formularfelder.Optionen = Formularfelder.Optionen.split(',')
      }
      // Wenn Beschriftung fehlt und Name existiert: Beschriftung = Name
      if (!Formularfelder.FeldBeschriftung && Formularfelder.Hierarchiestufe && Formularfelder.FeldName) {
        Formularfelder.FeldBeschriftung = Formularfelder.FeldName
        // Feldliste soll neu aufgebaut werden
        window.em.leereStorageFeldListe()
      }
      // Es braucht eine Reihenfolge
      if (!Formularfelder.Reihenfolge && Formularfelder.Hierarchiestufe && Formularfelder.FeldName) {
        Formularfelder.Reihenfolge = 1
        // Feldliste soll neu aufgebaut werden
        window.em.leereStorageFeldListe()
      }
      // Wenn Feldtyp von textinput weg geändert wurde, sollte InputTyp entfernt werden
      if (Formularfelder.Formularelement !== 'textinput' && Formularfelder.InputTyp) {
        delete Formularfelder.InputTyp
        $('#' + window.em.Feld.InputTyp).prop('checked', false).checkboxradio('refresh')
      }
      // Wenn Feldtyp textinput gesetzt wurde, muss ein InputTyp existieren. Wenn er nicht gesetzt wurde, text setzen
      if (Formularfelder.Formularelement === 'textinput' && !Formularfelder.InputTyp) {
        Formularfelder.InputTyp = 'text'
        $('#' + window.em.Feld.InputTyp).prop('checked', true).checkboxradio('refresh')
      }
      // Formularfelder in Dokument schreiben
      // setzt Vorhandensein von Feldnamen voraus!
      _.each(Formularfelder, function (feldwert, feldname) {
        if (feldwert) {
          if (feldname === 'Reihenfolge' || feldname === 'SliderMinimum' || feldname === 'SliderMaximum') {
            // Zahl wird sonst in Text verwandelt und falsch sortiert
            window.em.Feld[feldname] = parseInt(feldwert)
          } else {
            window.em.Feld[feldname] = feldwert
          }
        } else {
          // leere Felder entfernen, damit werden auch soeben gelöschte Felder entfernt
          delete window.em.Feld[feldname]
        }
      })
      var $db = $.couch.db('evab')
      $db.saveDoc(window.em.Feld, {
        success: function (data) {
          // rev aktualisieren
          window.em.Feld._rev = data.rev
          window.localStorage.FeldId = data.id
          // Feldliste soll neu aufbauen
          window.em.leereStorageFeldListe()
        },
        error: function () {
          window.em.melde('Fehler: Die letzte Änderung wurde nicht gespeichert')
        }
      })
      delete window.localStorage.FeldName
      delete window.localStorage.FeldWert
      delete window.localStorage.AlterFeldWert
    }

    // wird in BeobListe.html verwendet
    // eigene Funktion, weil auch die Beobliste darauf verweist, wenn noch keine Art erfasst wurde
    window.em.erstelleNeueBeob_1_Artgruppenliste = function () {
      'use strict'
      // Globale Variablen für BeobListe zurücksetzen, damit die Liste neu aufgebaut wird
      window.em.leereStorageBeobListe()
      window.localStorage.Status = 'neu'
      window.localStorage.Von = 'BeobListe'
      delete window.localStorage.aArtGruppe	// verhindern, dass eine Artgruppe übergeben wird
      $.mobile.navigate('Artgruppenliste.html')
    }

    // wird in BeobEdit.html benutzt
    // Öffnet die vorige oder nächste Beobachtung
    // vorige der ersten => BeobListe
    // nächste der letzten => melden
    // erwartet ob nächster oder voriger gesucht wird
    window.em.nächsteVorigeBeob = function (NächsteOderVorige) {
      'use strict'
      // prüfen, ob BeobListe schon existiert
      // nur abfragen, wenn sie noch nicht existiert
      if (window.em.BeobListe) {
        // globale Variable BeobListe existiert noch
        window.em.nächsteVorigeBeob_2(NächsteOderVorige)
      } else {
        // keine Projektliste übergeben
        // neu aus DB erstellen
        var $db = $.couch.db('evab')
        $db.view('evab/BeobListe?startkey=["' + window.localStorage.Email + '",{}]&endkey=["' + window.localStorage.Email + '"]&descending=true&include_docs=true', {
          success: function (data) {
            // Globale Variable erstellen, damit Abfrage ab dem zweiten Mal nicht mehr nötig ist
            // bei neuen/Löschen von Beobachtungen wird BeobListe wieder auf undefined gesetzt
            window.em.BeobListe = data
            window.em.nächsteVorigeBeob_2(NächsteOderVorige)
          }
        })
      }
    }

    window.em.nächsteVorigeBeob_2 = function (NächsteOderVorige) {
      'use strict'
      var i,
        BeobIdAktuell,
        AnzBeob
      for (i = 0; window.em.BeobListe.rows.length; i++) {
        BeobIdAktuell = window.em.BeobListe.rows[i].doc._id
        AnzBeob = window.em.BeobListe.rows.length - 1		// vorsicht: Objekte zählen Elemente ab 1, Arrays ab 0!
        if (BeobIdAktuell === window.localStorage.BeobId) {
          switch (NächsteOderVorige) {
            case 'nächste':
              if (i < AnzBeob) {
                window.localStorage.BeobId = window.em.BeobListe.rows[i + 1].doc._id
                window.em.leereStorageBeobEdit('ohneId')
                window.em.initiiereBeobEdit()
                return
              } else {
                window.em.melde('Das ist die letzte Beobachtung')
                return
              }
              break
            case 'vorige':
              if (i > 0) {
                window.localStorage.BeobId = window.em.BeobListe.rows[i - 1].doc._id
                window.em.leereStorageBeobEdit('ohneId')
                window.em.initiiereBeobEdit()
                return
              } else {
                window.em.leereStorageBeobEdit()
                $.mobile.navigate('BeobListe.html')
                return
              }
              break
          }
        }
      }
    }

    // wird in BeobEdit.html benutzt
    // löscht eine Beobachtung
    window.em.löscheBeob = function () {
      'use strict'
      if (window.em.Beobachtung) {
        // vorhandenes Objekt nutzen
        window.em.löscheBeob_2()
      } else {
        // Objekt aus DB holen
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.BeobId, {
          success: function (data) {
            window.em.Beobachtung = data
            window.em.löscheBeob_2()
          },
          error: function () {
            window.em.melde('Fehler: Beobachtung nicht gelöscht')
          }
        })
      }
    }

    window.em.löscheBeob_2 = function () {
      'use strict'
      var $db = $.couch.db('evab')
      $db.removeDoc(window.em.Beobachtung, {
        success: function (data) {
          // Liste anpassen. Vorsicht: Bei refresh kann sie fehlen
          if (window.em.BeobListe) {
            window.em.BeobListe.rows = _.reject(window.em.BeobListe.rows, function (row) {
              return row.doc._id === data.id
            })
          } else {
            // Keine BeobListe mehr. Storage löschen
            window.em.leereStorageBeobListe()
          }
          window.em.leereStorageBeobEdit()
          $.mobile.navigate('BeobListe.html')
        },
        error: function () {
          window.em.melde('Fehler: Beobachtung nicht gelöscht')
        }
      })
    }

    // Speichert alle Daten in BeobEdit.html
    window.em.speichereBeob = function (that) {
      'use strict'
      // eventhandler übergeben this nicht in der Klammer
      var _this = that || this
      // prüfen, ob Beob als Objekt vorliegt
      if (window.em.Beobachtung) {
        // ja: dieses Objekt verwenden
        window.em.speichereBeob_2(_this)
      } else {
        // nein: Beob aus DB holen
        var $db = $.couch.db('evab')
        $db.openDoc(window.localStorage.BeobId, {
          success: function (data) {
            window.em.Beobachtung = data
            window.em.speichereBeob_2(_this)
          },
          error: function () {
            console.log('Fehler in function speichereBeob_2(_this)')
          }
        })
      }
    }

    window.em.speichereBeob_2 = function (that) {
      'use strict'
      var FeldnameDb,
        Feldwert,
        feldinfos
      // Feldname und -wert ermitteln
      feldinfos = window.em.holeFeldInfosVonElement(that)
      FeldnameDb = feldinfos.feldname_db
      Feldwert = feldinfos.feldwert
      // Werte aus dem Formular aktualisieren
      if (Feldwert) {
        if (window.em.myTypeOf(Feldwert) === 'float') {
          window.em.Beobachtung[FeldnameDb] = parseFloat(Feldwert)
        } else if (window.em.myTypeOf(Feldwert) === 'integer') {
          window.em.Beobachtung[FeldnameDb] = parseInt(Feldwert)
        } else {
          window.em.Beobachtung[FeldnameDb] = Feldwert
        }
      } else if (window.em.Beobachtung[FeldnameDb]) {
        delete window.em.Beobachtung[FeldnameDb]
      }
      window.em.Beobachtung.aArtGruppe = window.localStorage.aArtGruppe
      window.em.Beobachtung.aArtName = window.localStorage.aArtName
      window.em.Beobachtung.aArtId = window.localStorage.aArtId
      // alles speichern
      var $db = $.couch.db('evab')
      $db.saveDoc(window.em.Beobachtung, {
        success: function (data) {
          window.em.Beobachtung._rev = data.rev
        },
        error: function () {
          console.log('Fehler in function speichereBeob_2(that)')
        }
      })
    }

    window.em.meldeNeuAn = function () {
      'use strict'
      window.localStorage.UserStatus = 'neu'
      $.mobile.changePage('index.html')
      // Felder zurücksetzen, sonst ist hier noch die alte Anmeldung drin
      $('#Email').val('')
      $('#Passwort').val('')
    }

    window.em.handleArtenImportierenPageshow = function () {
      'use strict'
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
      }
      window.em.initiiereArtenImportieren()
    }

    window.em.handleArtenImportierenPageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
      }

      $('#ArtenImportierenHeader')
        // zurück-Button steuern
        .on('click', '#zurückArtenImportieren', function (event) {
          event.preventDefault()
          window.em.handleArtenImportierenZurückClick()
        })

      $('#ArtenImportierenContent')
        .on('click', '#ai_arten_ohne_artgruppe_entfernen', window.em.entferneArtenOhneArtgruppe)
        .on('click', '#ai_gemeinsam_anzarten_aktualisieren', window.em.aktualisiereAnzahlArtenVonArten)
        .on('click', '#ai_fehlen_in_evab_importieren', window.em.importiereFehlendeArten)
        .on('click', '#ai_fehlen_in_artendb_exportieren', window.em.exportiereBeobVonInArtendbFehlendenArten)
    }

    window.em.importiereFehlendeArten = function () {
      'use strict'
      if (window.em.arten_fehlen_in_evab.length === 0) {
        window.em.melde('Aktion abgebrochen: Es gibt in arteigenschaften.ch keine Arten, die in artbeobachtungen.ch fehlen')
        return
      }
      var $db = $.couch.db('evab')
      _.each(window.em.arten_fehlen_in_evab, function (art) {
        $db.saveDoc(art, {
          success: function () {
            // window.em.initiiereArtenImportieren()
          },
          error: function () {
            window.em.melde('Fehler: Art ' + art.Artname + ' nicht importiert')
          }
        })
      })
    }

    window.em.aktualisiereAnzahlArtenVonArten = function () {
      'use strict'
      window.em.melde('Diese Funktion ist noch nicht implementiert')
    }

    window.em.exportiereBeobVonInArtendbFehlendenArten = function () {
      'use strict'
      window.em.melde('Diese Funktion ist noch nicht implementiert')
    }

    // PROVISORISCH, NACH BENUTZUNG ENTFERNEN
    window.em.entferneArtenOhneArtgruppe = function () {
      'use strict'
      var $db = $.couch.db('evab')
      $db.view('evab/ArtenOhneArtgruppe?include_docs=true', {
        success: function (data) {
          if (data.rows.length === 0) {
            window.em.melde('Es gibt keine Arten ohne Artgruppe')
            return
          }
          var arten_ohne_artgruppe = _.map(data.rows, function (objekt) {
            return objekt.doc
          })
          _.each(arten_ohne_artgruppe, function (art) {
            $db.removeDoc(art, {
              error: function () {
                console.log('Fehler: ' + art.Artname + ' nicht gelöscht')
              }
            })
          })
        }
      })
    }

    window.em.handleArtenImportierenZurückClick = function () {
      'use strict'
      // sicherstellen, dass er immer ein zurück kennt
      if (!window.localStorage.zurueck) {
        window.localStorage.zurueck = 'BeobListe'
      }
      $.mobile.navigate(window.localStorage.zurueck + '.html')
      delete window.localStorage.zurueck
    }

    window.em.initiiereArtenImportieren = function () {
      'use strict'
      // aktuelle aus evm holen
      $.ajax({
        type: 'GET',
        url: 'http://arteigenschaften.ch/_list/export_evm_arten/evab_arten?include_docs=true',
        contentType: 'application/json'
      })
        .done(function (data) {
          data = JSON.parse(data)
          window.em.arten_artendb = data.docs
          var arten_artendb_reduziert = window.em.reduziereArtenfelderAufArtgruppeUndName(window.em.arten_artendb)
          // Tabelle aufbauen
          $('#ai_artendb').html(window.em.erstelleTabelle(arten_artendb_reduziert, 'reflow', 'ai_artendb_tabelle'))
          // initialisieren
          $('#ai_artendb_tabelle').table()
          // Anzahl anzeigen
          $('#ai_artendb_titel').html('Erste 50 von ' + window.em.arten_artendb.length + ' Arten aus arteigenschaften.ch:')

          // eigene Arten holen
          console.log('hole Arten aus evab')
          var $db = $.couch.db('evab')
          $db.view('evab/Artliste?include_docs=true', {
            success: function (data) {
              // Arten in evab ermitteln
              console.log('verarbeite Arten aus evab')
              window.em.arten_evab = _.map(data.rows, function (objekt) {
                return objekt.doc
              })
              var arten_evab_reduziert = window.em.reduziereArtenfelderAufArtgruppeUndName(window.em.arten_evab)
              // Tabelle aufbauen
              $('#ai_evab').html(window.em.erstelleTabelle(arten_evab_reduziert, 'reflow', 'ai_evab_tabelle'))
              // initialisieren
              $('#ai_evab_tabelle').table()
              // Anzahl anzeigen
              $('#ai_evab_titel').html('Erste 50 von ' + window.em.arten_evab.length + ' Arten aus artbeobachtungen.ch:')

              // gemeinsame Arten mit unterschiedlichem Namen oder Artgruppe ermitteln
              console.log('suche Arten mit Unterschieden')
              window.em.arten_gemeinsam_unterschiedlich = _.filter(window.em.arten_artendb, function (art_artendb) {
                for (var i in window.em.arten_evab) {
                  var art_evab = window.em.arten_evab[i]
                  if (art_evab._id === art_artendb._id && (art_evab.ArtGruppe !== art_artendb.ArtGruppe || art_evab.Artname !== art_artendb.Artname)) {
                    return true
                  }
                }
              })
              if (window.em.arten_gemeinsam_unterschiedlich.length > 0) {
                var arten_gemeinsam_unterschiedlich_reduziert = window.em.reduziereArtenfelderAufArtgruppeUndName(window.em.arten_gemeinsam_unterschiedlich)
                // Tabelle aufbauen
                $('#ai_arten_gemeinsam_unterschiedlich').html(window.em.erstelleTabelle(arten_gemeinsam_unterschiedlich_reduziert, 'reflow', 'ai_arten_gemeinsam_unterschiedlich_tabelle'))
                // initialisieren
                $('#ai_arten_gemeinsam_unterschiedlich_tabelle').table()
                // Schaltfläche einschalten
                $('#ai_arten_gemeinsam_unterschiedlich_aktualisieren').button('enable')
              } else {
                // p mitliefern, damit der Text gleich eingerückt wird, wie der Titel darüber
                $('#ai_arten_gemeinsam_unterschiedlich').html('<p>Erfolg:<br>Alle gemeinsamen Arten haben denselben Namen und dieselbe Artgruppe!</p>')
                $('#ai_arten_gemeinsam_unterschiedlich_aktualisieren').button('disable')
              }
              // Anzahl anzeigen
              $('#ai_arten_gemeinsam_unterschiedlich_titel').html('Erste 50 von ' + window.em.arten_gemeinsam_unterschiedlich.length + ' gemeinsamen Arten<br>mit unterschiedlicher Artgruppe oder Artname:')

              // Arten aus artendb, die in evab fehlen
              console.log('suche Arten, die in evab fehlen')
              window.em.arten_fehlen_in_evab = _.reject(window.em.arten_artendb, function (art_artendb) {
                for (var i in window.em.arten_evab) {
                  if (window.em.arten_evab[i]._id === art_artendb._id) {
                    return true
                  }
                }
              })
              if (window.em.arten_fehlen_in_evab.length > 0) {
                var arten_fehlen_in_evab_reduziert = window.em.reduziereArtenfelderAufArtgruppeUndName(window.em.arten_fehlen_in_evab)
                // Tabelle aufbauen
                $('#ai_fehlen_in_evab').html(window.em.erstelleTabelle(arten_fehlen_in_evab_reduziert, 'reflow', 'ai_fehlen_in_evab_tabelle'))
                // initialisieren
                $('#ai_fehlen_in_evab_tabelle').table()
                // Schaltfläche einschalten
                $('#ai_fehlen_in_evab_importieren').button('enable')
              } else {
                // p mitliefern, damit der Text gleich eingerückt wird, wie der Titel darüber
                $('#ai_fehlen_in_evab').html('<p>Erfolg:<br>artbeobachtungen.ch enthält schon alle Arten aus arteigenschaften.ch!</p>')
                $('#ai_fehlen_in_evab_importieren').button('disable')
              }
              // Anzahl anzeigen
              $('#ai_fehlen_in_evab_titel').html('Erste 50 von ' + window.em.arten_fehlen_in_evab.length + ' Arten aus arteigenschaften.ch, die in artbeobachtungen.ch fehlen:')

              // Arten aus evab, die in artendb fehlen
              console.log('suche Arten, die in artendb fehlen')
              window.em.arten_fehlen_in_artendb = _.reject(window.em.arten_evab, function (art_evab) {
                // eigene und unbekannte Arten ignorieren
                if (art_evab.Artname.substring(0, 6) === 'Eigene' || art_evab.Artname.substring(0, 9) === 'Unbekannt') {
                  return true
                }
                for (var i in window.em.arten_artendb) {
                  if (window.em.arten_artendb[i]._id === art_evab._id) {
                    return true
                  }
                }
              })
              if (window.em.arten_fehlen_in_artendb.length > 0) {
                var arten_fehlen_in_artendb_reduziert = window.em.reduziereArtenfelderAufArtgruppeUndName(window.em.arten_fehlen_in_artendb)
                // Tabelle aufbauen
                $('#ai_fehlen_in_artendb').html(window.em.erstelleTabelle(arten_fehlen_in_artendb_reduziert, 'reflow', 'ai_fehlen_in_artendb_tabelle'))
                // initialisieren
                $('#ai_fehlen_in_artendb_tabelle').table()
                // Schaltfläche einschalten
                $('#ai_fehlen_in_artendb_exportieren').button('enable')
                $('#ai_fehlen_in_artendb_exportieren_hinweis').show()
              } else {
                // p mitliefern, damit der Text gleich eingerückt wird, wie der Titel darüber
                $('#ai_fehlen_in_artendb').html('<p>Erfolg:<br>artbeobachtungen.ch enthält keine Arten, die in arteigenschaften.ch nicht vorkommen!</p>')
                $('#ai_fehlen_in_artendb_exportieren').button('disable')
                $('#ai_fehlen_in_artendb_exportieren_hinweis').hide()
              }
              // Anzahl anzeigen
              $('#ai_fehlen_in_artendb_titel').html('Erste 50 von ' + window.em.arten_fehlen_in_artendb.length + ' Arten aus artbeobachtungen.ch, die in arteigenschaften.ch fehlen:')
            }
          })
        })
        .fail(function () {
          console.log('Fehler: keine Arten erhalten')
        })
    }

    window.em.reduziereArtenfelderAufArtgruppeUndName = function (arten) {
      'use strict'
      // da es soviele Arten gibt, nur die ersten 50 verarbeiten und anzeigen
      var erste_fünfzig_arten = _.first(arten, 50)
      return _.map(erste_fünfzig_arten, function (art) {
        var art_return = {}
        art_return.Artgruppe = art.ArtGruppe
        art_return.Artname = art.Artname
        return art_return
      })
    }

    window.em.handleArtengruppenImportierenPageshow = function () {
      'use strict'
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
      }
      window.em.initiiereArtengruppenImportieren()
    }

    window.em.handleArtengruppenImportierenPageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
      }

      $('#ArtengruppenImportierenHeader')
        // zurück-Button steuern
        .on('click', '#zurückArtengruppenImportieren', function (event) {
          event.preventDefault()
          window.em.handleArtengruppenImportierenZurückClick()
        })

      $(document)
        .on('click', '#agi_gemeinsam_anzarten_aktualisieren', window.em.aktualisiereAnzahlArtenVonArtengruppen)

      $('#ArtengruppenImportierenContent')
        .on('click', '#agi_fehlen_in_evab_importieren', window.em.importiereFehlendeArtengruppen)
        .on('click', '#agi_fehlen_in_artendb_exportieren', window.em.exportiereBeobVonInArtendbFehlendenArtengruppen)
    }

    window.em.exportiereBeobVonInArtendbFehlendenArtengruppen = function () {
      'use strict'
      console.log('window.em.exportiereBeobVonInArtendbFehlendenArtengruppen')
    }

    window.em.importiereFehlendeArtengruppen = function () {
      'use strict'
      if (window.em.artgruppen_fehlen_in_evab.length === 0) {
        window.em.melde('Aktion abgebrochen: Es gibt in arteigenschaften.ch keine Artengruppen, die in artbeobachtungen.ch fehlen')
        return
      }
      var $db = $.couch.db('evab')
      _.each(window.em.artgruppen_fehlen_in_evab, function (artgruppe) {
        $db.saveDoc(artgruppe, {
          success: function () {
            window.em.initiiereArtengruppenImportieren()
          },
          error: function () {
            window.em.melde('Fehler: Artgruppe ' + artgruppe_artendb.ArtGruppe + ' nicht aktualisiert')
          }
        })
      })
    }

    window.em.aktualisiereAnzahlArtenVonArtengruppen = function () {
      'use strict'
      if (window.em.artgruppen_gemeinsam_anzarten.length === 0) {
        window.em.melde('Aktion abgebrochen: Es gibt keine gemeinsamen Artengruppen mit unterschiedlicher Anzahl Arten')
        return
      }
      var $db = $.couch.db('evab')
      _.each(window.em.artgruppen_gemeinsam_anzarten, function (artgruppe_artendb) {
        $db.openDoc(artgruppe_artendb._id, {
          success: function (artgruppe_evab) {
            artgruppe_evab.AnzArten = artgruppe_artendb.AnzArten
            $db.saveDoc(artgruppe_evab, {
              success: function () {
                window.em.initiiereArtengruppenImportieren()
              },
              error: function () {
                window.em.melde('Fehler: Artgruppe ' + artgruppe_artendb.ArtGruppe + ' nicht aktualisiert')
              }
            })
          },
          error: function () {
            window.em.melde('Fehler: Artgruppe ' + artgruppe_artendb.ArtGruppe + ' nicht aktualisiert')
          }
        })

      })
    }

    window.em.handleArtengruppenImportierenZurückClick = function () {
      'use strict'
      // sicherstellen, dass er immer ein zurück kennt
      if (!window.localStorage.zurueck) {
        window.localStorage.zurueck = 'BeobListe'
      }
      $.mobile.navigate(window.localStorage.zurueck + '.html')
      delete window.localStorage.zurueck
    }

    window.em.öffneArtengruppenImportieren = function () {
      'use strict'
      window.localStorage.zurueck = $('body').pagecontainer('getActivePage').attr('id')
      $.mobile.navigate('ArtengruppenImportieren.html')
    }

    window.em.öffneAdmin = function () {
      'use strict'
      window.localStorage.zurueck = $('body').pagecontainer('getActivePage').attr('id')
      $.mobile.navigate('admin.html')
    }

    window.em.handleAdminPageshow = function () {
      'use strict'
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
      }
    // window.em.initiiereAdmin()
    }

    window.em.handleAdminPageinit = function () {
      'use strict'
      // Wird diese Seite direkt aufgerufen und es gibt keinen window.localStorage,
      // muss auf index.html umgeleitet werden
      if (window.localStorage.length === 0 || !window.localStorage.Email) {
        window.em.leereAlleVariabeln()
        $.mobile.navigate('index.html')
      }

      $('#AdminHeader')
        // zurück-Button steuern
        .on('click', '#zurückAdmin', function (event) {
          event.preventDefault()
          window.em.handleAdminZurückClick()
        })

      $('#AdminContent')
        .on('click', '#admin_beob_eines_users_entfernen', window.em.entferneDokumenteEinesUsers)
        .on('click', '#admin_user_entfernen', window.em.entferneUser)
    }

    window.em.handleAdminZurückClick = function () {
      'use strict'
      // sicherstellen, dass er immer ein zurück kennt
      if (!window.localStorage.zurueck) {
        window.localStorage.zurueck = 'BeobListe'
      }
      $.mobile.navigate(window.localStorage.zurueck + '.html')
      delete window.localStorage.zurueck
    }

    window.em.entferneDokumenteEinesUsers = function () {
      'use strict'
      var user = $('#admin_beob_eines_users_entfernen_user').val()
      if (!user) {
        window.em.melde('Bitte User eingeben')
        return
      }
      var $db = $.couch.db('evab')
      $db.view('evab/UserDocs?key="' + user + '"&descending=true&include_docs=true&reduce=false', {
        success: function (data) {
          var dokumenten = data.rows,
            fehler = 0,
            gelöscht = 0
          $('#admin_user_entfernen_rückmeldung').html('Dokumente: Gelöscht: ' + gelöscht + ', Fehler: ' + fehler + ' von ' + dokumenten.length)
          _.each(dokumenten, function (doc) {
            $db.removeDoc(doc.doc, {
              success: function () {
                gelöscht++
                $('#admin_user_entfernen_rückmeldung').html('Dokumente: Gelöscht: ' + gelöscht + ', Fehler: ' + fehler + ' von ' + dokumenten.length)
              },
              error: function () {
                fehler++
                $('#admin_user_entfernen_rückmeldung').html('Dokumente: Gelöscht: ' + gelöscht + ', Fehler: ' + fehler + ' von ' + dokumenten.length)

              }
            })
          })

          // Bezug zu Usern aus Feldern entfernen (username in Arrays)
          $db.view('evab/UserFelderMitDaten?key="' + user + '"&descending=true&include_docs=true&reduce=false', {
            success: function (data) {
              var felder = data.rows,
                fehler = 0,
                gelöscht = 0

              $('#admin_user_entfernen_rückmeldung2').html('Einstellungen in Feldern: Gelöscht: ' + gelöscht + ', Fehler: ' + fehler + ' von ' + felder.length)

              _.each(felder, function (feld) {
                feld = feld.doc

                // User aus SichtbarImModusEinfach entfernen
                if (feld.SichtbarImModusEinfach && feld.SichtbarImModusEinfach.length > 0) {
                  feld.SichtbarImModusEinfach = _.without(feld.SichtbarImModusEinfach, user)
                }

                // User aus SichtbarImModusHierarchisch entfernen
                if (feld.SichtbarImModusHierarchisch && feld.SichtbarImModusHierarchisch.length > 0) {
                  feld.SichtbarImModusHierarchisch = _.without(feld.SichtbarImModusHierarchisch, user)
                }

                // User aus SichtbarInHArtEditListe entfernen
                if (feld.SichtbarInHArtEditListe && feld.SichtbarInHArtEditListe.length > 0) {
                  feld.SichtbarInHArtEditListe = _.without(feld.SichtbarInHArtEditListe, user)
                }

                // User aus Standardwert entfernen
                if (feld.Standardwert && feld.Standardwert[user]) {
                  delete feld.Standardwert[user]
                }

                $db.saveDoc(feld, {
                  success: function () {
                    gelöscht++
                    $('#admin_user_entfernen_rückmeldung2').html('Einstellungen in Feldern: Gelöscht: ' + gelöscht + ', Fehler: ' + fehler + ' von ' + felder.length)
                  },
                  error: function () {
                    fehler++
                    $('#admin_user_entfernen_rückmeldung2').html('Einstellungen in Feldern: Gelöscht: ' + gelöscht + ', Fehler: ' + fehler + ' von ' + felder.length)
                  }
                })
              })
            },
            error: function () {
              window.em.melde('Die Felder konnten nicht abgerufen werden')
            }
          })

        },
        error: function () {
          window.em.melde('Die Dokumente des Benutzers konnten nicht abgerufen werden')
        }
      })
    }

    window.em.entferneUser = function () {
      'use strict'
      var user = $('#admin_user_entfernen_user').val()
      if (!user) {
        window.em.melde('Bitte User eingeben')
        return
      }
      // Kontrollieren, ob der User noch Dokumente hat
      var $db = $.couch.db('evab')
      $db.view('evab/UserDocs?key="' + user + '"&descending=true&include_docs=true&reduce=false', {
        success: function (data) {
          if (data.rows.length > 0) {
            window.em.melde('Dieser User hat noch Dokumente. Bitte diese zuerst entfernen')
            return
          }
          // kontrollieren, ob der User noch Feldeinstellungen hat
          $db.view('evab/UserFelderMitDaten?key="' + user + '"&descending=true&include_docs=true&reduce=false', {
            success: function (data) {
              if (data.rows.length > 0) {
                window.em.melde('Dieser User hat noch Einstellungen in Feldern. Bitte diese zuerst entfernen')
                return
              }
              // der Benutzer hat keine Daten mehr. Benutzer entfernen
              $.couch.userDb(function (db) {
                db.openDoc('org.couchdb.user:' + user, {
                  success: function (doc) {
                    db.removeDoc(doc, {
                      success: function () {
                        window.em.melde('Benutzer ' + user + ' wurde entfernt')
                      },
                      error: function () {
                        window.em.melde('Fehler: Benutzer ' + user + ' wurde nicht entfernt')
                      }
                    })
                  },
                  error: function () {
                    window.em.melde('Fehler: User wurde nicht gefunden')
                  }
                })
              })
            },
            error: function () {
              window.em.melde('Die Felder konnten nicht abgerufen werden')
            }
          })
        },
        error: function () {
          window.em.melde('Fehler: Es konnte nicht kontrolliert werden, ob der Benutzer noch Beobachtungen hat')
        }
      })
    }

    window.em.initiiereArtengruppenImportieren = function () {
      'use strict'
      // aktuelle aus evm holen
      $.ajax({
        type: 'GET',
        url: 'http://arteigenschaften.ch/_list/export_evm_artgruppen/artgruppen?group_level=1',
        contentType: 'application/json'
      })
        .done(function (data) {
          data = JSON.parse(data)
          window.em.artgruppen_artendb = data.docs
          var artgruppen_artendb_reduziert = window.em.reduziereArtgruppenfelderAufArtgruppeUndAnzahl(window.em.artgruppen_artendb)
          // Tabelle aufbauen
          $('#agi_artendb').html(window.em.erstelleTabelle(artgruppen_artendb_reduziert, 'reflow', 'agi_artendb_tabelle'))
          // initialisieren
          $('#agi_artendb_tabelle').table()
          // Anzahl anzeigen
          $('#agi_artendb_titel').html('In arteigenschaften.ch<br>vorhandene Artengruppen (' + artgruppen_artendb_reduziert.length + '):')
          // eigene Artgruppen holen
          var $db = $.couch.db('evab')
          $db.view('evab/Artgruppen?include_docs=true', {
            success: function (data) {
              // Artgruppen in evab ermitteln
              window.em.artgruppen_evab = _.map(data.rows, function (objekt) {
                return objekt.doc
              })
              var artgruppen_evab_reduziert = window.em.reduziereArtgruppenfelderAufArtgruppeUndAnzahl(window.em.artgruppen_evab)
              // Tabelle aufbauen
              $('#agi_evab').html(window.em.erstelleTabelle(artgruppen_evab_reduziert, 'reflow', 'agi_evab_tabelle'))
              // initialisieren
              $('#agi_evab_tabelle').table()
              // Anzahl anzeigen
              $('#agi_evab_titel').html('In artbeobachtungen.ch<br>vorhandene Artengruppen (' + artgruppen_evab_reduziert.length + '):')

              // gemeinsame Artgruppen ermitteln
              window.em.artgruppen_gemeinsam = _.filter(window.em.artgruppen_evab, function (artgruppe_evab) {
                return _.filter(window.em.artgruppen_artendb, _.matches(artgruppe_evab))
              })
              if (window.em.artgruppen_gemeinsam.length > 0) {
                var artgruppen_gemeinsam_reduziert = window.em.reduziereArtgruppenfelderAufArtgruppeUndAnzahl(window.em.artgruppen_gemeinsam)
                // Tabelle aufbauen
                $('#agi_gemeinsam').html(window.em.erstelleTabelle(artgruppen_gemeinsam_reduziert, 'reflow', 'agi_gemeinsam_tabelle'))
                // initialisieren
                $('#agi_gemeinsam_tabelle').table()
              } else {
                $('#agi_gemeinsam').html('<p>Oops: Es gibt keine gemeinsamen Artgruppen!</p>')
              }
              // Anzahl anzeigen
              $('#agi_gemeinsam_titel').html('Gemeinsame<br>Artengruppen (' + window.em.artgruppen_gemeinsam.length + '):')

              // gemeinsame Artengruppen mit unterschiedlicher Anzahl Arten ermitteln
              window.em.artgruppen_gemeinsam_anzarten = _.filter(window.em.artgruppen_artendb, function (artgruppe_artendb) {
                for (var i in window.em.artgruppen_evab) {
                  if (window.em.artgruppen_evab[i].ArtGruppe === artgruppe_artendb.ArtGruppe && window.em.artgruppen_evab[i].AnzArten !== artgruppe_artendb.AnzArten) {
                    return true
                  }
                }
              })
              var artgruppen_gemeinsam_anzarten_reduziert = _.map(window.em.artgruppen_gemeinsam_anzarten, function (artgruppe) {
                var artgruppe_return = {}
                artgruppe_return.Artgruppe = artgruppe.ArtGruppe
                return artgruppe_return
              })
              if (window.em.artgruppen_gemeinsam_anzarten.length > 0) {
                // Tabelle aufbauen
                $('#agi_gemeinsam_anzarten').html(window.em.erstelleTabelle(artgruppen_gemeinsam_anzarten_reduziert, 'reflow', 'agi_gemeinsam_anzarten_tabelle'))
                // initialisieren
                $('#agi_gemeinsam_anzarten_tabelle').table()
                // Schaltfläche einschalten
                $('#agi_gemeinsam_anzarten_aktualisieren').button('enable')
              } else {
                // p mitliefern, damit der Text gleich eingerückt wird, wie der Titel darüber
                $('#agi_gemeinsam_anzarten').html('<p>Erfolg:<br>Alle gemeinsamen Artengruppen weisen dieselbe Anzahl Arten aus!</p>')
                $('#agi_gemeinsam_anzarten_aktualisieren').button('disable')
              }
              // Anzahl anzeigen
              $('#agi_gemeinsam_anzarten_titel').html('Gemeinsame Artengruppen<br>mit unterschiedlicher Anz. Arten (' + window.em.artgruppen_gemeinsam_anzarten.length + '):')

              // Artengruppen aus artendb, die in evab fehlen
              window.em.artgruppen_fehlen_in_evab = _.reject(window.em.artgruppen_artendb, function (artgruppe_artendb) {
                for (var i in window.em.artgruppen_evab) {
                  if (window.em.artgruppen_evab[i].ArtGruppe === artgruppe_artendb.ArtGruppe) {
                    return true
                  }
                }
              })
              if (window.em.artgruppen_fehlen_in_evab.length > 0) {
                var artgruppen_fehlen_in_evab_reduziert = window.em.reduziereArtgruppenfelderAufArtgruppeUndAnzahl(window.em.artgruppen_fehlen_in_evab)
                // Tabelle aufbauen
                $('#agi_fehlen_in_evab').html(window.em.erstelleTabelle(artgruppen_fehlen_in_evab_reduziert, 'reflow', 'agi_fehlen_in_evab_tabelle'))
                // initialisieren
                $('#agi_fehlen_in_evab_tabelle').table()
                // Schaltfläche einschalten
                $('#agi_fehlen_in_evab_importieren').button('enable')
              } else {
                // p mitliefern, damit der Text gleich eingerückt wird, wie der Titel darüber
                $('#agi_fehlen_in_evab').html('<p>Erfolg:<br>artbeobachtungen.ch enthält schon alle Artgruppen aus arteigenschaften.ch!</p>')
                $('#agi_fehlen_in_evab_importieren').button('disable')
              }
              // Anzahl anzeigen
              $('#agi_fehlen_in_evab_titel').html('Artengruppen aus arteigenschaften.ch,<br>die in artbeobachtungen.ch fehlen (' + window.em.artgruppen_fehlen_in_evab.length + '):')

              // Artengruppen aus evab, die in artendb fehlen
              window.em.artgruppen_fehlen_in_artendb = _.reject(window.em.artgruppen_evab, function (artgruppe_evab) {
                for (var i in window.em.artgruppen_artendb) {
                  if (window.em.artgruppen_artendb[i].ArtGruppe === artgruppe_evab.ArtGruppe) {
                    return true
                  }
                }
              })
              if (window.em.artgruppen_fehlen_in_artendb.length > 0) {
                var artgruppen_fehlen_in_artendb_reduziert = window.em.reduziereArtgruppenfelderAufArtgruppeUndAnzahl(window.em.artgruppen_fehlen_in_artendb)
                // Tabelle aufbauen
                $('#agi_fehlen_in_artendb').html(window.em.erstelleTabelle(artgruppen_fehlen_in_artendb_reduziert, 'reflow', 'agi_fehlen_in_artendb_tabelle'))
                // initialisieren
                $('#agi_fehlen_in_artendb_tabelle').table()
                // Schaltfläche einschalten
                $('#agi_fehlen_in_artendb_exportieren').button('enable')
                $('#agi_fehlen_in_artendb_exportieren_hinweis').show()
              } else {
                // p mitliefern, damit der Text gleich eingerückt wird, wie der Titel darüber
                $('#agi_fehlen_in_artendb').html('<p>Erfolg:<br>artbeobachtungen.ch enthält keine Artgruppen, die in arteigenschaften.ch nicht vorkommen!</p>')
                $('#agi_fehlen_in_artendb_exportieren').button('disable')
                $('#agi_fehlen_in_artendb_exportieren_hinweis').hide()
              }
              // Anzahl anzeigen
              $('#agi_fehlen_in_artendb_titel').html('Artengruppen aus artbeobachtungen.ch,<br>die in arteigenschaften.ch fehlen (' + window.em.artgruppen_fehlen_in_artendb.length + '):')
            }
          })
        })
        .fail(function () {
          console.log('Fehler: keine Artgruppen erhalten')
        })
    }

    window.em.reduziereArtgruppenfelderAufArtgruppeUndAnzahl = function (artgruppen) {
      'use strict'
      return _.map(artgruppen, function (artgruppe) {
        var artgruppe_return = {}
        artgruppe_return.Artgruppe = artgruppe.ArtGruppe
        artgruppe_return['Anz. Arten'] = artgruppe.AnzArten
        return artgruppe_return
      })
    }

    // baut Tabellen auf
    // objekte: Array von Objekten, welche die darzustellenden Felder enthalten
    // datamode: gemäss jqm, standard = reflow
    // table_id: die ID wird benötigt, damit die Tabelle nach ihrer Erstellung initiiert werden kann
    // class: Klasse, welche die Darstellung bestimmt. Standard ist: tabelle_gestreift
    window.em.erstelleTabelle = function (objekte, datamode, table_id, css_class) {
      'use strict'
      var html,
        datamode = datamode || 'reflow',
        css_class = css_class || 'tabelle_gestreift'
      // html für Tabellen-div
      html = '<table data-role="table"'
      if (table_id) {
        html += ' id="' + table_id + '"'
      }
      html += ' data-mode="' + datamode + '" class="ui-responsive ' + css_class + '">'
      // html für die erste Zeile beginnen
      html += '<thead><tr>'
      // html für die Spalten, Biespiel: <th>Artgruppe</th><th>Anzahl Arten</th>
      _.each(_.first(objekte), function (value, key) {
        html += '<th>' + key + '</th>'
      })
      // html für die erste Zeile abschliessen
      html += '</tr></thead>'
      // Tabellenbody beginnen
      html += '<tbody>'
      // jede Zeile 
      _.each(objekte, function (objekt) {
        html += '<tr>'
        // alle Spalten
        _.each(objekt, function (value) {
          html += '<td>' + value + '</td>'
        })
        html += '</tr>'
      })
      // Tabellen-body und div abschliessen
      html += '</tbody></table>'
      return html
    }

    window.em.öffneArtenImportieren = function () {
      'use strict'
      window.localStorage.zurueck = $('body').pagecontainer('getActivePage').attr('id')
      $.mobile.navigate('ArtenImportieren.html')
    }

    /*!
    * jQuery Mobile Framework : drag pagination plugin
    * Copyright (c) Filament Group, Inc
    * Authored by Scott Jehl, scott@filamentgroup.com
    * Dual licensed under the MIT or GPL Version 2 licenses.
    */
    (function ($, undefined) {
      // auto-init on pagecreate
      $(document).bind('pagecreate', function (e) {
        $(":jqmData(role='pagination')", e.target).pagination()
      })

      var pageTitle = ''

      // create widget
      $.widget('mobile.pagination', $.mobile.widget, {
        _create: function () {
          var $el = this.element,
            $page = $el.closest('.ui-page'),
            $links = $el.find('a'),
            $origin = $.mobile.pageContainer,
            classNS = 'ui-pagination',
            prevLIClass = classNS + '-prev',
            nextLIClass = classNS + '-next',
            prevPClass = 'ui-page-prev',
            nextPClass = 'ui-page-next',
            snapClass = classNS + '-snapping',
            dragClass = classNS + '-dragging',
            dragClassOn = false,
            $nextPage,
            $prevPage

          $el.addClass(classNS)

          // set up next and prev buttons

          $links.each(function () {
            var reverse = $(this).closest('.' + prevLIClass).length

            $(this)
              .buttonMarkup({
                'role': 'button',
                'theme': 'd',
                'iconpos': 'notext',
                'icon': 'arrow-' + (reverse ? 'l' : 'r')
              })
          })
        }
      })

    }(jQuery))

    /*
     * A JavaScript implementation of the Secure Hash Algorithm, SHA-1, as defined
     * in FIPS PUB 180-1
     * Version 2.1a Copyright Paul Johnston 2000 - 2002.
     * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
     * Distributed under the BSD License
     * See http://pajhome.org.uk/crypt/md5 for details.
     */

    /*
     * Configurable variables. You may need to tweak these to be compatible with
     * the server-side, but the defaults work in most cases.
     */
    var hexcase = 0 /* hex output format. 0 - lowercase; 1 - uppercase        */
    var b64pad = '=' /* base-64 pad character. "=" for strict RFC compliance   */
    var chrsz = 8 /* bits per input character. 8 - ASCII; 16 - Unicode      */

    /*
     * These are the functions you'll usually want to call
     * They take string arguments and return either hex or base-64 encoded strings
     */
    function hex_sha1 (s) {return binb2hex(core_sha1(str2binb(s), s.length * chrsz))}
    function b64_sha1 (s) {return binb2b64(core_sha1(str2binb(s), s.length * chrsz))}
    function str_sha1 (s) {return binb2str(core_sha1(str2binb(s), s.length * chrsz))}
    function hex_hmac_sha1 (key, data) { return binb2hex(core_hmac_sha1(key, data))}
    function b64_hmac_sha1 (key, data) { return binb2b64(core_hmac_sha1(key, data))}
    function str_hmac_sha1 (key, data) { return binb2str(core_hmac_sha1(key, data))}

    /*
     * Perform a simple self-test to see if the VM is working
     */
    function sha1_vm_test () {
      return hex_sha1('abc') == 'a9993e364706816aba3e25717850c26c9cd0d89d'
    }

    /*
     * Calculate the SHA-1 of an array of big-endian words, and a bit length
     */
    function core_sha1 (x, len) {
      /* append padding */
      x[len >> 5] |= 0x80 << (24 - len % 32)
      x[((len + 64 >> 9) << 4) + 15] = len

      var w = Array(80)
      var a = 1732584193
      var b = -271733879
      var c = -1732584194
      var d = 271733878
      var e = -1009589776

      for (var i = 0; i < x.length; i += 16) {
        var olda = a
        var oldb = b
        var oldc = c
        var oldd = d
        var olde = e

        for (var j = 0; j < 80; j++) {
          if(j < 16) w[j] = x[i + j]
          else w[j] = rol(w[j - 3] ^ w[j - 8] ^ w[j - 14] ^ w[j - 16], 1)
          var t = safe_add(safe_add(rol(a, 5), sha1_ft(j, b, c, d)),
            safe_add(safe_add(e, w[j]), sha1_kt(j)))
          e = d
          d = c
          c = rol(b, 30)
          b = a
          a = t
        }

        a = safe_add(a, olda)
        b = safe_add(b, oldb)
        c = safe_add(c, oldc)
        d = safe_add(d, oldd)
        e = safe_add(e, olde)
      }
      return Array(a, b, c, d, e)

    }

    /*
     * Perform the appropriate triplet combination function for the current
     * iteration
     */
    function sha1_ft (t, b, c, d) {
      if(t < 20) return (b & c) | ((~b) & d)
      if(t < 40) return b ^ c ^ d
      if(t < 60) return (b & c) | (b & d) | (c & d)
      return b ^ c ^ d
    }

    /*
     * Determine the appropriate additive constant for the current iteration
     */
    function sha1_kt (t) {
      return (t < 20) ? 1518500249 : (t < 40) ? 1859775393 :
        (t < 60) ? -1894007588 : -899497514
    }

    /*
     * Calculate the HMAC-SHA1 of a key and some data
     */
    function core_hmac_sha1 (key, data) {
      var bkey = str2binb(key)
      if(bkey.length > 16) bkey = core_sha1(bkey, key.length * chrsz)

      var ipad = Array(16), opad = Array(16)
      for (var i = 0; i < 16; i++) {
        ipad[i] = bkey[i] ^ 0x36363636
        opad[i] = bkey[i] ^ 0x5C5C5C5C
      }

      var hash = core_sha1(ipad.concat(str2binb(data)), 512 + data.length * chrsz)
      return core_sha1(opad.concat(hash), 512 + 160)
    }

    /*
     * Add integers, wrapping at 2^32. This uses 16-bit operations internally
     * to work around bugs in some JS interpreters.
     */
    function safe_add (x, y) {
      var lsw = (x & 0xFFFF) + (y & 0xFFFF)
      var msw = (x >> 16) + (y >> 16) + (lsw >> 16)
      return (msw << 16) | (lsw & 0xFFFF)
    }

    /*
     * Bitwise rotate a 32-bit number to the left.
     */
    function rol (num, cnt) {
      return (num << cnt) | (num >>> (32 - cnt))
    }

    /*
     * Convert an 8-bit or 16-bit string to an array of big-endian words
     * In 8-bit function, characters >255 have their hi-byte silently ignored.
     */
    function str2binb (str) {
      var bin = Array()
      var mask = (1 << chrsz) - 1
      for (var i = 0; i < str.length * chrsz; i += chrsz)
        bin[i >> 5] |= (str.charCodeAt(i / chrsz) & mask) << (32 - chrsz - i % 32)
      return bin
    }

    /*
     * Convert an array of big-endian words to a string
     */
    function binb2str (bin) {
      var str = ''
      var mask = (1 << chrsz) - 1
      for (var i = 0; i < bin.length * 32; i += chrsz)
        str += String.fromCharCode((bin[i >> 5] >>> (32 - chrsz - i % 32)) & mask)
      return str
    }

    /*
     * Convert an array of big-endian words to a hex string.
     */
    function binb2hex (binarray) {
      var hex_tab = hexcase ? '0123456789ABCDEF' : '0123456789abcdef'
      var str = ''
      for (var i = 0; i < binarray.length * 4; i++) {
        str += hex_tab.charAt((binarray[i >> 2] >> ((3 - i % 4) * 8 + 4)) & 0xF) +
          hex_tab.charAt((binarray[i >> 2] >> ((3 - i % 4) * 8)) & 0xF)
      }
      return str
    }

    /*
     * Convert an array of big-endian words to a base-64 string
     */
    function binb2b64 (binarray) {
      var tab = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
      var str = ''
      for (var i = 0; i < binarray.length * 4; i += 3) {
        var triplet = (((binarray[i >> 2] >> 8 * (3 - i % 4)) & 0xFF) << 16)
          | (((binarray[i + 1 >> 2] >> 8 * (3 - (i + 1) % 4)) & 0xFF) << 8)
          | ((binarray[i + 2 >> 2] >> 8 * (3 - (i + 2) % 4)) & 0xFF)
        for (var j = 0; j < 4; j++) {
          if(i * 8 + j * 6 > binarray.length * 32) str += b64pad
          else str += tab.charAt((triplet >> 6 * (3 - j)) & 0x3F)
        }
      }
      return str
    }

    /*
     * jQuery Mobile Framework : plugin to provide a date and time picker.
     * Copyright (c) JTSage
     * CC 3.0 Attribution.  May be relicensed without permission/notifcation.
     * https://github.com/jtsage/jquery-mobile-datebox
     *
     * Translation by: Chris P. Vigelius <me@cv.gd>, Pascal Hofmann <crowdin>
     *
     */

    jQuery.extend(jQuery.mobile.datebox.prototype.options.lang, {
      'de': {
        setDateButtonLabel: 'speichern',
        setTimeButtonLabel: 'speichern',
        setDurationButtonLabel: 'speichern',
        calTodayButtonLabel: 'heute',
        titleDateDialogLabel: 'Datum wählen',
        titleTimeDialogLabel: 'Zeit wählen',
        daysOfWeek: ['Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag'],
        daysOfWeekShort: ['So', 'Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa'],
        monthsOfYear: ['Januar', 'Februar', 'März', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'],
        monthsOfYearShort: ['Jan', 'Feb', 'Mär', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dez'],
        durationLabel: ['Tage', 'Stunden', 'Minuten', 'Sekunden'],
        durationDays: ['Tag', 'Tage'],
        tooltip: 'Kalender öffnen',
        nextMonth: 'Nächster Monat',
        prevMonth: 'Vorheriger Monat',
        timeFormat: 24,
        // headerFormat: '%A, %B %-d, %Y',
        headerFormat: '%Y-%m-%d',
        dateFieldOrder: ['d', 'm', 'y'],
        timeFieldOrder: ['h', 'i', 'a'],
        slideFieldOrder: ['y', 'm', 'd'],
        dateFormat: '%Y-%m-%d',
        useArabicIndic: false,
        isRTL: false,
        calStartDay: 1,
        clearButton: 'löschen',
        durationOrder: ['d', 'h', 'i', 's'],
        meridiem: ['AM', 'PM'],
        timeOutput: '%k:%M',
        durationFormat: '%Dd %DA, %Dl:%DM:%DS',
        calDateListLabel: 'Weitere Termine'
      }
    })
    jQuery.extend(jQuery.mobile.datebox.prototype.options, {
      useLang: 'de'
    })
  }, {'./util/chToWgsLat': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\chToWgsLat.js','./util/chToWgsLng': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\chToWgsLng.js','./util/ddInChX': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInChX.js','./util/ddInChY': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInChY.js','./util/erstelleNeueUhrzeit': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\erstelleNeueUhrzeit.js','./util/erstelleNeuesDatum': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\erstelleNeuesDatum.js'}],'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\chToWgsLat.js': [function (require, module, exports) {
    /**
     * Convert CH y/x to WGS lat
     * @return {number}
     */

    'use strict'

    module.exports = function (y, x) {
      // Converts militar to civil and to unit = 1000km
      var lat,
        y_aux,
        x_aux

      // Axiliary values (% Bern)
      y_aux = (y - 600000) / 1000000
      x_aux = (x - 200000) / 1000000

      // Process lat
      lat = 16.9023892
        + 3.238272 * x_aux
        - 0.270978 * Math.pow(y_aux, 2)
        - 0.002528 * Math.pow(x_aux, 2)
        - 0.0447 * Math.pow(y_aux, 2) * x_aux
        - 0.0140 * Math.pow(x_aux, 3)

      // Unit 10000" to 1 " and converts seconds to degrees (dec)
      lat = lat * 100 / 36

      return lat
    }
  }, {}],'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\chToWgsLng.js': [function (require, module, exports) {
    /**
     * Convert CH y/x to WGS long
     * @return {number}
     */

    'use strict'

    module.exports = function (y, x) {
      // Converts militar to civil and to unit = 1000km
      var lng,
        y_aux,
        x_aux

      // Axiliary values (% Bern)
      y_aux = (y - 600000) / 1000000
      x_aux = (x - 200000) / 1000000

      // Process long
      lng = 2.6779094
        + 4.728982 * y_aux
        + 0.791484 * y_aux * x_aux
        + 0.1306 * y_aux * Math.pow(x_aux, 2)
        - 0.0436 * Math.pow(y_aux, 3)

      // Unit 10000" to 1 " and converts seconds to degrees (dec)
      lng = lng * 100 / 36

      return lng
    }
  }, {}],'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInChX.js': [function (require, module, exports) {
    /**
     * wandelt decimal degrees (vom GPS) in CH-Landeskoordinaten um
     * @return {number}
     */

    'use strict'

    module.exports = function (breite, länge) {
      var DdInWgs84BreiteGrad = require('./ddInWgs84BreiteGrad'),
        breiteGrad = DdInWgs84BreiteGrad(breite),
        DdInWgs84BreiteMin = require('./ddInWgs84BreiteMin'),
        breiteMin = DdInWgs84BreiteMin(breite),
        DdInWgs84BreiteSec = require('./ddInWgs84BreiteSec'),
        breiteSec = DdInWgs84BreiteSec(breite),
        DdInWgs84LängeGrad = require('./ddInWgs84LaengeGrad'),
        längeGrad = DdInWgs84LängeGrad(länge),
        DdInWgs84LängeMin = require('./ddInWgs84LaengeMin'),
        längeMin = DdInWgs84LängeMin(länge),
        DdInWgs84LängeSec = require('./ddInWgs84LaengeSec'),
        längeSec = DdInWgs84LängeSec(länge),
        Wgs84InChX = require('./wgs84InChX')
      return Math.floor(Wgs84InChX(breiteGrad, breiteMin, breiteSec, längeGrad, längeMin, längeSec))
    }
  }, {'./ddInWgs84BreiteGrad': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInWgs84BreiteGrad.js','./ddInWgs84BreiteMin': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInWgs84BreiteMin.js','./ddInWgs84BreiteSec': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInWgs84BreiteSec.js','./ddInWgs84LaengeGrad': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInWgs84LaengeGrad.js','./ddInWgs84LaengeMin': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInWgs84LaengeMin.js','./ddInWgs84LaengeSec': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInWgs84LaengeSec.js','./wgs84InChX': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\wgs84InChX.js'}],'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInChY.js': [function (require, module, exports) {
    /**
     * wandelt decimal degrees (vom GPS) in CH-Landeskoordinaten um
     * @return {number}
     */

    'use strict'

    module.exports = function (breite, länge) {
      var DdInWgs84BreiteGrad = require('./ddInWgs84BreiteGrad'),
        breiteGrad = DdInWgs84BreiteGrad(breite),
        DdInWgs84BreiteMin = require('./ddInWgs84BreiteMin'),
        breiteMin = DdInWgs84BreiteMin(breite),
        DdInWgs84BreiteSec = require('./ddInWgs84BreiteSec'),
        breiteSec = DdInWgs84BreiteSec(breite),
        DdInWgs84LängeGrad = require('./ddInWgs84LaengeGrad'),
        längeGrad = DdInWgs84LängeGrad(länge),
        DdInWgs84LängeMin = require('./ddInWgs84LaengeMin'),
        längeMin = DdInWgs84LängeMin(länge),
        DdInWgs84LängeSec = require('./ddInWgs84LaengeSec'),
        längeSec = DdInWgs84LängeSec(länge),
        Wgs84InChY = require('./wgs84InChY')
      return Math.floor(Wgs84InChY(breiteGrad, breiteMin, breiteSec, längeGrad, längeMin, längeSec))
    }
  }, {'./ddInWgs84BreiteGrad': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInWgs84BreiteGrad.js','./ddInWgs84BreiteMin': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInWgs84BreiteMin.js','./ddInWgs84BreiteSec': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInWgs84BreiteSec.js','./ddInWgs84LaengeGrad': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInWgs84LaengeGrad.js','./ddInWgs84LaengeMin': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInWgs84LaengeMin.js','./ddInWgs84LaengeSec': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInWgs84LaengeSec.js','./wgs84InChY': 'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\wgs84InChY.js'}],'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInWgs84BreiteGrad.js': [function (require, module, exports) {
    /**
     * wandelt decimal degrees (vom GPS) in WGS84 um
     * @return {number}
     */

    'use strict'

    module.exports = function (Breite) {
      return Math.floor(Breite)
    }
  }, {}],'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInWgs84BreiteMin.js': [function (require, module, exports) {
    /**
     * wandelt Projektionen um
     * @return {number}
     */

    'use strict'

    module.exports = function (Breite) {
      var BreiteGrad = Math.floor(Breite)
      return Math.floor((Breite - BreiteGrad) * 60)
    }
  }, {}],'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInWgs84BreiteSec.js': [function (require, module, exports) {
    /**
     * Konvertiert Projektionen
     * @return {number}
     */

    'use strict'

    module.exports = function (Breite) {
      var BreiteGrad = Math.floor(Breite),
        BreiteMin = Math.floor((Breite - BreiteGrad) * 60)
      return Math.round((((Breite - BreiteGrad) - (BreiteMin / 60)) * 60 * 60) * 100) / 100
    }
  }, {}],'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInWgs84LaengeGrad.js': [function (require, module, exports) {
    /**
     * Konvertiert Projektionen
     * @return {number}
     */

    'use strict'

    module.exports = function (Laenge) {
      return Math.floor(Laenge)
    }
  }, {}],'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInWgs84LaengeMin.js': [function (require, module, exports) {
    /**
     * Konvertiert Projektionen
     * @return {number}
     */

    'use strict'

    module.exports = function (Laenge) {
      var LaengeGrad = Math.floor(Laenge)
      return Math.floor((Laenge - LaengeGrad) * 60)
    }
  }, {}],'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\ddInWgs84LaengeSec.js': [function (require, module, exports) {
    /**
     * Konvertiert Projektionen
     * @return {number}
     */

    'use strict'

    module.exports = function (Laenge) {
      var LaengeGrad = Math.floor(Laenge),
        LaengeMin = Math.floor((Laenge - LaengeGrad) * 60)
      return Math.round((((Laenge - LaengeGrad) - (LaengeMin / 60)) * 60 * 60) * 100) / 100
    }
  }, {}],'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\erstelleNeueUhrzeit.js': [function (require, module, exports) {
    'use strict'

    module.exports = function () {
      var jetzt = new Date(),
        Std = jetzt.getHours(),
        StdAusgabe = ((Std < 10) ? '0' + Std : Std),
        Min = jetzt.getMinutes(),
        MinAusgabe = ((Min < 10) ? '0' + Min : Min),
        Sek = jetzt.getSeconds(),
        SekAusgabe = ((Sek < 10) ? '0' + Sek : Sek)
      return StdAusgabe + ':' + MinAusgabe + ':' + SekAusgabe
    }
  }, {}],'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\erstelleNeuesDatum.js': [function (require, module, exports) {
    'use strict'

    module.exports = function () {
      var jetzt = new Date(),
        Jahr = jetzt.getFullYear(),
        Mnt = jetzt.getMonth() + 1,
        MntAusgabe = ((Mnt < 10) ? '0' + Mnt : Mnt),
        Tag = jetzt.getDate(),
        TagAusgabe = ((Tag < 10) ? '0' + Tag : Tag)
      return Jahr + '-' + MntAusgabe + '-' + TagAusgabe
    }
  }, {}],'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\wgs84InChX.js': [function (require, module, exports) {
    /**
     * Wandelt WGS84 lat/long (° dec) in CH-Landeskoordinaten um
     * @return {number}
     */

    'use strict'

    module.exports = function (breiteGrad, breiteMin, breiteSec, längeGrad, längeMin, längeSec) {
      var lat,
        lng,
        lat_aux,
        lng_aux,
        x

      // Converts degrees dec to sex
      lat = breiteSec + breiteMin * 60 + breiteGrad * 3600
      lng = längeSec + längeMin * 60 + längeGrad * 3600

      // Axiliary values (% Bern)
      lat_aux = (lat - 169028.66) / 10000
      lng_aux = (lng - 26782.5) / 10000

      x = 200147.07
        + 308807.95 * lat_aux
        + 3745.25 * Math.pow(lng_aux, 2)
        + 76.63 * Math.pow(lat_aux, 2)
        - 194.56 * Math.pow(lng_aux, 2) * lat_aux
        + 119.79 * Math.pow(lat_aux, 3)

      return x
    }
  }, {}],'C:\\Users\\alex\\EvabMobile\\vendor\\couchapp\\_attachments\\util\\wgs84InChY.js': [function (require, module, exports) {
    /**
     * Wandelt WGS84 in CH-Landeskoordinaten um
     * @return {number}
     */

    'use strict'

    module.exports = function (breiteGrad, breiteMin, breiteSec, längeGrad, längeMin, läengeSec) {
      var lat,
        lng,
        lat_aux,
        lng_aux,
        y

      // Converts degrees dec to sex
      lat = breiteSec + breiteMin * 60 + breiteGrad * 3600
      lng = läengeSec + längeMin * 60 + längeGrad * 3600

      // Axiliary values (% Bern)
      lat_aux = (lat - 169028.66) / 10000
      lng_aux = (lng - 26782.5) / 10000

      // Process Y
      y = 600072.37
        + 211455.93 * lng_aux
        - 10938.51 * lng_aux * lat_aux
        - 0.36 * lng_aux * Math.pow(lat_aux, 2)
        - 44.54 * Math.pow(lng_aux, 3)

      return y
    }
}, {}]}, {}, ['./vendor/couchapp/_attachments/evab.js'])
// # sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYWxleFxcRXZhYk1vYmlsZVxcbm9kZV9tb2R1bGVzXFxicm93c2VyaWZ5XFxub2RlX21vZHVsZXNcXGJyb3dzZXItcGFja1xcX3ByZWx1ZGUuanMiLCIuL3ZlbmRvci9jb3VjaGFwcC9fYXR0YWNobWVudHMvZXZhYi5qcyIsIkM6L1VzZXJzL2FsZXgvRXZhYk1vYmlsZS92ZW5kb3IvY291Y2hhcHAvX2F0dGFjaG1lbnRzL3V0aWwvY2hUb1dnc0xhdC5qcyIsIkM6L1VzZXJzL2FsZXgvRXZhYk1vYmlsZS92ZW5kb3IvY291Y2hhcHAvX2F0dGFjaG1lbnRzL3V0aWwvY2hUb1dnc0xuZy5qcyIsIkM6L1VzZXJzL2FsZXgvRXZhYk1vYmlsZS92ZW5kb3IvY291Y2hhcHAvX2F0dGFjaG1lbnRzL3V0aWwvZGRJbkNoWC5qcyIsIkM6L1VzZXJzL2FsZXgvRXZhYk1vYmlsZS92ZW5kb3IvY291Y2hhcHAvX2F0dGFjaG1lbnRzL3V0aWwvZGRJbkNoWS5qcyIsIkM6L1VzZXJzL2FsZXgvRXZhYk1vYmlsZS92ZW5kb3IvY291Y2hhcHAvX2F0dGFjaG1lbnRzL3V0aWwvZGRJbldnczg0QnJlaXRlR3JhZC5qcyIsIkM6L1VzZXJzL2FsZXgvRXZhYk1vYmlsZS92ZW5kb3IvY291Y2hhcHAvX2F0dGFjaG1lbnRzL3V0aWwvZGRJbldnczg0QnJlaXRlTWluLmpzIiwiQzovVXNlcnMvYWxleC9FdmFiTW9iaWxlL3ZlbmRvci9jb3VjaGFwcC9fYXR0YWNobWVudHMvdXRpbC9kZEluV2dzODRCcmVpdGVTZWMuanMiLCJDOi9Vc2Vycy9hbGV4L0V2YWJNb2JpbGUvdmVuZG9yL2NvdWNoYXBwL19hdHRhY2htZW50cy91dGlsL2RkSW5XZ3M4NExhZW5nZUdyYWQuanMiLCJDOi9Vc2Vycy9hbGV4L0V2YWJNb2JpbGUvdmVuZG9yL2NvdWNoYXBwL19hdHRhY2htZW50cy91dGlsL2RkSW5XZ3M4NExhZW5nZU1pbi5qcyIsIkM6L1VzZXJzL2FsZXgvRXZhYk1vYmlsZS92ZW5kb3IvY291Y2hhcHAvX2F0dGFjaG1lbnRzL3V0aWwvZGRJbldnczg0TGFlbmdlU2VjLmpzIiwiQzovVXNlcnMvYWxleC9FdmFiTW9iaWxlL3ZlbmRvci9jb3VjaGFwcC9fYXR0YWNobWVudHMvdXRpbC9lcnN0ZWxsZU5ldWVVaHJ6ZWl0LmpzIiwiQzovVXNlcnMvYWxleC9FdmFiTW9iaWxlL3ZlbmRvci9jb3VjaGFwcC9fYXR0YWNobWVudHMvdXRpbC9lcnN0ZWxsZU5ldWVzRGF0dW0uanMiLCJDOi9Vc2Vycy9hbGV4L0V2YWJNb2JpbGUvdmVuZG9yL2NvdWNoYXBwL19hdHRhY2htZW50cy91dGlsL3dnczg0SW5DaFguanMiLCJDOi9Vc2Vycy9hbGV4L0V2YWJNb2JpbGUvdmVuZG9yL2NvdWNoYXBwL19hdHRhY2htZW50cy91dGlsL3dnczg0SW5DaFkuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDajJWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKlxyXG5EaWVzZSBGdW5rdGlvbmVuIHdlcmRlbiBpbiBldmFiIGF1ZiBtZWhyZXJlbiBTZWl0ZW4gYmVudXR6dFxyXG4qL1xyXG5cclxud2luZG93LmVtID0gd2luZG93LmVtIHx8IHt9O1xyXG5cclxuLypcclxuICogZGllc2VyIENvZGUgd2FyIGRlciBWZXJzdWNoLCBNb2RlbHMgZWluenVmw7xocmVuXHJcbiAqIHp3aXNjaGVuemVpdGxpY2ggYXVmZ2VnZWJlbiAoc3RhdHRkZXNzZW4gaW4gbmV1ZW0gUHJvamVrdClcclxuXHJcbndpbmRvdy5lbS5zeW5jID0gcmVxdWlyZSgnLi9tb2R1bGVzL2RiU3luYycpO1xyXG5cclxudmFyIEJlb2JFaW5mYWNoTGlzdGUgPSByZXF1aXJlKCcuL21vZHVsZXMvQmVvYkVpbmZhY2hMaXN0ZScpXHJcbiAgICAsIHRlc3REYXRhID0gcmVxdWlyZSgnLi90ZXN0X2RhdGEvYmVvYkVpbmZhY2hMaXN0ZS5qc29uJylcclxuICAgIDtcclxuXHJcbndpbmRvdy5lbS5iZW9iRWluZmFjaExpc3RlID0gbmV3IEJlb2JFaW5mYWNoTGlzdGUodGVzdERhdGEucm93cyk7XHJcbiovXHJcblxyXG5cclxuXHJcbndpbmRvdy5lbS5tZWxkZSA9IGZ1bmN0aW9uKE1lbGR1bmcpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0JChcIjxkaXYgaWQ9J21lbGR1bmcnIGRhdGEtcm9sZT0ncG9wdXAnIGNsYXNzPSd1aS1jb250ZW50JyBkYXRhLW92ZXJsYXktdGhlbWU9J2EnPjxhIGhyZWY9JyMnIGRhdGEtcmVsPSdiYWNrJyBjbGFzcz0ndWktYnRuIHVpLWNvcm5lci1hbGwgdWktc2hhZG93IHVpLWJ0bi1hIHVpLWljb24tZGVsZXRlIHVpLWJ0bi1pY29uLW5vdGV4dCB1aS1idG4tcmlnaHQnPkNsb3NlPC9hPlwiK01lbGR1bmcrXCI8L2Rpdj5cIilcclxuXHRcdC5jc3Moe1wibGluZS1oZWlnaHRcIjogXCI5NSVcIiwgXCJmb250LXdlaWdodFwiOiBcImJvbGRcIn0pXHJcblx0XHQuYXBwZW5kVG8oJC5tb2JpbGUucGFnZUNvbnRhaW5lcik7XHJcblx0JChcIiNtZWxkdW5nXCIpLnBvcHVwKHtcclxuXHRcdGFmdGVyY2xvc2U6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQvLyBNZWxkdW5nIHdpZWRlciBhdXMgcGFnZUNvbnRhaW5lciBlbnRmZXJuZW5cclxuXHRcdFx0JChcIiNtZWxkdW5nXCIpLnJlbW92ZSgpO1xyXG5cdFx0fVxyXG5cdH0pLnBvcHVwKFwib3BlblwiKTtcclxufTtcclxuXHJcbi8vIHdpcmQgaW4gRmVsZEVkaXQuaHRtbCB2ZXJ3ZW5kZXRcclxud2luZG93LmVtLmdlaGVadXJ1ZWNrRkUgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZUZlbGRFZGl0KCk7XHJcblx0aWYgKGxvY2FsU3RvcmFnZS56dXJ1ZWNrICYmIGxvY2FsU3RvcmFnZS56dXJ1ZWNrICE9PSBcIkZlbGRlcldhZWhsZW4uaHRtbFwiKSB7XHJcblx0XHQvLyB2aWEgZGllIEZlbGRsaXN0ZSB6dXLDvGNrXHJcblx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlRmVsZEVkaXQoKTtcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiRmVsZExpc3RlLmh0bWxcIik7XHJcblx0fSBlbHNlIGlmIChsb2NhbFN0b3JhZ2UuenVydWVjayAmJiBsb2NhbFN0b3JhZ2UuenVydWVjayA9PT0gXCJGZWxkZXJXYWVobGVuLmh0bWxcIikge1xyXG5cdFx0Ly8gZGlyZWt0IHp1csO8Y2ssIEZlbGRsaXN0ZSBhdXNsYXNzZW5cclxuXHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VGZWxkRWRpdCgpO1xyXG5cdFx0d2luZG93LmVtLmxlZXJlU3RvcmFnZUZlbGRMaXN0ZSgpO1xyXG5cdFx0Ly8gVE9ETzogR2VodCB6d2FyIHJpY2h0aWcgenVyw7xjay4gU3ByaW5ndCBkYW5uIGFiZXIgZGlyZWt0IHp1ciBCZW9iTGlzdGUuaHRtbCFcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiRmVsZGVyV2FlaGxlbi5odG1sXCIpO1xyXG5cdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS56dXJ1ZWNrO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyB1dXBzLCBrZWluIHp1csO8Y2sgdm9yaGFuZGVuXHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKCk7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkJlb2JMaXN0ZS5odG1sXCIpO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIE5ldWUgQmVvYmFjaHR1bmdlbiB3ZXJkZW4gZ2VzcGVpY2hlcnRcclxuLy8gYXVzZ2Vsw7ZzdCBkdXJjaCBCZW9iTGlzdGUuaHRtbCwgQmVvYkVkaXQuaHRtbCwgaEFydExpc3RlLmh0bWwgb2RlciBoQXJ0RWRpdC5odG1sXHJcbi8vIGF1ZmdlcnVmZW4gYmxvc3Mgdm9uIEFydGVubGlzdGUuaHRtbFxyXG53aW5kb3cuZW0uc3BlaWNoZXJlTmV1ZUJlb2IgPSBmdW5jdGlvbihhQXJ0QmV6ZWljaG51bmcpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGRvYyA9IHt9LFxyXG4gICAgICAgIGVyc3RlbGxlTmV1ZXNEYXR1bSA9IHJlcXVpcmUoJy4vdXRpbC9lcnN0ZWxsZU5ldWVzRGF0dW0nKSxcclxuICAgICAgICBlcnN0ZWxsZU5ldWVVaHJ6ZWl0ID0gcmVxdWlyZSgnLi91dGlsL2Vyc3RlbGxlTmV1ZVVocnplaXQnKTtcclxuXHRkb2MuVXNlciA9IGxvY2FsU3RvcmFnZS5FbWFpbDtcclxuXHRkb2MuYUF1dG9yID0gbG9jYWxTdG9yYWdlLkF1dG9yO1xyXG5cdGRvYy5hQXJ0R3J1cHBlID0gbG9jYWxTdG9yYWdlLmFBcnRHcnVwcGU7XHJcblx0Ly9kZWxldGUgbG9jYWxTdG9yYWdlLmFBcnRHcnVwcGU7XHJcblx0ZG9jLmFBcnROYW1lID0gYUFydEJlemVpY2hudW5nO1xyXG5cdGRvYy5hQXJ0SWQgPSBsb2NhbFN0b3JhZ2UuYUFydElkO1xyXG5cdGlmIChsb2NhbFN0b3JhZ2UuVm9uID09PSBcImhBcnRMaXN0ZVwiIHx8IGxvY2FsU3RvcmFnZS5Wb24gPT09IFwiaEFydEVkaXRcIikge1xyXG5cdFx0ZG9jLlR5cCA9IFwiaEFydFwiO1xyXG5cdFx0ZG9jLmhQcm9qZWt0SWQgPSBsb2NhbFN0b3JhZ2UuUHJvamVrdElkO1xyXG5cdFx0ZG9jLmhSYXVtSWQgPSBsb2NhbFN0b3JhZ2UuUmF1bUlkO1xyXG5cdFx0ZG9jLmhPcnRJZCA9IGxvY2FsU3RvcmFnZS5PcnRJZDtcclxuXHRcdGRvYy5oWmVpdElkID0gbG9jYWxTdG9yYWdlLlplaXRJZDtcclxuXHRcdGRvYy5hQXJ0SWQgPSBsb2NhbFN0b3JhZ2UuYUFydElkO1xyXG5cdFx0d2luZG93LmVtLnNwZWljaGVyZU5ldWVCZW9iXzAyKGRvYyk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vbG9jYWxTdG9yYWdlLlZvbiA9PSBcIkJlb2JMaXN0ZVwiIHx8IGxvY2FsU3RvcmFnZS5Wb24gPT0gXCJCZW9iRWRpdFwiXHJcblx0XHRkb2MuVHlwID0gXCJCZW9iYWNodHVuZ1wiO1xyXG5cdFx0ZG9jLnpEYXR1bSA9IGVyc3RlbGxlTmV1ZXNEYXR1bSgpO1xyXG5cdFx0ZG9jLnpVaHJ6ZWl0ID0gZXJzdGVsbGVOZXVlVWhyemVpdCgpO1xyXG5cdFx0d2luZG93LmVtLnNwZWljaGVyZU5ldWVCZW9iXzAyKGRvYyk7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gTmV1ZSBCZW9iYWNodHVuZ2VuIHdlcmRlbiBnZXNwZWljaGVydFxyXG4vLyBhdXNnZWzDtnN0IGR1cmNoIEJlb2JMaXN0ZS5odG1sLCBCZW9iRWRpdC5odG1sLCBoQXJ0TGlzdGUuaHRtbCBvZGVyIGhBcnRFZGl0Lmh0bWxcclxuLy8gZGllcyBpc3QgZGVyIGxldHp0ZSBTY2hyaXR0OlxyXG4vLyBBdXRvciBhbmbDvGdlbiB1bmQgd2VpdGVyIHp1bSBFZGl0LUZvcm11bGFyXHJcbndpbmRvdy5lbS5zcGVpY2hlcmVOZXVlQmVvYl8wMiA9IGZ1bmN0aW9uKGRvYykge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuICAgIHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHQkZGIuc2F2ZURvYyhkb2MsIHtcclxuXHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0dmFyIHJvd19vYmpla3QgPSB7fTtcclxuXHRcdFx0Ly8gZG9jIHVtIGlkIHVuZCByZXYgZXJnw6RuemVuXHJcblx0XHRcdGRvYy5faWQgPSBkYXRhLmlkO1xyXG5cdFx0XHRkb2MuX3JldiA9IGRhdGEucmV2O1xyXG5cdFx0XHRpZiAoZG9jLlR5cCA9PT0gJ2hBcnQnKSB7XHJcblx0XHRcdFx0Ly8gVmFyaWFiZWxuIHZlcmbDvGdiYXIgbWFjaGVuXHJcblx0XHRcdFx0bG9jYWxTdG9yYWdlLmhBcnRJZCA9IGRhdGEuaWQ7XHJcblx0XHRcdFx0Ly8gZGFtaXQgaEFydEVkaXQuaHRtbCBkaWUgaEFydCBuaWNodCBhdXMgZGVyIERCIGhvbGVuIG11c3NcclxuXHRcdFx0XHR3aW5kb3cuZW0uaEFydCA9IGRvYztcclxuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5hQXJ0SWQgPSB3aW5kb3cuZW0uaEFydC5hQXJ0SWQ7XHJcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UuYUFydE5hbWUgPSB3aW5kb3cuZW0uaEFydC5hQXJ0TmFtZTtcclxuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5hQXJ0R3J1cHBlID0gd2luZG93LmVtLmhBcnQuYUFydEdydXBwZTtcclxuXHRcdFx0XHQvLyB3aW5kb3cuZW0uaEFydExpc3RlIGVyZ8OkbnplbiwgZGFtaXQgYmVpIGRlciBuw6RjaHN0ZW4gQXJ0IGtvbnRyb2xsaWVydCB3ZXJkZW4ga2Fubiwgb2Igc2llIHNjaG9uIGVyZmFzc3Qgd3VyZGVcclxuXHRcdFx0XHRyb3dfb2JqZWt0LmlkID0gZGF0YS5pZDtcclxuXHRcdFx0XHRyb3dfb2JqZWt0LmRvYyA9IGRvYztcclxuXHRcdFx0XHQvLyBWb3JzaWNodDogd2luZG93LmVtLmhBcnRMaXN0ZSBleGlzdGllcnQgbmljaHQsIHdlbm4gaW4gaEFydEVkaXQgRjUgZ2VkcsO8Y2t0IHd1cmRlIVxyXG5cdFx0XHRcdGlmICh3aW5kb3cuZW0uaEFydExpc3RlICYmIHdpbmRvdy5lbS5oQXJ0TGlzdGUucm93cykge1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLmhBcnRMaXN0ZS5yb3dzLnB1c2gocm93X29iamVrdCk7XHJcblx0XHRcdFx0XHQvLyBqZXR6dCBkaWUgTGlzdGUgbmV1IHNvcnRpZXJlblxyXG5cdFx0XHRcdFx0d2luZG93LmVtLmhBcnRMaXN0ZS5yb3dzID0gXy5zb3J0Qnkod2luZG93LmVtLmhBcnRMaXN0ZS5yb3dzLCBmdW5jdGlvbihyb3cpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIHJvdy5kb2MuYUFydE5hbWU7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKGxvY2FsU3RvcmFnZS5oQXJ0U2ljaHQgPT09IFwibGlzdGVcIikge1xyXG5cdFx0XHRcdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJoQXJ0RWRpdExpc3RlLmh0bWxcIik7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiaEFydEVkaXQuaHRtbFwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly8gVmFyaWFiZWxuIHZlcmbDvGdiYXIgbWFjaGVuXHJcblx0XHRcdFx0bG9jYWxTdG9yYWdlLkJlb2JJZCA9IGRhdGEuaWQ7XHJcblx0XHRcdFx0Ly8gZGFtaXQgQmVvYkVkaXQuaHRtbCBkaWUgQmVvYiBuaWNodCBhdXMgZGVyIERCIGhvbGVuIG11c3NcclxuXHRcdFx0XHR3aW5kb3cuZW0uQmVvYmFjaHR1bmcgPSBkb2M7XHJcblx0XHRcdFx0Ly8gR2xvYmFsZSBWYXJpYWJsZW4gZsO8ciBCZW9iTGlzdGUgenVyw7xja3NldHplbiwgZGFtaXQgZGllIExpc3RlIGJlaW0gbsOkY2hzdGVuIEF1ZnJ1ZiBuZXUgYXVmZ2ViYXV0IHdpcmRcclxuXHRcdFx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlQmVvYkxpc3RlKCk7XHJcblx0XHRcdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJCZW9iRWRpdC5odG1sXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJCZW9iYWNodHVuZyBuaWNodCBnZXNwZWljaGVydC5cIik7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyBTcGVpY2hlcnQsIHdlbm4gaW4gQmVvYkVkaXQgb2RlciBoQXJ0RWRpdCBlaW5lIG5ldWUgQXJ0IHVuZCBldi4gYXVjaCBlaW5lIG5ldWUgQXJ0Z3J1cHBlIGdld8OkaGx0IHd1cmRlXHJcbi8vIGVyd2FydGV0IGxvY2FsU3RvcmFnZS5Wb24gPSB2b24gd2VsY2hlbSBGb3JtdWxhciBhdWZnZXJ1ZmVuIHd1cmRlXHJcbndpbmRvdy5lbS5zcGVpY2hlcmVCZW9iTmV1ZUFydGdydXBwZUFydCA9IGZ1bmN0aW9uKGFBcnROYW1lKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBkb2NJZDtcclxuXHRpZiAobG9jYWxTdG9yYWdlLlZvbiA9PT0gXCJCZW9iTGlzdGVcIiB8fCBsb2NhbFN0b3JhZ2UuVm9uID09PSBcIkJlb2JFZGl0XCIpIHtcclxuXHRcdGRvY0lkID0gbG9jYWxTdG9yYWdlLkJlb2JJZDtcclxuXHR9IGVsc2Uge1xyXG5cdFx0ZG9jSWQgPSBsb2NhbFN0b3JhZ2UuaEFydElkO1xyXG5cdH1cclxuXHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0JGRiLm9wZW5Eb2MoZG9jSWQsIHtcclxuXHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGJlb2IpIHtcclxuXHRcdFx0aWYgKGxvY2FsU3RvcmFnZS5hQXJ0R3J1cHBlKSB7XHJcblx0XHRcdFx0YmVvYi5hQXJ0R3J1cHBlID0gbG9jYWxTdG9yYWdlLmFBcnRHcnVwcGU7XHJcblx0XHRcdH1cclxuXHRcdFx0YmVvYi5hQXJ0TmFtZSA9IGFBcnROYW1lO1xyXG5cdFx0XHRiZW9iLmFBcnRJZCA9IGxvY2FsU3RvcmFnZS5hQXJ0SWQ7XHJcblx0XHRcdCRkYi5zYXZlRG9jKGJlb2IsIHtcclxuXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0XHRpZiAobG9jYWxTdG9yYWdlLlZvbiA9PT0gXCJCZW9iTGlzdGVcIiB8fCBsb2NhbFN0b3JhZ2UuVm9uID09PSBcIkJlb2JFZGl0XCIpIHtcclxuXHRcdFx0XHRcdFx0Ly8gVmFyaWFiZWxuIHZlcmbDvGdiYXIgbWFjaGVuXHJcblx0XHRcdFx0XHRcdGxvY2FsU3RvcmFnZS5CZW9iSWQgPSBkb2NJZDtcclxuXHRcdFx0XHRcdFx0Ly8gR2xvYmFsZSBWYXJpYWJsZW4gZsO8ciBCZW9iTGlzdGUgenVyw7xja3NldHplbiwgZGFtaXQgZGllIExpc3RlIGJlaW0gbsOkY2hzdGVuIEF1ZnJ1ZiBuZXUgYXVmZ2ViYXV0IHdpcmRcclxuXHRcdFx0XHRcdFx0d2luZG93LmVtLmxlZXJlU3RvcmFnZUJlb2JMaXN0ZSgpO1xyXG5cdFx0XHRcdFx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkJlb2JFZGl0Lmh0bWxcIik7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQvLyBWYXJpYWJlbG4gdmVyZsO8Z2JhciBtYWNoZW5cclxuXHRcdFx0XHRcdFx0bG9jYWxTdG9yYWdlLmhBcnRJZCA9IGRvY0lkO1xyXG5cdFx0XHRcdFx0XHQvLyBkYW1pdCBoQXJ0RWRpdC5odG1sIGRpZSBoQXJ0IG5pY2h0IGF1cyBkZXIgREIgaG9sZW4gbXVzc1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuZW0uaEFydCA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5hQXJ0SWQgPSB3aW5kb3cuZW0uaEFydC5hQXJ0SWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5hQXJ0TmFtZSA9IHdpbmRvdy5lbS5oQXJ0LmFBcnROYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UuYUFydEdydXBwZSA9IHdpbmRvdy5lbS5oQXJ0LmFBcnRHcnVwcGU7XHJcblx0XHRcdFx0XHRcdC8vIHdpbmRvdy5lbS5oQXJ0TGlzdGUgYW5wYXNzZW5cclxuXHRcdFx0XHRcdFx0Ly8gVm9yc2ljaHQ6IHdpbmRvdy5lbS5oQXJ0TGlzdGUgZXhpc3RpZXJ0IG5pY2h0LCB3ZW5uIGluIGhBcnRFZGl0IEY1IGdlZHLDvGNrdCB3dXJkZSFcclxuXHRcdFx0XHRcdFx0aWYgKHdpbmRvdy5lbS5oQXJ0TGlzdGUgJiYgd2luZG93LmVtLmhBcnRMaXN0ZS5yb3dzKSB7XHJcblx0XHRcdFx0XHRcdFx0Xy5lYWNoKHdpbmRvdy5lbS5oQXJ0TGlzdGUucm93cywgZnVuY3Rpb24ocm93KSB7XHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgaEFydCA9IHJvdy5kb2M7XHJcblx0XHRcdFx0XHRcdFx0XHRpZiAoaEFydC5faWQgPT0gZG9jSWQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aEFydC5hQXJ0R3J1cHBlID0gbG9jYWxTdG9yYWdlLmFBcnRHcnVwcGU7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGhBcnQuYUFydE5hbWUgPSBhQXJ0TmFtZTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aEFydC5hQXJ0SWQgPSBsb2NhbFN0b3JhZ2UuYUFydElkO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdC8vIHdpbmRvdy5lbS5oQXJ0TGlzdGUgbmV1IHNvcnRpZXJlblxyXG5cdFx0XHRcdFx0XHRcdHdpbmRvdy5lbS5oQXJ0TGlzdGUucm93cyA9IF8uc29ydEJ5KHdpbmRvdy5lbS5oQXJ0TGlzdGUucm93cywgZnVuY3Rpb24ocm93KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gcm93LmRvYy5hQXJ0TmFtZTtcclxuXHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLmFBcnRHcnVwcGU7XHJcblx0XHRcdFx0XHRcdGlmIChsb2NhbFN0b3JhZ2UuaEFydFNpY2h0ID09PSBcImxpc3RlXCIpIHtcclxuXHRcdFx0XHRcdFx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhBcnRFZGl0TGlzdGUuaHRtbFwiKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhBcnRFZGl0Lmh0bWxcIik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkZlaGxlcjogQmVvYmFjaHR1bmcgbmljaHQgZ2VzcGVpY2hlcnRcIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5lcnN0ZWxsZU5ldWVaZWl0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG4vLyBOZXVlIFplaXRlbiB3ZXJkZW4gZXJzdGVsbHRcclxuLy8gYXVzZ2Vsw7ZzdCBkdXJjaCBoWmVpdExpc3RlLmh0bWwgb2RlciBoWmVpdEVkaXQuaHRtbFxyXG4vLyBkaWVzIGlzdCBkZXIgZXJzdGUgU2Nocml0dDogZG9jIGJpbGRlblxyXG5cdHZhciBkb2MgPSB7fSxcclxuICAgICAgICAkaFplaXRFZGl0ID0gJChcIiNoWmVpdEVkaXRcIiksXHJcbiAgICAgICAgZXJzdGVsbGVOZXVlc0RhdHVtID0gcmVxdWlyZSgnLi91dGlsL2Vyc3RlbGxlTmV1ZXNEYXR1bScpLFxyXG4gICAgICAgIGVyc3RlbGxlTmV1ZVVocnplaXQgPSByZXF1aXJlKCcuL3V0aWwvZXJzdGVsbGVOZXVlVWhyemVpdCcpO1xyXG5cdGRvYy5UeXAgPSBcImhaZWl0XCI7XHJcblx0ZG9jLlVzZXIgPSBsb2NhbFN0b3JhZ2UuRW1haWw7XHJcblx0ZG9jLmhQcm9qZWt0SWQgPSBsb2NhbFN0b3JhZ2UuUHJvamVrdElkO1xyXG5cdGRvYy5oUmF1bUlkID0gbG9jYWxTdG9yYWdlLlJhdW1JZDtcclxuXHRkb2MuaE9ydElkID0gbG9jYWxTdG9yYWdlLk9ydElkO1xyXG5cdGRvYy56RGF0dW0gPSBlcnN0ZWxsZU5ldWVzRGF0dW0oKTtcclxuXHRkb2MuelVocnplaXQgPSBlcnN0ZWxsZU5ldWVVaHJ6ZWl0KCk7XHJcblx0Ly8gYW4gaFplaXRFZGl0Lmh0bWwgw7xiZXJnZWJlblxyXG5cdHdpbmRvdy5lbS5oWmVpdCA9IGRvYztcclxuXHQvLyBWYXJpYWJlbG4gdmVyZsO8Z2JhciBtYWNoZW5cclxuXHRkZWxldGUgbG9jYWxTdG9yYWdlLlplaXRJZDtcclxuXHRsb2NhbFN0b3JhZ2UuU3RhdHVzID0gXCJuZXVcIjtcclxuXHQvLyBHbG9iYWxlIFZhcmlhYmxlbiBmw7xyIFplaXRMaXN0ZSB6dXLDvGNrc2V0emVuLCBkYW1pdCBkaWUgTGlzdGUgYmVpbSBuw6RjaHN0ZW4gQXVmcnVmIG5ldSBhdWZnZWJhdXQgd2lyZFxyXG5cdGRlbGV0ZSB3aW5kb3cuZW0uWmVpdExpc3RlO1xyXG5cdC8vIFZvcnNpY2h0OiBWb24gaFplaXRFZGl0Lmh0bWwgYXVzIHNhbWVwYWdlIHRyYW5zaXRpb24hXHJcblx0aWYgKCRoWmVpdEVkaXQubGVuZ3RoID4gMCAmJiAkaFplaXRFZGl0LmF0dHIoXCJkYXRhLXVybFwiKSAhPT0gXCJoWmVpdEVkaXRcIikge1xyXG5cdFx0Ly8gV2VubiBkaWUgZGF0YS11cmwgZWluIFBmYWQgaXN0LCB2ZXJ1cnNhY2h0IGNoYW5nZVBhZ2UgZWluZW4gRmVobGVyOiBiLmRhdGEoXCJwYWdlXCIpIGlzIHVuZGVmaW5lZFxyXG5cdFx0Ly8gZGFzIE9iamVrdCBtdXNzIMO8YmVyIGRpZSBsb2NhbFN0b3JhZ2Ugw7xiZXJtaXR0ZWx0IHdlcmRlblxyXG5cdFx0bG9jYWxTdG9yYWdlLmhaZWl0ID0gSlNPTi5zdHJpbmdpZnkod2luZG93LmVtLmhaZWl0KTtcclxuXHRcdHdpbmRvdy5vcGVuKFwiaFplaXRFZGl0Lmh0bWxcIiwgXCJfc2VsZlwiKTtcclxuXHR9IGVsc2UgaWYgKCRoWmVpdEVkaXQubGVuZ3RoID4gMCAmJiAkaFplaXRFZGl0LmF0dHIoXCJkYXRhLXVybFwiKSA9PT0gXCJoWmVpdEVkaXRcIikge1xyXG5cdFx0Ly8kKFwiOm1vYmlsZS1wYWdlY29udGFpbmVyXCIpLnBhZ2Vjb250YWluZXIoXCJjaGFuZ2VcIiwgXCIjaFplaXRFZGl0Lmh0bWxcIiwgeyBhbGxvd1NhbWVQYWdlVHJhbnNpdGlvbiA6IHRydWUgfSk7ICAgIEZVTktUSU9OSUVSVCBOSUNIVFxyXG5cdFx0bG9jYWxTdG9yYWdlLmhaZWl0ID0gSlNPTi5zdHJpbmdpZnkod2luZG93LmVtLmhaZWl0KTtcclxuXHRcdHdpbmRvdy5vcGVuKFwiaFplaXRFZGl0Lmh0bWxcIiwgXCJfc2VsZlwiKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJoWmVpdEVkaXQuaHRtbFwiKTtcclxuXHR9XHJcbn07XHJcblxyXG4vLyBlcnN0ZWxsdCBlaW5lbiBuZXVlbiBPcnRcclxuLy8gd2lyZCBhdWZnZXJ1ZmVuIHZvbjogaE9ydEVkaXQuaHRtbCwgaE9ydExpc3RlLmh0bWxcclxuLy8gZXJ3YXJ0ZXQgVXNlcm5hbWUsIGhQcm9qZWt0SWQsIGhSYXVtSWRcclxud2luZG93LmVtLmVyc3RlbGxlTmV1ZW5PcnQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGRvYyA9IHt9LFxyXG4gICAgICAgICRoT3J0RWRpdCA9ICQoXCIjaE9ydEVkaXRcIik7XHJcblx0ZG9jLlR5cCA9IFwiaE9ydFwiO1xyXG5cdGRvYy5Vc2VyID0gbG9jYWxTdG9yYWdlLkVtYWlsO1xyXG5cdGRvYy5oUHJvamVrdElkID0gbG9jYWxTdG9yYWdlLlByb2pla3RJZDtcclxuXHRkb2MuaFJhdW1JZCA9IGxvY2FsU3RvcmFnZS5SYXVtSWQ7XHJcblx0Ly8gYW4gaE9ydEVkaXQuaHRtbCDDvGJlcmdlYmVuXHJcblx0d2luZG93LmVtLmhPcnQgPSBkb2M7XHJcblx0Ly8gVmFyaWFiZWxuIHZlcmbDvGdiYXIgbWFjaGVuXHJcblx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5PcnRJZDtcclxuXHQvLyBHbG9iYWxlIFZhcmlhYmxlbiBmw7xyIE9ydExpc3RlIHp1csO8Y2tzZXR6ZW4sIGRhbWl0IGRpZSBMaXN0ZSBiZWltIG7DpGNoc3RlbiBBdWZydWYgbmV1IGF1ZmdlYmF1dCB3aXJkXHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZU9ydExpc3RlKFwibWl0TGF0TG5nTGlzdGVcIik7XHJcblx0bG9jYWxTdG9yYWdlLlN0YXR1cyA9IFwibmV1XCI7XHQvLyBkYXMgbMO2c3QgYmVpIGluaXRpaWVyZU9ydEVkaXQgZGllIFZlcm9ydHVuZyBhdXNcclxuXHQvLyBWb3JzaWNodDogVm9uIGhPcnRFZGl0Lmh0bWwgYXVzIHNhbWVwYWdlIHRyYW5zaXRpb24hXHJcblx0aWYgKCRoT3J0RWRpdC5sZW5ndGggPiAwICYmICRoT3J0RWRpdC5hdHRyKFwiZGF0YS11cmxcIikgIT09IFwiaE9ydEVkaXRcIikge1xyXG5cdFx0Ly8gV2VubiBkaWUgZGF0YS11cmwgZWluIFBmYWQgaXN0LCB2ZXJ1cnNhY2h0IGNoYW5nZVBhZ2UgZWluZW4gRmVobGVyOiBiLmRhdGEoXCJwYWdlXCIpIGlzIHVuZGVmaW5lZFxyXG5cdFx0Ly8gZGFzIE9iamVrdCBtdXNzIMO8YmVyIGRpZSBsb2NhbFN0b3JhZ2Ugw7xiZXJtaXR0ZWx0IHdlcmRlblxyXG5cdFx0bG9jYWxTdG9yYWdlLmhPcnQgPSBKU09OLnN0cmluZ2lmeSh3aW5kb3cuZW0uaE9ydCk7XHJcblx0XHR3aW5kb3cub3BlbihcImhPcnRFZGl0Lmh0bWxcIiwgXCJfc2VsZlwiKTtcclxuXHR9IGVsc2UgaWYgKCRoT3J0RWRpdC5sZW5ndGggPiAwICYmICRoT3J0RWRpdC5hdHRyKFwiZGF0YS11cmxcIikgPT09IFwiaE9ydEVkaXRcIikge1xyXG5cdFx0Ly8kKFwiOm1vYmlsZS1wYWdlY29udGFpbmVyXCIpLnBhZ2Vjb250YWluZXIoXCJjaGFuZ2VcIiwgXCIjaE9ydEVkaXQuaHRtbFwiLCB7YWxsb3dTYW1lUGFnZVRyYW5zaXRpb24gOiB0cnVlfSk7ICAgIEZVTktUSU9OSUVSVCBOSUNIVFxyXG5cdFx0bG9jYWxTdG9yYWdlLmhPcnQgPSBKU09OLnN0cmluZ2lmeSh3aW5kb3cuZW0uaE9ydCk7XHJcblx0XHR3aW5kb3cub3BlbihcImhPcnRFZGl0Lmh0bWxcIiwgXCJfc2VsZlwiKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJoT3J0RWRpdC5odG1sXCIpO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5lcnN0ZWxsZU5ldWVuUmF1bSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgZG9jID0ge30sXHJcbiAgICAgICAgJGhSYXVtRWRpdCA9ICQoXCIjaFJhdW1FZGl0XCIpO1xyXG5cdGRvYy5UeXAgPSBcImhSYXVtXCI7XHJcblx0ZG9jLlVzZXIgPSBsb2NhbFN0b3JhZ2UuRW1haWw7XHJcblx0ZG9jLmhQcm9qZWt0SWQgPSBsb2NhbFN0b3JhZ2UuUHJvamVrdElkO1xyXG5cdC8vIGluIE9iamVrdCBzcGVpY2hlcm4sIGRhcyBhbiBoUmF1bUVkaXQuaHRtbCDDvGJlcmdlYmVuIHdpcmRcclxuXHR3aW5kb3cuZW0uaFJhdW0gPSBkb2M7XHJcblx0Ly8gVmFyaWFiZWxuIHZlcmbDvGdiYXIgbWFjaGVuXHJcblx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5SYXVtSWQ7XHJcblx0bG9jYWxTdG9yYWdlLlN0YXR1cyA9IFwibmV1XCI7XHJcblx0Ly8gR2xvYmFsZSBWYXJpYWJsZW4gZsO8ciBSYXVtTGlzdGUgenVyw7xja3NldHplbiwgZGFtaXQgZGllIExpc3RlIGJlaW0gbsOkY2hzdGVuIEF1ZnJ1ZiBuZXUgYXVmZ2ViYXV0IHdpcmRcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUmF1bUxpc3RlKFwibWl0TGF0TG5nTGlzdGVcIik7XHJcblx0Ly8gVm9yc2ljaHQ6IFZvbiBoUmF1bUVkaXQuaHRtbCBhdXMgc2FtZSBwYWdlIHRyYW5zaXRpb24hXHJcblx0aWYgKCRoUmF1bUVkaXQubGVuZ3RoID4gMCAmJiAkaFJhdW1FZGl0LmF0dHIoXCJkYXRhLXVybFwiKSAhPT0gXCJoUmF1bUVkaXRcIikge1xyXG5cdFx0Ly8gV2VubiBkaWUgZGF0YS11cmwgZWluIFBmYWQgaXN0LCB2ZXJ1cnNhY2h0IGNoYW5nZVBhZ2UgZWluZW4gRmVobGVyOiBiLmRhdGEoXCJwYWdlXCIpIGlzIHVuZGVmaW5lZFxyXG5cdFx0Ly8gZGFzIE9iamVrdCBtdXNzIMO8YmVyIGRpZSBsb2NhbFN0b3JhZ2Ugw7xiZXJtaXR0ZWx0IHdlcmRlblxyXG5cdFx0bG9jYWxTdG9yYWdlLmhSYXVtID0gSlNPTi5zdHJpbmdpZnkod2luZG93LmVtLmhSYXVtKTtcclxuXHRcdHdpbmRvdy5vcGVuKFwiaFJhdW1FZGl0Lmh0bWxcIiwgXCJfc2VsZlwiKTtcclxuXHR9IGVsc2UgaWYgKCRoUmF1bUVkaXQubGVuZ3RoID4gMCAmJiAkaFJhdW1FZGl0LmF0dHIoXCJkYXRhLXVybFwiKSA9PT0gXCJoUmF1bUVkaXRcIikge1xyXG5cdFx0Ly8kKFwiOm1vYmlsZS1wYWdlY29udGFpbmVyXCIpLnBhZ2Vjb250YWluZXIoXCJjaGFuZ2VcIiwgXCIjaFJhdW1FZGl0Lmh0bWxcIiwge2FsbG93U2FtZVBhZ2VUcmFuc2l0aW9uIDogXCJ0cnVlXCJ9KTsgICBGVU5LVElPTklFUlQgTklDSFRcclxuXHRcdGxvY2FsU3RvcmFnZS5oUmF1bSA9IEpTT04uc3RyaW5naWZ5KHdpbmRvdy5lbS5oUmF1bSk7XHJcblx0XHR3aW5kb3cub3BlbihcImhSYXVtRWRpdC5odG1sXCIsIFwiX3NlbGZcIik7XHJcblx0fSBlbHNlIHtcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiaFJhdW1FZGl0Lmh0bWxcIik7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gZXJzdGVsbHQgZWluIE9iamVrdCBmw7xyIGVpbiBuZXVlcyBQcm9qZWt0IHVuZCDDtmZmbmV0IGRhbmFjaCBoUHJvamVrdEVkaXQuaHRtbFxyXG4vLyBkYXMgT2JqZWt0IHdpcmQgZXJzdCB2b24gaW5pdGlpZXJlUHJvamVrdEVkaXQgZ2VzcGVpY2hlcnQgKGVpbmVuIERCLVp1Z3JpZmYgc3BhcmVuKVxyXG53aW5kb3cuZW0uZXJzdGVsbGVOZXVlc1Byb2pla3QgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGRvYyA9IHt9LFxyXG4gICAgICAgICRoUHJvamVrdEVkaXQgPSAkKFwiI2hQcm9qZWt0RWRpdFwiKTtcclxuXHRkb2MuVHlwID0gXCJoUHJvamVrdFwiO1xyXG5cdGRvYy5Vc2VyID0gbG9jYWxTdG9yYWdlLkVtYWlsO1xyXG5cdC8vIGRhbWl0IGhQcm9qZWt0RWRpdC5odG1sIGRpZSBoQXJ0IG5pY2h0IGF1cyBkZXIgREIgaG9sZW4gbXVzc1xyXG5cdHdpbmRvdy5lbS5oUHJvamVrdCA9IGRvYztcclxuXHQvLyBQcm9qZWt0SWQgZmFrZW4sIHNvbnN0IGxlaXRldCBkaWUgZWRpdC1TZWl0ZSBhbiBkaWUgb2JlcnN0ZSBMaXN0ZSB3ZWl0ZXJcclxuXHRkZWxldGUgbG9jYWxTdG9yYWdlLlByb2pla3RJZDtcclxuXHRsb2NhbFN0b3JhZ2UuU3RhdHVzID0gXCJuZXVcIjtcclxuXHQvLyBHbG9iYWxlIFZhcmlhYmxlbiBmw7xyIGhQcm9qZWt0TGlzdGUgenVyw7xja3NldHplbiwgZGFtaXQgZGllIExpc3RlIGJlaW0gbsOkY2hzdGVuIEF1ZnJ1ZiBuZXUgYXVmZ2ViYXV0IHdpcmRcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUHJvamVrdExpc3RlKFwibWl0TGF0TG5nTGlzdGVcIik7XHJcblx0Ly8gVm9yc2ljaHQ6IFZvbiBoUHJvamVrdEVkaXQuaHRtbCBhdXMgc2FtZSBwYWdlIHRyYW5zaXRpb24hXHJcblx0aWYgKCRoUHJvamVrdEVkaXQubGVuZ3RoID4gMCAmJiAkaFByb2pla3RFZGl0LmF0dHIoXCJkYXRhLXVybFwiKSAhPT0gXCJoUHJvamVrdEVkaXRcIikge1xyXG5cdFx0Ly8gV2VubiBkaWUgZGF0YS11cmwgZWluIFBmYWQgaXN0LCB2ZXJ1cnNhY2h0IGNoYW5nZVBhZ2UgZWluZW4gRmVobGVyOiBiLmRhdGEoXCJwYWdlXCIpIGlzIHVuZGVmaW5lZFxyXG5cdFx0Ly8gZGFzIE9iamVrdCBtdXNzIMO8YmVyIGRpZSBsb2NhbFN0b3JhZ2Ugw7xiZXJtaXR0ZWx0IHdlcmRlblxyXG5cdFx0bG9jYWxTdG9yYWdlLmhQcm9qZWt0ID0gSlNPTi5zdHJpbmdpZnkod2luZG93LmVtLmhQcm9qZWt0KTtcclxuXHRcdHdpbmRvdy5vcGVuKFwiaFByb2pla3RFZGl0Lmh0bWxcIiwgXCJfc2VsZlwiKTtcclxuXHR9IGVsc2UgaWYgKCRoUHJvamVrdEVkaXQubGVuZ3RoID4gMCAmJiAkaFByb2pla3RFZGl0LmF0dHIoXCJkYXRhLXVybFwiKSA9PT0gXCJoUHJvamVrdEVkaXRcIikge1xyXG5cdFx0Ly8kLm1vYmlsZS5uYXZpZ2F0ZSgkaFByb2pla3RFZGl0LCB7YWxsb3dTYW1lUGFnZVRyYW5zaXRpb246IHRydWV9KTsgICAgRlVOS1RJT05JRVJUIE5JQ0hUXHJcblx0XHRsb2NhbFN0b3JhZ2UuaFByb2pla3QgPSBKU09OLnN0cmluZ2lmeSh3aW5kb3cuZW0uaFByb2pla3QpO1xyXG5cdFx0d2luZG93Lm9wZW4oXCJoUHJvamVrdEVkaXQuaHRtbFwiLCBcIl9zZWxmXCIpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhQcm9qZWt0RWRpdC5odG1sXCIpO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS7DtmZmbmVNZWluZUVpbnN0ZWxsdW5nZW4gPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJVc2VyRWRpdC5odG1sXCIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmzDtnNjaGVEb2t1bWVudCA9IGZ1bmN0aW9uKERvY0lkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRyZXR1cm4gJGRiLm9wZW5Eb2MoRG9jSWQsIHtcclxuXHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRvY3VtZW50KSB7XHJcblx0XHRcdCRkYi5yZW1vdmVEb2MoZG9jdW1lbnQsIHtcclxuXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9LFxyXG5cdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyBpbml0aWllcnQgVmFyaWFiZWxuLCBmaXhlIEZlbGRlciB1bmQgZHluYW1pc2NoZSBGZWxkZXIgaW4gQmVvYkVkaXQuaHRtbFxyXG4vLyB3aXJkIGF1ZmdlcnVmZW4gdm9uIEJlb2JFZGl0Lmh0bWwgdW5kIEZlbGRlcl9CZW9iLmh0bWxcclxud2luZG93LmVtLmluaXRpaWVyZUJlb2JFZGl0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIEFuaMOkbmdlIGF1c2JsZW5kZW4sIHdlaWwgc2llIHNvbnN0IGJlaW0gV2VjaHNlbCBzdMO2cmVuXHJcblx0Ly8kKCcjQW5ow6RuZ2VCRScpLmhpZGUoKTtcclxuXHQvLyBwcsO8ZmVuLCBvYiBkaWUgRmVsZGxpc3RlIHNjaG9uIGdlaG9sdCB3dXJkZVxyXG5cdC8vIHdlbm4gamE6IGRlcmVuIGdsb2JhbGUgVmFyaWFibGUgdmVyd2VuZGVuXHJcblx0aWYgKHdpbmRvdy5lbS5GZWxkbGlzdGVCZW9iRWRpdCkge1xyXG5cdFx0d2luZG93LmVtLmluaXRpaWVyZUJlb2JFZGl0XzIoKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gZGFzIGRhdWVydCBsw6RuZ2VyIC0gaGlud2Vpc2VuXHJcblx0XHQkKFwiI0Jlb2JFZGl0Rm9ybUh0bWxcIikuaHRtbCgnPHAgY2xhc3M9XCJIaW53ZWlzRHluYW1pc2NoZXJGZWxkYXVmYmF1XCI+RGllIEZlbGRlciB3ZXJkZW4gYXVmZ2ViYXV0Li4uPC9wPicpO1xyXG5cdFx0Ly8gaG9sdCBkaWUgRmVsZGxpc3RlIGF1cyBkZXIgREJcclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi52aWV3KCdldmFiL0ZlbGRMaXN0ZUJlb2I/aW5jbHVkZV9kb2NzPXRydWUnLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHQvLyBHbG9iYWxlIFZhcmlhYmxlIGVyc3RlbGxlbiwgZGFtaXQgYWIgZGVtIHp3ZWl0ZW4gbWFsIGRpZSB2b3JpZ2UgQWJmcmFnZSBnZXNwYWFydCB3ZXJkZW4ga2FublxyXG5cdFx0XHRcdHdpbmRvdy5lbS5GZWxkbGlzdGVCZW9iRWRpdCA9IGRhdGE7XHJcblx0XHRcdFx0d2luZG93LmVtLmluaXRpaWVyZUJlb2JFZGl0XzIoKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gYWxsZsOkbGxpZ2UgQmVvYiDDvGJlcm5laG1lbiB2b24gc3BlaWNoZXJlTmV1ZUJlb2JcclxuLy8gdW0gZGllIERCLUFiZnJhZ2UgenUgc3BhcmVuXHJcbndpbmRvdy5lbS5pbml0aWllcmVCZW9iRWRpdF8yID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIGFjaHR1bmc6IHdlbm4gc29lYmVuIGRpZSBBcnQgZ2XDpG5kZXJ0IHd1cmRlLCBtw7xzc2VuIEFydElkIHVuZCBBcnROYW1lIG5ldSBnZWhvbHQgd2VyZGVuXHJcblx0aWYgKHdpbmRvdy5lbS5CZW9iYWNodHVuZyAmJiAoIWxvY2FsU3RvcmFnZS5Wb24gfHwgbG9jYWxTdG9yYWdlLlZvbiAhPT0gXCJCZW9iRWRpdFwiKSkge1xyXG5cdFx0d2luZG93LmVtLmluaXRpaWVyZUJlb2JFZGl0XzMoKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLm9wZW5Eb2MobG9jYWxTdG9yYWdlLkJlb2JJZCwge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLkJlb2JhY2h0dW5nID0gZGF0YTtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlQmVvYkVkaXRfMygpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaW5pdGlpZXJlQmVvYkVkaXRfMyA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBkaWVzZSAoZ2xvYmFsZW4pIFZhcmlhYmVsbiB3ZXJkZW4gaW4gQmVvYkVkaXQuaHRtbCBnZWJyYXVjaHRcclxuXHQvLyBiZWkgbmV1ZW4gQmVvYiBoYXQgZGFzIE9iamVrdCBub2NoIGtlaW5lIElEXHJcblx0aWYgKHdpbmRvdy5lbS5CZW9iYWNodHVuZy5faWQpIHtcclxuXHRcdGxvY2FsU3RvcmFnZS5CZW9iSWQgPSB3aW5kb3cuZW0uQmVvYmFjaHR1bmcuX2lkO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRsb2NhbFN0b3JhZ2UuQmVvYklkID0gXCJuZXVcIjtcclxuXHR9XHJcblx0bG9jYWxTdG9yYWdlLmFBcnRHcnVwcGUgPSB3aW5kb3cuZW0uQmVvYmFjaHR1bmcuYUFydEdydXBwZTtcclxuXHRsb2NhbFN0b3JhZ2UuYUFydE5hbWUgPSB3aW5kb3cuZW0uQmVvYmFjaHR1bmcuYUFydE5hbWU7XHJcblx0bG9jYWxTdG9yYWdlLmFBcnRJZCA9IHdpbmRvdy5lbS5CZW9iYWNodHVuZy5hQXJ0SWQ7XHJcblx0bG9jYWxTdG9yYWdlLm9Mb25naXR1ZGVEZWNEZWcgPSB3aW5kb3cuZW0uQmVvYmFjaHR1bmcub0xvbmdpdHVkZURlY0RlZyB8fCBcIlwiO1xyXG5cdGxvY2FsU3RvcmFnZS5vTGF0aXR1ZGVEZWNEZWcgPSB3aW5kb3cuZW0uQmVvYmFjaHR1bmcub0xhdGl0dWRlRGVjRGVnIHx8IFwiXCI7XHJcblx0bG9jYWxTdG9yYWdlLm9MYWdlZ2VuYXVpZ2tlaXQgPSB3aW5kb3cuZW0uQmVvYmFjaHR1bmcub0xhZ2VnZW5hdWlna2VpdCB8fCBcIlwiO1xyXG5cdGxvY2FsU3RvcmFnZS5vWEtvb3JkID0gd2luZG93LmVtLkJlb2JhY2h0dW5nLm9YS29vcmQ7XHJcblx0bG9jYWxTdG9yYWdlLm9ZS29vcmQgPSB3aW5kb3cuZW0uQmVvYmFjaHR1bmcub1lLb29yZDtcclxuXHR3aW5kb3cuZW0uc2V0emVGaXhlRmVsZGVySW5CZW9iRWRpdCh3aW5kb3cuZW0uQmVvYmFjaHR1bmcpO1xyXG5cdHdpbmRvdy5lbS5lcnN0ZWxsZUR5bmFtaXNjaGVGZWxkZXJCZW9iRWRpdCgpO1xyXG5cdHdpbmRvdy5lbS5ibGVuZGVNZW51cygpO1xyXG5cdC8vIGxldHp0ZSB1cmwgc3BlaWNoZXJuIC0gaGllciB1bmQgbmljaHQgaW0gcGFnZXNob3csIGRhbWl0IGVzIGJlaSBqZWRlbSBEYXRlbnNhdHp3ZWNoc2VsIHBhc3NpZXJ0XHJcblx0d2luZG93LmVtLnNwZWljaGVyZUxldHp0ZVVybCgpO1xyXG59O1xyXG5cclxuLy8gZ2VuZXJpZXJ0IGluIEJlb2JFZGl0Lmh0bWwgZHluYW1pc2NoIGRpZSB2b24gZGVuIFNpY2h0YmFya2VpdHMtRWluc3RlbGx1bmdlbiBhYmjDpG5naWdlbiBGZWxkZXJcclxuLy8gdW5kIGFrdHVhbGlzaWVydCBkaWUgTGlua3MgZsO8ciBwYWdpbmF0aW9uXHJcbi8vIE1pdGdlYmVuOiBpZCBkZXIgQmVvYmFjaHR1bmcsIFVzZXJuYW1lXHJcbndpbmRvdy5lbS5lcnN0ZWxsZUR5bmFtaXNjaGVGZWxkZXJCZW9iRWRpdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgaHRtbENvbnRhaW5lciA9IHdpbmRvdy5lbS5nZW5lcmllcmVIdG1sRsO8ckJlb2JFZGl0Rm9ybSgpO1xyXG5cdC8vIExpbmllIG51ciBhbmbDvGdlbiwgd2VubiBGZWxkZXIgZXJzdGVsbHQgd3VyZGVuXHJcblx0aWYgKGh0bWxDb250YWluZXIpIHtcclxuXHRcdGh0bWxDb250YWluZXIgPSBcIjxociAvPlwiICsgaHRtbENvbnRhaW5lcjtcclxuXHR9IGVsc2Uge1xyXG5cdFx0aHRtbENvbnRhaW5lciA9IFwiXCI7XHJcblx0fVxyXG5cdC8vIG7DtnRpZywgd2VpbCBzb25zdCBkaWUgZHluYW1pc2NoIGVpbmdlZsO8Z3RlbiBFbGVtZW50ZSBuaWNodCBlcnNjaGVpbmVuIChGZWxkZXIpIGJ6dy4gbmljaHQgZnVua3Rpb25pZXJlbiAobGlua3MpXHJcblx0JChcIiNCZW9iRWRpdEZvcm1IdG1sXCIpLmh0bWwoaHRtbENvbnRhaW5lcikudHJpZ2dlcihcImNyZWF0ZVwiKS50cmlnZ2VyKFwicmVmcmVzaFwiKTtcclxuXHQvLyBqZXR6dCBhbGxlIEZsaXBzd2l0c2NoZXMsIGRpZSBcIm5laW5cIiBzaW5kLCBha3RpdiBzZXR6ZW5cclxuXHR3aW5kb3cuZW0uYWt0aXZpZXJlRmxpcHN3aXRjaGVzKFwiI0Jlb2JFZGl0Rm9ybUh0bWxcIiwgd2luZG93LmVtLkJlb2JhY2h0dW5nKTtcclxuXHJcblx0JChcIiNCZW9iRWRpdFwiKS50cmlnZ2VyKFwiY3JlYXRlXCIpLnRyaWdnZXIoXCJyZWZyZXNoXCIpO1xyXG59O1xyXG5cclxuLy8gc2V0enQgZGllIFZhbHVlcyBpbiBkaWUgaGFydCBjb2RpZXJ0ZW4gRmVsZGVyIGltIEZvcm11bGFyIEJlb2JFZGl0Lmh0bWxcclxuLy8gZXJ3YXJ0ZXQgZGFzIE9iamVrdCBCZW9iLCB3ZWxjaGVzIGRpZSBXZXJ0ZSBlbnRow6RsdFxyXG53aW5kb3cuZW0uc2V0emVGaXhlRmVsZGVySW5CZW9iRWRpdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuICAgIHZhciAkYUFydEdydXBwZUJFID0gJChcIiNhQXJ0R3J1cHBlQkVcIiksXHJcbiAgICAgICAgJGFBcnROYW1lQkUgPSAkKFwiI2FBcnROYW1lQkVcIik7XHJcblx0JGFBcnRHcnVwcGVCRS5zZWxlY3RtZW51KCk7XHJcblx0JGFBcnRHcnVwcGVCRS5odG1sKFwiPG9wdGlvbiB2YWx1ZT0nXCIgKyB3aW5kb3cuZW0uQmVvYmFjaHR1bmcuYUFydEdydXBwZSArIFwiJz5cIiArIHdpbmRvdy5lbS5CZW9iYWNodHVuZy5hQXJ0R3J1cHBlICsgXCI8L29wdGlvbj5cIik7XHJcblx0JGFBcnRHcnVwcGVCRS52YWwod2luZG93LmVtLkJlb2JhY2h0dW5nLmFBcnRHcnVwcGUpO1xyXG5cdC8vIEpRVUVSWSBNT0JJTEUgQlJBQ0hUIE1BTkNITUFMIExBTkdFIFVNIFpVIElOSVRJQUxJSUVSRU5cclxuXHQvLyBPSE5FIFRJTUVPVVQgUkVLTEFNSUVSVCBFUyBCRUlNIFJFRlJFU0gsIERBUyBXSURHRVQgU0VJIE5PQ0ggTklDSFQgSU5JVElBTElTSUVSVCEhISFcclxuXHQvLyBOQUNIIEVJTiBNQUwgVkVSWsOWR0VSTiBIQVQgRVMgQUJFUiBXSUVERVIgRlVOS1RJT05JRVJUPz8/PyEhISFcclxuXHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0JGFBcnRHcnVwcGVCRS5zZWxlY3RtZW51KFwicmVmcmVzaFwiKTtcclxuXHR9LCAwKTtcclxuXHQkYUFydE5hbWVCRS5zZWxlY3RtZW51KCk7XHJcblx0JGFBcnROYW1lQkUuaHRtbChcIjxvcHRpb24gdmFsdWU9J1wiICsgd2luZG93LmVtLkJlb2JhY2h0dW5nLmFBcnROYW1lICsgXCInPlwiICsgd2luZG93LmVtLkJlb2JhY2h0dW5nLmFBcnROYW1lICsgXCI8L29wdGlvbj5cIik7XHJcblx0JGFBcnROYW1lQkUudmFsKHdpbmRvdy5lbS5CZW9iYWNodHVuZy5hQXJ0TmFtZSk7XHJcblx0JGFBcnROYW1lQkUuc2VsZWN0bWVudShcInJlZnJlc2hcIik7XHJcblx0JChcIltuYW1lPSdhQXV0b3InXVwiKS52YWwod2luZG93LmVtLkJlb2JhY2h0dW5nLmFBdXRvcik7XHJcblx0JChcIltuYW1lPSdvWEtvb3JkJ11cIikudmFsKHdpbmRvdy5lbS5CZW9iYWNodHVuZy5vWEtvb3JkKTtcclxuXHQkKFwiW25hbWU9J29ZS29vcmQnXVwiKS52YWwod2luZG93LmVtLkJlb2JhY2h0dW5nLm9ZS29vcmQpO1xyXG5cdCQoXCJbbmFtZT0nb0xhZ2VnZW5hdWlna2VpdCddXCIpLnZhbCh3aW5kb3cuZW0uQmVvYmFjaHR1bmcub0xhZ2VnZW5hdWlna2VpdCk7XHJcblx0JChcIltuYW1lPSd6RGF0dW0nXVwiKS52YWwod2luZG93LmVtLkJlb2JhY2h0dW5nLnpEYXR1bSk7XHJcblx0JChcIltuYW1lPSd6VWhyemVpdCddXCIpLnZhbCh3aW5kb3cuZW0uQmVvYmFjaHR1bmcuelVocnplaXQpO1xyXG59O1xyXG5cclxuLy8gZ2VuZXJpZXJ0IGRhcyBIdG1sIGbDvHIgZGFzIEZvcm11bGFyIGluIEJlb2JFZGl0Lmh0bWxcclxuLy8gZXJ3YXJ0ZXQgRmVsZGxpc3RlIGFscyBPYmpla3Q7IEJlb2IgYWxzIE9iamVrdCwgQXJ0Z3J1cHBlXHJcbi8vIGRlciBodG1sQ29udGFpbmVyIHdpcmQgenVyw7xjayBnZWdlYmVuXHJcbndpbmRvdy5lbS5nZW5lcmllcmVIdG1sRsO8ckJlb2JFZGl0Rm9ybSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgaHRtbENvbnRhaW5lciA9IFwiXCIsXHJcblx0XHRBcnRHcnVwcGUgPSB3aW5kb3cuZW0uQmVvYmFjaHR1bmcuYUFydEdydXBwZSxcclxuICAgICAgICBGZWxkV2VydDtcclxuXHRfLmVhY2god2luZG93LmVtLkZlbGRsaXN0ZUJlb2JFZGl0LnJvd3MsIGZ1bmN0aW9uKHJvdykge1xyXG5cdFx0dmFyIEZlbGQgPSByb3cuZG9jLFxyXG5cdFx0XHRGZWxkTmFtZSA9IEZlbGQuRmVsZE5hbWU7XHJcblx0XHQvLyBudXIgc2ljaHRiYXJlIGVpZ2VuZSBGZWxkZXIuIEJlcmVpdHMgaW0gRm9ybXVsYXIgaW50ZWdyaWVydGUgRmVsZGVyIG5pY2h0IGFuemVpZ2VuXHJcblx0XHRpZiAoKEZlbGQuVXNlciA9PT0gbG9jYWxTdG9yYWdlLkVtYWlsIHx8IEZlbGQuVXNlciA9PT0gXCJaZW50cmVuQmRLdFwiKSAmJiBGZWxkLlNpY2h0YmFySW1Nb2R1c0VpbmZhY2guaW5kZXhPZihsb2NhbFN0b3JhZ2UuRW1haWwpICE9PSAtMSAmJiBbJ2FBcnRHcnVwcGUnLCAnYUFydE5hbWUnLCAnYUF1dG9yJywgJ2FBdXRvcicsICdvWEtvb3JkJywgJ29ZS29vcmQnLCAnb0xhZ2VnZW5hdWlna2VpdCcsICd6RGF0dW0nLCAnelVocnplaXQnXS5pbmRleE9mKEZlbGROYW1lKSA9PT0gLTEpIHtcclxuXHRcdFx0Ly8gSW4gSGllcmFyY2hpZXN0dWZlIEFydCBtdXNzIGRpZSBBcnRncnVwcGUgaW0gRmVsZCBBcnRncnVwcGVuIGVudGhhbHRlbiBzZWluXHJcblx0XHRcdC8vIHZvcnNpY2h0OiBFcmZhc3N0IGplbWFuZCBlaW4gRmVsZCBkZXIgSGllcmFyY2hpZXN0dWZlIEFydCBvaG5lIEFydGdydXBwZSwgc29sbHRlIGRhcyBrZWluZW4gRmVobGVyIGF1c2zDtnNlblxyXG5cdFx0XHRpZiAoRmVsZC5IaWVyYXJjaGllc3R1ZmUgIT09IFwiQXJ0XCIgfHwgKHR5cGVvZiBGZWxkLkFydEdydXBwZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiAoRmVsZC5BcnRHcnVwcGUuaW5kZXhPZihBcnRHcnVwcGUpID49IDAgfHwgRmVsZC5BcnRHcnVwcGVbMF0gPT09IFwiYWxsZVwiKSkpIHtcclxuXHRcdFx0XHRpZiAobG9jYWxTdG9yYWdlLlN0YXR1cyA9PT0gXCJuZXVcIiAmJiBGZWxkLlN0YW5kYXJkd2VydCAmJiBGZWxkLlN0YW5kYXJkd2VydFtsb2NhbFN0b3JhZ2UuRW1haWxdKSB7XHJcblx0XHRcdFx0XHRGZWxkV2VydCA9IEZlbGQuU3RhbmRhcmR3ZXJ0W2xvY2FsU3RvcmFnZS5FbWFpbF07XHJcblx0XHRcdFx0XHQvLyBPYmpla3QgQmVvYiB1bSBkZW4gU3RhbmRhcmR3ZXJ0IGVyZ8OkbnplbiwgdW0gc3DDpHRlciB6dSBzcGVpY2hlcm5cclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5CZW9iYWNodHVuZ1tGZWxkTmFtZV0gPSBGZWxkV2VydDtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0Ly8gXCJcIiB2ZXJoaW5kZXJ0IGRpZSBBbnplaWdlIHZvbiB1bmRlZmluZWQgaW0gRmVsZFxyXG5cdFx0XHRcdFx0RmVsZFdlcnQgPSB3aW5kb3cuZW0uQmVvYmFjaHR1bmdbRmVsZE5hbWVdIHx8IFwiXCI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGh0bWxDb250YWluZXIgKz0gd2luZG93LmVtLmdlbmVyaWVyZUh0bWxGw7xyRm9ybXVsYXJlbGVtZW50KEZlbGQsIEZlbGRXZXJ0KTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdGlmIChsb2NhbFN0b3JhZ2UuU3RhdHVzID09PSBcIm5ldVwiKSB7XHJcblx0XHQvLyBpbiBuZXVlbiBEYXRlbnPDpHR6ZW4gZHluYW1pc2NoIGVyc3RlbGx0ZSBTdGFuZGFyZHdlcnRlIHNwZWljaGVyblxyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLnNhdmVEb2Mod2luZG93LmVtLkJlb2JhY2h0dW5nLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uQmVvYmFjaHR1bmcuX2lkID0gZGF0YS5pZDtcclxuXHRcdFx0XHR3aW5kb3cuZW0uQmVvYmFjaHR1bmcuX3JldiA9IGRhdGEucmV2O1xyXG5cdFx0XHRcdGxvY2FsU3RvcmFnZS5CZW9iSWQgPSBkYXRhLmlkO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5HZXRHZW9sb2NhdGlvbihkYXRhLmlkLCBcIkJlb2JhY2h0dW5nXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuU3RhdHVzO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBOZXVlIERhdGVuc8OkdHplIGhhYmVuIGtlaW5lIEF0dGFjaG1lbnRzXHJcblx0XHR3aW5kb3cuZW0uemVpZ2VBdHRhY2htZW50cyh3aW5kb3cuZW0uQmVvYmFjaHR1bmcsIFwiQkVcIik7XHJcblx0fVxyXG5cdHJldHVybiBodG1sQ29udGFpbmVyO1xyXG59O1xyXG5cclxuLy8gQmVvYkxpc3RlIGluIEJlb2JMaXN0Lmh0bWwgdm9sbHN0w6RuZGlnIG5ldSBhdWZiYXVlblxyXG53aW5kb3cuZW0uaW5pdGlpZXJlQmVvYmxpc3RlID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIGhhdCBCZW9iRWRpdC5odG1sIGVpbmUgQmVvYkxpc3RlIMO8YmVyZ2ViZW4/XHJcblx0aWYgKHdpbmRvdy5lbS5CZW9iTGlzdGUpIHtcclxuXHRcdC8vIEJlb2JsaXN0ZSBhdXMgZ2xvYmFsZXIgVmFyaWFibGUgaG9sZW4gLSBtdXNzIG5pY2h0IGdlcGFyc3Qgd2VyZGVuXHJcblx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlQmVvYmxpc3RlXzIoKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gQmVvYmxpc3RlIGF1cyBEQiBob2xlblxyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLnZpZXcoJ2V2YWIvQmVvYkxpc3RlP3N0YXJ0a2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCIse31dJmVuZGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiXSZkZXNjZW5kaW5nPXRydWUmaW5jbHVkZV9kb2NzPXRydWUnLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHQvLyBCZW9iTGlzdGUgZsO8ciBCZW9iRWRpdCBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdFx0d2luZG93LmVtLkJlb2JMaXN0ZSA9IGRhdGE7XHJcblx0XHRcdFx0d2luZG93LmVtLmluaXRpaWVyZUJlb2JsaXN0ZV8yKCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5pbml0aWllcmVCZW9ibGlzdGVfMiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgYW56QmVvYiA9IHdpbmRvdy5lbS5CZW9iTGlzdGUucm93cy5sZW5ndGgsXHJcblx0XHRiZW9iLFxyXG5cdFx0a2V5LFxyXG5cdFx0bGlzdEl0ZW1Db250YWluZXIgPSBcIlwiLFxyXG5cdFx0VGl0ZWwyLFxyXG5cdFx0YXJ0Z3J1cHBlbm5hbWU7XHJcblxyXG5cdC8vIEltIFRpdGVsIGRlciBTZWl0ZSBkaWUgQW56YWhsIEJlb2JhY2h0dW5nZW4gYW56ZWlnZW5cclxuXHRUaXRlbDIgPSBcIiBCZW9iYWNodHVuZ2VuXCI7XHJcblx0aWYgKGFuekJlb2IgPT09IDEpIHtcclxuXHRcdFRpdGVsMiA9IFwiIEJlb2JhY2h0dW5nXCI7XHJcblx0fVxyXG5cdCQoXCIjQmVvYkxpc3RlUGFnZUhlYWRlclwiKVxyXG4gICAgICAgIC5maW5kKFwiLkJlb2JMaXN0ZVBhZ2VUaXRlbFwiKVxyXG4gICAgICAgIC50ZXh0KGFuekJlb2IgKyBUaXRlbDIpO1xyXG5cclxuXHRpZiAoYW56QmVvYiA9PT0gMCkge1xyXG5cdFx0bGlzdEl0ZW1Db250YWluZXIgPSAnPGxpPjxhIGhyZWY9XCIjXCIgY2xhc3M9XCJlcnN0ZSBOZXVlQmVvYkJlb2JMaXN0ZVwiPkVyc3RlIEJlb2JhY2h0dW5nIGVyZmFzc2VuPC9hPjwvbGk+JztcclxuXHR9IGVsc2Uge1xyXG5cdFx0Xy5lYWNoKHdpbmRvdy5lbS5CZW9iTGlzdGUucm93cywgZnVuY3Rpb24ocm93KSB7XHJcblx0XHRcdGJlb2IgPSByb3cuZG9jO1xyXG5cdFx0XHRrZXkgPSByb3cua2V5O1xyXG5cdFx0XHRhcnRncnVwcGVubmFtZSA9IGVuY29kZVVSSUNvbXBvbmVudChiZW9iLmFBcnRHcnVwcGUucmVwbGFjZSgnw7wnLCAndWUnKS5yZXBsYWNlKCfDpCcsICdhZScpLnJlcGxhY2UoJ8O2JywgJ29lJykpICsgXCIucG5nXCI7XHJcblx0XHRcdGlmIChiZW9iLmFBcnRHcnVwcGUgPT09IFwiRGl2ZXJzZUluc2VrdGVuXCIpIHtcclxuXHRcdFx0XHRhcnRncnVwcGVubmFtZSA9IFwidW5iZW5hbm50LnBuZ1wiO1xyXG5cdFx0XHR9XHJcblx0XHRcdGxpc3RJdGVtQ29udGFpbmVyICs9IFwiPGxpIGNsYXNzPSdiZW9iIHVpLWxpLWhhcy10aHVtYicgaWQ9J1wiO1xyXG5cdFx0XHRsaXN0SXRlbUNvbnRhaW5lciArPSBiZW9iLl9pZDtcclxuXHRcdFx0bGlzdEl0ZW1Db250YWluZXIgKz0gXCInPjxhIGhyZWY9JyMnPjxpbWcgY2xhc3M9J3VpLWxpLXRodW1iJyBzcmM9J1wiO1xyXG5cdFx0XHRsaXN0SXRlbUNvbnRhaW5lciArPSBcIkFydGdydXBwZW5iaWxkZXIvXCIgKyBhcnRncnVwcGVubmFtZTtcclxuXHRcdFx0bGlzdEl0ZW1Db250YWluZXIgKz0gXCInIC8+PGgzIGNsYXNzPSdhQXJ0TmFtZSc+XCI7XHJcblx0XHRcdGxpc3RJdGVtQ29udGFpbmVyICs9IGJlb2IuYUFydE5hbWU7XHJcblx0XHRcdGxpc3RJdGVtQ29udGFpbmVyICs9IFwiPFxcL2gzPjxwIGNsYXNzPSd6VWhyemVpdCc+XCI7XHJcblx0XHRcdGxpc3RJdGVtQ29udGFpbmVyICs9IGJlb2IuekRhdHVtO1xyXG5cdFx0XHRsaXN0SXRlbUNvbnRhaW5lciArPSBcIiZuYnNwOyAmbmJzcDtcIjtcclxuXHRcdFx0bGlzdEl0ZW1Db250YWluZXIgKz0gYmVvYi56VWhyemVpdDtcclxuXHRcdFx0bGlzdEl0ZW1Db250YWluZXIgKz0gXCI8XFwvcD48XFwvYT4gPFxcL2xpPlwiO1xyXG5cdFx0fSk7XHJcblx0fVxyXG4gICAgJChcIiNCZW9ibGlzdGVCTFwiKVxyXG4gICAgICAgIC5odG1sKGxpc3RJdGVtQ29udGFpbmVyKVxyXG4gICAgICAgIC5saXN0dmlldyhcInJlZnJlc2hcIik7XHJcblx0d2luZG93LmVtLmJsZW5kZU1lbnVzKCk7XHJcblx0Ly8gRm9rdXMgaW4gZGFzIFN1Y2hmZWxkIHNldHplblxyXG5cdCQoXCIjQmVvYkxpc3RlXCIpXHJcbiAgICAgICAgLmZpbmQoXCIudWktaW5wdXQtc2VhcmNoXCIpXHJcbiAgICAgICAgLmNoaWxkcmVuKFwiaW5wdXRcIilbMF1cclxuICAgICAgICAuZm9jdXMoKTtcclxuXHR3aW5kb3cuZW0uc3BlaWNoZXJlTGV0enRlVXJsKCk7XHJcbn07XHJcblxyXG4vLyBsw7ZzY2h0IEFuaMOkbmdlXHJcbi8vIGVyd2FydGV0IGRlbiBEYXRlbnNhdHogYWxzIE9iamVrdCB1bmQgZGFzIE9iamVrdCwgZGFzcyBnZWtsaWNrdCB3dXJkZVxyXG53aW5kb3cuZW0ubMO2c2NoZUFuaGFuZyA9IGZ1bmN0aW9uKHRoYXQsIE9iamVrdCwgaWQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKE9iamVrdCkge1xyXG5cdFx0Ly8gRXMgd3VyZGUgZWluIE9iamVrdCDDvGJlcmdlYmVuLCBrZWluZSBEQi1BYmZyYWdlIG7DtnRpZ1xyXG5cdFx0d2luZG93LmVtLmzDtnNjaGVBbmhhbmdfMih0aGF0LCBPYmpla3QpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBPYmpla3QgYXVzIGRlciBEQiBob2xlblxyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLm9wZW5Eb2MoaWQsIHtcclxuXHRcdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbVtPYmpla3QuVHlwXSA9IGRhdGE7XHJcblx0XHRcdFx0d2luZG93LmVtLmzDtnNjaGVBbmhhbmdfMih0aGF0LCB3aW5kb3cuZW1bT2JqZWt0LlR5cF0pO1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRmVobGVyOiBBbmhhbmcgd3VyZGUgbmljaHQgZW50ZmVybnRcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5sw7ZzY2hlQW5oYW5nXzIgPSBmdW5jdGlvbih0aGF0LCBPYmpla3QpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIERhdGVpbmFtZSA9IHRoYXQuaWQ7XHJcblx0Ly8gQW5oYW5nIGF1cyBPYmpla3QgZW50ZmVybmVuXHJcblx0ZGVsZXRlIHdpbmRvdy5lbVtPYmpla3QuVHlwXS5fYXR0YWNobWVudHNbRGF0ZWluYW1lXTtcclxuXHQvLyBPYmpla3QgaW4gREIgc3BlaWNoZXJuXHJcblx0JGRiLnNhdmVEb2Mod2luZG93LmVtW09iamVrdC5UeXBdLCB7XHJcblx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdC8vIHJldiBpbSBPYmpla3QgZXJnw6RuemVuXHJcblx0XHRcdC8vIGRpZSBnbG9iYWxlIFZhcmlhYmxlIGhlaXNzdCBnbGVpY2gsIHdpZSBkZXIgVHlwIGltIE9iamVrdFxyXG5cdFx0XHR3aW5kb3cuZW1bT2JqZWt0LlR5cF0uX3JldiA9IGRhdGEucmV2O1xyXG5cdFx0XHQvLyBpbSBGb3JtdWxhciBkZW4gQW5oYW5nIHVuZCBkaWUgTMO2c2NoLVNjaGFsdGZsw6RjaGUgZW50ZmVybmVuXHJcblx0XHRcdCQodGhhdCkucGFyZW50KCkucGFyZW50KCkucmVtb3ZlKCk7XHJcblx0XHR9LFxyXG5cdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJGZWhsZXI6IEFuaMOkbmdlIHdlcmRlbiBuaWNodCByaWNodGlnIGFuZ2V6ZWlndFwiKTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbi8vIGluaXRpaWVydCBVc2VyRWRpdC5odG1sXHJcbndpbmRvdy5lbS5pbml0aWllcmVVc2VyRWRpdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQkKFwiI3VlX0VtYWlsXCIpLnZhbChsb2NhbFN0b3JhZ2UuRW1haWwpO1xyXG5cdCQoXCJbbmFtZT0nRGF0ZW52ZXJ3ZW5kdW5nJ11cIikuY2hlY2tib3hyYWRpbygpO1xyXG5cdGlmIChsb2NhbFN0b3JhZ2UuQXV0b3IpIHtcclxuXHRcdCQoXCIjQXV0b3JcIikudmFsKGxvY2FsU3RvcmFnZS5BdXRvcik7XHJcblx0fVxyXG5cdCQuY291Y2gudXNlckRiKGZ1bmN0aW9uKGRiKSB7XHJcblx0XHRkYi5vcGVuRG9jKFwib3JnLmNvdWNoZGIudXNlcjpcIiArIGxvY2FsU3RvcmFnZS5FbWFpbCwge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihVc2VyKSB7XHJcblx0XHRcdFx0Ly8gZml4ZSBGZWxkZXIgYWt0dWFsaXNpZXJlblxyXG5cdFx0XHRcdGlmIChVc2VyLkRhdGVudmVyd2VuZHVuZykge1xyXG5cdFx0XHRcdFx0JChcIiNcIiArIFVzZXIuRGF0ZW52ZXJ3ZW5kdW5nKS5wcm9wKFwiY2hlY2tlZFwiLHRydWUpLmNoZWNrYm94cmFkaW8oXCJyZWZyZXNoXCIpO1xyXG5cdFx0XHRcdFx0bG9jYWxTdG9yYWdlLkRhdGVudmVyd2VuZHVuZyA9IFVzZXIuRGF0ZW52ZXJ3ZW5kdW5nO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQvLyBTdGFuZGFyZHdlcnQgc2V0emVuXHJcblx0XHRcdFx0XHQkKFwiI0phQWJlclwiKS5wcm9wKFwiY2hlY2tlZFwiLHRydWUpLmNoZWNrYm94cmFkaW8oXCJyZWZyZXNoXCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR3aW5kb3cuZW0uYmxlbmRlTWVudXMoKTtcclxuXHRcdFx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlTGV0enRlVXJsKCk7XHJcblx0XHRcdH0sXHJcblx0XHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyIGluIHdpbmRvdy5lbS5pbml0aWllcmVVc2VyRWRpdCcpO1xyXG5cdFx0XHRcdC8vIFN0YW5kYXJkd2VydCBzZXR6ZW5cclxuXHRcdFx0XHQkKFwiI0phQWJlclwiKS5wcm9wKFwiY2hlY2tlZFwiLHRydWUpLmNoZWNrYm94cmFkaW8oXCJyZWZyZXNoXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9KTtcclxufTtcclxuXHJcbi8vIGluaXRpaWVydCBJbnN0YWxsaWVyZW4uaHRtbFxyXG4vLyBrdXJ6LCBkYSBrZWluZSBEYXRlbiBiZW7DtnRpZ3Qgd2VyZGVuXHJcbndpbmRvdy5lbS5pbml0aWllcmVJbnN0YWxsaWVyZW4gPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93LmVtLmJsZW5kZU1lbnVzKCk7XHJcblx0d2luZG93LmVtLnNwZWljaGVyZUxldHp0ZVVybCgpO1xyXG59O1xyXG5cclxuLy8gZ2VuZXJpZXJ0IGluIGhQcm9qZWt0RWRpdC5odG1sIGR5bmFtaXNjaCBkaWUgdm9uIGRlbiBTaWNodGJhcmtlaXRzLUVpbnN0ZWxsdW5nZW4gYWJow6RuZ2lnZW4gRmVsZGVyXHJcbi8vIE1pdGdlYmVuOiBpZCBkZXMgUHJvamVrdHMsIFVzZXJuYW1lXHJcbi8vIGJlaSBuZXVlbiBQcm9qZWt0ZW4gd2lyZCBkYXMgenV2b3IgZXJ6ZXVndGUgUHJvamVrdCDDvGJlcm5vbW1lbiwgdW0gZGllIERCLUFuZnJhZ2UgenUgc3BhcmVuXHJcbndpbmRvdy5lbS5pbml0aWllcmVQcm9qZWt0RWRpdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBBbmjDpG5nZSBhdXNibGVuZGVuLCB3ZWlsIHNvbnN0IGJlaW0gRWluYmxlbmRlbiBkaWVqZW5pZ2VuIGRlcyB2b3JpZ2VuIERhdGVuc2F0emVzIGF1ZmJsaXR6ZW5cclxuXHQvLyQoJyNBbmjDpG5nZWhQRScpLmhpZGUoKS50cmlnZ2VyKCd1cGRhdGVsYXlvdXQnKTtcclxuXHQvLyB3aW5kb3cuZW0uaFByb2pla3QgZXhpc3RpZXJ0IHNjaG9uIGJlaSBuZXVlbSBQcm9qZWt0XHJcblx0aWYgKHdpbmRvdy5lbS5oUHJvamVrdCkge1xyXG5cdFx0d2luZG93LmVtLmluaXRpaWVyZVByb2pla3RFZGl0XzIoKTtcclxuXHR9IGVsc2UgaWYgKGxvY2FsU3RvcmFnZS5TdGF0dXMgPT09IFwibmV1XCIgJiYgbG9jYWxTdG9yYWdlLmhQcm9qZWt0KSB7XHJcblx0XHQvLyB3ZW5uIG1pdCB3aW5kb3cub3BlbiB2b24gbmV1IGdla29tbWVuLCBleGlzdGllcnQgZGllIGdsb2JhbGUgVmFyaWFibGUgbmljaHQgbWVoclxyXG5cdFx0d2luZG93LmVtLmhQcm9qZWt0ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuaFByb2pla3QpO1xyXG5cdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5oUHJvamVrdDtcclxuXHRcdHdpbmRvdy5lbS5pbml0aWllcmVQcm9qZWt0RWRpdF8yKCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi5vcGVuRG9jKGxvY2FsU3RvcmFnZS5Qcm9qZWt0SWQsIHtcclxuXHRcdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5oUHJvamVrdCA9IGRhdGE7XHJcblx0XHRcdFx0d2luZG93LmVtLmluaXRpaWVyZVByb2pla3RFZGl0XzIoKTtcclxuXHRcdFx0fSxcclxuXHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdC8vIGhvcHBsYSwgenUgZGllc2VyIElEIGdpYnQgZXMga2VpbiBQcm9qZWt0ID4gU3BlaWNoZXIgbMO2c2NoZW4gdW5kIExpc3RlIGFuemVpZ2VuXHJcblx0XHRcdFx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVByb2pla3RFZGl0KFwibWl0TGF0TG5nTGlzdGVcIik7XHJcblx0XHRcdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJoUHJvamVrdExpc3RlLmh0bWxcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5pbml0aWllcmVQcm9qZWt0RWRpdF8yID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIGZpeGUgRmVsZGVyIGFrdHVhbGlzaWVyZW5cclxuXHQkKFwiI3BOYW1lXCIpLnZhbCh3aW5kb3cuZW0uaFByb2pla3QucE5hbWUpO1xyXG5cdC8vIFZhcmlhYmVsbiBiZXJlaXRzdGVsbGVuIChiZWkgbmV1ZW4gUHJvamVrdGVuIHdpcmQgUHJvamVrdElkIHNww6R0ZXIgbmFjaGdlc2Nob2JlbilcclxuXHRpZiAod2luZG93LmVtLmhQcm9qZWt0Ll9pZCkge1xyXG5cdFx0bG9jYWxTdG9yYWdlLlByb2pla3RJZCA9IHdpbmRvdy5lbS5oUHJvamVrdC5faWQ7XHJcblx0fSBlbHNlIHtcclxuXHRcdGxvY2FsU3RvcmFnZS5Qcm9qZWt0SWQgPSBcIm5ldVwiO1xyXG5cdH1cclxuXHQvLyBwcsO8ZmVuLCBvYiBkaWUgRmVsZGxpc3RlIHNjaG9uIGdlaG9sdCB3dXJkZVxyXG5cdC8vIHdlbm4gamE6IGRlcmVuIGdsb2JhbGUgVmFyaWFibGUgdmVyd2VuZGVuXHJcblx0aWYgKHdpbmRvdy5lbS5GZWxkbGlzdGVQcm9qZWt0KSB7XHJcblx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlUHJvamVrdEVkaXRfMygpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBkYXMgZGF1ZXJ0IGzDpG5nZXIgLSBIaW53ZWlzIGVpbmJsZW5kZW5cclxuXHRcdCQoXCIjaFByb2pla3RFZGl0Rm9ybUh0bWxcIikuaHRtbCgnPHAgY2xhc3M9XCJIaW53ZWlzRHluYW1pc2NoZXJGZWxkYXVmYmF1XCI+RGllIEZlbGRlciB3ZXJkZW4gYXVmZ2ViYXV0Li4uPC9wPicpO1xyXG5cdFx0Ly8gRmVsZGxpc3RlIGF1cyBkZXIgREIgaG9sZW5cclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi52aWV3KCdldmFiL0ZlbGRMaXN0ZVByb2pla3Q/aW5jbHVkZV9kb2NzPXRydWUnLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKEZlbGRsaXN0ZSkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5GZWxkbGlzdGVQcm9qZWt0ID0gRmVsZGxpc3RlO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5pbml0aWllcmVQcm9qZWt0RWRpdF8zKCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5pbml0aWllcmVQcm9qZWt0RWRpdF8zID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBodG1sQ29udGFpbmVyID0gd2luZG93LmVtLmdlbmVyaWVyZUh0bWxGw7xyUHJvamVrdEVkaXRGb3JtKCk7XHJcblx0Ly8gTGluaWUgbnVyIGFuZsO8Z2VuLCB3ZW5uIEZlbGRlciBlcnN0ZWxsdCB3dXJkZW5cclxuXHRpZiAoaHRtbENvbnRhaW5lcikge1xyXG5cdFx0aHRtbENvbnRhaW5lciA9IFwiPGhyIC8+XCIgKyBodG1sQ29udGFpbmVyO1xyXG5cdH1cclxuXHQkKFwiI2hQcm9qZWt0RWRpdEZvcm1IdG1sXCIpLmh0bWwoaHRtbENvbnRhaW5lcikudHJpZ2dlcihcImNyZWF0ZVwiKS50cmlnZ2VyKFwicmVmcmVzaFwiKTtcclxuXHQvLyBqZXR6dCBhbGxlIEZsaXBzd2l0c2NoZXMsIGRpZSBcIm5laW5cIiBzaW5kLCBha3RpdiBzZXR6ZW5cclxuXHR3aW5kb3cuZW0uYWt0aXZpZXJlRmxpcHN3aXRjaGVzKFwiI2hQcm9qZWt0RWRpdEZvcm1IdG1sXCIsIHdpbmRvdy5lbS5oUHJvamVrdCk7XHJcblx0d2luZG93LmVtLmJsZW5kZU1lbnVzKCk7XHJcblx0Ly8gbGV0enRlIHVybCBzcGVpY2hlcm4gLSBoaWVyIHVuZCBuaWNodCBpbSBwYWdlc2hvdywgZGFtaXQgZXMgYmVpIGplZGVtIERhdGVuc2F0endlY2hzZWwgcGFzc2llcnRcclxuXHR3aW5kb3cuZW0uc3BlaWNoZXJlTGV0enRlVXJsKCk7XHJcbn07XHJcblxyXG4vLyBnZW5lcmllcnQgZGFzIEh0bWwgZsO8ciBkYXMgRm9ybXVsYXIgaW4gaFByb2pla3RFZGl0Lmh0bWxcclxuLy8gZXJ3YXJ0ZXQgRmVsZGxpc3RlIGFscyBPYmpla3Q7IFByb2pla3QgYWxzIE9iamVrdFxyXG4vLyBkZXIgaHRtbENvbnRhaW5lciB3aXJkIHp1csO8Y2sgZ2VnZWJlblxyXG53aW5kb3cuZW0uZ2VuZXJpZXJlSHRtbEbDvHJQcm9qZWt0RWRpdEZvcm0gPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIEZlbGQgPSB7fSxcclxuXHRcdEZlbGROYW1lLFxyXG4gICAgICAgIEZlbGRXZXJ0LFxyXG5cdFx0aHRtbENvbnRhaW5lciA9IFwiXCI7XHJcblx0Xy5lYWNoKHdpbmRvdy5lbS5GZWxkbGlzdGVQcm9qZWt0LnJvd3MsIGZ1bmN0aW9uKHJvdykge1xyXG5cdFx0RmVsZCA9IHJvdy5kb2M7XHJcblx0XHRGZWxkTmFtZSA9IEZlbGQuRmVsZE5hbWU7XHJcblx0XHQvLyBudXIgc2ljaHRiYXJlIGVpZ2VuZSBGZWxkZXIuIEJlcmVpdHMgaW0gRm9ybXVsYXIgaW50ZWdyaWVydGUgRmVsZGVyIG5pY2h0IGFuemVpZ2VuXHJcblx0XHRpZiAoKEZlbGQuVXNlciA9PT0gbG9jYWxTdG9yYWdlLkVtYWlsIHx8IEZlbGQuVXNlciA9PT0gXCJaZW50cmVuQmRLdFwiKSAmJiBGZWxkLlNpY2h0YmFySW1Nb2R1c0hpZXJhcmNoaXNjaC5pbmRleE9mKGxvY2FsU3RvcmFnZS5FbWFpbCkgIT09IC0xICYmIEZlbGROYW1lICE9PSBcInBOYW1lXCIpIHtcclxuXHRcdFx0aWYgKGxvY2FsU3RvcmFnZS5TdGF0dXMgPT09IFwibmV1XCIgJiYgRmVsZC5TdGFuZGFyZHdlcnQgJiYgRmVsZC5TdGFuZGFyZHdlcnRbbG9jYWxTdG9yYWdlLkVtYWlsXSkge1xyXG5cdFx0XHRcdEZlbGRXZXJ0ID0gRmVsZC5TdGFuZGFyZHdlcnRbbG9jYWxTdG9yYWdlLkVtYWlsXTtcclxuXHRcdFx0XHQvLyB3aW5kb3cuZW0uaFByb2pla3QgdW0gZGVuIFN0YW5kYXJkd2VydCBlcmfDpG56ZW4sIHVtIHNww6R0ZXIgenUgc3BlaWNoZXJuXHJcblx0XHRcdFx0d2luZG93LmVtLmhQcm9qZWt0W0ZlbGROYW1lXSA9IEZlbGRXZXJ0O1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdC8vXCJcIiB2ZXJoaW5kZXJ0IGRpZSBBbnplaWdlIHZvbiB1bmRlZmluZWQgaW0gRmVsZFxyXG5cdFx0XHRcdEZlbGRXZXJ0ID0gd2luZG93LmVtLmhQcm9qZWt0W0ZlbGROYW1lXSB8fCBcIlwiO1xyXG5cdFx0XHR9XHJcblx0XHRcdGh0bWxDb250YWluZXIgKz0gd2luZG93LmVtLmdlbmVyaWVyZUh0bWxGw7xyRm9ybXVsYXJlbGVtZW50KEZlbGQsIEZlbGRXZXJ0KTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHRpZiAobG9jYWxTdG9yYWdlLlN0YXR1cyA9PT0gXCJuZXVcIikge1xyXG5cdFx0JChcIiNwTmFtZVwiKS5mb2N1cygpO1xyXG5cdFx0Ly8gaW4gbmV1ZW4gRGF0ZW5zw6R0emVuIGR5bmFtaXNjaCBlcnN0ZWxsdGUgU3RhbmRhcmR3ZXJ0ZSBzcGVpY2hlcm5cclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi5zYXZlRG9jKHdpbmRvdy5lbS5oUHJvamVrdCwge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLmhQcm9qZWt0Ll9pZCA9IGRhdGEuaWQ7XHJcblx0XHRcdFx0d2luZG93LmVtLmhQcm9qZWt0Ll9yZXYgPSBkYXRhLnJldjtcclxuXHRcdFx0XHQvL1xyXG5cdFx0XHRcdGxvY2FsU3RvcmFnZS5Qcm9qZWt0SWQgPSBkYXRhLmlkO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuU3RhdHVzO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBuZXVlIERhdGVuc8OkdHplIGhhYmVuIGtlaW5lIEF0dGFjaG1lbnRzXHJcblx0XHR3aW5kb3cuZW0uemVpZ2VBdHRhY2htZW50cyh3aW5kb3cuZW0uaFByb2pla3QsIFwiaFBFXCIpO1xyXG5cdH1cclxuXHRyZXR1cm4gaHRtbENvbnRhaW5lcjtcclxufTtcclxuXHJcbi8vIGluaXRpaWVydCBGZWxkRWRpdC5odG1sXHJcbndpbmRvdy5lbS5pbml0aWllcmVGZWxkRWRpdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBCZWkgbmV1ZW0gRmVsZCBnaWJ0IGVzIEZlbGQgc2Nob25cclxuXHRpZiAod2luZG93LmVtLkZlbGQpIHtcclxuXHRcdHdpbmRvdy5lbS5pbml0aWllcmVGZWxkRWRpdF8yKCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi5vcGVuRG9jKGxvY2FsU3RvcmFnZS5GZWxkSWQsIHtcclxuXHRcdFx0c3VjY2VzczogZnVuY3Rpb24oZG9jKSB7XHJcblx0XHRcdFx0Ly8gRmVsZCBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdFx0d2luZG93LmVtLkZlbGQgPSBkb2M7XHJcblx0XHRcdFx0d2luZG93LmVtLmluaXRpaWVyZUZlbGRFZGl0XzIoKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLmluaXRpaWVyZUZlbGRFZGl0XzIgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIFNpY2h0YmFySW1Nb2R1c0hpZXJhcmNoaXNjaCA9IHdpbmRvdy5lbS5GZWxkLlNpY2h0YmFySW1Nb2R1c0hpZXJhcmNoaXNjaCxcclxuICAgICAgICAkU2ljaHRiYXJJbU1vZHVzSGllcmFyY2hpc2NoID0gJChcIiNTaWNodGJhckltTW9kdXNIaWVyYXJjaGlzY2hcIiksXHJcbiAgICAgICAgU2ljaHRiYXJJbkhBcnRFZGl0TGlzdGUgPSB3aW5kb3cuZW0uRmVsZC5TaWNodGJhckluSEFydEVkaXRMaXN0ZSxcclxuICAgICAgICAkU2ljaHRiYXJJbkhBcnRFZGl0TGlzdGUgPSAkKFwiI1NpY2h0YmFySW5IQXJ0RWRpdExpc3RlXCIpLFxyXG5cdFx0U2ljaHRiYXJJbU1vZHVzRWluZmFjaCA9IHdpbmRvdy5lbS5GZWxkLlNpY2h0YmFySW1Nb2R1c0VpbmZhY2gsXHJcbiAgICAgICAgJFNpY2h0YmFySW1Nb2R1c0VpbmZhY2ggPSAkKFwiI1NpY2h0YmFySW1Nb2R1c0VpbmZhY2hcIiksXHJcblx0XHRTdGFuZGFyZHdlcnQsXHJcbiAgICAgICAgJFN0YW5kYXJkd2VydCA9ICQoXCIjU3RhbmRhcmR3ZXJ0XCIpO1xyXG5cclxuXHQvLyBhbGxlIHJhZGlvIHVuZCBjaGVja2JveGVuIGxlZXJlbiAoZGFtaXQga2VpbmUgdm9oZXIgZ2V3w6RobHRlbiBXZXJ0ZSB2ZXJibGVpYmVuKVxyXG5cdHdpbmRvdy5lbS5jaGVja0FsbFJhZGlvc09mRm9ybShcIkZlbGRFZGl0XCIsIGZhbHNlKTtcclxuXHJcblx0Ly8gU2ljaHRiYXJrZWl0IGFuemVpZ2VuXHJcblx0aWYgKFNpY2h0YmFySW1Nb2R1c0hpZXJhcmNoaXNjaCAmJiBTaWNodGJhckltTW9kdXNIaWVyYXJjaGlzY2guaW5kZXhPZihsb2NhbFN0b3JhZ2UuRW1haWwpID49IDApIHtcclxuICAgICAgICAkU2ljaHRiYXJJbU1vZHVzSGllcmFyY2hpc2NoXHJcbiAgICAgICAgICAgIC52YWwoXCJqYVwiKVxyXG4gICAgICAgICAgICAucGFyZW50KCkucmVtb3ZlQ2xhc3MoXCJ1aS1mbGlwc3dpdGNoLWFjdGl2ZVwiKTtcclxuXHR9IGVsc2Uge1xyXG4gICAgICAgICRTaWNodGJhckltTW9kdXNIaWVyYXJjaGlzY2hcclxuICAgICAgICAgICAgLnZhbChcIm5laW5cIilcclxuICAgICAgICAgICAgLnBhcmVudCgpLmFkZENsYXNzKFwidWktZmxpcHN3aXRjaC1hY3RpdmVcIik7XHJcblx0fVxyXG4gICAgaWYgKFNpY2h0YmFySW5IQXJ0RWRpdExpc3RlICYmIFNpY2h0YmFySW5IQXJ0RWRpdExpc3RlLmluZGV4T2YobG9jYWxTdG9yYWdlLkVtYWlsKSA+PSAwKSB7XHJcbiAgICAgICAgJFNpY2h0YmFySW5IQXJ0RWRpdExpc3RlXHJcbiAgICAgICAgICAgIC52YWwoXCJqYVwiKVxyXG4gICAgICAgICAgICAucGFyZW50KCkucmVtb3ZlQ2xhc3MoXCJ1aS1mbGlwc3dpdGNoLWFjdGl2ZVwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJFNpY2h0YmFySW5IQXJ0RWRpdExpc3RlXHJcbiAgICAgICAgICAgIC52YWwoXCJuZWluXCIpXHJcbiAgICAgICAgICAgIC5wYXJlbnQoKS5hZGRDbGFzcyhcInVpLWZsaXBzd2l0Y2gtYWN0aXZlXCIpO1xyXG4gICAgfVxyXG5cdGlmIChTaWNodGJhckltTW9kdXNFaW5mYWNoICYmIFNpY2h0YmFySW1Nb2R1c0VpbmZhY2guaW5kZXhPZihsb2NhbFN0b3JhZ2UuRW1haWwpID49IDApIHtcclxuICAgICAgICAkU2ljaHRiYXJJbU1vZHVzRWluZmFjaC52YWwoXCJqYVwiKTtcclxuICAgICAgICAkU2ljaHRiYXJJbU1vZHVzRWluZmFjaC5wYXJlbnQoKS5yZW1vdmVDbGFzcyhcInVpLWZsaXBzd2l0Y2gtYWN0aXZlXCIpO1xyXG5cdH0gZWxzZSB7XHJcbiAgICAgICAgJFNpY2h0YmFySW1Nb2R1c0VpbmZhY2gudmFsKFwibmVpblwiKTtcclxuICAgICAgICAkU2ljaHRiYXJJbU1vZHVzRWluZmFjaC5wYXJlbnQoKS5hZGRDbGFzcyhcInVpLWZsaXBzd2l0Y2gtYWN0aXZlXCIpO1xyXG5cdH1cclxuXHJcblx0Ly8gQXJ0Z3J1cHBlIEF1ZmJhdWVuLCB3ZW5uIEhpZXJhcmNoaWVzdHVmZSA9PSBBcnRcclxuXHRpZiAod2luZG93LmVtLkZlbGQuSGllcmFyY2hpZXN0dWZlID09PSBcIkFydFwiKSB7XHJcblx0XHR3aW5kb3cuZW0uQXJ0R3J1cHBlQXVmYmF1ZW5GZWxkRWRpdCh3aW5kb3cuZW0uRmVsZC5BcnRHcnVwcGUpO1xyXG5cdH1cclxuXHJcblx0Ly8gYWxsZsOkbGxpZ2VuIFN0YW5kYXJkd2VydCBhbnplaWdlblxyXG5cdC8vIFN0YW5kYXJkd2VydCBpc3QgT2JqZWt0LCBkYXJpbiB3ZXJkZW4gZGllIFN0YW5kYXJkd2VydGUgYWxsZXIgQmVudXR6ZXIgZ2VzcGVpY2hlcnRcclxuXHQvLyBkYXJ1bSBoaWVyIGF1c2xlc2VuIHVuZCBzZXR6ZW5cclxuXHQvLyBadWVyc3QgbGVlcmVuIFdlcnQgc2V0emVuLCBzb25zdCBibGVpYnQgbGV0enRlciwgd2VubiBrZWluZXIgZXhpc3RpZXJ0IVxyXG5cdCRTdGFuZGFyZHdlcnQudmFsKFwiXCIpO1xyXG5cdGlmICh3aW5kb3cuZW0uRmVsZC5TdGFuZGFyZHdlcnQpIHtcclxuXHRcdFN0YW5kYXJkd2VydCA9IHdpbmRvdy5lbS5GZWxkLlN0YW5kYXJkd2VydFtsb2NhbFN0b3JhZ2UuRW1haWxdO1xyXG5cdFx0aWYgKFN0YW5kYXJkd2VydCkge1xyXG5cdFx0XHQkU3RhbmRhcmR3ZXJ0LnZhbChTdGFuZGFyZHdlcnQpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0aWYgKHdpbmRvdy5lbS5GZWxkLkZlbGROYW1lKSB7XHJcblx0XHQvLyBmaXggaW4gRm9ybXVsYXJlIGVpbmdlYmF1dGUgRmVsZGVyOiBTdGFuZGFyZHdlcnRlIGF1c2JsZW5kZW4gdW5kIGVya2zDpHJlblxyXG5cdFx0aWYgKFtcImFBcnRHcnVwcGVcIiwgXCJhQXJ0TmFtZVwiXS5pbmRleE9mKHdpbmRvdy5lbS5GZWxkLkZlbGROYW1lKSA+IC0xKSB7XHJcblx0XHRcdCRTdGFuZGFyZHdlcnRcclxuICAgICAgICAgICAgICAgIC5hdHRyKFwicGxhY2Vob2xkZXJcIiwgXCJLZWluZSBWb3JlaW5zdGVsbHVuZyBtw7ZnbGljaFwiKVxyXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJkaXNhYmxlZFwiLCB0cnVlKTtcclxuXHRcdC8vIGF1c3NjaGFsdGVuLCBzb2xsIGpldHp0IGltIEZlbGQgdmVyd2FsdGV0IHdlcmRlblxyXG5cdFx0Lyp9IGVsc2UgaWYgKHdpbmRvdy5lbS5GZWxkLkZlbGROYW1lID09PSBcImFBdXRvclwiKSB7XHJcblx0XHRcdCRTdGFuZGFyZHdlcnQuYXR0cihcInBsYWNlaG9sZGVyXCIsICdCaXR0ZSBpbSBNZW7DvCBcIm1laW5lIEVpbnN0ZWxsdW5nZW5cIiB2b3JlaW5zdGVsbGVuJyk7XHJcblx0XHRcdCRTdGFuZGFyZHdlcnQuYXR0cihcImRpc2FibGVkXCIsIHRydWUpOyovXHJcblx0XHR9IGVsc2UgaWYgKFtcIm9YS29vcmRcIiwgXCJvWUtvb3JkXCIsIFwib0xhdGl0dWRlRGVjRGVnXCIsIFwib0xvbmdpdHVkZURlY0RlZ1wiLCBcIm9MYWdlZ2VuYXVpZ2tlaXRcIl0uaW5kZXhPZih3aW5kb3cuZW0uRmVsZC5GZWxkTmFtZSkgPiAtMSkge1xyXG5cdFx0XHQkU3RhbmRhcmR3ZXJ0XHJcbiAgICAgICAgICAgICAgICAuYXR0cihcInBsYWNlaG9sZGVyXCIsICdMb2thbGlzaWVydW5nIGVyZm9sZ3QgYXV0b21hdGlzY2gsIGtlaW5lIFZvcmVpbnN0ZWxsdW5nIG3DtmdsaWNoJylcclxuICAgICAgICAgICAgICAgIC5hdHRyKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XHJcblx0XHR9IGVsc2UgaWYgKFtcInpEYXR1bVwiLCBcInpVaHJ6ZWl0XCJdLmluZGV4T2Yod2luZG93LmVtLkZlbGQuRmVsZE5hbWUpID4gLTEpIHtcclxuXHRcdFx0JFN0YW5kYXJkd2VydFxyXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJwbGFjZWhvbGRlclwiLCAnU3RhbmRhcmR3ZXJ0IGlzdCBcImpldHp0XCIsIGtlaW5lIFZvcmVpbnN0ZWxsdW5nIG3DtmdsaWNoJylcclxuICAgICAgICAgICAgICAgIC5hdHRyKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdCQoXCIuRmVsZEVkaXRIZWFkZXJUaXRlbFwiKS50ZXh0KHdpbmRvdy5lbS5GZWxkLkhpZXJhcmNoaWVzdHVmZSArIFwiOiBcIiArIHdpbmRvdy5lbS5GZWxkLkZlbGRCZXNjaHJpZnR1bmcpO1xyXG5cclxuXHQvLyBSYWRpbyBGZWxkZXIgaW5pdGlpZXJlbiAoYXVzc2VyIEFydEdydXBwZSwgZGFzIHdpcmQgZHluYW1pc2NoIGVyemV1Z3QpXHJcblx0JChcImlucHV0W25hbWU9J0hpZXJhcmNoaWVzdHVmZSddXCIpLmNoZWNrYm94cmFkaW8oKTtcclxuXHQkKFwiI1wiICsgd2luZG93LmVtLkZlbGQuSGllcmFyY2hpZXN0dWZlKS5wcm9wKFwiY2hlY2tlZFwiLHRydWUpLmNoZWNrYm94cmFkaW8oXCJyZWZyZXNoXCIpO1xyXG5cdCQoXCJpbnB1dFtuYW1lPSdGb3JtdWxhcmVsZW1lbnQnXVwiKS5jaGVja2JveHJhZGlvKCk7XHJcblx0JChcIiNcIiArIHdpbmRvdy5lbS5GZWxkLkZvcm11bGFyZWxlbWVudCkucHJvcChcImNoZWNrZWRcIix0cnVlKS5jaGVja2JveHJhZGlvKFwicmVmcmVzaFwiKTtcclxuXHQkKFwiaW5wdXRbbmFtZT0nSW5wdXRUeXAnXVwiKS5jaGVja2JveHJhZGlvKCk7XHJcblx0JChcIiNcIiArIHdpbmRvdy5lbS5GZWxkLklucHV0VHlwKS5wcm9wKFwiY2hlY2tlZFwiLHRydWUpLmNoZWNrYm94cmFkaW8oXCJyZWZyZXNoXCIpO1xyXG5cclxuXHQvLyBXZXJ0ZSBpbiDDvGJyaWdlIEZlbGRlciBlaW5mw7xnZW5cclxuXHQkKFwiI0ZlbGROYW1lXCIpLnZhbCh3aW5kb3cuZW0uRmVsZC5GZWxkTmFtZSk7XHJcblx0JChcIiNGZWxkQmVzY2hyaWZ0dW5nXCIpLnZhbCh3aW5kb3cuZW0uRmVsZC5GZWxkQmVzY2hyaWZ0dW5nKTtcclxuXHQkKFwiI0ZlbGRCZXNjaHJlaWJ1bmdcIikudmFsKHdpbmRvdy5lbS5GZWxkLkZlbGRCZXNjaHJlaWJ1bmcpO1x0Ly8gVGV4dGFyZWEgLSBhbmRlcnMgcmVmcmVzaGVuP1xyXG5cdCQoXCIjUmVpaGVuZm9sZ2VcIikudmFsKHdpbmRvdy5lbS5GZWxkLlJlaWhlbmZvbGdlKTtcclxuXHQkKFwiI0ZlbGROYW1lRXZhYlwiKS52YWwod2luZG93LmVtLkZlbGQuRmVsZE5hbWVFdmFiKTtcclxuXHQkKFwiI0ZlbGROYW1lWmRzZlwiKS52YWwod2luZG93LmVtLkZlbGQuRmVsZE5hbWVaZHNmKTtcclxuXHQkKFwiI0ZlbGROYW1lQ3NjZlwiKS52YWwod2luZG93LmVtLkZlbGQuRmVsZE5hbWVDc2NmKTtcclxuXHQkKFwiI0ZlbGROYW1lTmlzbVwiKS52YWwod2luZG93LmVtLkZlbGQuRmVsZE5hbWVOaXNtKTtcclxuXHQkKFwiI0ZlbGROYW1lV3NsRmxlY2h0ZW5cIikudmFsKHdpbmRvdy5lbS5GZWxkLkZlbGROYW1lV3NsRmxlY2h0ZW4pO1xyXG5cdCQoXCIjRmVsZE5hbWVXc2xQaWx6ZVwiKS52YWwod2luZG93LmVtLkZlbGQuRmVsZE5hbWVXc2xQaWx6ZSk7XHJcblx0JChcIiNPcHRpb25lblwiKS52YWwod2luZG93LmVtLkZlbGQuT3B0aW9uZW4pO1x0Ly8gVGV4dGFyZWEgLSBhbmRlcnMgcmVmcmVzaGVuP1xyXG5cdCQoXCIjU2xpZGVyTWluaW11bVwiKS52YWwod2luZG93LmVtLkZlbGQuU2xpZGVyTWluaW11bSk7XHJcblx0JChcIiNTbGlkZXJNYXhpbXVtXCIpLnZhbCh3aW5kb3cuZW0uRmVsZC5TbGlkZXJNYXhpbXVtKTtcclxuXHJcblx0d2luZG93LmVtLmVyc3RlbGxlU2VsZWN0RmVsZEZvbGd0TmFjaCgpO1x0Ly8gQkVTU0VSOiBOdXIgYXVmcnVmZW4sIHdlbm4gZXJzdGF1ZmJhdSBvZGVyIGF1Y2ggRmVsZGxpc3RlIHp1csO8Y2tnZXNldHp0IHd1cmRlXHJcblx0d2luZG93LmVtLnNwZWljaGVyZUxldHp0ZVVybCgpO1xyXG5cdC8vIGFiaMOkbmdpZ2UgRmVsZGVyIGJsZW5kZW5cclxuXHR3aW5kb3cuZW0uYmxlbmRlRGF0ZW50eXBhYmjDpG5naWdlRmVsZGVyKCk7XHJcblx0d2luZG93LmVtLmJsZW5kZU1lbnVzKCk7XHJcblx0Ly8gRm9rdXMgYXVmIFBhZ2UgcmljaHRlbiwgZGFtaXQgZGllIFBhZ2luYXRpb24gbWl0IGRlbiBQZmVpbHRhc3RlbiBmdW5rdGlvbmllcnRcclxuXHQkKFwiOmpxbURhdGEocm9sZT0ncGFnZScpXCIpLmZvY3VzKCk7XHJcbn07XHJcblxyXG4vLyB3aXJkIHZvbiBGZWxkRWRpdC5odG1sIGF1ZmdlcnVmZW5cclxuLy8gZXJzdGVsbHQgZGFzIFNlbGVjdG1lbnUsIHVtIGRpZSBSZWloZW5mb2xnZS1Qb3NpdGlvbiBkZXMgRmVsZHMgenUgYmVzdGltbWVuXHJcbndpbmRvdy5lbS5lcnN0ZWxsZVNlbGVjdEZlbGRGb2xndE5hY2ggPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gTnVyIGJlaSBlaWdlbmVuIEZlbGRlcm4gYW56ZWlnZW5cclxuXHRpZiAod2luZG93LmVtLkZlbGQuVXNlciAhPT0gXCJaZW50cmVuQmRLdFwiKSB7XHJcblx0XHRpZiAod2luZG93LmVtLkZlbGRsaXN0ZSkge1xyXG5cdFx0XHQvLyBGZWxkbGlzdGUgYXVzIGdsb2JhbGVyIFZhcmlhYmxlIHZlcndlbmRlbiAtIG11c3MgbmljaHQgZ2VwYXJzdCB3ZXJkZW5cclxuXHRcdFx0d2luZG93LmVtLmVyc3RlbGxlU2VsZWN0RmVsZEZvbGd0TmFjaF8yKCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHRcdCRkYi52aWV3KFwiZXZhYi9GZWxkTGlzdGU/aW5jbHVkZV9kb2NzPXRydWVcIiwge1xyXG5cdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5GZWxkbGlzdGUgPSBkYXRhO1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLmVyc3RlbGxlU2VsZWN0RmVsZEZvbGd0TmFjaF8yKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0uZXJzdGVsbGVTZWxlY3RGZWxkRm9sZ3ROYWNoXzIgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIHRlbXBGZWxkLFxyXG5cdFx0b3B0aW9uZW4gPSBbXSxcclxuICAgICAgICBodG1sQ29udGFpbmVyO1xyXG5cdG9wdGlvbmVuLnB1c2goXCJcIik7XHJcblx0Xy5lYWNoKHdpbmRvdy5lbS5GZWxkbGlzdGUucm93cywgZnVuY3Rpb24ocm93KSB7XHJcblx0XHR0ZW1wRmVsZCA9IHJvdy5kb2M7XHJcblx0XHQvLyBMaXN0ZSBhdWZiYXVlblxyXG5cdFx0Ly8gTnVyIGVpZ2VuZSBGZWxkZXIgdW5kIG9mZml6aWVsbGVcclxuXHRcdGlmICh0ZW1wRmVsZC5Vc2VyID09PSBsb2NhbFN0b3JhZ2UuRW1haWwgfHwgdGVtcEZlbGQuVXNlciA9PT0gXCJaZW50cmVuQmRLdFwiKSB7XHJcblx0XHRcdG9wdGlvbmVuLnB1c2godGVtcEZlbGQuRmVsZE5hbWUpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdGh0bWxDb250YWluZXIgPSB3aW5kb3cuZW0uZ2VuZXJpZXJlSHRtbEbDvHJTZWxlY3RtZW51KFwiRmVsZEZvbGd0TmFjaFwiLCBcIkZlbGQgZm9sZ3QgbmFjaDpcIiwgXCJcIiwgb3B0aW9uZW4sIFwiU2luZ2xlU2VsZWN0XCIpO1xyXG5cdCQoXCIjRmVsZEZvbGd0TmFjaERpdlwiKS5odG1sKGh0bWxDb250YWluZXIpLnRyaWdnZXIoXCJjcmVhdGVcIikudHJpZ2dlcihcInJlZnJlc2hcIik7XHJcbn07XHJcblxyXG4vLyB3aXJkIGJlbnV0enQgaW4gRmVsZEVkaXQuaHRtbFxyXG4vLyB2b24gamUgZWluZXIgRnVua3Rpb24gaW4gRmVsZEVkaXQuaHRtbCB1bmQgZXZhYi5qc1xyXG4vLyBGdW5rdGlvbiBpc3QgendlaWdldGVpbHQsIHVtIHdlbm4gbcO2Z2xpY2ggRGF0ZW5iYW5rYWJmcmFnZW4genUgc3BhcmVuXHJcbndpbmRvdy5lbS5BcnRHcnVwcGVBdWZiYXVlbkZlbGRFZGl0ID0gZnVuY3Rpb24oQXJ0R3J1cHBlbkFycmF5SW4pIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKHdpbmRvdy5lbS5BcnRncnVwcGVuKSB7XHJcblx0XHQvLyBBcnRncnVwcGVuIHZvbiBnbG9iYWxlciBWYXJpYWJsZSBob2xlblxyXG5cdFx0d2luZG93LmVtLkFydEdydXBwZUF1ZmJhdWVuRmVsZEVkaXRfMihBcnRHcnVwcGVuQXJyYXlJbik7XHJcblx0fSBlbHNlIGlmIChsb2NhbFN0b3JhZ2UuQXJ0Z3J1cHBlbikge1xyXG5cdFx0Ly8gQXJ0Z3J1cHBlbiBhdXMgbG9jYWxTdG9yYWdlIGhvbGVuIHVuZCBwYXJzZW5cclxuXHRcdHdpbmRvdy5lbS5BcnRncnVwcGVuID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuQXJ0Z3J1cHBlbik7XHJcblx0XHR3aW5kb3cuZW0uQXJ0R3J1cHBlQXVmYmF1ZW5GZWxkRWRpdF8yKEFydEdydXBwZW5BcnJheUluKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gQXJ0Z3J1cHBlbiBhdXMgREIgaG9sZW5cclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCQoXCJzZWxlY3QjQXJ0R3J1cHBlXCIpLmVtcHR5KCk7XHJcblx0XHQkZGIudmlldyhcImV2YWIvQXJ0Z3J1cHBlblwiLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uQXJ0Z3J1cHBlbiA9IGRhdGE7XHJcblx0XHRcdFx0bG9jYWxTdG9yYWdlLkFydGdydXBwZW4gPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcclxuXHRcdFx0XHR3aW5kb3cuZW0uQXJ0R3J1cHBlQXVmYmF1ZW5GZWxkRWRpdF8yKEFydEdydXBwZW5BcnJheUluKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLkFydEdydXBwZUF1ZmJhdWVuRmVsZEVkaXRfMiA9IGZ1bmN0aW9uKEFydEdydXBwZW5BcnJheUluKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBBcnRHcnVwcGUsXHJcblx0XHRsaXN0SXRlbUNvbnRhaW5lciA9IFwiPGZpZWxkc2V0IGRhdGEtcm9sZT0nY29udHJvbGdyb3VwJz48bGVnZW5kPkluIGRpZXNlbiBBcnRncnVwcGVuIGthbm4gZGFzIEZlbGQgYW5nZXplaWd0IHdlcmRlbiAoZXJmb3JkZXJsaWNoKTo8L2xlZ2VuZD5cIixcclxuXHRcdGxpc3RJdGVtLFxyXG5cdFx0QXJ0R3J1cHBlbkFycmF5ID0gQXJ0R3J1cHBlbkFycmF5SW4gfHwgW107XHJcblx0Xy5lYWNoKHdpbmRvdy5lbS5BcnRncnVwcGVuLnJvd3MsIGZ1bmN0aW9uKHJvdykge1xyXG5cdFx0QXJ0R3J1cHBlID0gcm93LmtleTtcclxuXHRcdGxpc3RJdGVtID0gXCI8aW5wdXQgdHlwZT0nY2hlY2tib3gnIGNsYXNzPSdjdXN0b20gRmVsZGVpZ2Vuc2NoYWZ0ZW4nIG5hbWU9J0FydEdydXBwZScgaWQ9J1wiO1xyXG5cdFx0bGlzdEl0ZW0gKz0gQXJ0R3J1cHBlO1xyXG5cdFx0bGlzdEl0ZW0gKz0gXCInIHZhbHVlPSdcIjtcclxuXHRcdGxpc3RJdGVtICs9IEFydEdydXBwZTtcclxuXHRcdGlmIChBcnRHcnVwcGVuQXJyYXkuaW5kZXhPZihBcnRHcnVwcGUpICE9PSAtMSkge1xyXG5cdFx0XHRsaXN0SXRlbSArPSBcIicgY2hlY2tlZD0nY2hlY2tlZFwiO1xyXG5cdFx0fVxyXG5cdFx0bGlzdEl0ZW0gKz0gXCInLz5cXG48bGFiZWwgZm9yPSdcIjtcclxuXHRcdGxpc3RJdGVtICs9IEFydEdydXBwZTtcclxuXHRcdGxpc3RJdGVtICs9IFwiJz5cIjtcclxuXHRcdGxpc3RJdGVtICs9IEFydEdydXBwZTtcclxuXHRcdGxpc3RJdGVtICs9IFwiPC9sYWJlbD5cIjtcclxuXHRcdGxpc3RJdGVtQ29udGFpbmVyICs9IGxpc3RJdGVtO1xyXG5cdH0pO1xyXG5cdGxpc3RJdGVtQ29udGFpbmVyICs9IFwiXFxuPC9maWVsZHNldD5cIjtcclxuXHQkKFwiI0FydGdydXBwZW5saXN0ZV9GZWxkRWRpdFwiKS5odG1sKGxpc3RJdGVtQ29udGFpbmVyKS50cmlnZ2VyKFwiY3JlYXRlXCIpLnRyaWdnZXIoXCJyZWZyZXNoXCIpO1xyXG4gICAgJChcIiNTaWNodGJhckluSEFydEVkaXRMaXN0ZUZpZWxkQ29udGFpblwiKS5zaG93KCk7XHJcbn07XHJcblxyXG4vLyBpbml0aWllcnQgRmVsZExpc3RlLmh0bWxcclxud2luZG93LmVtLmluaXRpaWVyZUZlbGRsaXN0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBoYXQgRmVsZEVkaXQuaHRtbCBlaW5lIEZlbGRsaXN0ZSDDvGJlcmdlYmVuP1xyXG5cdGlmICh3aW5kb3cuZW0uRmVsZGxpc3RlKSB7XHJcblx0XHQvLyBGZWxkbGlzdGUgYXVzIGdsb2JhbGVyIFZhcmlhYmxlIGhvbGVuIC0gbXVzcyBuaWNodCBnZXBhcnN0IHdlcmRlblxyXG5cdFx0d2luZG93LmVtLmluaXRpaWVyZUZlbGRsaXN0ZV8yKCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIEZlbGRMaXN0ZSBhdXMgREIgaG9sZW5cclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi52aWV3KFwiZXZhYi9GZWxkTGlzdGU/aW5jbHVkZV9kb2NzPXRydWVcIiwge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLkZlbGRsaXN0ZSA9IGRhdGE7XHJcblx0XHRcdFx0d2luZG93LmVtLmluaXRpaWVyZUZlbGRsaXN0ZV8yKCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5pbml0aWllcmVGZWxkbGlzdGVfMiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgdGVtcEZlbGQsXHJcblx0XHRhbnpGZWxkZXIgPSAwLFxyXG5cdFx0SW1hZ2VMaW5rLFxyXG5cdFx0bGlzdEl0ZW1Db250YWluZXIgPSBcIlwiLFxyXG5cdFx0SGllcmFyY2hpZXN0dWZlLFxyXG5cdFx0RmVsZEJlc2NocmlmdHVuZyxcclxuXHRcdEZlbGRCZXNjaHJlaWJ1bmc7XHJcblx0Xy5lYWNoKHdpbmRvdy5lbS5GZWxkbGlzdGUucm93cywgZnVuY3Rpb24ocm93KSB7XHJcblx0XHR0ZW1wRmVsZCA9IHJvdy5kb2M7XHJcblx0XHQvLyBMaXN0ZSBhdWZiYXVlblxyXG5cdFx0Ly8gTnVyIGVpZ2VuZSBGZWxkZXIgdW5kIG9mZml6aWVsbGVcclxuXHRcdGlmICh0ZW1wRmVsZC5Vc2VyID09PSBsb2NhbFN0b3JhZ2UuRW1haWwgfHwgdGVtcEZlbGQuVXNlciA9PT0gXCJaZW50cmVuQmRLdFwiKSB7XHJcblx0XHRcdEhpZXJhcmNoaWVzdHVmZSA9IHRlbXBGZWxkLkhpZXJhcmNoaWVzdHVmZTtcclxuXHRcdFx0RmVsZEJlc2NocmlmdHVuZyA9IHRlbXBGZWxkLkZlbGRCZXNjaHJpZnR1bmcgfHwgXCIob2huZSBGZWxkYmVzY2hyaWZ0dW5nKVwiO1xyXG5cdFx0XHRGZWxkQmVzY2hyZWlidW5nID0gXCJcIjtcclxuXHRcdFx0aWYgKHRlbXBGZWxkLkZlbGRCZXNjaHJlaWJ1bmcpIHtcclxuXHRcdFx0XHRGZWxkQmVzY2hyZWlidW5nID0gdGVtcEZlbGQuRmVsZEJlc2NocmVpYnVuZztcclxuXHRcdFx0fVxyXG5cdFx0XHRJbWFnZUxpbmsgPSBcIkhpZXJhcmNoaWViaWxkZXIvXCIgKyBIaWVyYXJjaGllc3R1ZmUgKyBcIi5wbmdcIjtcclxuXHRcdFx0bGlzdEl0ZW1Db250YWluZXIgKz0gXCI8bGkgY2xhc3M9J0ZlbGQgdWktbGktaGFzLXRodW1iJyBGZWxkSWQ9J1wiO1xyXG5cdFx0XHRsaXN0SXRlbUNvbnRhaW5lciArPSB0ZW1wRmVsZC5faWQ7XHJcblx0XHRcdGxpc3RJdGVtQ29udGFpbmVyICs9IFwiJz48YSBocmVmPScjJz48aW1nIGNsYXNzPSd1aS1saS10aHVtYicgc3JjPSdcIjtcclxuXHRcdFx0bGlzdEl0ZW1Db250YWluZXIgKz0gSW1hZ2VMaW5rICsgXCInIC8+PGgyPlwiO1xyXG5cdFx0XHRsaXN0SXRlbUNvbnRhaW5lciArPSBIaWVyYXJjaGllc3R1ZmU7XHJcblx0XHRcdGxpc3RJdGVtQ29udGFpbmVyICs9ICc6ICc7XHJcblx0XHRcdGxpc3RJdGVtQ29udGFpbmVyICs9IEZlbGRCZXNjaHJpZnR1bmc7XHJcblx0XHRcdGxpc3RJdGVtQ29udGFpbmVyICs9IFwiPFxcL2gyPjxwPlwiO1xyXG5cdFx0XHRsaXN0SXRlbUNvbnRhaW5lciArPSBGZWxkQmVzY2hyZWlidW5nO1xyXG5cdFx0XHRsaXN0SXRlbUNvbnRhaW5lciArPSBcIjwvcD48XFwvYT48XFwvbGk+XCI7XHJcblx0XHRcdC8vIEZlbGRlciB6w6RobGVuXHJcblx0XHRcdGFuekZlbGRlciArPSAxO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdC8vIEltIFRpdGVsIGRlciBTZWl0ZSBkaWUgQW56YWhsIEJlb2JhY2h0dW5nZW4gYW56ZWlnZW5cclxuXHQkKFwiI0ZlbGRMaXN0ZUhlYWRlclwiKVxyXG4gICAgICAgIC5maW5kKFwiLkZlbGRMaXN0ZVRpdGVsXCIpXHJcbiAgICAgICAgLnRleHQoYW56RmVsZGVyICsgXCIgRmVsZGVyXCIpO1xyXG5cdCQoXCIjRmVsZExpc3RlRkxcIilcclxuICAgICAgICAuaHRtbChsaXN0SXRlbUNvbnRhaW5lcilcclxuICAgICAgICAubGlzdHZpZXcoXCJyZWZyZXNoXCIpO1xyXG5cdHdpbmRvdy5lbS5ibGVuZGVNZW51cygpO1xyXG5cdC8vIEZva3VzIGluIGRhcyBTdWNoZmVsZCBzZXR6ZW5cclxuXHQkKFwiI0ZlbGRMaXN0ZVBhZ2VcIilcclxuICAgICAgICAuZmluZChcIi51aS1pbnB1dC1zZWFyY2hcIilcclxuICAgICAgICAuY2hpbGRyZW4oXCJpbnB1dFwiKVswXVxyXG4gICAgICAgIC5mb2N1cygpO1xyXG5cdHdpbmRvdy5lbS5zcGVpY2hlcmVMZXR6dGVVcmwoKTtcclxufTtcclxuXHJcbi8vIHdpcmQgYmVudXR6dCB2b24gaE9ydEVkaXQuaHRtbCwgQmVvYkVkaXQuaHRtbCB1bmQgS2FydGUuaHRtbFxyXG4vLyBkaWUgRmVsZGVyIHdlcmRlbiBhdXMgbG9jYWxTdG9yYWdlIMO8YmVybm9tbWVuLCBkaWUgTGlzdGUgaWhyZXIgTmFtZW4gd2lyZCBhbHMgQXJyYXkgRmVsZGVyQXJyYXkgw7xiZXJiZWJlblxyXG4vLyBkaWUgRmVsZGVyIHdlcmRlbiBpbiBkZXIgREIgdW5kIGltIMO8YmVyZ2ViZW5lbiBPYmpla3QgXCJEYXRlbnNhdHpPYmpla3RcIiBnZXNwZWljaGVydFxyXG4vLyB1bmQgYW5zY2hsaWVzc2VuZCBpbiBGb3JtdWxhcmZlbGRlcm4gYWt0dWFsaXNpZXJ0XHJcbi8vIGZ1bmN0aW9uIHNwZWljaGVyZUtvb3JkaW5hdGVuIMO8YmVybmltbXQgaWQgdW5kIGRlbiBPYmpla3ROYW1lblxyXG4vLyBrb250cm9sbGllcnQsIG9iIGRhcyBPYmpla3QgZXhpc3RpZXJ0XHJcbi8vIHdlbm4gbmVpbiB3aXJkIGVzIGF1cyBkZXIgREIgZ2Vob2x0XHJcbndpbmRvdy5lbS5zcGVpY2hlcmVLb29yZGluYXRlbiA9IGZ1bmN0aW9uKGlkLCBPYmpla3ROYW1lKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIGtvbnRyb2xsaWVyZW4sIG9iIE9ydCBvZGVyIEJlb2IgYWxzIE9iamVrdCB2b3JsaWVndFxyXG5cdGlmICh3aW5kb3cuZW1bT2JqZWt0TmFtZV0pIHtcclxuXHRcdC8vIGphOiBPYmpla3QgdmVyd2VuZGVuXHJcblx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlS29vcmRpbmF0ZW5fMihpZCwgT2JqZWt0TmFtZSk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIG5laW46IE9iamVrdCBhdXMgREIgaG9sZW5cclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi5vcGVuRG9jKGlkLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW1bT2JqZWt0TmFtZV0gPSBkYXRhO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5zcGVpY2hlcmVLb29yZGluYXRlbl8yKGlkLCBPYmpla3ROYW1lKTtcclxuXHRcdFx0fSxcclxuXHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkZlaGxlcjogS29vcmRpbmF0ZW4gbmljaHQgZ2VzcGVpY2hlcnRcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIHNldHp0IGRhcyBEYXRlbnNhdHpPYmpla3Qgdm9yYXVzXHJcbi8vIGFrdHVhbGlzaWVydCBkYXJpbiBkaWUgRmVsZGVyLCB3ZWxjaGUgaW4gRmVsZGVyQXJyYXkgYXVmZ2VsaXN0ZXQgc2luZFxyXG4vLyBWYXJpYWJsZW4gbcO8c3NlbiBpbiBPYmpla3QgdW5kIGxvY2FsU3RvcmFnZSBkZW5zZWxiZW4gTmFtZW4gdmVyd2VuZGVuXHJcbndpbmRvdy5lbS5zcGVpY2hlcmVLb29yZGluYXRlbl8yID0gZnVuY3Rpb24oaWQsIE9iamVrdE5hbWUpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIEZlbGRlckFycmF5ID0gW1wib0xvbmdpdHVkZURlY0RlZ1wiLCBcIm9Mb25naXR1ZGVEZWNEZWdcIiwgXCJvTGF0aXR1ZGVEZWNEZWdcIiwgXCJvWEtvb3JkXCIsIFwib1lLb29yZFwiLCBcIm9MYWdlZ2VuYXVpZ2tlaXRcIiwgXCJvSMO2aGVcIiwgXCJvSMO2aGVHZW5hdWlna2VpdFwiXTtcclxuXHR3aW5kb3cuZW0uc3BlaWNoZXJlRmVsZGVyQXVzTG9jYWxTdG9yYWdlSW5PYmpla3QoT2JqZWt0TmFtZSwgRmVsZGVyQXJyYXksIFwiRm9ybXVsYXJBa3R1YWxpc2llcmVuXCIpO1xyXG5cdC8vIG51biBkaWUgS29vcmRpbmF0ZW4gaW4gZGVuIFplaXRlbiB1bmQgQXJ0ZW4gZGllc2VzIE9iamVrdHMgYWt0dWFsaXNpZXJlblxyXG5cdHdpbmRvdy5lbS5zcGVpY2hlcmVGZWxkZXJBdXNMb2NhbFN0b3JhZ2VJbk9iamVrdGxpc3RlKFwiWmVpdGVuVm9uT3J0XCIsIEZlbGRlckFycmF5LCBcImhPcnRJZFwiLCBpZCwgXCJoWmVpdElkVm9uT3J0XCIpO1xyXG5cdHdpbmRvdy5lbS5zcGVpY2hlcmVGZWxkZXJBdXNMb2NhbFN0b3JhZ2VJbk9iamVrdGxpc3RlKFwiQXJ0ZW5Wb25PcnRcIiwgRmVsZGVyQXJyYXksIFwiaE9ydElkXCIsIGlkLCBcImhBcnRJZFZvbk9ydFwiKTtcclxufTtcclxuXHJcbi8vIMO8YmVybmltbXQgZWluZSBMaXN0ZSB2b24gRmVsZGVybiB1bmQgZWluZSBPYmpla3RsaXN0ZSAodmlhIE5hbWUpXHJcbi8vIHN1Y2h0IGluIGRlciBPYmpla3RsaXN0ZSBuYWNoIGRlbiBPYmpla3RlbiBtaXQgZGVyIEJlenVnc0lkXHJcbi8vIGFrdHVhbGlzaWVydCBkaWVzZSBPYmpla3RlXHJcbi8vIHdpcmQgdmVyd2VuZGV0LCB1bSBkaWUgS29vcmRpbmF0ZW4gdm9uIE9ydGVuIGluIFplaXRlbiB1bmQgQXJ0ZW4genUgc2NocmVpYmVuXHJcbi8vIGltIGVyc3RlbiBTY2hyaXR0IHByw7xmZW4sIG9iIGRpZSBPYmpla3RsaXN0ZSB2b3JoYW5kZW4gaXN0LiBXZW5uIG5pY2h0LCBhdXMgREIgaG9sZW5cclxud2luZG93LmVtLnNwZWljaGVyZUZlbGRlckF1c0xvY2FsU3RvcmFnZUluT2JqZWt0bGlzdGUgPSBmdW5jdGlvbihPYmpla3RsaXN0ZW5OYW1lLCBGZWxkZXJBcnJheSwgQmV6dWdzSWROYW1lLCBCZXp1Z3NJZFdlcnQsIFF1ZXJ5c3RyaW5nKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICh3aW5kb3cuZW1bT2JqZWt0bGlzdGVuTmFtZV0pIHtcclxuXHRcdC8vIHZvcmhhbmRlbmUgT2JqZWt0bGlzdGUgbnV0emVuXHJcblx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlRmVsZGVyQXVzTG9jYWxTdG9yYWdlSW5PYmpla3RsaXN0ZV8yKE9iamVrdGxpc3Rlbk5hbWUsIEZlbGRlckFycmF5LCBCZXp1Z3NJZE5hbWUsIEJlenVnc0lkV2VydCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIE9iamVrdGxpc3RlIGF1cyBEQiBob2xlblxyXG5cdFx0dmFyIHZpZXduYW1lID0gJ2V2YWIvJyArIFF1ZXJ5c3RyaW5nICsgJz9zdGFydGtleT1bXCInICsgQmV6dWdzSWRXZXJ0ICsgJ1wiXSZlbmRrZXk9W1wiJyArIEJlenVnc0lkV2VydCArICdcIix7fV0maW5jbHVkZV9kb2NzPXRydWUnO1xyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLnZpZXcodmlld25hbWUsIHtcclxuXHRcdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbVtPYmpla3RsaXN0ZW5OYW1lXSA9IGRhdGE7XHJcblx0XHRcdFx0d2luZG93LmVtLnNwZWljaGVyZUZlbGRlckF1c0xvY2FsU3RvcmFnZUluT2JqZWt0bGlzdGVfMihPYmpla3RsaXN0ZW5OYW1lLCBGZWxkZXJBcnJheSwgQmV6dWdzSWROYW1lLCBCZXp1Z3NJZFdlcnQpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0uc3BlaWNoZXJlRmVsZGVyQXVzTG9jYWxTdG9yYWdlSW5PYmpla3RsaXN0ZV8yID0gZnVuY3Rpb24oT2JqZWt0bGlzdGVuTmFtZSwgRmVsZGVyQXJyYXksIEJlenVnc0lkTmFtZSwgQmV6dWdzSWRXZXJ0KSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIGluIGFsbGVuIE9iamVrdGVuIGluIGRlciBPYmpla3RsaXN0ZVxyXG5cdHZhciBEc0J1bGtMaXN0ZSA9IHt9LFxyXG5cdFx0RG9jcyA9IFtdLFxyXG5cdFx0ZG9jO1xyXG5cdC8vIG51ciBtYWNoZW4sIHdlbm4gcm93cyB2b3JoYW5kZW4hXHJcblx0aWYgKHdpbmRvdy5lbVtPYmpla3RsaXN0ZW5OYW1lXS5yb3dzLmxlbmd0aCA+IDApIHtcclxuXHRcdF8uZWFjaCh3aW5kb3cuZW1bT2JqZWt0bGlzdGVuTmFtZV0ucm93cywgZnVuY3Rpb24ocm93KSB7XHJcblx0XHRcdGRvYyA9IHJvdy5kb2M7XHJcblx0XHRcdC8vIE9iamVrdGUgbWl0IGRlbSByaWNodGlnZW4gV2VydCBpbiBkZXIgQmV6dWdzSWQgc3VjaGVuICh6LkIuIGRpZSByaWNodGlnZSBoT3J0SWQpXHJcblx0XHRcdGlmIChkb2NbQmV6dWdzSWROYW1lXSAmJiBkb2NbQmV6dWdzSWROYW1lXSA9PT0gQmV6dWdzSWRXZXJ0KSB7XHJcblx0XHRcdFx0Ly8gaW0gT2JqZWt0IGFsbGUgaW4gRmVsZGVyQXJyYXkgYXVmZ2VsaXN0ZXRlbiBGZWxkZXIgc3VjaGVuXHJcblx0XHRcdFx0Xy5lYWNoKEZlbGRlckFycmF5LCBmdW5jdGlvbihmZWxkbmFtZSkge1xyXG5cdFx0XHRcdFx0Ly8gdW5kIGlocmUgV2VydGUgYWt0dWFsaXNpZXJlblxyXG5cdFx0XHRcdFx0aWYgKGxvY2FsU3RvcmFnZVtmZWxkbmFtZV0pIHtcclxuXHRcdFx0XHRcdFx0aWYgKHdpbmRvdy5lbS5teVR5cGVPZihsb2NhbFN0b3JhZ2VbZmVsZG5hbWVdKSA9PT0gXCJpbnRlZ2VyXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRkb2NbZmVsZG5hbWVdID0gcGFyc2VJbnQobG9jYWxTdG9yYWdlW2ZlbGRuYW1lXSwgMTApO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKHdpbmRvdy5lbS5teVR5cGVPZihsb2NhbFN0b3JhZ2VbZmVsZG5hbWVdKSA9PT0gXCJmbG9hdFwiKSB7XHJcblx0XHRcdFx0XHRcdFx0ZG9jW2ZlbGRuYW1lXSA9IHBhcnNlRmxvYXQobG9jYWxTdG9yYWdlW2ZlbGRuYW1lXSk7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0ZG9jW2ZlbGRuYW1lXSA9IGxvY2FsU3RvcmFnZVtmZWxkbmFtZV07XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdGRlbGV0ZSBkb2NbZmVsZG5hbWVdO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdERvY3MucHVzaChkb2MpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdERzQnVsa0xpc3RlLmRvY3MgPSBEb2NzO1xyXG5cdFx0Ly8gT2JqZWt0bGlzdGUgaW4gREIgc3BlaWNoZXJuXHJcblx0XHQkLmFqYXgoe1xyXG5cdFx0XHR0eXBlOiBcIlBPU1RcIixcclxuXHRcdFx0dXJsOiBcIi4uLy4uL19idWxrX2RvY3NcIixcclxuXHRcdFx0Y29udGVudFR5cGU6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG5cdFx0XHRkYXRhOiBKU09OLnN0cmluZ2lmeShEc0J1bGtMaXN0ZSlcclxuXHRcdH0pLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHR2YXIgb2JqZWt0LFxyXG5cdFx0XHRcdGRvYztcclxuXHRcdFx0Ly8gX3JldiBpbiBkZW4gT2JqZWt0ZW4gaW4gT2JqZWt0bGlzdGUgYWt0dWFsaXNpZXJlblxyXG5cdFx0XHQvLyBmw7xyIGFsbGUgenVyw7xja2dlZ2ViZW5lbiBha3R1YWxpc2llcnRlbiBaZWlsZW5cclxuXHRcdFx0Ly8gb2ZmZW5iYXIgbXVzcyBkYXRhIHp1ZXJzdCBnZXBhcnN0IHdlcmRlbiA/PyEhXHJcblx0XHRcdGRhdGEgPSBKU09OLnBhcnNlKGRhdGEpO1xyXG5cdFx0XHRfLmVhY2goZGF0YSwgZnVuY3Rpb24oZHMsIGluZGV4KSB7XHJcblx0XHRcdFx0Ly8gZGFzIHp1Z2Vow7ZyaWdlIE9iamVrdCBpbiBkZXIgT2JqZWt0bGlzdGUgc3VjaGVuXHJcblx0XHRcdFx0b2JqZWt0ID0gXy5maW5kKHdpbmRvdy5lbVtPYmpla3RsaXN0ZW5OYW1lXS5yb3dzLCBmdW5jdGlvbihyb3cpIHtcclxuXHRcdFx0XHRcdGRvYyA9IHJvdy5kb2M7XHJcblx0XHRcdFx0XHRyZXR1cm4gZG9jLl9pZCA9PT0gZGF0YVtpbmRleF0uaWQ7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0b2JqZWt0Ll9yZXYgPSBkYXRhW2luZGV4XS5yZXY7XHJcblx0XHRcdH0pO1xyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gTmV1ZSBEYXRlbiBsaWVnZW4gaW4gbG9jYWxTdG9yYWdlIHZvclxyXG4vLyBzaWUgd2VyZGVuIGluIE9iamVrdCB1bmQgaW4gREIgZ2VzY2hyaWViZW5cclxuLy8gVmFyaWFibGVuIG3DvHNzZW4gaW4gT2JqZWt0IHVuZCBsb2NhbFN0b3JhZ2UgZGVuc2VsYmVuIE5hbWVuIHZlcndlbmRlblxyXG4vLyBGZWxkZXJBcnJheSBlbnRow6RsdCBlaW5lIExpc3RlIGRlciBOYW1lbiBkZXIgenUgYWt0dWFsaXNpZXJlbmRlbiBGZWxkZXJcclxuLy8gT2JqZWt0TmFtZSBpc3QgZGVyIE5hbWUgZGVzIHp1IGFrdHVhbGlzaWVyZW5kZW4gT2JqZWt0cyBiencuIERhdGVuc2F0emVzXHJcbndpbmRvdy5lbS5zcGVpY2hlcmVGZWxkZXJBdXNMb2NhbFN0b3JhZ2VJbk9iamVrdCA9IGZ1bmN0aW9uKE9iamVrdE5hbWUsIEZlbGRlckFycmF5LCBGb3JtdWxhckFrdHVhbGlzaWVyZW4pIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gT2JqZWt0IGFrdHVhbGlzaWVyZW5cclxuXHRfLmVhY2goRmVsZGVyQXJyYXksIGZ1bmN0aW9uKGZlbGRuYW1lKSB7XHJcblx0XHRpZiAobG9jYWxTdG9yYWdlW2ZlbGRuYW1lXSkge1xyXG5cdFx0XHRpZiAod2luZG93LmVtLm15VHlwZU9mKGxvY2FsU3RvcmFnZVtmZWxkbmFtZV0pID09PSBcImludGVnZXJcIikge1xyXG5cdFx0XHRcdHdpbmRvdy5lbVtPYmpla3ROYW1lXVtmZWxkbmFtZV0gPSBwYXJzZUludChsb2NhbFN0b3JhZ2VbZmVsZG5hbWVdLCAxMCk7XHJcblx0XHRcdH0gZWxzZSBpZiAod2luZG93LmVtLm15VHlwZU9mKGxvY2FsU3RvcmFnZVtmZWxkbmFtZV0pID09PSBcImZsb2F0XCIpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW1bT2JqZWt0TmFtZV1bZmVsZG5hbWVdID0gcGFyc2VGbG9hdChsb2NhbFN0b3JhZ2VbZmVsZG5hbWVdKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR3aW5kb3cuZW1bT2JqZWt0TmFtZV1bZmVsZG5hbWVdID0gbG9jYWxTdG9yYWdlW2ZlbGRuYW1lXTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0ZGVsZXRlIHdpbmRvdy5lbVtPYmpla3ROYW1lXVtmZWxkbmFtZV07XHJcblx0XHR9XHJcblx0fSk7XHJcblx0Ly8gaW4gREIgc3BlaWNoZXJuXHJcbiAgICB2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0JGRiLnNhdmVEb2Mod2luZG93LmVtW09iamVrdE5hbWVdLCB7XHJcblx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdHdpbmRvdy5lbVtPYmpla3ROYW1lXS5fcmV2ID0gZGF0YS5yZXY7XHJcblx0XHRcdGlmIChGb3JtdWxhckFrdHVhbGlzaWVyZW4pIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uYWt0dWFsaXNpZXJlS29vcmRpbmF0ZW5mZWxkZXJJbkZvcm11bGFyKE9iamVrdE5hbWUpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyDDvGJlcm5pbW10IGVpbiBPYmpla3QgKHZpYSBkZXNzZW4gTmFtZW4pIHVuZCBlaW5lIExpc3RlIHZvbiBGZWxkZXJuIChGZWxkZXJBcnJheSlcclxuLy8gc2V0enQgaW4gYWxsZSBGZWxkZXIgbWl0IGRlbiBOYW1lbiBnZW3DpHNzIEZlbGRlckFycmF5IGRpZSBXZXJ0ZSBnZW3DpHNzIE9iamVrdFxyXG53aW5kb3cuZW0uYWt0dWFsaXNpZXJlS29vcmRpbmF0ZW5mZWxkZXJJbkZvcm11bGFyID0gZnVuY3Rpb24oT2JqZWt0TmFtZSwgRmVsZGVyQXJyYXkpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Xy5lYWNoKEZlbGRlckFycmF5LCBmdW5jdGlvbihmZWxkbmFtZSkge1xyXG5cdFx0JChcIltuYW1lPSdcIiArIGZlbGRuYW1lICsgXCInXVwiKS52YWwod2luZG93LmVtW09iamVrdE5hbWVdW2ZlbGRuYW1lXSB8fCBudWxsKTtcclxuXHR9KTtcclxufTtcclxuXHJcbi8vIGRpZW50IGRlciBVbnRlcnNjaGVpZHVuZyB2b24gSW50IHVuZCBGbG9hdFxyXG4vLyBOSUNIVCBCRU5VVFpUXHJcbndpbmRvdy5lbS5pc0ludCA9IGZ1bmN0aW9uKG4pIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0cmV0dXJuIHR5cGVvZiBuID09PSAnbnVtYmVyJyAmJiBwYXJzZUZsb2F0KG4pID09IHBhcnNlSW50KG4sIDEwKSAmJiAhaXNOYU4obik7XHJcbn07XHJcblxyXG4vLyBIaWxmc2Z1bmt0aW9uLCBkaWUgdHlwZW9mIGVyc2V0enQgdW5kIGVyZ8Okbnp0XHJcbi8vIHR5cGVvZiBnaWJ0IGJlaSBpbnB1dC1GZWxkZXJuIGltbWVyIFN0cmluZyB6dXLDvGNrIVxyXG53aW5kb3cuZW0ubXlUeXBlT2YgPSBmdW5jdGlvbihXZXJ0KSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICh0eXBlb2YgV2VydCA9PT0gXCJib29sZWFuXCIpIHtcclxuXHRcdHJldHVybiBcImJvb2xlYW5cIjtcclxuXHR9IGVsc2UgaWYgKHBhcnNlSW50KFdlcnQsIDEwKSAmJiBwYXJzZUZsb2F0KFdlcnQpICYmIHBhcnNlSW50KFdlcnQsIDEwKSAhPSBwYXJzZUZsb2F0KFdlcnQpICYmIHBhcnNlSW50KFdlcnQsIDEwKSA9PSBXZXJ0KSB7XHJcblx0XHQvLyBlcyBpc3QgZWluZSBGbG9hdFxyXG5cdFx0cmV0dXJuIFwiZmxvYXRcIjtcclxuXHR9IGVsc2UgaWYgKHBhcnNlSW50KFdlcnQsIDEwKSA9PSBXZXJ0KSB7XHJcblx0XHQvLyBlcyBpc3QgZWluZSBJbnRlZ2VyXHJcblx0XHRyZXR1cm4gXCJpbnRlZ2VyXCI7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIGFscyBTdHJpbmcgYmVoYW5kZWxuXHJcblx0XHRyZXR1cm4gXCJzdHJpbmdcIjtcclxuXHR9XHJcbn07XHJcblxyXG4vLyDDnGJlcm5pbW10IGVpbmVuIEZlbGRuYW1lbiwgZWluZW4gZmVsZHdlcnRcclxuLy8gdW5kIGVpbmUgRGF0ZW5zYXR6bGlzdGUgKHouQi4gYWxsZSBSw6R1bWUgZWluZXMgUHJvamVrdHMpIHNvd2llIGlocmVuIE5hbWVuXHJcbi8vIHNwZWljaGVydCBkYXMgbmV1ZSBGZWxkIGluIGFsbGUgRGF0ZW5zw6R0emUgZGVyIExpc3RlIGluIGRlciBEQlxyXG4vLyB1bmQgYWt0dWFsaXNpZXJ0IGRpZSBMaXN0ZSBzZWxiZXIsIGRhbWl0IHNpZSBkYXMgbsOkY2hzdGUgbWFsIG5pY2h0IGluIGRlciBEQiBnZWhvbHQgd2VyZGVuIG11c3NcclxuLy8gTklDSFQgSU0gR0VCUkFVQ0hcclxud2luZG93LmVtLnNwZWljaGVyZUZlbGRJbkRhdGVuc2F0emxpc3RlID0gZnVuY3Rpb24oRmVsZG5hbWUsIEZlbGR3ZXJ0LCBEYXRlbnNhdHpsaXN0ZU5hbWUpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIERzQnVsa0xpc3RlID0ge30sXHJcblx0XHREb2NzID0gW10sXHJcblx0XHRkb2M7XHJcblx0Ly8gbnVyIG1hY2hlbiwgd2VubiBEYXRlbnPDpHR6ZSBkYSBzaW5kXHJcblx0Xy5lYWNoKERhdGVuc2F0emxpc3RlTmFtZS5yb3dzLCBmdW5jdGlvbihyb3cpIHtcclxuXHRcdGRvYyA9IHJvdy5kb2M7XHJcblx0XHRpZiAoRmVsZHdlcnQpIHtcclxuXHRcdFx0aWYgKHdpbmRvdy5lbS5teVR5cGVPZihGZWxkd2VydCkgPT09IFwiZmxvYXRcIikge1xyXG5cdFx0XHRcdGRvY1tGZWxkbmFtZV0gPSBwYXJzZUZsb2F0KEZlbGR3ZXJ0KTtcclxuXHRcdFx0fSBlbHNlIGlmICh3aW5kb3cuZW0ubXlUeXBlT2YoRmVsZHdlcnQpID09PSBcImludGVnZXJcIikge1xyXG5cdFx0XHRcdGRvY1tGZWxkbmFtZV0gPSBwYXJzZUludChGZWxkd2VydCwgMTApO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGRvY1tGZWxkbmFtZV0gPSBGZWxkd2VydDtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIGlmIChkb2NbRmVsZG5hbWVdKSB7XHJcblx0XHRcdGRlbGV0ZSBkb2NbRmVsZG5hbWVdO1xyXG5cdFx0fVxyXG5cdFx0RG9jcy5wdXNoKGRvYyk7XHJcblx0fSk7XHJcblx0RHNCdWxrTGlzdGUuZG9jcyA9IERvY3M7XHJcblx0JC5hamF4KHtcclxuXHRcdHR5cGU6IFwiUE9TVFwiLFxyXG5cdFx0dXJsOiBcIi4uLy4uL19idWxrX2RvY3NcIixcclxuXHRcdGNvbnRlbnRUeXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuXHRcdGRhdGE6IEpTT04uc3RyaW5naWZ5KERzQnVsa0xpc3RlKVxyXG5cdH0pO1xyXG59O1xyXG5cclxuLy8gbMO2c2NodCBEYXRlbnPDpHR6ZSBpbiBNYXNzZW5cclxuLy8gbmltbXQgZGFzIEVyZ2VibmlzIGVpbmVyIEFiZnJhZ2UgZW50Z2VnZW4sIHdlbGNoZSBpbSBrZXkgZWluZW4gQXJyYXkgaGF0XHJcbi8vIEFycmF5WzBdIGlzdCBmcmVtZGUgX2lkIChtaXQgZGVyIGRpZSBBYmZyYWdlIGdlZmlsdGVydCB3dXJkZSksXHJcbi8vIEFycmF5WzFdIGRpZSBfaWQgZGVzIHp1IGzDtnNjaGVuZGVuIERhdGVuc2F0emVzIHVuZCBBcnJheVsyXSBkZXNzZW4gX3JldlxyXG53aW5kb3cuZW0ubG9lc2NoZUlkSWRSZXZMaXN0ZSA9IGZ1bmN0aW9uKERhdGVuc2F0em9iamVrdCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgT2JqZWt0TWl0RGVsZXRlTGlzdGUgPSB7fSxcclxuXHRcdERvY3MgPSBbXTtcclxuXHRfLmVhY2goRGF0ZW5zYXR6b2JqZWt0LnJvd3MsIGZ1bmN0aW9uKHJvdykge1xyXG5cdFx0Ly8gdW5zZXJlIERhdGVuIHNpbmQgaW0ga2V5XHJcblx0XHR2YXIgcm93a2V5ID0gcm93LmtleSxcclxuXHRcdFx0RGF0ZW5zYXR6ID0ge307XHJcblx0XHREYXRlbnNhdHouX2lkID0gcm93a2V5WzFdO1xyXG5cdFx0RGF0ZW5zYXR6Ll9yZXYgPSByb3drZXlbMl07XHJcblx0XHREYXRlbnNhdHouX2RlbGV0ZWQgPSB0cnVlO1xyXG5cdFx0RG9jcy5wdXNoKERhdGVuc2F0eik7XHJcblx0fSk7XHJcblx0T2JqZWt0TWl0RGVsZXRlTGlzdGUuZG9jcyA9IERvY3M7XHJcblx0JC5hamF4KHtcclxuXHRcdHR5cGU6IFwiUE9TVFwiLFxyXG5cdFx0dXJsOiBcIi4uLy4uL19idWxrX2RvY3NcIixcclxuXHRcdGNvbnRlbnRUeXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuXHRcdGRhdGE6IEpTT04uc3RyaW5naWZ5KE9iamVrdE1pdERlbGV0ZUxpc3RlKVxyXG5cdH0pO1xyXG59O1xyXG5cclxuXHJcbndpbmRvdy5lbS5pbml0aWllcmVQcm9qZWt0bGlzdGUgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gaGF0IGhQcm9qZWt0RWRpdC5odG1sIGVpbmUgUHJvamVrdGxpc3RlIMO8YmVyZ2ViZW4/XHJcblx0aWYgKHdpbmRvdy5lbS5Qcm9qZWt0bGlzdGUpIHtcclxuXHRcdHdpbmRvdy5lbS5pbml0aWllcmVQcm9qZWt0bGlzdGVfMigpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBEYXRlbiBmw7xyIGRpZSBQcm9qZWt0bGlzdGUgYXVzIERCIGhvbGVuXHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIudmlldygnZXZhYi9oUHJvakxpc3RlP3N0YXJ0a2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCJdJmVuZGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiLHt9XSZpbmNsdWRlX2RvY3M9dHJ1ZScsIHtcclxuXHRcdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdC8vIFByb2pla3RsaXN0ZSBmw7xyIGhQcm9qZWt0RWRpdCBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdFx0d2luZG93LmVtLlByb2pla3RsaXN0ZSA9IGRhdGE7XHJcblx0XHRcdFx0d2luZG93LmVtLmluaXRpaWVyZVByb2pla3RsaXN0ZV8yKCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5pbml0aWllcmVQcm9qZWt0bGlzdGVfMiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgYW56UHJvaiA9IHdpbmRvdy5lbS5Qcm9qZWt0bGlzdGUucm93cy5sZW5ndGgsXHJcblx0XHRsaXN0SXRlbSxcclxuXHRcdGxpc3RJdGVtQ29udGFpbmVyID0gXCJcIixcclxuXHRcdFRpdGVsMjtcclxuXHJcblx0Ly8gSW0gVGl0ZWwgZGVyIFNlaXRlIGRpZSBBbnphaGwgUHJvamVrdGUgYW56ZWlnZW5cclxuXHRUaXRlbDIgPSBcIiBQcm9qZWt0ZVwiO1xyXG5cdGlmIChhbnpQcm9qID09PSAxKSB7XHJcblx0XHRUaXRlbDIgPSBcIiBQcm9qZWt0XCI7XHJcblx0fVxyXG5cdCQoXCIjaFByb2pla3RMaXN0ZVBhZ2VIZWFkZXJcIilcclxuICAgICAgICAuZmluZChcIi5oUHJvamVrdExpc3RlUGFnZVRpdGVsXCIpXHJcbiAgICAgICAgLnRleHQoYW56UHJvaiArIFRpdGVsMik7XHJcblxyXG5cdGlmIChhbnpQcm9qID09PSAwKSB7XHJcblx0XHRsaXN0SXRlbUNvbnRhaW5lciA9IFwiPGxpPjxhIGhyZWY9JyMnIGNsYXNzPSdlcnN0ZSBOZXVlc1Byb2pla3RQcm9qZWt0TGlzdGUnPkVyc3RlcyBQcm9qZWt0IGVyZmFzc2VuPC9hPjwvbGk+XCI7XHJcblx0fSBlbHNlIHtcclxuXHRcdF8uZWFjaCh3aW5kb3cuZW0uUHJvamVrdGxpc3RlLnJvd3MsIGZ1bmN0aW9uKHJvdykge1xyXG5cdFx0XHR2YXIgUHJvaiA9IHJvdy5kb2MsXHJcblx0XHRcdFx0a2V5ID0gcm93LmtleSxcclxuXHRcdFx0XHRwTmFtZSA9IGtleVsxXTtcclxuXHRcdFx0bGlzdEl0ZW0gPSBcIjxsaSBQcm9qZWt0SWQ9J1wiICsgUHJvai5faWQgKyBcIicgY2xhc3M9J1Byb2pla3QnPlwiO1xyXG5cdFx0XHRsaXN0SXRlbSArPSBcIjxhIGhyZWY9JyMnPlwiO1xyXG5cdFx0XHRsaXN0SXRlbSArPSBcIjxoMz5cIiArIHBOYW1lICsgXCI8XFwvaDM+PFxcL2E+PFxcL2xpPlwiO1xyXG5cdFx0XHRsaXN0SXRlbUNvbnRhaW5lciArPSBsaXN0SXRlbTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHQkKFwiI1Byb2pla3RsaXN0ZWhQTFwiKVxyXG4gICAgICAgIC5odG1sKGxpc3RJdGVtQ29udGFpbmVyKVxyXG4gICAgICAgIC5saXN0dmlldyhcInJlZnJlc2hcIik7XHJcblx0d2luZG93LmVtLmJsZW5kZU1lbnVzKCk7XHJcblx0Ly8gRm9rdXMgaW4gZGFzIFN1Y2hmZWxkIHNldHplblxyXG5cdCQoXCIjaFByb2pla3RMaXN0ZVwiKVxyXG4gICAgICAgIC5maW5kKFwiLnVpLWlucHV0LXNlYXJjaFwiKVxyXG4gICAgICAgIC5jaGlsZHJlbihcImlucHV0XCIpWzBdXHJcbiAgICAgICAgLmZvY3VzKCk7XHJcblx0d2luZG93LmVtLnNwZWljaGVyZUxldHp0ZVVybCgpO1xyXG59O1xyXG5cclxuLy8gZ2VuZXJpZXJ0IGluIGhSYXVtRWRpdC5odG1sIGR5bmFtaXNjaCBkaWUgdm9uIGRlbiBTaWNodGJhcmtlaXRzLUVpbnN0ZWxsdW5nZW4gYWJow6RuZ2lnZW4gRmVsZGVyXHJcbi8vIE1pdGdlYmVuOiBpZCBkZXMgUmF1bXMsIFVzZXJuYW1lXHJcbi8vIEJlaSBuZXVlbiBSw6R1bWVuIHdpcmQgZGVyIFJhdW0gw7xiZXJub21tZW4gdW0gZWluZSBEQi1BYmZyYWdlIHp1IHNwYXJlblxyXG53aW5kb3cuZW0uaW5pdGlpZXJlUmF1bUVkaXQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gQW5ow6RuZ2UgYXVzYmxlbmRlbiwgd2VpbCBzaWUgc29uc3QgYmVpbSBXZWNoc2VsIHN0w7ZyZW5cclxuXHQvLyQoJyNBbmjDpG5nZWhSRScpLmhpZGUoKTtcclxuXHRpZiAod2luZG93LmVtLmhSYXVtKSB7XHJcblx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlUmF1bUVkaXRfMigpO1xyXG5cdH0gZWxzZSBpZiAobG9jYWxTdG9yYWdlLlN0YXR1cyA9PT0gXCJuZXVcIiAmJiBsb2NhbFN0b3JhZ2UuaFJhdW0pIHtcclxuXHRcdC8vIHdlbm4gbWl0IHdpbmRvdy5vcGVuIHZvbiBuZXUgZ2Vrb21tZW4sIGV4aXN0aWVydCBkaWUgZ2xvYmFsZSBWYXJpYWJsZSBuaWNodCBtZWhyXHJcblx0XHR3aW5kb3cuZW0uaFJhdW0gPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5oUmF1bSk7XHJcblx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLmhSYXVtO1xyXG5cdFx0d2luZG93LmVtLmluaXRpaWVyZVJhdW1FZGl0XzIoKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLm9wZW5Eb2MobG9jYWxTdG9yYWdlLlJhdW1JZCwge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLmhSYXVtID0gZGF0YTtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlUmF1bUVkaXRfMigpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaW5pdGlpZXJlUmF1bUVkaXRfMiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBmaXhlcyBGZWxkIHNldHplblxyXG5cdCQoXCIjck5hbWVcIikudmFsKHdpbmRvdy5lbS5oUmF1bS5yTmFtZSk7XHJcblx0Ly8gVmFyaWFiZWxuIGJlcmVpdHN0ZWxsZW5cclxuXHRsb2NhbFN0b3JhZ2UuUHJvamVrdElkID0gd2luZG93LmVtLmhSYXVtLmhQcm9qZWt0SWQ7XHJcblx0Ly8gYmVpIG5ldWVuIFLDpHVtZW4gaGF0IGRhcyBPYmpla3Qgbm9jaCBrZWluZSBJRFxyXG5cdGlmICh3aW5kb3cuZW0uaFJhdW0uX2lkKSB7XHJcblx0XHRsb2NhbFN0b3JhZ2UuUmF1bUlkID0gd2luZG93LmVtLmhSYXVtLl9pZDtcclxuXHR9IGVsc2Uge1xyXG5cdFx0bG9jYWxTdG9yYWdlLlJhdW1JZCA9IFwibmV1XCI7XHJcblx0fVxyXG5cdC8vIHByw7xmZW4sIG9iIGRpZSBGZWxkbGlzdGUgc2Nob24gZ2Vob2x0IHd1cmRlXHJcblx0Ly8gd2VubiBqYTogZGVyZW4gZ2xvYmFsZSBWYXJpYWJsZSB2ZXJ3ZW5kZW5cclxuXHRpZiAod2luZG93LmVtLkZlbGRsaXN0ZVJhdW1FZGl0KSB7XHJcblx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlUmF1bUVkaXRfMygpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBkYXMgZGF1ZXJ0IGzDpG5nZXIgLSBoaW53ZWlzZW5cclxuXHRcdCQoXCIjaFJhdW1FZGl0Rm9ybUh0bWxcIikuaHRtbCgnPHAgY2xhc3M9XCJIaW53ZWlzRHluYW1pc2NoZXJGZWxkYXVmYmF1XCI+RGllIEZlbGRlciB3ZXJkZW4gYXVmZ2ViYXV0Li4uPC9wPicpO1xyXG5cdFx0Ly8gaG9sdCBkaWUgRmVsZGxpc3RlIGF1cyBkZXIgREJcclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi52aWV3KCdldmFiL0ZlbGRMaXN0ZVJhdW0/aW5jbHVkZV9kb2NzPXRydWUnLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKEZlbGRsaXN0ZSkge1xyXG5cdFx0XHRcdC8vIFZhcmlhYmVsbiBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdFx0d2luZG93LmVtLkZlbGRsaXN0ZVJhdW1FZGl0ID0gRmVsZGxpc3RlO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5pbml0aWllcmVSYXVtRWRpdF8zKCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5pbml0aWllcmVSYXVtRWRpdF8zID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBodG1sQ29udGFpbmVyID0gd2luZG93LmVtLmdlbmVyaWVyZUh0bWxGdWVyUmF1bUVkaXRGb3JtKCk7XHJcblx0Ly8gTGluaWUgbnVyIGFuZsO8Z2VuLCB3ZW5uIEZlbGRlciBlcnN0ZWxsdCB3dXJkZW5cclxuXHRpZiAoaHRtbENvbnRhaW5lcikge1xyXG5cdFx0aHRtbENvbnRhaW5lciA9IFwiPGhyIC8+XCIgKyBodG1sQ29udGFpbmVyO1xyXG5cdH1cclxuXHQkKFwiI2hSYXVtRWRpdEZvcm1IdG1sXCIpLmh0bWwoaHRtbENvbnRhaW5lcikudHJpZ2dlcihcImNyZWF0ZVwiKS50cmlnZ2VyKFwicmVmcmVzaFwiKTtcclxuXHQvLyBqZXR6dCBhbGxlIEZsaXBzd2l0c2NoZXMsIGRpZSBcIm5laW5cIiBzaW5kLCBha3RpdiBzZXR6ZW5cclxuXHR3aW5kb3cuZW0uYWt0aXZpZXJlRmxpcHN3aXRjaGVzKFwiI2hSYXVtRWRpdEZvcm1IdG1sXCIsIHdpbmRvdy5lbS5oUmF1bSk7XHJcblx0d2luZG93LmVtLmJsZW5kZU1lbnVzKCk7XHJcblx0Ly8gbGV0enRlIHVybCBzcGVpY2hlcm4gLSBoaWVyIHVuZCBuaWNodCBpbSBwYWdlc2hvdywgZGFtaXQgZXMgYmVpIGplZGVtIERhdGVuc2F0endlY2hzZWwgcGFzc2llcnRcclxuXHR3aW5kb3cuZW0uc3BlaWNoZXJlTGV0enRlVXJsKCk7XHJcbn07XHJcblxyXG4vLyBnZW5lcmllcnQgZGFzIEh0bWwgZsO8ciBkYXMgRm9ybXVsYXIgaW4gaFJhdW1FZGl0Lmh0bWxcclxuLy8gZXJ3YXJ0ZXQgRmVsZGxpc3RlIGFscyBPYmpla3Q7IHdpbmRvdy5lbS5oUmF1bSBhbHMgT2JqZWt0XHJcbi8vIGRlciBodG1sQ29udGFpbmVyIHdpcmQgenVyw7xjayBnZWdlYmVuXHJcbndpbmRvdy5lbS5nZW5lcmllcmVIdG1sRnVlclJhdW1FZGl0Rm9ybSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgRmVsZCA9IHt9LFxyXG5cdFx0RmVsZE5hbWUsXHJcbiAgICAgICAgRmVsZFdlcnQsXHJcblx0XHRodG1sQ29udGFpbmVyID0gXCJcIjtcclxuXHRfLmVhY2god2luZG93LmVtLkZlbGRsaXN0ZVJhdW1FZGl0LnJvd3MsIGZ1bmN0aW9uKHJvdykge1xyXG5cdFx0RmVsZCA9IHJvdy5kb2M7XHJcblx0XHRGZWxkTmFtZSA9IEZlbGQuRmVsZE5hbWU7XHJcblx0XHQvLyBudXIgc2ljaHRiYXJlIGVpZ2VuZSBGZWxkZXIuIEJlcmVpdHMgaW0gRm9ybXVsYXIgaW50ZWdyaWVydGUgRmVsZGVyIG5pY2h0IGFuemVpZ2VuXHJcblx0XHRpZiAoKEZlbGQuVXNlciA9PT0gbG9jYWxTdG9yYWdlLkVtYWlsIHx8IEZlbGQuVXNlciA9PT0gXCJaZW50cmVuQmRLdFwiKSAmJiBGZWxkLlNpY2h0YmFySW1Nb2R1c0hpZXJhcmNoaXNjaC5pbmRleE9mKGxvY2FsU3RvcmFnZS5FbWFpbCkgIT09IC0xICYmIEZlbGROYW1lICE9PSBcInJOYW1lXCIpIHtcclxuXHRcdFx0aWYgKGxvY2FsU3RvcmFnZS5TdGF0dXMgPT09IFwibmV1XCIgJiYgRmVsZC5TdGFuZGFyZHdlcnQgJiYgRmVsZC5TdGFuZGFyZHdlcnRbbG9jYWxTdG9yYWdlLkVtYWlsXSkge1xyXG5cdFx0XHRcdEZlbGRXZXJ0ID0gRmVsZC5TdGFuZGFyZHdlcnRbbG9jYWxTdG9yYWdlLkVtYWlsXTtcclxuXHRcdFx0XHQvLyBPYmpla3Qgd2luZG93LmVtLmhSYXVtIHVtIGRlbiBTdGFuZGFyZHdlcnQgZXJnw6RuemVuLCB1bSBzcMOkdGVyIHp1IHNwZWljaGVyblxyXG5cdFx0XHRcdHdpbmRvdy5lbS5oUmF1bVtGZWxkTmFtZV0gPSBGZWxkV2VydDtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvL1wiXCIgdmVyaGluZGVydCBkaWUgQW56ZWlnZSB2b24gdW5kZWZpbmVkIGltIEZlbGRcclxuXHRcdFx0XHRGZWxkV2VydCA9IHdpbmRvdy5lbS5oUmF1bVtGZWxkTmFtZV0gfHwgXCJcIjtcclxuXHRcdFx0fVxyXG5cdFx0XHRodG1sQ29udGFpbmVyICs9IHdpbmRvdy5lbS5nZW5lcmllcmVIdG1sRsO8ckZvcm11bGFyZWxlbWVudChGZWxkLCBGZWxkV2VydCk7XHJcblx0XHR9XHJcblx0fSk7XHJcblx0Ly8gSW4gbmV1ZW4gRGF0ZW5zw6R0emVuIGFsbGbDpGxsaWdlIFN0YW5kYXJkd2VydGUgc3BlaWNoZXJuXHJcblx0aWYgKGxvY2FsU3RvcmFnZS5TdGF0dXMgPT09IFwibmV1XCIpIHtcclxuXHRcdCQoXCIjck5hbWVcIikuZm9jdXMoKTtcclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi5zYXZlRG9jKHdpbmRvdy5lbS5oUmF1bSwge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLmhSYXVtLl9pZCA9IGRhdGEuaWQ7XHJcblx0XHRcdFx0d2luZG93LmVtLmhSYXVtLl9yZXYgPSBkYXRhLnJldjtcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UuUmF1bUlkID0gZGF0YS5pZDtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLlN0YXR1cztcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gQXR0YWNobWVudHMgZ2lidCdzIGJlaSBuZXVlbiBEYXRlbnPDpHR6ZW4gbmljaHRcclxuXHRcdHdpbmRvdy5lbS56ZWlnZUF0dGFjaG1lbnRzKHdpbmRvdy5lbS5oUmF1bSwgXCJoUkVcIik7XHJcblx0fVxyXG5cdHJldHVybiBodG1sQ29udGFpbmVyO1xyXG59O1xyXG5cclxud2luZG93LmVtLmluaXRpaWVyZVJhdW1MaXN0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBoYXQgaFJhdW1FZGl0Lmh0bWwgZWluZSBSYXVtTGlzdGUgw7xiZXJnZWJlbj9cclxuXHRpZiAod2luZG93LmVtLlJhdW1MaXN0ZSkge1xyXG5cdFx0Ly8gUmF1bWxpc3RlIGF1cyBnbG9iYWxlciBWYXJpYWJsZSBob2xlbiAtIG11c3MgbmljaHQgZ2VwYXJzdCB3ZXJkZW5cclxuXHRcdHdpbmRvdy5lbS5pbml0aWllcmVSYXVtTGlzdGVfMigpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBSYXVtbGlzdGUgYXVkIERCIGhvbGVuXHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIudmlldygnZXZhYi9oUmF1bUxpc3RlP3N0YXJ0a2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCIsIFwiJyArIGxvY2FsU3RvcmFnZS5Qcm9qZWt0SWQgKyAnXCJdJmVuZGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiLCBcIicgKyBsb2NhbFN0b3JhZ2UuUHJvamVrdElkICsgJ1wiICx7fV0maW5jbHVkZV9kb2NzPXRydWUnLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHQvLyBSYXVtTGlzdGUgZsO8ciBoYXVtRWRpdCBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdFx0d2luZG93LmVtLlJhdW1MaXN0ZSA9IGRhdGE7XHJcblx0XHRcdFx0d2luZG93LmVtLmluaXRpaWVyZVJhdW1MaXN0ZV8yKCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5pbml0aWllcmVSYXVtTGlzdGVfMiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgYW56UmF1bSA9IHdpbmRvdy5lbS5SYXVtTGlzdGUucm93cy5sZW5ndGgsXHJcblx0XHRSYXVtLFxyXG5cdFx0a2V5LFxyXG5cdFx0ck5hbWUsXHJcblx0XHRsaXN0SXRlbUNvbnRhaW5lciA9IFwiXCIsXHJcblx0XHRUaXRlbDI7XHJcblxyXG5cdC8vIEltIFRpdGVsIGRlciBTZWl0ZSBkaWUgQW56YWhsIFLDpHVtZSBhbnplaWdlblxyXG5cdFRpdGVsMiA9IFwiIFLDpHVtZVwiO1xyXG5cdGlmIChhbnpSYXVtID09PSAxKSB7XHJcblx0XHRUaXRlbDIgPSBcIiBSYXVtXCI7XHJcblx0fVxyXG5cdCQoXCIjaFJhdW1MaXN0ZVBhZ2VIZWFkZXJcIilcclxuICAgICAgICAuZmluZChcIi5oUmF1bUxpc3RlUGFnZVRpdGVsXCIpXHJcbiAgICAgICAgLnRleHQoYW56UmF1bSArIFRpdGVsMik7XHJcblxyXG5cdGlmIChhbnpSYXVtID09PSAwKSB7XHJcblx0XHRsaXN0SXRlbUNvbnRhaW5lciA9ICc8bGk+PGEgaHJlZj1cIiNcIiBuYW1lPVwiTmV1ZXJSYXVtUmF1bUxpc3RlXCIgY2xhc3M9XCJlcnN0ZVwiPkVyc3RlbiBSYXVtIGVyZmFzc2VuPC9hPjwvbGk+JztcclxuXHR9IGVsc2Uge1xyXG5cdFx0Xy5lYWNoKHdpbmRvdy5lbS5SYXVtTGlzdGUucm93cywgZnVuY3Rpb24ocm93KSB7XHJcblx0XHRcdFJhdW0gPSByb3cuZG9jO1xyXG5cdFx0XHRrZXkgPSByb3cua2V5O1xyXG5cdFx0XHRyTmFtZSA9IFJhdW0uck5hbWU7XHJcblx0XHRcdGxpc3RJdGVtQ29udGFpbmVyICs9IFwiPGxpIFJhdW1JZD0nXCIgKyBSYXVtLl9pZCArIFwiJyBjbGFzcz0nUmF1bSc+PGEgaHJlZj0nIyc+PGgzPlwiICsgck5hbWUgKyBcIjxcXC9oMz48XFwvYT48XFwvbGk+XCI7XHJcblx0XHR9KTtcclxuXHR9XHJcblx0JChcIiNSYXVtbGlzdGVoUkxcIilcclxuICAgICAgICAuaHRtbChsaXN0SXRlbUNvbnRhaW5lcilcclxuICAgICAgICAubGlzdHZpZXcoXCJyZWZyZXNoXCIpO1xyXG5cdHdpbmRvdy5lbS5ibGVuZGVNZW51cygpO1xyXG5cdC8vIEZva3VzIGluIGRhcyBTdWNoZmVsZCBzZXR6ZW5cclxuXHQkKFwiI2hSYXVtTGlzdGVcIilcclxuICAgICAgICAuZmluZChcIi51aS1pbnB1dC1zZWFyY2hcIilcclxuICAgICAgICAuY2hpbGRyZW4oXCJpbnB1dFwiKVswXVxyXG4gICAgICAgIC5mb2N1cygpO1xyXG5cdHdpbmRvdy5lbS5zcGVpY2hlcmVMZXR6dGVVcmwoKTtcclxufTtcclxuXHJcbi8vIGdlbmVyaWVydCBpbiBoT3J0RWRpdC5odG1sIGR5bmFtaXNjaCBkaWUgdm9uIGRlbiBTaWNodGJhcmtlaXRzLUVpbnN0ZWxsdW5nZW4gYWJow6RuZ2lnZW4gRmVsZGVyXHJcbi8vIE1pdGdlYmVuOiBpZCBkZXMgT3J0c1xyXG53aW5kb3cuZW0uaW5pdGlpZXJlT3J0RWRpdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBBbmjDpG5nZSBhdXNibGVuZGVuLCB3ZWlsIHNpZSBzb25zdCBiZWltIFdlY2hzZWwgc3TDtnJlblxyXG5cdC8vJCgnI0FuaMOkbmdlaE9FJykuaGlkZSgpO1xyXG5cdGlmICh3aW5kb3cuZW0uaE9ydCkge1xyXG5cdFx0d2luZG93LmVtLmluaXRpaWVyZU9ydEVkaXRfMigpO1xyXG5cdH0gZWxzZSBpZiAobG9jYWxTdG9yYWdlLlN0YXR1cyA9PT0gXCJuZXVcIiAmJiBsb2NhbFN0b3JhZ2UuaE9ydCkge1xyXG5cdFx0Ly8gd2VubiBtaXQgd2luZG93Lm9wZW4gdm9uIG5ldSBnZWtvbW1lbiwgZXhpc3RpZXJ0IGRpZSBnbG9iYWxlIFZhcmlhYmxlIG5pY2h0IG1laHJcclxuXHRcdHdpbmRvdy5lbS5oT3J0ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuaE9ydCk7XHJcblx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLmhPcnQ7XHJcblx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlT3J0RWRpdF8yKCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi5vcGVuRG9jKGxvY2FsU3RvcmFnZS5PcnRJZCwge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLmhPcnQgPSBkYXRhO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5pbml0aWllcmVPcnRFZGl0XzIoKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLmluaXRpaWVyZU9ydEVkaXRfMiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBmaXhlIEZlbGRlciBha3R1YWxpc2llcmVuXHJcblx0JChcIltuYW1lPSdvTmFtZSddXCIpLnZhbCh3aW5kb3cuZW0uaE9ydC5vTmFtZSk7XHJcblx0JChcIltuYW1lPSdvWEtvb3JkJ11cIikudmFsKHdpbmRvdy5lbS5oT3J0Lm9YS29vcmQpO1xyXG5cdCQoXCJbbmFtZT0nb1lLb29yZCddXCIpLnZhbCh3aW5kb3cuZW0uaE9ydC5vWUtvb3JkKTtcclxuXHQkKFwiW25hbWU9J29MYWdlZ2VuYXVpZ2tlaXQnXVwiKS52YWwod2luZG93LmVtLmhPcnQub0xhZ2VnZW5hdWlna2VpdCk7XHJcblx0Ly8gVmFyaWFiZWxuIGJlcmVpdHN0ZWxsZW5cclxuXHRsb2NhbFN0b3JhZ2UuUHJvamVrdElkID0gd2luZG93LmVtLmhPcnQuaFByb2pla3RJZDtcclxuXHRsb2NhbFN0b3JhZ2UuUmF1bUlkID0gd2luZG93LmVtLmhPcnQuaFJhdW1JZDtcclxuXHQvLyBiZWkgbmV1ZW4gT3J0ZW4gaGF0IGRhcyBPYmpla3Qgbm9jaCBrZWluZSBJRFxyXG5cdGlmICh3aW5kb3cuZW0uaE9ydC5faWQpIHtcclxuXHRcdGxvY2FsU3RvcmFnZS5PcnRJZCA9IHdpbmRvdy5lbS5oT3J0Ll9pZDtcclxuXHR9IGVsc2Uge1xyXG5cdFx0bG9jYWxTdG9yYWdlLk9ydElkID0gXCJuZXVcIjtcclxuXHR9XHJcblx0Ly8gTGF0IExuZyB3ZXJkZW4gZ2Vob2x0LiBFeGlzdGllcmVuIHNpZSBuaWNodCwgZXJoYWx0ZW4gU2llIGRlbiBXZXJ0IFwiXCJcclxuXHRsb2NhbFN0b3JhZ2Uub0xvbmdpdHVkZURlY0RlZyA9IHdpbmRvdy5lbS5oT3J0Lm9Mb25naXR1ZGVEZWNEZWc7XHJcblx0bG9jYWxTdG9yYWdlLm9MYXRpdHVkZURlY0RlZyA9IHdpbmRvdy5lbS5oT3J0Lm9MYXRpdHVkZURlY0RlZztcclxuXHRsb2NhbFN0b3JhZ2Uub0xhZ2VnZW5hdWlna2VpdCA9IHdpbmRvdy5lbS5oT3J0Lm9MYWdlZ2VuYXVpZ2tlaXQ7XHJcblx0bG9jYWxTdG9yYWdlLm9YS29vcmQgPSB3aW5kb3cuZW0uaE9ydC5vWEtvb3JkO1xyXG5cdGxvY2FsU3RvcmFnZS5vWUtvb3JkID0gd2luZG93LmVtLmhPcnQub1lLb29yZDtcclxuXHQvLyBwcsO8ZmVuLCBvYiBkaWUgRmVsZGxpc3RlIHNjaG9uIGdlaG9sdCB3dXJkZVxyXG5cdC8vIHdlbm4gamE6IGRlcmVuIGdsb2JhbGUgVmFyaWFibGUgdmVyd2VuZGVuXHJcblx0aWYgKHdpbmRvdy5lbS5GZWxkbGlzdGVPcnRFZGl0KSB7XHJcblx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlT3J0RWRpdF8zKCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIGRhcyBkYXVlcnQgbMOkbmdlciAtIGhpbndlaXNlblxyXG5cdFx0JChcIiNoT3J0RWRpdEZvcm1IdG1sXCIpLmh0bWwoJzxwIGNsYXNzPVwiSGlud2Vpc0R5bmFtaXNjaGVyRmVsZGF1ZmJhdVwiPkRpZSBGZWxkZXIgd2VyZGVuIGF1ZmdlYmF1dC4uLjwvcD4nKTtcclxuXHRcdC8vIGhvbHQgZGllIEZlbGRsaXN0ZSBhdXMgZGVyIERCXHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIudmlldygnZXZhYi9GZWxkTGlzdGVPcnQ/aW5jbHVkZV9kb2NzPXRydWUnLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKEZlbGRsaXN0ZSkge1xyXG5cdFx0XHRcdC8vIEdsb2JhbGUgVmFyaWFibGUgZXJzdGVsbGVuLCBkYW1pdCBhYiBkZW0gendlaXRlbiBtYWwgZGllIHZvcmlnZSBBYmZyYWdlIGdlc3BhYXJ0IHdlcmRlbiBrYW5uXHJcblx0XHRcdFx0d2luZG93LmVtLkZlbGRsaXN0ZU9ydEVkaXQgPSBGZWxkbGlzdGU7XHJcblx0XHRcdFx0d2luZG93LmVtLmluaXRpaWVyZU9ydEVkaXRfMygpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaW5pdGlpZXJlT3J0RWRpdF8zID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBodG1sQ29udGFpbmVyID0gd2luZG93LmVtLmdlbmVyaWVyZUh0bWxGw7xyT3J0RWRpdEZvcm0oKTtcclxuXHQvLyBMaW5pZSBudXIgYW5mw7xnZW4sIHdlbm4gRmVsZGVyIGVyc3RlbGx0IHd1cmRlblxyXG5cdGlmIChodG1sQ29udGFpbmVyKSB7XHJcblx0XHRodG1sQ29udGFpbmVyID0gXCI8aHIgLz5cIiArIGh0bWxDb250YWluZXI7XHJcblx0fVxyXG5cdCQoXCIjaE9ydEVkaXRGb3JtSHRtbFwiKS5odG1sKGh0bWxDb250YWluZXIpLnRyaWdnZXIoXCJjcmVhdGVcIikudHJpZ2dlcihcInJlZnJlc2hcIik7XHJcblx0Ly8gamV0enQgYWxsZSBGbGlwc3dpdHNjaGVzLCBkaWUgXCJuZWluXCIgc2luZCwgYWt0aXYgc2V0emVuXHJcblx0d2luZG93LmVtLmFrdGl2aWVyZUZsaXBzd2l0Y2hlcyhcIiNoT3J0RWRpdEZvcm1IdG1sXCIsIHdpbmRvdy5lbS5oT3J0KTtcclxuXHR3aW5kb3cuZW0uYmxlbmRlTWVudXMoKTtcclxuXHQvLyBsZXR6dGUgdXJsIHNwZWljaGVybiAtIGhpZXIgdW5kIG5pY2h0IGltIHBhZ2VzaG93LCBkYW1pdCBlcyBiZWkgamVkZW0gRGF0ZW5zYXR6d2VjaHNlbCBwYXNzaWVydFxyXG5cdHdpbmRvdy5lbS5zcGVpY2hlcmVMZXR6dGVVcmwoKTtcclxufTtcclxuXHJcbi8vIGdlbmVyaWVydCBkYXMgSHRtbCBmw7xyIGRhcyBGb3JtdWxhciBpbiBoT3J0RWRpdC5odG1sXHJcbi8vIGVyd2FydGV0IEZlbGRsaXN0ZSBhbHMgT2JqZWt0IChhdXMgZGVyIGdsb2JhbGVuIFZhcmlhYmxlKTsgd2luZG93LmVtLmhPcnQgYWxzIE9iamVrdFxyXG4vLyBkZXIgaHRtbENvbnRhaW5lciB3aXJkIHp1csO8Y2sgZ2VnZWJlblxyXG53aW5kb3cuZW0uZ2VuZXJpZXJlSHRtbEbDvHJPcnRFZGl0Rm9ybSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgRmVsZCA9IHt9LFxyXG5cdFx0RmVsZE5hbWUsXHJcbiAgICAgICAgRmVsZFdlcnQsXHJcblx0XHRodG1sQ29udGFpbmVyID0gXCJcIjtcclxuXHRfLmVhY2god2luZG93LmVtLkZlbGRsaXN0ZU9ydEVkaXQucm93cywgZnVuY3Rpb24ocm93KSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdFx0RmVsZCA9IHJvdy5kb2M7XHJcblx0XHRGZWxkTmFtZSA9IEZlbGQuRmVsZE5hbWU7XHJcblx0XHQvLyBudXIgc2ljaHRiYXJlIGVpZ2VuZSBGZWxkZXIuIEJlcmVpdHMgaW0gRm9ybXVsYXIgaW50ZWdyaWVydGUgRmVsZGVyIG5pY2h0IGFuemVpZ2VuXHJcblx0XHRpZiAoKEZlbGQuVXNlciA9PT0gbG9jYWxTdG9yYWdlLkVtYWlsIHx8IEZlbGQuVXNlciA9PT0gXCJaZW50cmVuQmRLdFwiKSAmJiBGZWxkLlNpY2h0YmFySW1Nb2R1c0hpZXJhcmNoaXNjaC5pbmRleE9mKHdpbmRvdy5lbS5oT3J0LlVzZXIpICE9PSAtMSAmJiAoRmVsZE5hbWUgIT09IFwib05hbWVcIikgJiYgKEZlbGROYW1lICE9PSBcIm9YS29vcmRcIikgJiYgKEZlbGROYW1lICE9PSBcIm9ZS29vcmRcIikgJiYgKEZlbGROYW1lICE9PSBcIm9MYWdlZ2VuYXVpZ2tlaXRcIikpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0XHRcdGlmIChsb2NhbFN0b3JhZ2UuU3RhdHVzID09PSBcIm5ldVwiICYmIEZlbGQuU3RhbmRhcmR3ZXJ0ICYmIEZlbGQuU3RhbmRhcmR3ZXJ0W2xvY2FsU3RvcmFnZS5FbWFpbF0pIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0XHRcdFx0RmVsZFdlcnQgPSBGZWxkLlN0YW5kYXJkd2VydFtsb2NhbFN0b3JhZ2UuRW1haWxdO1xyXG5cdFx0XHRcdC8vIE9iamVrdCB3aW5kb3cuZW0uaE9ydCB1bSBkZW4gU3RhbmRhcmR3ZXJ0IGVyZ8OkbnplbiwgdW0gc3DDpHRlciB6dSBzcGVpY2hlcm5cclxuXHRcdFx0XHR3aW5kb3cuZW0uaE9ydFtGZWxkTmFtZV0gPSBGZWxkV2VydDtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvL1wiXCIgdmVyaGluZGVydCBkaWUgQW56ZWlnZSB2b24gdW5kZWZpbmVkIGltIEZlbGRcclxuXHRcdFx0XHRGZWxkV2VydCA9IHdpbmRvdy5lbS5oT3J0W0ZlbGROYW1lXSB8fCBcIlwiO1xyXG5cdFx0XHR9XHJcblx0XHRcdGh0bWxDb250YWluZXIgKz0gd2luZG93LmVtLmdlbmVyaWVyZUh0bWxGw7xyRm9ybXVsYXJlbGVtZW50KEZlbGQsIEZlbGRXZXJ0KTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHQvLyBBbGxmw6RsbGlnZSBTdGFuZGFyZHdlcnRlIHNwZWljaGVyblxyXG5cdGlmIChsb2NhbFN0b3JhZ2UuU3RhdHVzID09PSBcIm5ldVwiKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdFx0JChcIltuYW1lPSdvTmFtZSddXCIpLmZvY3VzKCk7XHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIuc2F2ZURvYyh3aW5kb3cuZW0uaE9ydCwge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5oT3J0Ll9pZCA9IGRhdGEuaWQ7XHJcblx0XHRcdFx0d2luZG93LmVtLmhPcnQuX3JldiA9IGRhdGEucmV2O1xyXG5cdFx0XHRcdGxvY2FsU3RvcmFnZS5PcnRJZCA9IGRhdGEuaWQ7XHJcblx0XHRcdFx0d2luZG93LmVtLkdldEdlb2xvY2F0aW9uKGRhdGEuaWQsIFwiaE9ydFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHQvLyBTdGF0dXMgenVyw7xja3NldHplbiAtIGVzIHNvbGwgbnVyIGVpbiBtYWwgdmVyb3J0ZXQgd2VyZGVuXHJcblx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLlN0YXR1cztcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gQXR0YWNobWVudHMgZ2lidCBlcyBiZWkgbmV1ZW4gT3J0ZW4gbmljaHRcclxuXHRcdHdpbmRvdy5lbS56ZWlnZUF0dGFjaG1lbnRzKHdpbmRvdy5lbS5oT3J0LCBcImhPRVwiKTtcclxuXHR9XHJcblx0cmV0dXJuIGh0bWxDb250YWluZXI7XHJcbn07XHJcblxyXG4vLyBlcnN0ZWxsdCBkaWUgT3J0bGlzdGUgaW4gaE9ydExpc3RlLmh0bWxcclxud2luZG93LmVtLmluaXRpaWVyZU9ydExpc3RlID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIGhhdCBoT3J0RWRpdC5odG1sIGVpbmUgT3J0TGlzdGUgw7xiZXJnZWJlbj9cclxuXHRpZiAod2luZG93LmVtLk9ydExpc3RlKSB7XHJcblx0XHQvLyBPcnRsaXN0ZSBhdXMgZ2xvYmFsZXIgVmFyaWFibGUgaG9sZW4gLSBtdXNzIG5pY2h0IGdlcGFyc3Qgd2VyZGVuXHJcblx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlT3J0TGlzdGVfMigpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBPcnRsaXN0ZSBhdXMgREIgaG9sZW5cclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi52aWV3KCdldmFiL2hPcnRMaXN0ZT9zdGFydGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiLCBcIicgKyBsb2NhbFN0b3JhZ2UuUmF1bUlkICsgJ1wiXSZlbmRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5FbWFpbCArICdcIiwgXCInICsgbG9jYWxTdG9yYWdlLlJhdW1JZCArICdcIiAse31dJmluY2x1ZGVfZG9jcz10cnVlJywge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0Ly8gT3J0TGlzdGUgZsO8ciBoT3J0RWRpdCBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdFx0d2luZG93LmVtLk9ydExpc3RlID0gZGF0YTtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlT3J0TGlzdGVfMigpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaW5pdGlpZXJlT3J0TGlzdGVfMiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgYW56T3J0ID0gd2luZG93LmVtLk9ydExpc3RlLnJvd3MubGVuZ3RoLFxyXG5cdFx0T3J0LFxyXG5cdFx0a2V5LFxyXG5cdFx0bGlzdEl0ZW1Db250YWluZXIgPSBcIlwiLFxyXG5cdFx0VGl0ZWwyO1xyXG5cclxuXHQvLyBJbSBUaXRlbCBkZXIgU2VpdGUgZGllIEFuemFobCBPcnRlIGFuemVpZ2VuXHJcblx0VGl0ZWwyID0gXCIgT3J0ZVwiO1xyXG5cdGlmIChhbnpPcnQgPT09IDEpIHtcclxuXHRcdFRpdGVsMiA9IFwiIE9ydFwiO1xyXG5cdH1cclxuXHQkKFwiI2hPcnRMaXN0ZVBhZ2VIZWFkZXJcIilcclxuICAgICAgICAuZmluZChcIi5oT3J0TGlzdGVQYWdlVGl0ZWxcIilcclxuICAgICAgICAudGV4dChhbnpPcnQgKyBUaXRlbDIpO1xyXG5cclxuXHRpZiAoYW56T3J0ID09PSAwKSB7XHJcblx0XHRsaXN0SXRlbUNvbnRhaW5lciA9ICc8bGk+PGEgaHJlZj1cIiNcIiBjbGFzcz1cImVyc3RlIE5ldWVyT3J0T3J0TGlzdGVcIj5FcnN0ZW4gT3J0IGVyZmFzc2VuPC9hPjwvbGk+JztcclxuXHR9IGVsc2Uge1xyXG5cdFx0Xy5lYWNoKHdpbmRvdy5lbS5PcnRMaXN0ZS5yb3dzLCBmdW5jdGlvbihyb3cpIHtcclxuXHRcdFx0T3J0ID0gcm93LmRvYztcclxuXHRcdFx0a2V5ID0gcm93LmtleTtcclxuXHRcdFx0bGlzdEl0ZW1Db250YWluZXIgKz0gXCI8bGkgT3J0SWQ9J1wiICsgT3J0Ll9pZCArIFwiJyBjbGFzcz0nT3J0Jz48YSBocmVmPScjJz48aDM+XCIgKyBPcnQub05hbWUgKyBcIjxcXC9oMz48XFwvYT48XFwvbGk+XCI7XHJcblx0XHR9KTtcclxuXHR9XHJcblx0JChcIiNPcnRsaXN0ZWhPTFwiKVxyXG4gICAgICAgIC5odG1sKGxpc3RJdGVtQ29udGFpbmVyKVxyXG4gICAgICAgIC5saXN0dmlldyhcInJlZnJlc2hcIik7XHJcblx0d2luZG93LmVtLmJsZW5kZU1lbnVzKCk7XHJcblx0Ly8gRm9rdXMgaW4gZGFzIFN1Y2hmZWxkIHNldHplblxyXG5cdCQoXCIjaE9ydExpc3RlXCIpXHJcbiAgICAgICAgLmZpbmQoXCIudWktaW5wdXQtc2VhcmNoXCIpXHJcbiAgICAgICAgLmNoaWxkcmVuKFwiaW5wdXRcIilbMF1cclxuICAgICAgICAuZm9jdXMoKTtcclxuXHR3aW5kb3cuZW0uc3BlaWNoZXJlTGV0enRlVXJsKCk7XHJcbn07XHJcblxyXG4vLyBnZW5lcmllcnQgaW4gaFplaXRFZGl0Lmh0bWwgZHluYW1pc2NoIGRpZSB2b24gZGVuIFNpY2h0YmFya2VpdHMtRWluc3RlbGx1bmdlbiBhYmjDpG5naWdlbiBGZWxkZXJcclxuLy8gTWl0Z2ViZW46IGlkIGRlciBaZWl0XHJcbndpbmRvdy5lbS5pbml0aWllcmVaZWl0RWRpdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBBbmjDpG5nZSBhdXNibGVuZGVuLCB3ZWlsIHNpZSBzb25zdCBiZWltIFdlY2hzZWwgc3TDtnJlblxyXG5cdC8vJCgnI0FuaMOkbmdlaFpFJykuaGlkZSgpO1xyXG5cdC8vIGhaZWl0IGV4aXN0aWVydCBzY2hvbiBiZWkgbmV1ZXIgWmVpdFxyXG5cdC8vYWxlcnQoXCJ3aW5kb3cuZW0uaFplaXQgPSBcIiArIEpTT04uc3RyaW5naWZ5KHdpbmRvdy5lbS5oWmVpdCkpO1xyXG5cdGlmICh3aW5kb3cuZW0uaFplaXQpIHtcclxuXHRcdHdpbmRvdy5lbS5pbml0aWllcmVaZWl0RWRpdF8yKCk7XHJcblx0fSBlbHNlIGlmIChsb2NhbFN0b3JhZ2UuU3RhdHVzID09PSBcIm5ldVwiICYmIGxvY2FsU3RvcmFnZS5oWmVpdCkge1xyXG5cdFx0Ly8gd2VubiBtaXQgd2luZG93Lm9wZW4gdm9uIG5ldSBnZWtvbW1lbiwgZXhpc3RpZXJ0IGRpZSBnbG9iYWxlIFZhcmlhYmxlIG5pY2h0IG1laHJcclxuXHRcdHdpbmRvdy5lbS5oWmVpdCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmhaZWl0KTtcclxuXHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuaFplaXQ7XHJcblx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlWmVpdEVkaXRfMigpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIub3BlbkRvYyhsb2NhbFN0b3JhZ2UuWmVpdElkLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaFplaXQgPSBkYXRhO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5pbml0aWllcmVaZWl0RWRpdF8yKCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5pbml0aWllcmVaZWl0RWRpdF8yID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIGZpeGUgRmVsZGVyIGFrdHVhbGlzaWVyZW5cclxuXHQkKFwiW25hbWU9J3pEYXR1bSddXCIpLnZhbCh3aW5kb3cuZW0uaFplaXQuekRhdHVtKTtcclxuXHQkKFwiW25hbWU9J3pVaHJ6ZWl0J11cIikudmFsKHdpbmRvdy5lbS5oWmVpdC56VWhyemVpdCk7XHJcblx0Ly8gVmFyaWFiZWxuIGJlcmVpdHN0ZWxsZW5cclxuXHRsb2NhbFN0b3JhZ2UuUHJvamVrdElkID0gd2luZG93LmVtLmhaZWl0LmhQcm9qZWt0SWQ7XHJcblx0bG9jYWxTdG9yYWdlLlJhdW1JZCA9IHdpbmRvdy5lbS5oWmVpdC5oUmF1bUlkO1xyXG5cdGxvY2FsU3RvcmFnZS5PcnRJZCA9IHdpbmRvdy5lbS5oWmVpdC5oT3J0SWQ7XHJcblx0Ly8gYmVpIG5ldWVuIFplaXRlbiBoYXQgZGFzIE9iamVrdCBub2NoIGtlaW5lIElEXHJcblx0aWYgKHdpbmRvdy5lbS5oWmVpdC5faWQpIHtcclxuXHRcdGxvY2FsU3RvcmFnZS5aZWl0SWQgPSB3aW5kb3cuZW0uaFplaXQuX2lkO1xyXG5cdH1cclxuXHQvLyBwcsO8ZmVuLCBvYiBkaWUgRmVsZGxpc3RlIHNjaG9uIGdlaG9sdCB3dXJkZVxyXG5cdC8vIHdlbm4gamE6IGRlcmVuIGdsb2JhbGUgVmFyaWFibGUgdmVyd2VuZGVuXHJcblx0aWYgKHdpbmRvdy5lbS5GZWxkbGlzdGVaZWl0RWRpdCkge1xyXG5cdFx0d2luZG93LmVtLmluaXRpaWVyZVplaXRFZGl0XzMoKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gRmVsZGxpc3RlIGF1cyBkZXIgREIgaG9sZW5cclxuXHRcdC8vIGRhcyBkYXVlcnQgbMOkbmdlciAtIGhpbndlaXNlblxyXG5cdFx0JChcIiNoWmVpdEVkaXRGb3JtSHRtbFwiKS5odG1sKCc8cCBjbGFzcz1cIkhpbndlaXNEeW5hbWlzY2hlckZlbGRhdWZiYXVcIj5EaWUgRmVsZGVyIHdlcmRlbiBhdWZnZWJhdXQuLi48L3A+Jyk7XHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIudmlldygnZXZhYi9GZWxkTGlzdGVaZWl0P2luY2x1ZGVfZG9jcz10cnVlJywge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihGZWxkbGlzdGUpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uRmVsZGxpc3RlWmVpdEVkaXQgPSBGZWxkbGlzdGU7XHJcblx0XHRcdFx0d2luZG93LmVtLmluaXRpaWVyZVplaXRFZGl0XzMoKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLmluaXRpaWVyZVplaXRFZGl0XzMgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGh0bWxDb250YWluZXIgPSB3aW5kb3cuZW0uZ2VuZXJpZXJlSHRtbEZ1ZXJaZWl0RWRpdEZvcm0oKTtcclxuXHQvLyBMaW5pZSBudXIgYW5mw7xnZW4sIHdlbm4gRmVsZGVyIGVyc3RlbGx0IHd1cmRlblxyXG5cdGlmIChodG1sQ29udGFpbmVyKSB7XHJcblx0XHRodG1sQ29udGFpbmVyID0gXCI8aHIgLz5cIiArIGh0bWxDb250YWluZXI7XHJcblx0fVxyXG5cdCQoXCIjaFplaXRFZGl0Rm9ybUh0bWxcIikuaHRtbChodG1sQ29udGFpbmVyKS50cmlnZ2VyKFwiY3JlYXRlXCIpLnRyaWdnZXIoXCJyZWZyZXNoXCIpO1xyXG5cdC8vIGpldHp0IGFsbGUgRmxpcHN3aXRzY2hlcywgZGllIFwibmVpblwiIHNpbmQsIGFrdGl2IHNldHplblxyXG5cdHdpbmRvdy5lbS5ha3RpdmllcmVGbGlwc3dpdGNoZXMoXCIjaFplaXRFZGl0Rm9ybUh0bWxcIiwgd2luZG93LmVtLmhaZWl0KTtcclxuXHR3aW5kb3cuZW0uYmxlbmRlTWVudXMoKTtcclxuXHQvLyBsZXR6dGUgdXJsIHNwZWljaGVybiAtIGhpZXIgdW5kIG5pY2h0IGltIHBhZ2VzaG93LCBkYW1pdCBlcyBiZWkgamVkZW0gRGF0ZW5zYXR6d2VjaHNlbCBwYXNzaWVydFxyXG5cdHdpbmRvdy5lbS5zcGVpY2hlcmVMZXR6dGVVcmwoKTtcclxufTtcclxuXHJcbi8vIGVyc3RlbGx0IGRpZSBMaXN0ZSBkZXIgWmVpdGVuIGluIEZvcm11bGFyIGhaZWl0TGlzdGUuaHRtbFxyXG53aW5kb3cuZW0uaW5pdGlpZXJlWmVpdExpc3RlID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIGhhdCBoWmVpdEVkaXQuaHRtbCBlaW5lIFplaXRMaXN0ZSDDvGJlcmdlYmVuP1xyXG5cdGlmICh3aW5kb3cuZW0uWmVpdExpc3RlKSB7XHJcblx0XHQvLyBaZWl0bGlzdGUgYXVzIGdsb2JhbGVyIFZhcmlhYmxlIGhvbGVuIC0gbXVzcyBuaWNodCBnZXBhcnN0IHdlcmRlblxyXG5cdFx0d2luZG93LmVtLmluaXRpaWVyZVplaXRMaXN0ZV8yKCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIFplaXRsaXN0ZSBhdXMgREIgaG9sZW5cclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi52aWV3KCdldmFiL2haZWl0TGlzdGU/c3RhcnRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5FbWFpbCArICdcIiwgXCInICsgbG9jYWxTdG9yYWdlLk9ydElkICsgJ1wiXSZlbmRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5FbWFpbCArICdcIiwgXCInICsgbG9jYWxTdG9yYWdlLk9ydElkICsgJ1wiICx7fV0maW5jbHVkZV9kb2NzPXRydWUnLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHQvLyBaZWl0TGlzdGUgZsO8ciBoWmVpdEVkaXQgYmVyZWl0c3RlbGxlblxyXG5cdFx0XHRcdHdpbmRvdy5lbS5aZWl0TGlzdGUgPSBkYXRhO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5pbml0aWllcmVaZWl0TGlzdGVfMigpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaW5pdGlpZXJlWmVpdExpc3RlXzIgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGFuelplaXQgPSB3aW5kb3cuZW0uWmVpdExpc3RlLnJvd3MubGVuZ3RoLFxyXG5cdFx0WmVpdCxcclxuXHRcdGtleSxcclxuXHRcdGxpc3RJdGVtQ29udGFpbmVyID0gXCJcIixcclxuXHRcdFRpdGVsMixcclxuXHRcdHpaZWl0RGF0dW07XHJcblxyXG5cdC8vIEltIFRpdGVsIGRlciBTZWl0ZSBkaWUgQW56YWhsIFplaXRlbiBhbnplaWdlblxyXG5cdFRpdGVsMiA9IFwiIFplaXRlblwiO1xyXG5cdGlmIChhbnpaZWl0ID09PSAxKSB7XHJcblx0XHRUaXRlbDIgPSBcIiBaZWl0XCI7XHJcblx0fVxyXG5cdCQoXCIjaFplaXRMaXN0ZVBhZ2VIZWFkZXJcIilcclxuICAgICAgICAuZmluZChcIi5oWmVpdExpc3RlUGFnZVRpdGVsXCIpXHJcbiAgICAgICAgLnRleHQoYW56WmVpdCArIFRpdGVsMik7XHJcblxyXG5cdGlmIChhbnpaZWl0ID09PSAwKSB7XHJcblx0XHRsaXN0SXRlbUNvbnRhaW5lciA9ICc8bGk+PGEgaHJlZj1cIiNcIiBjbGFzcz1cImVyc3RlIE5ldWVaZWl0WmVpdExpc3RlXCI+RXJzdGUgWmVpdCBlcmZhc3NlbjwvYT48L2xpPic7XHJcblx0fSBlbHNlIHtcclxuXHRcdF8uZWFjaCh3aW5kb3cuZW0uWmVpdExpc3RlLnJvd3MsIGZ1bmN0aW9uKHJvdykge1xyXG5cdFx0XHRaZWl0ID0gcm93LmRvYztcclxuXHRcdFx0a2V5ID0gcm93LmtleTtcclxuXHRcdFx0elplaXREYXR1bSA9IGtleVsyXSArIFwiJm5ic3A7ICZuYnNwO1wiICsga2V5WzNdO1xyXG5cdFx0XHRsaXN0SXRlbUNvbnRhaW5lciArPSBcIjxsaSBaZWl0SWQ9J1wiICsgWmVpdC5faWQgKyBcIicgY2xhc3M9J1plaXQnPjxhIGhyZWY9JyMnPjxoMz5cIiArIHpaZWl0RGF0dW0gKyBcIjxcXC9oMz48XFwvYT48XFwvbGk+XCI7XHJcblx0XHR9KTtcclxuXHR9XHJcblx0JChcIiNaZWl0bGlzdGVoWkxcIilcclxuICAgICAgICAuaHRtbChsaXN0SXRlbUNvbnRhaW5lcilcclxuICAgICAgICAubGlzdHZpZXcoXCJyZWZyZXNoXCIpO1xyXG5cdHdpbmRvdy5lbS5ibGVuZGVNZW51cygpO1xyXG5cdC8vIEZva3VzIGluIGRhcyBTdWNoZmVsZCBzZXR6ZW5cclxuXHQkKFwiI2haZWl0TGlzdGVcIilcclxuICAgICAgICAuZmluZChcIi51aS1pbnB1dC1zZWFyY2hcIilcclxuICAgICAgICAuY2hpbGRyZW4oXCJpbnB1dFwiKVswXVxyXG4gICAgICAgIC5mb2N1cygpO1xyXG5cdHdpbmRvdy5lbS5zcGVpY2hlcmVMZXR6dGVVcmwoKTtcclxufTtcclxuXHJcbi8vIGdlbmVyaWVydCBkYXMgSHRtbCBmw7xyIGRhcyBGb3JtdWxhciBpbiBoWmVpdEVkaXQuaHRtbFxyXG4vLyBlcndhcnRldCBGZWxkbGlzdGUgYWxzIE9iamVrdDsgWmVpdCBhbHMgT2JqZWt0XHJcbi8vIGRlciBodG1sQ29udGFpbmVyIHdpcmQgenVyw7xjayBnZWdlYmVuXHJcbndpbmRvdy5lbS5nZW5lcmllcmVIdG1sRnVlclplaXRFZGl0Rm9ybSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgRmVsZCA9IHt9LFxyXG5cdFx0RmVsZE5hbWUsXHJcbiAgICAgICAgRmVsZFdlcnQsXHJcblx0XHRodG1sQ29udGFpbmVyID0gXCJcIjtcclxuXHRfLmVhY2god2luZG93LmVtLkZlbGRsaXN0ZVplaXRFZGl0LnJvd3MsIGZ1bmN0aW9uKHJvdykge1xyXG5cdFx0RmVsZCA9IHJvdy5kb2M7XHJcblx0XHRGZWxkTmFtZSA9IEZlbGQuRmVsZE5hbWU7XHJcblx0XHQvLyBudXIgc2ljaHRiYXJlIGVpZ2VuZSBGZWxkZXIuIEJlcmVpdHMgaW0gRm9ybXVsYXIgaW50ZWdyaWVydGUgRmVsZGVyIG5pY2h0IGFuemVpZ2VuXHJcblx0XHRpZiAoKEZlbGQuVXNlciA9PT0gd2luZG93LmVtLmhaZWl0LlVzZXIgfHwgRmVsZC5Vc2VyID09PSBcIlplbnRyZW5CZEt0XCIpICYmIEZlbGQuU2ljaHRiYXJJbU1vZHVzSGllcmFyY2hpc2NoLmluZGV4T2Yod2luZG93LmVtLmhaZWl0LlVzZXIpICE9PSAtMSAmJiBGZWxkTmFtZSAhPT0gXCJ6RGF0dW1cIiAmJiBGZWxkTmFtZSAhPT0gXCJ6VWhyemVpdFwiKSB7XHJcblx0XHRcdGlmIChsb2NhbFN0b3JhZ2UuU3RhdHVzID09PSBcIm5ldVwiICYmIEZlbGQuU3RhbmRhcmR3ZXJ0ICYmIHdpbmRvdy5lbS5oWmVpdFtGZWxkTmFtZV0pIHtcclxuXHRcdFx0XHRGZWxkV2VydCA9IEZlbGQuU3RhbmRhcmR3ZXJ0W3dpbmRvdy5lbS5oWmVpdC5Vc2VyXSB8fCBcIlwiO1xyXG5cdFx0XHRcdC8vIE9iamVrdCB3aW5kb3cuZW0uaFplaXQgdW0gZGVuIFN0YW5kYXJkd2VydCBlcmfDpG56ZW4sIHVtIHNww6R0ZXIgenUgc3BlaWNoZXJuXHJcblx0XHRcdFx0d2luZG93LmVtLmhaZWl0W0ZlbGROYW1lXSA9IEZlbGRXZXJ0O1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdEZlbGRXZXJ0ID0gd2luZG93LmVtLmhaZWl0W0ZlbGROYW1lXSB8fCBcIlwiO1xyXG5cdFx0XHR9XHJcblx0XHRcdGh0bWxDb250YWluZXIgKz0gd2luZG93LmVtLmdlbmVyaWVyZUh0bWxGw7xyRm9ybXVsYXJlbGVtZW50KEZlbGQsIEZlbGRXZXJ0KTtcclxuXHRcdH1cclxuXHRcdC8vIGxvY2FsU3RvcmFnZS5TdGF0dXMgd2lyZCBzY2hvbiBpbSBhdWZydWZlbmRlbiBmdW5jdGlvbiBnZWzDtnNjaHQhXHJcblx0fSk7XHJcblx0aWYgKGxvY2FsU3RvcmFnZS5TdGF0dXMgPT09IFwibmV1XCIpIHtcclxuXHRcdC8vIGluIG5ldWVuIERhdGVuc8OkdHplbiBkeW5hbWlzY2ggZXJzdGVsbHRlIFN0YW5kYXJkd2VydGUgc3BlaWNoZXJuXHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIuc2F2ZURvYyh3aW5kb3cuZW0uaFplaXQsIHtcclxuXHRcdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5oWmVpdC5faWQgPSBkYXRhLmlkO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5oWmVpdC5fcmV2ID0gZGF0YS5yZXY7XHJcblx0XHRcdFx0bG9jYWxTdG9yYWdlLlplaXRJZCA9IGRhdGEuaWQ7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5TdGF0dXM7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIE5ldWUgRGF0ZW5zw6R0emUgaGFiZW4ga2VpbmUgQXR0YWNobWVudHNcclxuXHRcdHdpbmRvdy5lbS56ZWlnZUF0dGFjaG1lbnRzKHdpbmRvdy5lbS5oWmVpdCwgXCJoWkVcIik7XHJcblx0fVxyXG5cdHJldHVybiBodG1sQ29udGFpbmVyO1xyXG59O1xyXG5cclxuLy8gbWFuYWd0IGRlbiBBdWZiYXUgYWxsZXIgRGF0ZW4gdW5kIEZlbGRlciBmw7xyIGhBcnRFZGl0Lmh0bWxcclxuLy8gZXJ3YXJ0ZXQgZGllIGhBcnRJZFxyXG4vLyB3aXJkIGF1ZmdlcnVmZW4gdm9uIGhBcnRFZGl0Lmh0bWwgYmVpIHBhZ2VzaG93XHJcbndpbmRvdy5lbS5pbml0aWllcmVoQXJ0RWRpdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBtYXJraWVyZW4sIGRhc3MgZGllIEVpbnplbHNpY2h0IGFrdGl2IGlzdFxyXG5cdGxvY2FsU3RvcmFnZS5oQXJ0U2ljaHQgPSBcImVpbnplbFwiO1xyXG5cdC8vIGFjaHR1bmc6IHdlbm4gc29lYmVuIGRpZSBBcnQgZ2XDpG5kZXJ0IHd1cmRlLCBtw7xzc2VuIEFydElkIHVuZCBBcnROYW1lIG5ldSBnZWhvbHQgd2VyZGVuXHJcblx0aWYgKHdpbmRvdy5lbS5oQXJ0ICYmICghbG9jYWxTdG9yYWdlLlZvbiB8fCBsb2NhbFN0b3JhZ2UuVm9uICE9PSBcImhBcnRFZGl0XCIpKSB7XHJcblx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlaEFydEVkaXRfMih3aW5kb3cuZW0uaEFydCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi5vcGVuRG9jKGxvY2FsU3RvcmFnZS5oQXJ0SWQsIHtcclxuXHRcdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5oQXJ0ID0gZGF0YTtcclxuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5hQXJ0SWQgPSB3aW5kb3cuZW0uaEFydC5hQXJ0SWQ7XHJcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UuYUFydE5hbWUgPSB3aW5kb3cuZW0uaEFydC5hQXJ0TmFtZTtcclxuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5hQXJ0R3J1cHBlID0gd2luZG93LmVtLmhBcnQuYUFydEdydXBwZTtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlaEFydEVkaXRfMihkYXRhKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLmluaXRpaWVyZWhBcnRFZGl0XzIgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gaGllciB3ZXJkZW4gVmFyaWFibGVuIGdlc2V0enQsXHJcblx0Ly8gaW4gZGllIGZpeGVuIEZlbGRlciBXZXJ0ZSBlaW5nZXNldHp0LFxyXG5cdC8vIGRpZSBkeW5hbWlzY2hlbiBGZWxkZXIgYXVmZ2ViYXV0XHJcblx0Ly8gdW5kIGRpZSBOYXYtTGlua3MgZ2VzZXR6dFxyXG5cclxuXHQvLyBBbmjDpG5nZSBhdXNibGVuZGVuLCB3ZWlsIHNpZSBzb25zdCBiZWltIFdlY2hzZWwgc3TDtnJlblxyXG5cdC8vJCgnI0FuaMOkbmdlaEFFJykuaGlkZSgpO1xyXG5cclxuXHQvLyBkaWVzZSAoZ2xvYmFsZW4pIFZhcmlhYmVsbiB3ZXJkZW4gaW4gaEFydEVkaXQuaHRtbCBnZWJyYXVjaHRcclxuXHQvLyBWYXJpYWJlbG4gYmVyZWl0c3RlbGxlblxyXG5cdGxvY2FsU3RvcmFnZS5Qcm9qZWt0SWQgPSB3aW5kb3cuZW0uaEFydC5oUHJvamVrdElkO1xyXG5cdGxvY2FsU3RvcmFnZS5SYXVtSWQgPSB3aW5kb3cuZW0uaEFydC5oUmF1bUlkO1xyXG5cdGxvY2FsU3RvcmFnZS5PcnRJZCA9IHdpbmRvdy5lbS5oQXJ0LmhPcnRJZDtcclxuXHRsb2NhbFN0b3JhZ2UuWmVpdElkID0gd2luZG93LmVtLmhBcnQuaFplaXRJZDtcclxuXHQvLyBiZWkgbmV1ZW4gaEFydCBoYXQgZGFzIE9iamVrdCBub2NoIGtlaW5lIElEXHJcblx0aWYgKHdpbmRvdy5lbS5oQXJ0Ll9pZCkge1xyXG5cdFx0bG9jYWxTdG9yYWdlLmhBcnRJZCA9IHdpbmRvdy5lbS5oQXJ0Ll9pZDtcclxuXHR9IGVsc2Uge1xyXG5cdFx0bG9jYWxTdG9yYWdlLmhBcnRJZCA9IFwibmV1XCI7XHJcblx0fVxyXG5cdGxvY2FsU3RvcmFnZS5hQXJ0R3J1cHBlID0gd2luZG93LmVtLmhBcnQuYUFydEdydXBwZTtcclxuXHRsb2NhbFN0b3JhZ2UuYUFydE5hbWUgPSB3aW5kb3cuZW0uaEFydC5hQXJ0TmFtZTtcclxuXHRsb2NhbFN0b3JhZ2UuYUFydElkID0gd2luZG93LmVtLmhBcnQuYUFydElkO1xyXG5cdC8vIGZpeGUgRmVsZGVyIGFrdHVhbGlzaWVyZW5cclxuXHQkKFwiI2FBcnRHcnVwcGVcIilcclxuICAgICAgICAudmFsKHdpbmRvdy5lbS5oQXJ0LmFBcnRHcnVwcGUpXHJcbiAgICAgICAgLmh0bWwoXCI8b3B0aW9uIHZhbHVlPSdcIiArIHdpbmRvdy5lbS5oQXJ0LmFBcnRHcnVwcGUgKyBcIic+XCIgKyB3aW5kb3cuZW0uaEFydC5hQXJ0R3J1cHBlICsgXCI8L29wdGlvbj5cIilcclxuICAgICAgICAuc2VsZWN0bWVudSgpXHJcbiAgICAgICAgLnNlbGVjdG1lbnUoXCJyZWZyZXNoXCIpO1xyXG5cdC8vIEpRVUVSWSBNT0JJTEUgQlJBQ0hUIE1BTkNITUFMIExBTkdFIFVNIFpVIElOSVRJQUxJSUVSRU5cclxuXHQvLyBPSE5FIFRJTUVPVVQgUkVLTEFNSUVSVCBFUyBCRUlNIFJFRlJFU0gsIERBUyBXSURHRVQgU0VJIE5PQ0ggTklDSFQgSU5JVElBTElTSUVSVCEhISFcclxuXHQvLyBOQUNIIEVJTiBNQUwgVkVSWsOWR0VSTiBIQVQgRVMgQUJFUiBXSUVERVIgRlVOS1RJT05JRVJUPz8/PyEhISFcclxuXHQvKnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblx0XHQkKFwiI2FBcnRHcnVwcGVcIikuc2VsZWN0bWVudShcInJlZnJlc2hcIik7XHJcblx0fSwgMCk7Ki9cclxuXHQkKFwiI2FBcnROYW1lXCIpXHJcbiAgICAgICAgLnZhbCh3aW5kb3cuZW0uaEFydC5hQXJ0TmFtZSlcclxuICAgICAgICAuaHRtbChcIjxvcHRpb24gdmFsdWU9J1wiICsgd2luZG93LmVtLmhBcnQuYUFydE5hbWUgKyBcIic+XCIgKyB3aW5kb3cuZW0uaEFydC5hQXJ0TmFtZSArIFwiPC9vcHRpb24+XCIpXHJcbiAgICAgICAgLnNlbGVjdG1lbnUoKVxyXG4gICAgICAgIC5zZWxlY3RtZW51KFwicmVmcmVzaFwiKTtcclxuXHQvLyBwcsO8ZmVuLCBvYiBkaWUgRmVsZGxpc3RlIHNjaG9uIGdlaG9sdCB3dXJkZVxyXG5cdC8vIHdlbm4gamE6IGRlcmVuIGdsb2JhbGUgVmFyaWFibGUgdmVyd2VuZGVuXHJcblx0aWYgKHdpbmRvdy5lbS5GZWxkbGlzdGVoQXJ0RWRpdCkge1xyXG5cdFx0d2luZG93LmVtLmVyc3RlbGxlRHluYW1pc2NoZUZlbGRlcmhBcnRFZGl0KCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIEZlbGRsaXN0ZSBhdXMgZGVyIERCIGhvbGVuXHJcblx0XHQvLyBkYXMgZGF1ZXJ0IGzDpG5nZXIgLSBoaW53ZWlzZW5cclxuXHRcdCQoXCIjaEFydEVkaXRGb3JtSHRtbFwiKS5odG1sKCc8cCBjbGFzcz1cIkhpbndlaXNEeW5hbWlzY2hlckZlbGRhdWZiYXVcIj5EaWUgRmVsZGVyIHdlcmRlbiBhdWZnZWJhdXQuLi48L3A+Jyk7XHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIudmlldygnZXZhYi9GZWxkTGlzdGVBcnQ/aW5jbHVkZV9kb2NzPXRydWUnLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uRmVsZGxpc3RlaEFydEVkaXQgPSBkYXRhO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5lcnN0ZWxsZUR5bmFtaXNjaGVGZWxkZXJoQXJ0RWRpdCgpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG4vLyBnZW5lcmllcnQgZHluYW1pc2NoIGRpZSBBcnRncnVwcGVuLWFiaMOkbmdpZ2VuIEZlbGRlclxyXG4vLyBNaXRnZWJlbjogRmVsZGxpc3RlLCBCZW9iYWNodHVuZ1xyXG53aW5kb3cuZW0uZXJzdGVsbGVEeW5hbWlzY2hlRmVsZGVyaEFydEVkaXQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGh0bWxDb250YWluZXIgPSB3aW5kb3cuZW0uZ2VuZXJpZXJlSHRtbEbDvHJoQXJ0RWRpdEZvcm0oKTtcclxuXHQvLyBMaW5pZSBudXIgYW5mw7xnZW4sIHdlbm4gRmVsZGVyIGVyc3RlbGx0IHd1cmRlblxyXG5cdGlmIChodG1sQ29udGFpbmVyKSB7XHJcblx0XHRodG1sQ29udGFpbmVyID0gXCI8aHIgLz5cIiArIGh0bWxDb250YWluZXI7XHJcblx0fVxyXG5cdCQoXCIjaEFydEVkaXRGb3JtSHRtbFwiKS5odG1sKGh0bWxDb250YWluZXIpLnRyaWdnZXIoXCJjcmVhdGVcIikudHJpZ2dlcihcInJlZnJlc2hcIik7XHJcblx0Ly8gamV0enQgYWxsZSBGbGlwc3dpdHNjaGVzLCBkaWUgXCJuZWluXCIgc2luZCwgYWt0aXYgc2V0emVuXHJcblx0d2luZG93LmVtLmFrdGl2aWVyZUZsaXBzd2l0Y2hlcyhcIiNoQXJ0RWRpdEZvcm1IdG1sXCIsIHdpbmRvdy5lbS5oQXJ0KTtcclxuXHR3aW5kb3cuZW0uYmxlbmRlTWVudXMoKTtcclxuXHQvLyBsZXR6dGUgdXJsIHNwZWljaGVybiAtIGhpZXIgdW5kIG5pY2h0IGltIHBhZ2VzaG93LCBkYW1pdCBlcyBiZWkgamVkZW0gRGF0ZW5zYXR6d2VjaHNlbCBwYXNzaWVydFxyXG5cdHdpbmRvdy5lbS5zcGVpY2hlcmVMZXR6dGVVcmwoKTtcclxufTtcclxuXHJcbi8vIEZsaXBzd2l0Y2hlcyBtaXQgV2VydCBcIm5laW5cIiBha3RpdiBzY2hhbHRlblxyXG4vLyBkYXp1IG11c3MgZGVyIFdlcnQgYXVzIGRlciBPYmpla3QtVmFyaWFiZWxuIGdlaG9sdCB3ZXJkZW5cclxuLy8ga2VpbmUgQWhudW5nLCB3aWVzbyBkYXMgalF1ZXJ5LW1vYmlsZSBuaWNodCBtYWNodFxyXG53aW5kb3cuZW0uYWt0aXZpZXJlRmxpcHN3aXRjaGVzID0gZnVuY3Rpb24oZG9tX2VsZW1lbnQsIG9iamVrdF92YXJpYWJsZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQkKGRvbV9lbGVtZW50KVxyXG4gICAgICAgIC5maW5kKFwic2VsZWN0W2RhdGEtcm9sZT0nZmxpcHN3aXRjaCddXCIpXHJcbiAgICAgICAgLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmIChvYmpla3RfdmFyaWFibGVbdGhpcy5uYW1lXSA9PT0gXCJuZWluXCIpIHtcclxuICAgICAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYWRkQ2xhc3MoXCJ1aS1mbGlwc3dpdGNoLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG59O1xyXG5cclxuLy8gZ2VuZXJpZXJ0IGRhcyBIdG1sIGbDvHIgRm9ybXVsYXIgaW4gaEFydEVkaXQuaHRtbFxyXG4vLyBlcndhcnRldCBBcnRHcnVwcGU7IEZlbGRsaXN0ZSBhbHMgT2JqZWt0OyBCZW9iYWNodHVuZyBhbHMgT2JqZWt0XHJcbi8vIGRlciBodG1sQ29udGFpbmVyIHdpcmQgenVyw7xjayBnZWdlYmVuXHJcbndpbmRvdy5lbS5nZW5lcmllcmVIdG1sRsO8cmhBcnRFZGl0Rm9ybSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgRmVsZCA9IHt9LFxyXG5cdFx0RmVsZE5hbWUsXHJcbiAgICAgICAgRmVsZFdlcnQsXHJcblx0XHRodG1sQ29udGFpbmVyID0gXCJcIixcclxuXHRcdEFydEdydXBwZSA9IHdpbmRvdy5lbS5oQXJ0LmFBcnRHcnVwcGU7XHJcblx0Xy5lYWNoKHdpbmRvdy5lbS5GZWxkbGlzdGVoQXJ0RWRpdC5yb3dzLCBmdW5jdGlvbihyb3cpIHtcclxuXHRcdEZlbGQgPSByb3cuZG9jO1xyXG5cdFx0RmVsZE5hbWUgPSBGZWxkLkZlbGROYW1lO1xyXG5cdFx0Ly8gbnVyIHNpY2h0YmFyZSBlaWdlbmUgRmVsZGVyLiBCZXJlaXRzIGltIEZvcm11bGFyIGludGVncmllcnRlIEZlbGRlciBuaWNodCBhbnplaWdlblxyXG5cdFx0Ly8gVm9yc2ljaHQ6IEVyZmFzc3QgamVtYW5kIGVpbiBGZWxkIGRlciBIaWVyYXJjaGllc3R1ZmUgQXJ0IG9obmUgQXJ0Z3J1cHBlLCBzb2xsdGUgZGFzIGtlaW5lbiBGZWhsZXIgYXVzbMO2c2VuXHJcblx0XHRpZiAoKEZlbGQuVXNlciA9PT0gd2luZG93LmVtLmhBcnQuVXNlciB8fCBGZWxkLlVzZXIgPT09IFwiWmVudHJlbkJkS3RcIikgJiYgRmVsZC5TaWNodGJhckltTW9kdXNIaWVyYXJjaGlzY2guaW5kZXhPZih3aW5kb3cuZW0uaEFydC5Vc2VyKSAhPT0gLTEgJiYgKHR5cGVvZiBGZWxkLkFydEdydXBwZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiAoRmVsZC5BcnRHcnVwcGUuaW5kZXhPZihBcnRHcnVwcGUpID49IDAgfHwgRmVsZC5BcnRHcnVwcGVbMF0gPT09IFwiYWxsZVwiKSkgJiYgKEZlbGROYW1lICE9PSBcImFBcnRJZFwiKSAmJiAoRmVsZE5hbWUgIT09IFwiYUFydEdydXBwZVwiKSAmJiAoRmVsZE5hbWUgIT09IFwiYUFydE5hbWVcIikpIHtcclxuXHRcdFx0aWYgKHdpbmRvdy5lbS5oQXJ0W0ZlbGROYW1lXSAmJiBsb2NhbFN0b3JhZ2UuU3RhdHVzID09PSBcIm5ldVwiICYmIEZlbGQuU3RhbmRhcmR3ZXJ0ICYmIEZlbGQuU3RhbmRhcmR3ZXJ0W3dpbmRvdy5lbS5oQXJ0LlVzZXJdKSB7XHJcblx0XHRcdFx0RmVsZFdlcnQgPSBGZWxkLlN0YW5kYXJkd2VydFt3aW5kb3cuZW0uaEFydC5Vc2VyXTtcclxuXHRcdFx0XHQvLyBPYmpla3Qgd2luZG93LmVtLmhBcnQgdW0gZGVuIFN0YW5kYXJkd2VydCBlcmfDpG56ZW4sIHVtIHNww6R0ZXIgenUgc3BlaWNoZXJuXHJcblx0XHRcdFx0d2luZG93LmVtLmhBcnRbRmVsZE5hbWVdID0gRmVsZFdlcnQ7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly9cIlwiIHZlcmhpbmRlcnQsIGRhc3MgaW0gRmVsZCB1bmRlZmluZWQgZXJzY2hlaW50XHJcblx0XHRcdFx0RmVsZFdlcnQgPSB3aW5kb3cuZW0uaEFydFtGZWxkTmFtZV0gfHwgXCJcIjtcclxuXHRcdFx0fVxyXG5cdFx0XHRodG1sQ29udGFpbmVyICs9IHdpbmRvdy5lbS5nZW5lcmllcmVIdG1sRsO8ckZvcm11bGFyZWxlbWVudChGZWxkLCBGZWxkV2VydCk7XHJcblx0XHR9XHJcblx0fSk7XHJcblx0aWYgKGxvY2FsU3RvcmFnZS5TdGF0dXMgPT09IFwibmV1XCIpIHtcclxuXHRcdC8vIGluIG5ldWVuIERhdGVuc8OkdHplbiBkeW5hbWlzY2ggZXJzdGVsbHRlIFN0YW5kYXJkd2VydGUgc3BlaWNoZXJuXHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIuc2F2ZURvYyh3aW5kb3cuZW0uaEFydCwge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLmhBcnQuX2lkID0gZGF0YS5pZDtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaEFydC5fcmV2ID0gZGF0YS5yZXY7XHJcblx0XHRcdFx0bG9jYWxTdG9yYWdlLmhBcnRJZCA9IGRhdGEuaWQ7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5TdGF0dXM7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIE5ldWUgRGF0ZW5zw6R0emUgaGFiZW4ga2VpbmUgQW5ow6RuZ2VcclxuXHRcdHdpbmRvdy5lbS56ZWlnZUF0dGFjaG1lbnRzKHdpbmRvdy5lbS5oQXJ0LCBcImhBRVwiKTtcclxuXHR9XHJcblx0cmV0dXJuIGh0bWxDb250YWluZXI7XHJcbn07XHJcblxyXG4vLyBpbml0aWllcnQgQmVvYkxpc3RlLmh0bWxcclxud2luZG93LmVtLmluaXRpaWVyZWhBcnRMaXN0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBoYXQgaEFydEVkaXQuaHRtbCBlaW5lIGhBcnRMaXN0ZSDDvGJlcmdlYmVuP1xyXG5cdGlmICh3aW5kb3cuZW0uaEFydExpc3RlKSB7XHJcblx0XHQvLyBCZW9ibGlzdGUgYXVzIGdsb2JhbGVyIFZhcmlhYmxlIGhvbGVuIC0gbXVzcyBuaWNodCBnZXBhcnN0IHdlcmRlblxyXG5cdFx0d2luZG93LmVtLmluaXRpaWVyZWhBcnRMaXN0ZV8yKCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIEJlb2JsaXN0ZSBhdXMgREIgaG9sZW5cclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi52aWV3KCdldmFiL2hBcnRMaXN0ZT9zdGFydGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiLCBcIicgKyBsb2NhbFN0b3JhZ2UuWmVpdElkICsgJ1wiXSZlbmRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5FbWFpbCArICdcIiwgXCInICsgbG9jYWxTdG9yYWdlLlplaXRJZCArICdcIiAse31dJmluY2x1ZGVfZG9jcz10cnVlJywge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0Ly8gTGlzdGUgYmVyZWl0c3RlbGxlbiwgdW0gRGF0ZW5iYW5renVncmlmZmUgenUgcmVkdXppZXJlblxyXG5cdFx0XHRcdHdpbmRvdy5lbS5oQXJ0TGlzdGUgPSBkYXRhO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5pbml0aWllcmVoQXJ0TGlzdGVfMigpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaW5pdGlpZXJlaEFydExpc3RlXzIgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGFuekFydCA9IHdpbmRvdy5lbS5oQXJ0TGlzdGUucm93cy5sZW5ndGgsXHJcblx0XHRsaXN0SXRlbUNvbnRhaW5lciA9IFwiXCIsXHJcblx0XHRUaXRlbDIsXHJcblx0XHRoQXJ0VGVtcCxcclxuICAgICAgICAkQXJ0bGlzdGVoQUwgPSAkKFwiI0FydGxpc3RlaEFMXCIpO1xyXG5cclxuXHQvLyBJbSBUaXRlbCBkZXIgU2VpdGUgZGllIEFuemFobCBBcnRlbiBhbnplaWdlblxyXG5cdFRpdGVsMiA9IFwiIEFydGVuXCI7XHJcblx0aWYgKGFuekFydCA9PT0gMSkge1xyXG5cdFx0VGl0ZWwyID0gXCIgQXJ0XCI7XHJcblx0fVxyXG5cdCQoXCIjaEFydExpc3RlUGFnZUhlYWRlclwiKVxyXG4gICAgICAgIC5maW5kKFwiLmhBcnRMaXN0ZVBhZ2VUaXRlbFwiKVxyXG4gICAgICAgIC50ZXh0KGFuekFydCArIFRpdGVsMik7XHJcblxyXG5cdGlmIChhbnpBcnQgPT09IDApIHtcclxuXHRcdGxpc3RJdGVtQ29udGFpbmVyID0gJzxsaT48YSBocmVmPVwiI1wiIGNsYXNzPVwiZXJzdGUgTmV1ZUJlb2JoQXJ0TGlzdGVcIj5FcnN0ZSBBcnQgZXJmYXNzZW48L2E+PC9saT4nO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRfLmVhY2god2luZG93LmVtLmhBcnRMaXN0ZS5yb3dzLCBmdW5jdGlvbihyb3cpIHtcclxuXHRcdFx0aEFydFRlbXAgPSByb3cuZG9jO1xyXG5cdFx0XHRpZiAoaEFydFRlbXApIHtcclxuXHRcdFx0XHRsaXN0SXRlbUNvbnRhaW5lciArPSB3aW5kb3cuZW0uZXJzdGVsbGVIdG1sRsO8ckJlb2JJbkhBcnRMaXN0ZShoQXJ0VGVtcCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxuXHQkQXJ0bGlzdGVoQUwuaHRtbChsaXN0SXRlbUNvbnRhaW5lcik7XHJcblx0JEFydGxpc3RlaEFMLmxpc3R2aWV3KFwicmVmcmVzaFwiKTtcclxuXHR3aW5kb3cuZW0uYmxlbmRlTWVudXMoKTtcclxuXHQvLyBGb2t1cyBpbiBkYXMgU3VjaGZlbGQgc2V0emVuXHJcblx0JChcIiNoQXJ0TGlzdGVcIilcclxuICAgICAgICAuZmluZChcIi51aS1pbnB1dC1zZWFyY2hcIilcclxuICAgICAgICAuY2hpbGRyZW4oXCJpbnB1dFwiKVswXVxyXG4gICAgICAgIC5mb2N1cygpO1xyXG5cdHdpbmRvdy5lbS5zcGVpY2hlcmVMZXR6dGVVcmwoKTtcclxufTtcclxuXHJcbi8vIMO8YmVybmltbXQgZWluZSBoQXJ0XHJcbi8vIHJldG91cm5pZXJ0IGRhcyBodG1sIGbDvHIgZGVyZW4gWmVpbGUgaW4gZGVyIExpc3RlXHJcbndpbmRvdy5lbS5lcnN0ZWxsZUh0bWxGw7xyQmVvYkluSEFydExpc3RlID0gZnVuY3Rpb24oYmVvYikge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgYXJ0Z3J1cHBlbm5hbWUgPSBlbmNvZGVVUklDb21wb25lbnQoYmVvYi5hQXJ0R3J1cHBlLnJlcGxhY2UoJ8O8JywgJ3VlJykucmVwbGFjZSgnw6QnLCAnYWUnKS5yZXBsYWNlKCfDticsICdvZScpKSArIFwiLnBuZ1wiLFxyXG5cdFx0bGlzdEl0ZW07XHJcblx0aWYgKGJlb2IuYUFydEdydXBwZSA9PT0gXCJEaXZlcnNlSW5zZWt0ZW5cIikge1xyXG5cdFx0Ly8gZGFzIGxlZXJlIEJpbGQgYW56ZWlnZW5cclxuXHRcdGFydGdydXBwZW5uYW1lID0gXCJ1bmJlbmFubnQucG5nXCI7XHJcblx0fVxyXG5cdGxpc3RJdGVtID0gXCI8bGkgY2xhc3M9J2Jlb2IgdWktbGktaGFzLXRodW1iJyBoQXJ0SWQ9J1wiICsgYmVvYi5faWQgKyBcIicgYUFydEdydXBwZT0nXCIgKyBiZW9iLmFBcnRHcnVwcGUgKyBcIidcIiArIFwiJyBhQXJ0SWQ9J1wiICsgYmVvYi5hQXJ0SWQgKyBcIic+XCIgK1xyXG5cdFx0XCI8YSBocmVmPScjJz5cIiArXHJcblx0XHRcIjxpbWcgY2xhc3M9J3VpLWxpLXRodW1iJyBzcmM9J0FydGdydXBwZW5iaWxkZXIvXCIgKyBhcnRncnVwcGVubmFtZSArIFwiJyAvPlwiICtcclxuXHRcdFwiPGgzPlwiICsgYmVvYi5hQXJ0TmFtZSArIFwiPFxcL2gzPlwiICtcclxuXHRcdFwiPFxcL2E+IDxcXC9saT5cIjtcclxuXHRyZXR1cm4gbGlzdEl0ZW07XHJcbn07XHJcblxyXG4vLyBnZW5lcmllcnQgZGFzIEh0bWwgZsO8ciBlaW4gRm9ybXVsYXJlbGVtZW50XHJcbi8vIGVyd2FydGV0IGRpdmVyc2Ugw5xiZXJnYWJld2VydGVcclxuLy8gZGVyIGh0bWxDb250YWluZXIgd2lyZCB6dXLDvGNrIGdlZ2ViZW5cclxuLy8gT2huZUxhYmVsOiBGw7xyIGRpZSBUYWJlbGxlIGluIGhBcnRFZGl0TGlzdGUuaHRtbCB3ZXJkZW4gZGllIEZlbGRlciBvaG5lIExhYmVsIGJlbsO2dGlndCwgd2VpbCBkaWVzZXMgaW0gU3BhbHRlbnRpdGVsIHN0ZWh0XHJcbndpbmRvdy5lbS5nZW5lcmllcmVIdG1sRsO8ckZvcm11bGFyZWxlbWVudCA9IGZ1bmN0aW9uKEZlbGQsIEZlbGRXZXJ0LCBPaG5lTGFiZWwpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGh0bWxDb250YWluZXIgPSBcIlwiLFxyXG5cdFx0U2xpZGVyTWluaW11bSxcclxuICAgICAgICBTbGlkZXJNYXhpbXVtLFxyXG5cdFx0b3B0aW9uZW4gPSBGZWxkLk9wdGlvbmVuIHx8IFsnQml0dGUgaW4gRmVsZHZlcndhbHR1bmcgT3B0aW9uZW4gZXJmYXNzZW4nXSxcclxuXHRcdEZlbGROYW1lID0gRmVsZC5GZWxkTmFtZSxcclxuXHRcdEZlbGRCZXNjaHJpZnR1bmcgPSBGZWxkLkZlbGRCZXNjaHJpZnR1bmcgfHwgRmVsZE5hbWU7XHJcblx0Ly8gYWJmYW5nZW4sIHdlbm4gSW5wdXR0eXAgdmVyZ2Vzc2VuIHd1cmRlXHJcblx0RmVsZC5JbnB1dFR5cCA9IEZlbGQuSW5wdXRUeXAgfHwgXCJ0ZXh0XCI7XHJcblx0c3dpdGNoKEZlbGQuRm9ybXVsYXJlbGVtZW50KSB7XHJcblx0Y2FzZSBcInRleHRpbnB1dFwiOlxyXG5cdFx0aHRtbENvbnRhaW5lciA9IHdpbmRvdy5lbS5nZW5lcmllcmVIdG1sRsO8clRleHRpbnB1dChGZWxkTmFtZSwgRmVsZEJlc2NocmlmdHVuZywgRmVsZFdlcnQsIEZlbGQuSW5wdXRUeXAsIE9obmVMYWJlbCk7XHJcblx0XHRicmVhaztcclxuXHRjYXNlIFwidGV4dGFyZWFcIjpcclxuXHRcdGh0bWxDb250YWluZXIgPSB3aW5kb3cuZW0uZ2VuZXJpZXJlSHRtbEbDvHJUZXh0YXJlYShGZWxkTmFtZSwgRmVsZEJlc2NocmlmdHVuZywgRmVsZFdlcnQsIE9obmVMYWJlbCk7XHJcblx0XHRicmVhaztcclxuXHRjYXNlIFwidG9nZ2xlc3dpdGNoXCI6XHJcblx0XHRodG1sQ29udGFpbmVyID0gd2luZG93LmVtLmdlbmVyaWVyZUh0bWxGw7xyVG9nZ2xlc3dpdGNoKEZlbGROYW1lLCBGZWxkQmVzY2hyaWZ0dW5nLCBGZWxkV2VydCwgT2huZUxhYmVsKTtcclxuXHRcdGJyZWFrO1xyXG5cdGNhc2UgXCJjaGVja2JveFwiOlxyXG5cdFx0aHRtbENvbnRhaW5lciA9IHdpbmRvdy5lbS5nZW5lcmllcmVIdG1sRsO8ckNoZWNrYm94KEZlbGROYW1lLCBGZWxkQmVzY2hyaWZ0dW5nLCBGZWxkV2VydCwgb3B0aW9uZW4sIE9obmVMYWJlbCk7XHJcblx0XHRicmVhaztcclxuXHRjYXNlIFwicmFkaW9cIjpcclxuXHRcdGh0bWxDb250YWluZXIgPSB3aW5kb3cuZW0uZ2VuZXJpZXJlSHRtbEbDvHJSYWRpbyhGZWxkTmFtZSwgRmVsZEJlc2NocmlmdHVuZywgRmVsZFdlcnQsIG9wdGlvbmVuLCBPaG5lTGFiZWwpO1xyXG5cdFx0YnJlYWs7XHJcblx0Y2FzZSBcInNlbGVjdG1lbnVcIjpcclxuXHRcdGh0bWxDb250YWluZXIgPSB3aW5kb3cuZW0uZ2VuZXJpZXJlSHRtbEbDvHJTZWxlY3RtZW51KEZlbGROYW1lLCBGZWxkQmVzY2hyaWZ0dW5nLCBGZWxkV2VydCwgb3B0aW9uZW4sIFwiU2luZ2xlU2VsZWN0XCIsIE9obmVMYWJlbCk7XHJcblx0XHRicmVhaztcclxuXHRjYXNlIFwibXVsdGlwbGVzZWxlY3RcIjpcclxuXHRcdGh0bWxDb250YWluZXIgPSB3aW5kb3cuZW0uZ2VuZXJpZXJlSHRtbEbDvHJTZWxlY3RtZW51KEZlbGROYW1lLCBGZWxkQmVzY2hyaWZ0dW5nLCBGZWxkV2VydCwgb3B0aW9uZW4sIFwiTXVsdGlwbGVTZWxlY3RcIiwgT2huZUxhYmVsKTtcclxuXHRcdGJyZWFrO1xyXG5cdGNhc2UgXCJzbGlkZXJcIjpcclxuXHRcdFNsaWRlck1pbmltdW0gPSBGZWxkLlNsaWRlck1pbmltdW0gfHwgMDtcclxuXHRcdFNsaWRlck1heGltdW0gPSBGZWxkLlNsaWRlck1heGltdW0gfHwgMTAwO1xyXG5cdFx0aHRtbENvbnRhaW5lciA9IHdpbmRvdy5lbS5nZW5lcmllcmVIdG1sRsO8clNsaWRlcihGZWxkTmFtZSwgRmVsZEJlc2NocmlmdHVuZywgRmVsZFdlcnQsIFNsaWRlck1pbmltdW0sIFNsaWRlck1heGltdW0sIE9obmVMYWJlbCk7XHJcblx0XHRicmVhaztcclxuXHRjYXNlIG51bGw6XHJcblx0XHQvLyBBYmZhbmdlbiwgd2VubiBkYXMgRm9ybXVsYXJlbGVtZW50IG5pY2h0IGdld8OkaGx0IHd1cmRlXHJcblx0XHRodG1sQ29udGFpbmVyID0gd2luZG93LmVtLmdlbmVyaWVyZUh0bWxGw7xyVGV4dGlucHV0KEZlbGROYW1lLCBGZWxkQmVzY2hyaWZ0dW5nLCBGZWxkV2VydCwgRmVsZC5JbnB1dFR5cCwgT2huZUxhYmVsKTtcclxuXHRcdGJyZWFrO1xyXG5cdH1cclxuXHRyZXR1cm4gaHRtbENvbnRhaW5lcjtcclxufTtcclxuXHJcbi8vIGdlbmVyaWVydCBkZW4gaHRtbC1JbmhhbHQgZsO8ciBUZXh0aW5wdXRzXHJcbi8vIHdpcmQgdm9uIGVyc3RlbGxlaEFydEVkaXQgYXVmZ2VydWZlblxyXG53aW5kb3cuZW0uZ2VuZXJpZXJlSHRtbEbDvHJUZXh0aW5wdXQgPSBmdW5jdGlvbihGZWxkTmFtZSwgRmVsZEJlc2NocmlmdHVuZywgRmVsZFdlcnQsIElucHV0VHlwLCBPaG5lTGFiZWwpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGh0bWxDb250YWluZXIgPSAnPGRpdiBjbGFzcz1cInVpLWZpZWxkLWNvbnRhaW5cIj4nO1xyXG5cdGlmICghT2huZUxhYmVsKSB7XHJcblx0XHRodG1sQ29udGFpbmVyICs9ICc8bGFiZWwgZm9yPVwiJztcclxuXHRcdGh0bWxDb250YWluZXIgKz0gRmVsZE5hbWU7XHJcblx0XHRodG1sQ29udGFpbmVyICs9ICdcIj4nO1xyXG5cdFx0aHRtbENvbnRhaW5lciArPSBGZWxkQmVzY2hyaWZ0dW5nO1xyXG5cdFx0aHRtbENvbnRhaW5lciArPSAnOjwvbGFiZWw+JztcclxuXHR9XHJcblx0aHRtbENvbnRhaW5lciArPSAnPGlucHV0IGlkPVwiJztcclxuXHRodG1sQ29udGFpbmVyICs9IEZlbGROYW1lO1xyXG5cdGh0bWxDb250YWluZXIgKz0gJ1wiIG5hbWU9XCInO1xyXG5cdGh0bWxDb250YWluZXIgKz0gRmVsZE5hbWU7XHJcblx0aHRtbENvbnRhaW5lciArPSAnXCIgdHlwZT1cIic7XHJcblx0aHRtbENvbnRhaW5lciArPSBJbnB1dFR5cDtcclxuXHRodG1sQ29udGFpbmVyICs9ICdcIiB2YWx1ZT1cIic7XHJcblx0aHRtbENvbnRhaW5lciArPSBGZWxkV2VydDtcclxuXHRodG1sQ29udGFpbmVyICs9ICdcIiBjbGFzcz1cInNwZWljaGVyblwiLz48L2Rpdj4nO1xyXG5cdHJldHVybiBodG1sQ29udGFpbmVyO1xyXG59O1xyXG5cclxuLy8gZ2VuZXJpZXJ0IGRlbiBodG1sLUluaGFsdCBmw7xyIFNsaWRlclxyXG4vLyB3aXJkIHZvbiBlcnN0ZWxsZWhBcnRFZGl0IGF1ZmdlcnVmZW5cclxud2luZG93LmVtLmdlbmVyaWVyZUh0bWxGw7xyU2xpZGVyID0gZnVuY3Rpb24oRmVsZE5hbWUsIEZlbGRCZXNjaHJpZnR1bmcsIEZlbGRXZXJ0LCBTbGlkZXJNaW5pbXVtLCBTbGlkZXJNYXhpbXVtLCBPaG5lTGFiZWwpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGh0bWxDb250YWluZXIgPSAnPGRpdiBjbGFzcz1cInVpLWZpZWxkLWNvbnRhaW5cIj4nO1xyXG5cdGlmICghT2huZUxhYmVsKSB7XHJcblx0XHRodG1sQ29udGFpbmVyICs9ICc8bGFiZWwgZm9yPVwiJztcclxuXHRcdGh0bWxDb250YWluZXIgKz0gRmVsZE5hbWU7XHJcblx0XHRodG1sQ29udGFpbmVyICs9ICdcIj4nO1xyXG5cdFx0aHRtbENvbnRhaW5lciArPSBGZWxkQmVzY2hyaWZ0dW5nO1xyXG5cdFx0aHRtbENvbnRhaW5lciArPSAnOjwvbGFiZWw+JztcclxuXHR9XHJcblx0aHRtbENvbnRhaW5lciArPSAnPGlucHV0IGNsYXNzPVwic3BlaWNoZXJuU2xpZGVyXCIgdHlwZT1cInJhbmdlXCIgZGF0YS1oaWdobGlnaHQ9XCJ0cnVlXCIgbmFtZT1cIic7XHJcblx0aHRtbENvbnRhaW5lciArPSBGZWxkTmFtZTtcclxuXHRodG1sQ29udGFpbmVyICs9ICdcIiBpZD1cIic7XHJcblx0aHRtbENvbnRhaW5lciArPSBGZWxkTmFtZTtcclxuXHRodG1sQ29udGFpbmVyICs9ICdcIiB2YWx1ZT1cIic7XHJcblx0aHRtbENvbnRhaW5lciArPSBGZWxkV2VydDtcclxuXHRodG1sQ29udGFpbmVyICs9ICdcIiBtaW49XCInO1xyXG5cdGh0bWxDb250YWluZXIgKz0gU2xpZGVyTWluaW11bTtcclxuXHRodG1sQ29udGFpbmVyICs9ICdcIiBtYXg9XCInO1xyXG5cdGh0bWxDb250YWluZXIgKz0gU2xpZGVyTWF4aW11bTtcclxuXHRodG1sQ29udGFpbmVyICs9ICdcIi8+PC9kaXY+JztcclxuXHRyZXR1cm4gaHRtbENvbnRhaW5lcjtcclxufTtcclxuXHJcbi8vIGdlbmVyaWVydCBkZW4gaHRtbC1JbmhhbHQgZsO8ciBUZXh0YXJlYVxyXG4vLyB3aXJkIHZvbiBlcnN0ZWxsZWhBcnRFZGl0IGF1ZmdlcnVmZW5cclxud2luZG93LmVtLmdlbmVyaWVyZUh0bWxGw7xyVGV4dGFyZWEgPSBmdW5jdGlvbihGZWxkTmFtZSwgRmVsZEJlc2NocmlmdHVuZywgRmVsZFdlcnQsIE9obmVMYWJlbCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgaHRtbENvbnRhaW5lciA9ICc8ZGl2IGNsYXNzPVwidWktZmllbGQtY29udGFpblwiPic7XHJcblx0aWYgKCFPaG5lTGFiZWwpIHtcclxuXHRcdGh0bWxDb250YWluZXIgKz0gJzxsYWJlbCBmb3I9XCInO1xyXG5cdFx0aHRtbENvbnRhaW5lciArPSBGZWxkTmFtZTtcclxuXHRcdGh0bWxDb250YWluZXIgKz0gJ1wiPic7XHJcblx0XHRodG1sQ29udGFpbmVyICs9IEZlbGRCZXNjaHJpZnR1bmc7XHJcblx0XHRodG1sQ29udGFpbmVyICs9ICc6PC9sYWJlbD4nO1xyXG5cdH1cclxuXHRodG1sQ29udGFpbmVyICs9ICc8dGV4dGFyZWEgaWQ9XCInO1xyXG5cdGh0bWxDb250YWluZXIgKz0gRmVsZE5hbWU7XHJcblx0aHRtbENvbnRhaW5lciArPSAnXCIgbmFtZT1cIic7XHJcblx0aHRtbENvbnRhaW5lciArPSBGZWxkTmFtZTtcclxuXHRodG1sQ29udGFpbmVyICs9ICdcIiBjbGFzcz1cInNwZWljaGVyblwiPic7XHJcblx0aHRtbENvbnRhaW5lciArPSBGZWxkV2VydDtcclxuXHRodG1sQ29udGFpbmVyICs9ICc8L3RleHRhcmVhPjwvZGl2Pic7XHJcblx0cmV0dXJuIGh0bWxDb250YWluZXI7XHJcbn07XHJcblxyXG4vLyBnZW5lcmllcnQgZGVuIGh0bWwtSW5oYWx0IGbDvHIgVG9nZ2xlc3dpdGNoXHJcbi8vIHdpcmQgdm9uIGVyc3RlbGxlaEFydEVkaXQgYXVmZ2VydWZlblxyXG53aW5kb3cuZW0uZ2VuZXJpZXJlSHRtbEbDvHJUb2dnbGVzd2l0Y2ggPSBmdW5jdGlvbihGZWxkTmFtZSwgRmVsZEJlc2NocmlmdHVuZywgRmVsZFdlcnQsIE9obmVMYWJlbCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgaHRtbENvbnRhaW5lciA9IFwiPGRpdiBjbGFzcz0ndWktZmllbGQtY29udGFpbic+XCI7XHJcblx0aWYgKCFPaG5lTGFiZWwpIHtcclxuXHRcdGh0bWxDb250YWluZXIgKz0gXCI8bGFiZWwgZm9yPSdcIjtcclxuXHRcdGh0bWxDb250YWluZXIgKz0gRmVsZE5hbWU7XHJcblx0XHRodG1sQ29udGFpbmVyICs9IFwiJz5cIjtcclxuXHRcdGh0bWxDb250YWluZXIgKz0gRmVsZEJlc2NocmlmdHVuZztcclxuXHRcdGh0bWxDb250YWluZXIgKz0gXCI8L2xhYmVsPlwiO1xyXG5cdH1cclxuXHRodG1sQ29udGFpbmVyICs9IFwiPHNlbGVjdCBuYW1lPSdcIjtcclxuXHRodG1sQ29udGFpbmVyICs9IEZlbGROYW1lO1xyXG5cdGh0bWxDb250YWluZXIgKz0gXCInIGlkPSdcIjtcclxuXHRodG1sQ29udGFpbmVyICs9IEZlbGROYW1lO1xyXG5cdGh0bWxDb250YWluZXIgKz0gXCInIGRhdGEtcm9sZT0nZmxpcHN3aXRjaCcgdmFsdWU9J1wiO1xyXG5cdGh0bWxDb250YWluZXIgKz0gRmVsZFdlcnQ7XHJcblx0aHRtbENvbnRhaW5lciArPSBcIicgY2xhc3M9J3NwZWljaGVybiBmbGlwc3dpdGNoJz48b3B0aW9uIHZhbHVlPSdqYSc+amE8L29wdGlvbj48b3B0aW9uIHZhbHVlPSduZWluJz5uZWluPC9vcHRpb24+PC9zZWxlY3Q+PC9kaXY+XCI7XHJcblx0cmV0dXJuIGh0bWxDb250YWluZXI7XHJcbn07XHJcblxyXG4vLyBnZW5lcmllcnQgZGVuIGh0bWwtSW5oYWx0IGbDvHIgQ2hlY2tib3hcclxuLy8gd2lyZCB2b24gZXJzdGVsbGVoQXJ0RWRpdCBhdWZnZXJ1ZmVuXHJcbndpbmRvdy5lbS5nZW5lcmllcmVIdG1sRsO8ckNoZWNrYm94ID0gZnVuY3Rpb24oRmVsZE5hbWUsIEZlbGRCZXNjaHJpZnR1bmcsIEZlbGRXZXJ0LCBvcHRpb25lbiwgT2huZUxhYmVsKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBodG1sQ29udGFpbmVyID0gXCI8ZGl2IGNsYXNzPSd1aS1maWVsZC1jb250YWluJz48ZmllbGRzZXQgZGF0YS1yb2xlPSdjb250cm9sZ3JvdXAnPlwiO1xyXG5cdGlmICghT2huZUxhYmVsKSB7XHJcblx0XHRodG1sQ29udGFpbmVyICs9IFwiPGxlZ2VuZD5cIjtcclxuXHRcdGh0bWxDb250YWluZXIgKz0gRmVsZEJlc2NocmlmdHVuZztcclxuXHRcdGh0bWxDb250YWluZXIgKz0gXCI8L2xlZ2VuZD5cIjtcclxuXHR9XHJcblx0aHRtbENvbnRhaW5lciArPSB3aW5kb3cuZW0uZ2VuZXJpZXJlSHRtbEbDvHJDaGVja2JveE9wdGlvbmVuKEZlbGROYW1lLCBGZWxkV2VydCwgb3B0aW9uZW4pO1xyXG5cdGh0bWxDb250YWluZXIgKz0gXCI8L2ZpZWxkc2V0PjwvZGl2PlwiO1xyXG5cdHJldHVybiBodG1sQ29udGFpbmVyO1xyXG59O1xyXG5cclxuLy8gZ2VuZXJpZXJ0IGRlbiBodG1sLUluaGFsdCBmw7xyIE9wdGlvbmVuIHZvbiBDaGVja2JveFxyXG4vLyB3aXJkIHZvbiBnZW5lcmllcmVIdG1sRsO8ckNoZWNrYm94IGF1ZmdlcnVmZW5cclxud2luZG93LmVtLmdlbmVyaWVyZUh0bWxGw7xyQ2hlY2tib3hPcHRpb25lbiA9IGZ1bmN0aW9uKEZlbGROYW1lLCBGZWxkV2VydCwgb3B0aW9uZW4pIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGh0bWxDb250YWluZXIgPSBcIlwiLFxyXG5cdFx0bGlzdEl0ZW0sXHJcbiAgICAgICAgaWQ7XHJcblx0Xy5lYWNoKG9wdGlvbmVuLCBmdW5jdGlvbihvcHRpb24pIHtcclxuICAgICAgICBpZCA9IF8udW5pcXVlSWQoRmVsZE5hbWUgKyBcIl9vcHRpb25fXCIpO1xyXG5cdFx0bGlzdEl0ZW0gPSBcIjxsYWJlbCBmb3I9J1wiO1xyXG4gICAgICAgIGxpc3RJdGVtICs9IGlkO1xyXG5cdFx0bGlzdEl0ZW0gKz0gXCInPlwiO1xyXG5cdFx0bGlzdEl0ZW0gKz0gb3B0aW9uO1xyXG5cdFx0bGlzdEl0ZW0gKz0gXCI8L2xhYmVsPjxpbnB1dCB0eXBlPSdjaGVja2JveCcgbmFtZT0nXCI7XHJcblx0XHRsaXN0SXRlbSArPSBGZWxkTmFtZTtcclxuXHRcdGxpc3RJdGVtICs9IFwiJyBpZD0nXCI7XHJcbiAgICAgICAgbGlzdEl0ZW0gKz0gaWQ7XHJcblx0XHRsaXN0SXRlbSArPSBcIicgdmFsdWU9J1wiO1xyXG5cdFx0bGlzdEl0ZW0gKz0gb3B0aW9uO1xyXG5cdFx0bGlzdEl0ZW0gKz0gXCInIGNsYXNzPSdjdXN0b20gc3BlaWNoZXJuJ1wiO1xyXG5cdFx0aWYgKEZlbGRXZXJ0LmluZGV4T2Yob3B0aW9uKSA+PSAwKSB7XHJcblx0XHRcdGxpc3RJdGVtICs9IFwiIGNoZWNrZWQ9J2NoZWNrZWQnXCI7XHJcblx0XHR9XHJcblx0XHRsaXN0SXRlbSArPSBcIi8+XCI7XHJcblx0XHRodG1sQ29udGFpbmVyICs9IGxpc3RJdGVtO1xyXG5cdH0pO1xyXG5cdHJldHVybiBodG1sQ29udGFpbmVyO1xyXG59O1xyXG5cclxuLy8gZ2VuZXJpZXJ0IGRlbiBodG1sLUluaGFsdCBmw7xyIFJhZGlvXHJcbi8vIHdpcmQgdm9uIGVyc3RlbGxlaEFydEVkaXQgYXVmZ2VydWZlblxyXG53aW5kb3cuZW0uZ2VuZXJpZXJlSHRtbEbDvHJSYWRpbyA9IGZ1bmN0aW9uKEZlbGROYW1lLCBGZWxkQmVzY2hyaWZ0dW5nLCBGZWxkV2VydCwgb3B0aW9uZW4sIE9obmVMYWJlbCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgaHRtbENvbnRhaW5lciA9IFwiPGRpdiBjbGFzcz0ndWktZmllbGQtY29udGFpbic+PGZpZWxkc2V0IGRhdGEtcm9sZT0nY29udHJvbGdyb3VwJz5cIjtcclxuXHRpZiAoIU9obmVMYWJlbCkge1xyXG5cdFx0aHRtbENvbnRhaW5lciArPSBcIjxsZWdlbmQ+XCI7XHJcblx0XHRodG1sQ29udGFpbmVyICs9IEZlbGRCZXNjaHJpZnR1bmc7XHJcblx0XHRodG1sQ29udGFpbmVyICs9IFwiPC9sZWdlbmQ+XCI7XHJcblx0fVxyXG5cdGh0bWxDb250YWluZXIgKz0gd2luZG93LmVtLmdlbmVyaWVyZUh0bWxGw7xyUmFkaW9PcHRpb25lbihGZWxkTmFtZSwgRmVsZFdlcnQsIG9wdGlvbmVuKTtcclxuXHRodG1sQ29udGFpbmVyICs9IFwiPC9maWVsZHNldD48L2Rpdj5cIjtcclxuXHRyZXR1cm4gaHRtbENvbnRhaW5lcjtcclxufTtcclxuXHJcbi8vIGdlbmVyaWVydCBkZW4gaHRtbC1JbmhhbHQgZsO8ciBPcHRpb25lbiB2b24gUmFkaW9cclxuLy8gd2lyZCB2b24gZ2VuZXJpZXJlSHRtbEbDvHJSYWRpbyBhdWZnZXJ1ZmVuXHJcbndpbmRvdy5lbS5nZW5lcmllcmVIdG1sRsO8clJhZGlvT3B0aW9uZW4gPSBmdW5jdGlvbihmZWxkbmFtZSwgZmVsZHdlcnQsIG9wdGlvbmVuKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBodG1sQ29udGFpbmVyID0gXCJcIixcclxuXHRcdGxpc3RJdGVtLFxyXG4gICAgICAgIGlkLFxyXG4gICAgICAgIGZlbGRuYW1lX2VpbmRldXRpZyA9IF8udW5pcXVlSWQoZmVsZG5hbWUgKyBcIl9cIik7XHJcblx0Xy5lYWNoKG9wdGlvbmVuLCBmdW5jdGlvbihvcHRpb24pIHtcclxuICAgICAgICBpZCA9IF8udW5pcXVlSWQoZmVsZG5hbWUgKyBcIl9vcHRpb25fXCIpO1xyXG5cdFx0bGlzdEl0ZW0gPSBcIjxsYWJlbCBmb3I9J1wiO1xyXG5cdFx0bGlzdEl0ZW0gKz0gaWQ7XHJcblx0XHRsaXN0SXRlbSArPSBcIic+XCI7XHJcblx0XHRsaXN0SXRlbSArPSBvcHRpb247XHJcblx0XHRsaXN0SXRlbSArPSBcIjwvbGFiZWw+PGlucHV0IGNsYXNzPSdzcGVpY2hlcm4nIHR5cGU9J3JhZGlvJyBuYW1lPSdcIjtcclxuXHRcdC8vbGlzdEl0ZW0gKz0gZmVsZG5hbWU7XHJcbiAgICAgICAgbGlzdEl0ZW0gKz0gZmVsZG5hbWVfZWluZGV1dGlnO1xyXG5cdFx0bGlzdEl0ZW0gKz0gXCInXCI7XHJcbiAgICAgICAgbGlzdEl0ZW0gKz0gXCIgaWQ9J1wiO1xyXG5cdFx0bGlzdEl0ZW0gKz0gaWQ7XHJcbiAgICAgICAgbGlzdEl0ZW0gKz0gXCInXCI7XHJcblx0XHRsaXN0SXRlbSArPSBcIiB2YWx1ZT0nXCI7XHJcblx0XHRsaXN0SXRlbSArPSBvcHRpb247XHJcblx0XHRpZiAoZmVsZHdlcnQgPT09IG9wdGlvbikge1xyXG5cdFx0XHRsaXN0SXRlbSArPSBcIicgY2hlY2tlZD0nY2hlY2tlZFwiO1xyXG5cdFx0fVxyXG5cdFx0bGlzdEl0ZW0gKz0gXCInLz5cIjtcclxuXHRcdGh0bWxDb250YWluZXIgKz0gbGlzdEl0ZW07XHJcblx0fSk7XHJcblx0cmV0dXJuIGh0bWxDb250YWluZXI7XHJcbn07XHJcblxyXG4vLyBnZW5lcmllcnQgZGVuIGh0bWwtSW5oYWx0IGbDvHIgU2VsZWN0bWVudXNcclxuLy8gd2lyZCB2b24gZXJzdGVsbGVoQXJ0RWRpdCBhdWZnZXJ1ZmVuXHJcbndpbmRvdy5lbS5nZW5lcmllcmVIdG1sRsO8clNlbGVjdG1lbnUgPSBmdW5jdGlvbihGZWxkTmFtZSwgRmVsZEJlc2NocmlmdHVuZywgRmVsZFdlcnQsIG9wdGlvbmVuLCBNdWx0aXBsZVNpbmdsZVNlbGVjdCwgT2huZUxhYmVsLCBpY29uKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBodG1sQ29udGFpbmVyID0gXCI8ZGl2IGNsYXNzPSd1aS1maWVsZC1jb250YWluJz5cIixcclxuICAgICAgICBpZDtcclxuICAgIGlkID0gXy51bmlxdWVJZChGZWxkTmFtZSArIFwiX1wiKTtcclxuXHRpZiAoIU9obmVMYWJlbCkge1xyXG5cdFx0aHRtbENvbnRhaW5lciArPSBcIjxsYWJlbCBmb3I9J1wiO1xyXG5cdFx0aHRtbENvbnRhaW5lciArPSBpZDtcclxuXHRcdGh0bWxDb250YWluZXIgKz0gXCInIGNsYXNzPSdzZWxlY3QnPlwiO1xyXG5cdFx0aHRtbENvbnRhaW5lciArPSBGZWxkQmVzY2hyaWZ0dW5nO1xyXG5cdFx0aHRtbENvbnRhaW5lciArPSBcIjwvbGFiZWw+XCI7XHJcblx0fVxyXG5cdGh0bWxDb250YWluZXIgKz0gXCI8c2VsZWN0IG5hbWU9J1wiO1xyXG5cdGh0bWxDb250YWluZXIgKz0gRmVsZE5hbWU7XHJcblx0aHRtbENvbnRhaW5lciArPSBcIicgaWQ9J1wiO1xyXG5cdGh0bWxDb250YWluZXIgKz0gaWQ7XHJcblx0aHRtbENvbnRhaW5lciArPSBcIicgdmFsdWU9J1wiO1xyXG5cdGh0bWxDb250YWluZXIgKz0gRmVsZFdlcnQudG9TdHJpbmcoKTtcclxuXHRodG1sQ29udGFpbmVyICs9IFwiJyBkYXRhLW5hdGl2ZS1tZW51PSdmYWxzZSdcIjtcclxuXHRpZiAoTXVsdGlwbGVTaW5nbGVTZWxlY3QgPT09IFwiTXVsdGlwbGVTZWxlY3RcIikge1xyXG5cdFx0aHRtbENvbnRhaW5lciArPSBcIiBtdWx0aXBsZT0nbXVsdGlwbGUnXCI7XHJcblx0fVxyXG5cdGlmIChpY29uKSB7XHJcblx0XHRodG1sQ29udGFpbmVyICs9IFwiIGRhdGEtaWNvbj0nXCIgKyBpY29uICsgXCInXCI7XHJcblx0fVxyXG5cdGh0bWxDb250YWluZXIgKz0gXCIgY2xhc3M9J3NwZWljaGVybic+XCI7XHJcblx0aWYgKE11bHRpcGxlU2luZ2xlU2VsZWN0ID09PSBcIk11bHRpcGxlU2VsZWN0XCIpIHtcclxuXHRcdGh0bWxDb250YWluZXIgKz0gd2luZG93LmVtLmdlbmVyaWVyZUh0bWxGdWVyTXVsdGlwbGVzZWxlY3RPcHRpb25lbihGZWxkTmFtZSwgRmVsZFdlcnQsIG9wdGlvbmVuKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0aHRtbENvbnRhaW5lciArPSB3aW5kb3cuZW0uZ2VuZXJpZXJlSHRtbEZ1ZXJTZWxlY3RtZW51T3B0aW9uZW4oRmVsZE5hbWUsIEZlbGRXZXJ0LCBvcHRpb25lbik7XHJcblx0fVxyXG5cdGh0bWxDb250YWluZXIgKz0gXCI8L3NlbGVjdD48L2Rpdj5cIjtcclxuXHRyZXR1cm4gaHRtbENvbnRhaW5lcjtcclxufTtcclxuXHJcbi8vIGdlbmVyaWVydCBkZW4gaHRtbC1JbmhhbHQgZsO8ciBPcHRpb25lbiB2b24gU2VsZWN0bWVudVxyXG4vLyB3aXJkIHZvbiBnZW5lcmllcmVIdG1sRsO8clNlbGVjdG1lbnUgYXVmZ2VydWZlblxyXG53aW5kb3cuZW0uZ2VuZXJpZXJlSHRtbEZ1ZXJTZWxlY3RtZW51T3B0aW9uZW4gPSBmdW5jdGlvbihmZWxkbmFtZSwgZmVsZHdlcnQsIG9wdGlvbmVuKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBodG1sQ29udGFpbmVyID0gXCI8b3B0aW9uIHZhbHVlPScnPjwvb3B0aW9uPlwiLFxyXG5cdFx0bGlzdEl0ZW07XHJcblx0XHRfLmVhY2gob3B0aW9uZW4sIGZ1bmN0aW9uKG9wdGlvbikge1xyXG5cdFx0XHRsaXN0SXRlbSA9IFwiPG9wdGlvbiB2YWx1ZT0nXCI7XHJcblx0XHRcdGxpc3RJdGVtICs9IG9wdGlvbjtcclxuXHRcdFx0bGlzdEl0ZW0gKz0gXCInIGNsYXNzPSdzcGVpY2hlcm4nXCI7XHJcblx0XHRcdGlmIChmZWxkd2VydCA9PT0gb3B0aW9uKSB7XHJcblx0XHRcdFx0bGlzdEl0ZW0gKz0gXCIgc2VsZWN0ZWQ9J3NlbGVjdGVkJ1wiO1xyXG5cdFx0XHR9XHJcblx0XHRcdGxpc3RJdGVtICs9IFwiPlwiO1xyXG5cdFx0XHRsaXN0SXRlbSArPSBvcHRpb247XHJcblx0XHRcdGxpc3RJdGVtICs9IFwiPC9vcHRpb24+XCI7XHJcblx0XHRcdGh0bWxDb250YWluZXIgKz0gbGlzdEl0ZW07XHJcblx0XHR9KTtcclxuXHRyZXR1cm4gaHRtbENvbnRhaW5lcjtcclxufTtcclxuXHJcbi8vIGdlbmVyaWVydCBkZW4gaHRtbC1JbmhhbHQgZsO8ciBPcHRpb25lbiB2b24gTXVsdGlwbGVTZWxlY3RcclxuLy8gd2lyZCB2b24gZ2VuZXJpZXJlSHRtbEbDvHJTZWxlY3RtZW51IGF1ZmdlcnVmZW5cclxuLy8gRmVsZFdlcnQgaXN0IGVpbiBBcnJheVxyXG53aW5kb3cuZW0uZ2VuZXJpZXJlSHRtbEZ1ZXJNdWx0aXBsZXNlbGVjdE9wdGlvbmVuID0gZnVuY3Rpb24oZmVsZG5hbWUsIGZlbGR3ZXJ0LCBvcHRpb25lbikge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgaHRtbENvbnRhaW5lciA9IFwiPG9wdGlvbiB2YWx1ZT0nJz48L29wdGlvbj5cIixcclxuXHRcdGxpc3RJdGVtO1xyXG5cdF8uZWFjaChvcHRpb25lbiwgZnVuY3Rpb24ob3B0aW9uKSB7XHJcblx0XHRsaXN0SXRlbSA9IFwiPG9wdGlvbiB2YWx1ZT0nXCI7XHJcblx0XHRsaXN0SXRlbSArPSBvcHRpb247XHJcblx0XHRsaXN0SXRlbSArPSBcIicgY2xhc3M9J3NwZWljaGVybidcIjtcclxuXHRcdGlmIChmZWxkd2VydC5pbmRleE9mKG9wdGlvbikgIT09IC0xKSB7XHJcblx0XHRcdGxpc3RJdGVtICs9IFwiIHNlbGVjdGVkPSdzZWxlY3RlZCdcIjtcclxuXHRcdH1cclxuXHRcdGxpc3RJdGVtICs9IFwiPlwiO1xyXG5cdFx0bGlzdEl0ZW0gKz0gb3B0aW9uO1xyXG5cdFx0bGlzdEl0ZW0gKz0gXCI8L29wdGlvbj5cIjtcclxuXHRcdGh0bWxDb250YWluZXIgKz0gbGlzdEl0ZW07XHJcblx0fSk7XHJcblx0cmV0dXJuIGh0bWxDb250YWluZXI7XHJcbn07XHJcblxyXG4oZnVuY3Rpb24oJCkge1xyXG5cdC8vIGZyaWVuZGx5IGhlbHBlciBodHRwOi8vdGlueXVybC5jb20vNmFvdzZ5blxyXG5cdC8vIEzDpHVmdCBkdXJjaCBhbGxlIEZlbGRlciBpbSBGb3JtdWxhclxyXG5cdC8vIFdlbm4gZWluIFdlcnQgZW50aGFsdGVuIGlzdCwgd2lyZCBGZWxkbmFtZSB1bmQgV2VydCBpbnMgT2JqZWt0IGdlc2NocmllYmVuXHJcblx0Ly8gbmljaHQgdmVyZ2Vzc2VuOiBUeXAsIF9pZCB1bmQgX3JldiBkYXp1IGdlYmVuLCB1bSB6dSBzcGVpY2hlcm5cclxuXHQkLmZuLnNlcmlhbGl6ZU9iamVjdCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIG8gPSB7fSxcclxuXHRcdFx0YSA9IHRoaXMuc2VyaWFsaXplQXJyYXkoKTtcclxuXHRcdCQuZWFjaChhLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0aWYgKHRoaXMudmFsdWUpIHtcclxuXHRcdFx0XHRpZiAob1t0aGlzLm5hbWVdKSB7XHJcblx0XHRcdFx0XHRpZiAoIW9bdGhpcy5uYW1lXS5wdXNoKSB7XHJcblx0XHRcdFx0XHRcdG9bdGhpcy5uYW1lXSA9IFtvW3RoaXMubmFtZV1dO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0b1t0aGlzLm5hbWVdLnB1c2godGhpcy52YWx1ZSk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGlmICh3aW5kb3cuZW0ubXlUeXBlT2YodGhpcy52YWx1ZSkgPT09IFwiaW50ZWdlclwiKSB7XHJcblx0XHRcdFx0XHRcdC8vIHR5cCBpc3QgSW50XHJcblx0XHRcdFx0XHRcdG9bdGhpcy5uYW1lXSA9IHBhcnNlSW50KHRoaXMudmFsdWUsIDEwKTtcclxuXHRcdFx0XHRcdH0gZWxzZSBpZiAod2luZG93LmVtLm15VHlwZU9mKHRoaXMudmFsdWUpID09PSBcImZsb2F0XCIpIHtcclxuXHRcdFx0XHRcdFx0Ly8gdHlwIGlzdCBGbG9hdFxyXG5cdFx0XHRcdFx0XHRvW3RoaXMubmFtZV0gPSBwYXJzZUZsb2F0KHRoaXMudmFsdWUpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0Ly8gYW5kZXJlciBUeXAsIGFscyBTdHJpbmcgYmVoYW5kZWxuXHJcblx0XHRcdFx0XHRcdG9bdGhpcy5uYW1lXSA9IHRoaXMudmFsdWU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdHJldHVybiBvO1xyXG5cdH07XHJcblx0Ly8gZnJpZW5kbHkgaGVscGVyIGh0dHA6Ly90aW55dXJsLmNvbS82YW93NnluXHJcblx0Ly8gTMOkdWZ0IGR1cmNoIGFsbGUgRmVsZGVyIGltIEZvcm11bGFyXHJcblx0Ly8gRmVsZG5hbWUgdW5kIFdlcnQgYWxsZXIgRmVsZGVyIHdlcmRlbiBpbnMgT2JqZWt0IGdlc2NocmllYmVuXHJcblx0Ly8gc28ga8O2bm5lbiBhdWNoIGJlaSBzb2ViZW4gZ2Vsw7ZzY2h0ZW4gRmVsZGluaGFsdGVuIGRhcyBlbnRzcHJlY2hlbmRlIEZlbGQgaW0gZG9jIGdlbMO2c2NodCB3ZXJkZW5cclxuXHQvLyBzaWVoZSBCZWlzcGllbCBpbiBGZWxkRWRpdC5odG1sXHJcblx0Ly8gbmljaHQgdmVyZ2Vzc2VuOiBUeXAsIF9pZCB1bmQgX3JldiBkYXp1IGdlYmVuLCB1bSB6dSBzcGVpY2hlcm5cclxuXHQkLmZuLnNlcmlhbGl6ZU9iamVjdE51bGwgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBvID0ge30sXHJcblx0XHRcdGEgPSB0aGlzLnNlcmlhbGl6ZUFycmF5KCk7XHJcblx0XHQkLmVhY2goYSwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmIChvW3RoaXMubmFtZV0pIHtcclxuXHRcdFx0XHRpZiAoIW9bdGhpcy5uYW1lXS5wdXNoKSB7XHJcblx0XHRcdFx0XHRvW3RoaXMubmFtZV0gPSBbb1t0aGlzLm5hbWVdXTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0b1t0aGlzLm5hbWVdLnB1c2godGhpcy52YWx1ZSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0aWYgKHdpbmRvdy5lbS5teVR5cGVPZih0aGlzLnZhbHVlKSA9PT0gXCJpbnRlZ2VyXCIpIHtcclxuXHRcdFx0XHRcdC8vIHR5cCBpc3QgSW50XHJcblx0XHRcdFx0XHRvW3RoaXMubmFtZV0gPSBwYXJzZUludCh0aGlzLnZhbHVlLCAxMCk7XHJcblx0XHRcdFx0fSBlbHNlIGlmICh3aW5kb3cuZW0ubXlUeXBlT2YodGhpcy52YWx1ZSkgPT09IFwiZmxvYXRcIikge1xyXG5cdFx0XHRcdFx0Ly8gdHlwIGlzdCBGbG9hdFxyXG5cdFx0XHRcdFx0b1t0aGlzLm5hbWVdID0gcGFyc2VGbG9hdCh0aGlzLnZhbHVlKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0Ly8gYW5kZXJlciBUeXAsIGFscyBTdHJpbmcgYmVoYW5kZWxuXHJcblx0XHRcdFx0XHRvW3RoaXMubmFtZV0gPSB0aGlzLnZhbHVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRyZXR1cm4gbztcclxuXHR9O1xyXG59KShqUXVlcnkpO1xyXG5cclxud2luZG93LmVtLmNoZWNrQWxsQ2hlY2tib3hlc09mRm9ybSA9IGZ1bmN0aW9uKHBhZ2VuYW1lLCBjaGVja3RvZ2dsZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgY2hlY2tib3hlcyA9ICQoXCIjXCIgKyBwYWdlbmFtZSkuZmluZCgnaW5wdXQnKTtcclxuXHRfLmVhY2goY2hlY2tib3hlcywgZnVuY3Rpb24oY2hlY2tib3gpIHtcclxuXHRcdGlmIChjaGVja2JveC50eXBlID09PSAnY2hlY2tib3gnKVx0IHtcclxuXHRcdFx0Y2hlY2tib3guY2hlY2tlZCA9IGNoZWNrdG9nZ2xlO1xyXG5cdFx0XHQkKFwiI1wiK2NoZWNrYm94LmlkKS5jaGVja2JveHJhZGlvKFwicmVmcmVzaFwiKTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5jaGVja0FsbFJhZGlvc09mRm9ybSA9IGZ1bmN0aW9uKHBhZ2VuYW1lLCBjaGVja3RvZ2dsZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgcmFkaW9zID0gJChcIiNcIiArIHBhZ2VuYW1lKS5maW5kKCdpbnB1dCcpO1xyXG5cdF8uZWFjaChyYWRpb3MsIGZ1bmN0aW9uKHJhZGlvKSB7XHJcblx0XHRpZiAocmFkaW8udHlwZSA9PSAncmFkaW8nKVx0IHtcclxuXHRcdFx0cmFkaW8uY2hlY2tlZCA9IGNoZWNrdG9nZ2xlO1xyXG5cdFx0XHQkKFwiI1wiK3JhZGlvLmlkKS5jaGVja2JveHJhZGlvKFwicmVmcmVzaFwiKTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbi8vIHZlcm9ydGVkIG1pdCBIaWxmZSBhbGxlciBNZXRob2RlblxyXG4vLyB3aXJkIGJlbnV0enQgdm9uIEJlb2JFZGl0Lmh0bWwgdW5kIGhPcnRFZGl0Lmh0bWxcclxuLy8gZXJ3YXJ0ZXQgZGllIGRvY0lkLCB1bSBhbSBFbmRlIGRlciBWZXJvcnR1bmcgZGllIG5ldWVuIEtvb3JkaW5hdGVuIHp1IHNwZWljaGVyblxyXG53aW5kb3cuZW0uR2V0R2VvbG9jYXRpb24gPSBmdW5jdGlvbihkb2NJZCwgT3J0T2RlckJlb2IpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gYmVuw7Z0aWd0ZSBWYXJpYWJlbG4gc2V0emVuXHJcblx0bG9jYWxTdG9yYWdlLmRvY0lkID0gZG9jSWQ7XHJcblx0Ly8gWndlY2s6IEdlbmF1IHNvbGFuZ2UgYW5pbWllcmVuLCB3aWUgdmVyb3J0ZXQgd2lyZFxyXG5cdGxvY2FsU3RvcmFnZS5OYXZiYXJWZXJvcnR1bmdBbmltaWVyZW4gPSBcInRydWVcIjtcclxuXHQvLyDDvGJlcmdlYmVuZSBIZXJrdW5mdCAoT3J0IG9kZXIgQmVvYikgZsO8ciBkaWUgbGlzdGVuZXJzIGJlcmVpdHN0ZWxsZW5cclxuXHRsb2NhbFN0b3JhZ2UuT3J0T2RlckJlb2IgPSBPcnRPZGVyQmVvYjtcclxuXHQvLyBkZW0gQmVudXR6ZXIgemVpZ2VuLCBkYXNzIHZlcm9ydGV0IHdpcmRcclxuXHR3aW5kb3cuZW0uTmF2YmFyVmVyb3J0dW5nQW5pbWllcmVuKCk7XHJcblx0Ly8gS29vcmRpbmF0ZW4genVyw7xja3NldHplblxyXG5cdGRlbGV0ZSBsb2NhbFN0b3JhZ2Uub1hLb29yZDtcclxuXHRkZWxldGUgbG9jYWxTdG9yYWdlLm9ZS29vcmQ7XHJcblx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5vTG9uZ2l0dWRlRGVjRGVnO1xyXG5cdGRlbGV0ZSBsb2NhbFN0b3JhZ2Uub0xhdGl0dWRlRGVjRGVnO1xyXG5cdGRlbGV0ZSBsb2NhbFN0b3JhZ2Uub0xhZ2VnZW5hdWlna2VpdDtcclxuXHRkZWxldGUgbG9jYWxTdG9yYWdlLm9Iw7ZoZTtcclxuXHRkZWxldGUgbG9jYWxTdG9yYWdlLm9Iw7ZoZUdlbmF1aWdrZWl0O1xyXG5cdC8vIE1pdCBkZXIgVmVyb3J0dW5nIGJlZ2lubmVuXHJcblx0d2luZG93LmVtLndhdGNoSUQgPSBudWxsO1xyXG5cdHdpbmRvdy5lbS53YXRjaElEID0gbmF2aWdhdG9yLmdlb2xvY2F0aW9uLndhdGNoUG9zaXRpb24od2luZG93LmVtLm9uR2VvbG9jYXRpb25TdWNjZXNzLCB3aW5kb3cuZW0ub25HZW9sb2NhdGlvbkVycm9yLCB7IGZyZXF1ZW5jeTogMzAwMCwgZW5hYmxlSGlnaEFjY3VyYWN5OiB0cnVlIH0pO1xyXG5cdC8vIG5hY2ggc3DDpHRlc3RlbnMgMjAgU2VrdW5kZW4gYXVmaMO2cmVuXHJcblx0d2luZG93LmVtLnN0b3AgPSBzZXRUaW1lb3V0KFwid2luZG93LmVtLnN0b3BHZW9sb2NhdGlvbigpXCIsIDIwMDAwKTtcclxuXHRyZXR1cm4gd2luZG93LmVtLndhdGNoSUQ7XHJcbn07XHJcblxyXG4vLyBzb2xhbmdlIHZlcm9ydGV0IHdpcmQsIFxyXG4vLyB3aXJkIGRpZSBWZXJvcnR1bmcgaW4gZGVyIE5hdmJhciBqZWRlIFNla3VuZGUgZWluLSB1bmQgYXVzZ2VibGVuZGV0XHJcbndpbmRvdy5lbS5OYXZiYXJWZXJvcnR1bmdBbmltaWVyZW4gPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKGxvY2FsU3RvcmFnZS5OYXZiYXJWZXJvcnR1bmdBbmltaWVyZW4gJiYgbG9jYWxTdG9yYWdlLk5hdmJhclZlcm9ydHVuZ0FuaW1pZXJlbiA9PT0gXCJ0cnVlXCIpIHtcclxuXHRcdCQoXCIubmV1XCIpLnJlbW92ZUNsYXNzKFwidWktYnRuLWFjdGl2ZVwiKTtcclxuXHRcdCQoXCIudmVyb3J0ZW5cIikuYWRkQ2xhc3MoXCJ1aS1idG4tYWN0aXZlXCIpLmZhZGVUb2dnbGUoXCJzbG93XCIpO1xyXG5cdFx0c2V0VGltZW91dChcIndpbmRvdy5lbS5OYXZiYXJWZXJvcnR1bmdBbmltaWVyZW4oKVwiLCAxMDAwKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0JChcIi52ZXJvcnRlblwiKS5yZW1vdmVDbGFzcyhcInVpLWJ0bi1hY3RpdmVcIikuZmFkZUluKFwic2xvd1wiKTtcclxuXHRcdC8vJChcIi5uZXVcIikuYWRkQ2xhc3MoXCJ1aS1idG4tYWN0aXZlXCIpO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5HZW9sb2NhdGlvbkF1c2xlc2VuID0gZnVuY3Rpb24ocG9zaXRpb24pIHtcclxuXHQndXNlIHN0cmljdCc7XHJcbiAgICB2YXIgRGRJbkNoWCA9IHJlcXVpcmUoJy4vdXRpbC9kZEluQ2hYJyksXHJcbiAgICAgICAgRGRJbkNoWSA9IHJlcXVpcmUoJy4vdXRpbC9kZEluQ2hZJyk7XHJcblx0bG9jYWxTdG9yYWdlLm9MYWdlZ2VuYXVpZ2tlaXQgPSBNYXRoLmZsb29yKHBvc2l0aW9uLmNvb3Jkcy5hY2N1cmFjeSk7XHJcblx0bG9jYWxTdG9yYWdlLm9Mb25naXR1ZGVEZWNEZWcgPSBwb3NpdGlvbi5jb29yZHMubG9uZ2l0dWRlO1xyXG5cdGxvY2FsU3RvcmFnZS5vTGF0aXR1ZGVEZWNEZWcgPSBwb3NpdGlvbi5jb29yZHMubGF0aXR1ZGU7XHJcblx0bG9jYWxTdG9yYWdlLm9YS29vcmQgPSBEZEluQ2hYKHBvc2l0aW9uLmNvb3Jkcy5sYXRpdHVkZSwgcG9zaXRpb24uY29vcmRzLmxvbmdpdHVkZSk7XHJcblx0bG9jYWxTdG9yYWdlLm9ZS29vcmQgPSBEZEluQ2hZKHBvc2l0aW9uLmNvb3Jkcy5sYXRpdHVkZSwgcG9zaXRpb24uY29vcmRzLmxvbmdpdHVkZSk7XHJcblx0JChcIltuYW1lPSdvWEtvb3JkJ11cIikudmFsKGxvY2FsU3RvcmFnZS5vWEtvb3JkKTtcclxuXHQkKFwiW25hbWU9J29ZS29vcmQnXVwiKS52YWwobG9jYWxTdG9yYWdlLm9ZS29vcmQpO1xyXG5cdCQoXCJbbmFtZT0nb0xvbmdpdHVkZURlY0RlZyddXCIpLnZhbChwb3NpdGlvbi5jb29yZHMubG9uZ2l0dWRlKTtcclxuXHQkKFwiW25hbWU9J29MYXRpdHVkZURlY0RlZyddXCIpLnZhbChwb3NpdGlvbi5jb29yZHMubGF0aXR1ZGUpO1xyXG5cdCQoXCJbbmFtZT0nb0xhZ2VnZW5hdWlna2VpdCddXCIpLnZhbChwb3NpdGlvbi5jb29yZHMuYWNjdXJhY3kpO1xyXG5cdGlmIChwb3NpdGlvbi5jb29yZHMuYWx0aXR1ZGUgPiAwKSB7XHJcblx0XHQkKFwiW25hbWU9J29Iw7ZoZSddXCIpLnZhbChwb3NpdGlvbi5jb29yZHMuYWx0aXR1ZGUpO1xyXG5cdFx0JChcIltuYW1lPSdvSMO2aGVHZW5hdWlna2VpdCddXCIpLnZhbChwb3NpdGlvbi5jb29yZHMuYWx0aXR1ZGVBY2N1cmFjeSk7XHJcblx0XHRsb2NhbFN0b3JhZ2Uub0jDtmhlID0gcG9zaXRpb24uY29vcmRzLmFsdGl0dWRlO1xyXG5cdFx0bG9jYWxTdG9yYWdlLm9Iw7ZoZUdlbmF1aWdrZWl0ID0gcG9zaXRpb24uY29vcmRzLmFsdGl0dWRlQWNjdXJhY3k7XHJcblx0fVxyXG5cdHdpbmRvdy5lbS5zcGVpY2hlcmVLb29yZGluYXRlbihsb2NhbFN0b3JhZ2UuZG9jSWQsIGxvY2FsU3RvcmFnZS5PcnRPZGVyQmVvYik7XHJcbn07XHJcblxyXG4vLyBQb3NpdGlvbiBlcm1pdHRlbG4gd2FyIGVyZm9sZ3JlaWNoXHJcbndpbmRvdy5lbS5vbkdlb2xvY2F0aW9uU3VjY2VzcyA9IGZ1bmN0aW9uKHBvc2l0aW9uKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIG51ciBlcnN0ZSBQb3NpdGlvbiBha3plcHRpZXJlbiBvZGVyIHNvbGNoZSwgZGllIGdlbmF1ZXIgc2luZCBhbHMgdm9yaWdlXHJcblx0aWYgKCFsb2NhbFN0b3JhZ2Uub0xhZ2VnZW5hdWlna2VpdCB8fCBwb3NpdGlvbi5jb29yZHMuYWNjdXJhY3kgPCBsb2NhbFN0b3JhZ2Uub0xhZ2VnZW5hdWlna2VpdCkge1xyXG5cdFx0aWYgKHBvc2l0aW9uLmNvb3Jkcy5hY2N1cmFjeSA8IDEwMCkge1xyXG5cdFx0XHR3aW5kb3cuZW0uR2VvbG9jYXRpb25BdXNsZXNlbihwb3NpdGlvbik7XHJcblx0XHRcdGlmIChwb3NpdGlvbi5jb29yZHMuYWNjdXJhY3kgPD0gNSkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5zdG9wR2VvbG9jYXRpb24oKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxufTtcclxuXHJcbi8vIFBvc2l0aW9uIGVybWl0dGVsbiB3YXIgbmljaHQgZXJmb2xncmVpY2hcclxuLy8gb25FcnJvciBDYWxsYmFjayByZWNlaXZlcyBhIFBvc2l0aW9uRXJyb3Igb2JqZWN0XHJcbndpbmRvdy5lbS5vbkdlb2xvY2F0aW9uRXJyb3IgPSBmdW5jdGlvbihlcnJvcikge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cuZW0ubWVsZGUoXCJLZWluZSBQb3NpdGlvbiBlcmhhbHRlblxcblwiICsgZXJyb3IubWVzc2FnZSk7XHJcblx0d2luZG93LmVtLnN0b3BHZW9sb2NhdGlvbigpO1xyXG59O1xyXG5cclxuLy8gQmVlbmRldCBFcm1pdHRsdW5nIGRlciBQb3NpdGlvblxyXG53aW5kb3cuZW0uc3RvcEdlb2xvY2F0aW9uID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIFBvc2l0aW9uc3N1Y2hlIGJlZW5kZW5cclxuXHQvLyB3ZW5uIGtlaW5lIHdhdGNoSUQgbWVociwgd3VyZGUgc2llIHNjaG9uIGJlZW5kZXRcclxuXHQvLyBzdG9wIHRpbWVvdXQgc3RvcHBlblxyXG5cdGNsZWFyVGltZW91dCh3aW5kb3cuZW0uc3RvcCk7XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5zdG9wO1xyXG5cdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuVmVyb3J0dW5nQWJnZXNjaGxvc3NlbjtcclxuXHQvLyBWb3JzaWNodDogSW4gQmVvYkVkaXQuaHRtbCB1bmQgaE9ydEVkaXQuaHRtbCBpc3Qgd2F0Y2hJRCBuaWNodCBkZWZpbmVkXHJcblx0aWYgKHR5cGVvZiB3aW5kb3cuZW0ud2F0Y2hJRCAhPT0gXCJ1bmRlZmluZWRcIikge1xyXG5cdFx0bmF2aWdhdG9yLmdlb2xvY2F0aW9uLmNsZWFyV2F0Y2god2luZG93LmVtLndhdGNoSUQpO1xyXG5cdFx0ZGVsZXRlIHdpbmRvdy5lbS53YXRjaElEO1xyXG5cdH1cclxuXHQvLyBBbmltYXRpb24gYmVlbmRlblxyXG5cdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuTmF2YmFyVmVyb3J0dW5nQW5pbWllcmVuO1xyXG5cdC8vIGF1ZiBkZW4gRXJmb2xnIHJlYWdpZXJlblxyXG5cdGlmIChsb2NhbFN0b3JhZ2Uub0xhZ2VnZW5hdWlna2VpdCA+IDMwKSB7XHJcblx0XHR3aW5kb3cuZW0ubWVsZGUoXCJLb29yZGluYXRlbiBuaWNodCBzZWhyIGdlbmF1XFxuQXVmIEthcnRlIHZlcm9ydGVuP1wiKTtcclxuXHR9IGVsc2UgaWYgKCFsb2NhbFN0b3JhZ2Uub0xhZ2VnZW5hdWlna2VpdCkge1xyXG5cdFx0Ly8gRmVsZGVyIGxlZXJlblxyXG5cdFx0JChcIltuYW1lPSdvWEtvb3JkJ11cIikudmFsKFwiXCIpO1xyXG5cdFx0JChcIltuYW1lPSdvWUtvb3JkJ11cIikudmFsKFwiXCIpO1xyXG5cdFx0JChcIltuYW1lPSdvTG9uZ2l0dWRlRGVjRGVnJ11cIikudmFsKFwiXCIpO1xyXG5cdFx0JChcIltuYW1lPSdvTGF0aXR1ZGVEZWNEZWcnXVwiKS52YWwoXCJcIik7XHJcblx0XHQkKFwiW25hbWU9J29MYWdlZ2VuYXVpZ2tlaXQnXVwiKS52YWwoXCJcIik7XHJcblx0XHQkKFwiW25hbWU9J29Iw7ZoZSddXCIpLnZhbChcIlwiKTtcclxuXHRcdCQoXCJbbmFtZT0nb0jDtmhlR2VuYXVpZ2tlaXQnXVwiKS52YWwoXCJcIik7XHJcblx0XHQvLyBEaWVzZW4gbmV1ZW4gU3RhbmQgc3BlaWNoZXJuIChhbGxmw6RsbGlnZSBhbHRlIEtvb3JkaW5hdGVuIHdlcmRlbiB2ZXJ3b3JmZW4pXHJcblx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlS29vcmRpbmF0ZW4obG9jYWxTdG9yYWdlLmRvY0lkLCBsb2NhbFN0b3JhZ2UuT3J0T2RlckJlb2IpO1xyXG5cdFx0d2luZG93LmVtLm1lbGRlKFwiS2VpbmUgZ2VuYXVlIFBvc2l0aW9uIGVyaGFsdGVuXCIpO1xyXG5cdH1cclxuXHQvLyBWYXJpYWJsZW4gYXVmcsOkdW1lblxyXG5cdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuZG9jSWQ7XHJcblx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5PcnRPZGVyQmVvYjtcclxufTtcclxuXHJcbi8vIGRhbWl0IGthbm4gYmVpIGVybmV1dGVyIEFubWVsZHVuZyB3aW5kb3cuZW0uw7ZmZm5lWnVsZXR6dEJlbnV0enRlU2VpdGUoKSBkaWUgbGV0enRlIEFuc2ljaHQgd2llZGVyaGVyc3RlbGxlblxyXG4vLyBob3N0IHdpcmQgTklDSFQgZ2VzY2hyaWViZW4sIHdlaWwgc29uc3QgYmVpbSBXZWNoc2VsIHZvbiBsb2thbCB6dSBpcmlzY291Y2ggRmVobGVyIVxyXG53aW5kb3cuZW0uc3BlaWNoZXJlTGV0enRlVXJsID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS5MZXR6dGVVcmwgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgKyB3aW5kb3cubG9jYXRpb24uc2VhcmNoO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhvbGVBdXRvciA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBhQXV0b3IgaG9sZW5cclxuXHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0JGRiLm9wZW5Eb2MoXCJmMTljZDQ5YmQ3YjdhMTUwYzg5NTA0MWE1ZDAyYWNiMFwiLCB7XHJcblx0XHRzdWNjZXNzOiBmdW5jdGlvbihkb2MpIHtcclxuXHRcdFx0aWYgKGRvYy5TdGFuZGFyZHdlcnQpIHtcclxuXHRcdFx0XHRpZiAoZG9jLlN0YW5kYXJkd2VydFtsb2NhbFN0b3JhZ2UuRW1haWxdKSB7XHJcblx0XHRcdFx0XHRsb2NhbFN0b3JhZ2UuQXV0b3IgPSBkb2MuU3RhbmRhcmR3ZXJ0W2xvY2FsU3RvcmFnZS5FbWFpbF07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyBzcGVpY2hlcnQgQW5ow6RuZ2VcclxuLy8gc2V0enQgZWluIHBhc3NlbmRlcyBGb3JtdWxhciBtaXQgZGVuIGZlbGRlcm4gX3JldiB1bmQgX2F0dGFjaG1lbnRzIHZvcmF1c1xyXG4vLyBuaW1tdCBkZW4gRm9ybW5hbWVuIGVudGdlZ2VuIHJlc3Bla3RpdmUgZWluZW4gQW5oYW5nIGRhenUsIGRhbWl0IGRpZSBGb3JtIElEIGVpbmRldXRpZyBzZWluIGthbm5cclxuLy8gd2lyZCBiZW51dHp0IHZvbiBhbGxlbiBGb3JtdWxhcmVuIG1pdCBBbmjDpG5nZW5cclxud2luZG93LmVtLnNwZWljaGVyZUFuaMOkbmdlID0gZnVuY3Rpb24oaWQsIE9iamVrdCwgUGFnZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBwcsO8ZmVuLCBvYiBkZXIgRGF0ZW5zYXR6IGFscyBPYmpla3Qgw7xiZXJnZWJlbiB3dXJkZVxyXG5cdGlmIChPYmpla3QpIHtcclxuXHRcdC8vIGRhcyBPYmpla3QgdmVyd2VuZGVuXHJcblx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlQW5ow6RuZ2VfMihpZCwgT2JqZWt0LCBQYWdlKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gT2JqZWt0IGF1cyBkZXIgREIgaG9sZW5cclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi5vcGVuRG9jKGlkLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW1bT2JqZWt0LlR5cF0gPSBkYXRhO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5zcGVpY2hlcmVBbmjDpG5nZV8yKGlkLCBkYXRhLCBQYWdlKTtcclxuXHRcdFx0fSxcclxuXHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkZlaGxlcjogQW5oYW5nIG5pY2h0IGdlc3BlaWNoZXJ0XCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0uc3BlaWNoZXJlQW5ow6RuZ2VfMiA9IGZ1bmN0aW9uKGlkLCBPYmpla3QsIFBhZ2UpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcbiAgICB2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0JChcIiNfcmV2XCIgKyBQYWdlKS52YWwod2luZG93LmVtW09iamVrdC5UeXBdLl9yZXYpO1xyXG5cdCQoXCIjRm9ybUFuaMOkbmdlXCIgKyBQYWdlKS5hamF4U3VibWl0KHtcclxuXHRcdHVybDogXCIvZXZhYi9cIiArIGlkLFxyXG5cdFx0c3VjY2VzczogZnVuY3Rpb24oKSB7XHJcblx0XHRcdC8vIGRvYyBub2NobWFscyBob2xlbiwgZGFtaXQgZGVyIEFuaGFuZyBtaXQgRGF0ZWluYW1lIGRhYmVpIGlzdFxyXG5cdFx0XHQkZGIub3BlbkRvYyhpZCwge1xyXG5cdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEyKSB7XHJcblx0XHRcdFx0XHR3aW5kb3cuZW1bT2JqZWt0LlR5cF0gPSBkYXRhMjtcclxuXHRcdFx0XHRcdC8vIHNob3cgYXR0YWNobWVudHMgaW4gZm9ybVxyXG5cdFx0XHRcdFx0d2luZG93LmVtLnplaWdlQXR0YWNobWVudHMoZGF0YTIsIFBhZ2UpO1xyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiVXVwcywgQW5oYW5nIHdpcmQgZXJzdCBiZWltIG7DpGNoc3RlbiBNYWwgYW5nZXplaWd0XCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9LFxyXG5cdFx0Ly8gZm9ybS5qcXVlcnkuanMgbWVsZGV0IGVpbmVuIEZlaGxlciwgb2J3b2hsIGRlciBWb3JnYW5nIGZ1bmt0aW9uaWVydCFcclxuXHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0Ly8gZG9jIG5vY2htYWxzIGhvbGVuLCBkYW1pdCBkZXIgQW5oYW5nIG1pdCBEYXRlaW5hbWUgZGFiZWkgaXN0XHJcblx0XHRcdCRkYi5vcGVuRG9jKGlkLCB7XHJcblx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YTMpIHtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbVtPYmpla3QuVHlwXSA9IGRhdGEzO1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLnplaWdlQXR0YWNobWVudHMoZGF0YTMsIFBhZ2UpO1xyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiVXVwcywgQW5oYW5nIHdpcmQgZXJzdCBiZWltIG7DpGNoc3RlbiBNYWwgYW5nZXplaWd0XCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyB6ZWlndCBBbmjDpG5nZSBpbSBGb3JtdWxhciBhblxyXG4vLyBzZXR6dCBlaW4gcGFzc2VuZGVzIEZvcm11bGFyIG1pdCBkZW0gRmVsZCBfYXR0YWNobWVudHMgKyBQYWdlIHZvcmF1c1xyXG4vLyB1bmQgZWluZSBkaXYgbmFtZW5zIEFuaMOkbmdlICsgUGFnZSwgaW4gZGVyIGRpZSBBbmjDpG5nZSBhbmdlemVpZ3Qgd2VyZGVuXHJcbi8vIHdpcmQgYmVudXR6dCB2b24gYWxsZW4gKGgpQmVvYmFjaHR1bmdzLUVkaXQtRm9ybXVsYXJlblxyXG4vLyBlcndhcnRldCBQYWdlLCBkYW1pdCBzb3dvaGwgZGFzIEF0dGFjaG1lbnRGZWxkIGFscyBhdWNoIGRhcyBkaXYgdW0gZGllIEFuaMOkbmdlIHJlaW56dWjDpG5nZW4gZWluZGV1dGlnIHNpbmQgXHJcbndpbmRvdy5lbS56ZWlnZUF0dGFjaG1lbnRzID0gZnVuY3Rpb24oZG9jLCBQYWdlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBodG1sQ29udGFpbmVyID0gXCJcIixcclxuXHRcdHVybDtcclxuXHQkKFwiI19hdHRhY2htZW50c1wiICsgUGFnZSkudmFsKFwiXCIpO1xyXG5cdGlmIChkb2MuX2F0dGFjaG1lbnRzKSB7XHJcblx0XHQkLmVhY2goZG9jLl9hdHRhY2htZW50cywgZnVuY3Rpb24oRGF0ZWluYW1lKSB7XHJcblx0XHRcdHVybCA9IFwiL2V2YWIvXCIgKyBkb2MuX2lkICsgXCIvXCIgKyBEYXRlaW5hbWU7XHJcblx0XHRcdC8vdXJsX3p1bUzDtnNjaGVuID0gdXJsICsgXCI/XCIgKyBkb2MuX3JldjtcdC8vIHRoZW9yZXRpc2NoIGthbm4gZGllc2UgcmV2IGJpcyB6dW0gTMO2c2NoZW4gdmVyYWx0ZXQgc2VpbiwgcHJha3Rpc2NoIGthdW1cclxuXHRcdFx0aHRtbENvbnRhaW5lciArPSBcIjxkaXY+PGEgaHJlZj0nXCI7XHJcblx0XHRcdGh0bWxDb250YWluZXIgKz0gdXJsO1xyXG5cdFx0XHRodG1sQ29udGFpbmVyICs9IFwiJyBkYXRhLWlubGluZT0ndHJ1ZScgZGF0YS1yb2xlPSdidXR0b24nIHRhcmdldD0nX2JsYW5rJz5cIjtcclxuXHRcdFx0aHRtbENvbnRhaW5lciArPSBEYXRlaW5hbWU7XHJcblx0XHRcdGh0bWxDb250YWluZXIgKz0gXCI8L2E+PGJ1dHRvbiBuYW1lPSdMw7ZzY2hlQW5oYW5nJyBpZD0nXCI7XHJcblx0XHRcdGh0bWxDb250YWluZXIgKz0gRGF0ZWluYW1lO1xyXG5cdFx0XHRodG1sQ29udGFpbmVyICs9IFwiJyBkYXRhLWljb249J2RlbGV0ZScgZGF0YS1pbmxpbmU9J3RydWUnIGRhdGEtaWNvbnBvcz0nbm90ZXh0Jy8+PC9kaXY+XCI7XHJcblx0XHR9KTtcclxuXHR9XHJcblx0JChcIiNBbmjDpG5nZVwiICsgUGFnZSkuaHRtbChodG1sQ29udGFpbmVyKS50cmlnZ2VyKFwiY3JlYXRlXCIpO1xyXG5cdC8vIEZva3VzIGF1ZiBQYWdlIHJpY2h0ZW4sIGRhbWl0IGRpZSBQYWdpbmF0aW9uIG1pdCBkZW4gUGZlaWx0YXN0ZW4gZnVua3Rpb25pZXJ0XHJcblx0JChcIjpqcW1EYXRhKHJvbGU9J3BhZ2UnKVwiKS5mb2N1cygpO1xyXG59O1xyXG5cclxuLy8gaW5pdGlpZXJ0IEZlbGRlcldhZWhsZW4uaHRtbFxyXG4vLyBnZW5lcmllcnQgZHluYW1pc2NoIGRpZSBGZWxkZXIgaW0gQ2hlY2tib3ggRmVsZGVyXHJcbi8vIGNoZWNrZWQgZGllamVuaWdlbiwgZGllIGRlciBVc2VyIGFuemVpZ2VuIHdpbGxcclxud2luZG93LmVtLmluaXRpaWVyZUZlbGRlclfDpGhsZW4gPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIFRleHRVZWJlckxpc3RlX0ZXLFxyXG5cdFx0RmVsZGxpc3RlVmlld25hbWU7XHJcblx0Ly8gSmUgbmFjaCBhdWZydWZlbmRlciBTZWl0ZSBWYXJpYWJlbG4gc2V0emVuXHJcblx0c3dpdGNoKGxvY2FsU3RvcmFnZS5BdWZydWZlbmRlU2VpdGVGVykge1xyXG5cdGNhc2UgXCJoUHJvamVrdEVkaXRcIjpcclxuXHRcdFRleHRVZWJlckxpc3RlX0ZXID0gXCI8aDM+RmVsZGVyIGbDvHIgUHJvamVrdGUgd8OkaGxlbjo8L2gzPlwiO1xyXG5cdFx0bG9jYWxTdG9yYWdlLkZlbGRsaXN0ZUZ3TmFtZSA9IFwiRmVsZGxpc3RlUHJvamVrdFwiO1xyXG5cdFx0RmVsZGxpc3RlVmlld25hbWUgPSBcIkZlbGRMaXN0ZVByb2pla3RcIjtcclxuXHRcdGxvY2FsU3RvcmFnZS5Lcml0ZXJpZW5Gw7xyWnVXw6RobGVuZGVGZWxkZXIgPSBcIkZlbGQuSGllcmFyY2hpZXN0dWZlID09PSAnUHJvamVrdCcgJiYgRmVsZE5hbWUgIT09ICdwTmFtZSdcIjtcclxuXHRcdGJyZWFrO1xyXG5cdGNhc2UgXCJoUmF1bUVkaXRcIjpcclxuXHRcdFRleHRVZWJlckxpc3RlX0ZXID0gXCI8aDM+RmVsZGVyIGbDvHIgUsOkdW1lIHfDpGhsZW46PC9oMz5cIjtcclxuXHRcdGxvY2FsU3RvcmFnZS5GZWxkbGlzdGVGd05hbWUgPSBcIkZlbGRsaXN0ZVJhdW1FZGl0XCI7XHJcblx0XHRGZWxkbGlzdGVWaWV3bmFtZSA9IFwiRmVsZExpc3RlUmF1bVwiO1xyXG5cdFx0bG9jYWxTdG9yYWdlLktyaXRlcmllbkbDvHJadVfDpGhsZW5kZUZlbGRlciA9IFwiRmVsZC5IaWVyYXJjaGllc3R1ZmUgPT09ICdSYXVtJyAmJiBGZWxkTmFtZSAhPT0gJ3JOYW1lJ1wiO1xyXG5cdFx0YnJlYWs7XHJcblx0Y2FzZSBcImhPcnRFZGl0XCI6XHJcblx0XHRUZXh0VWViZXJMaXN0ZV9GVyA9IFwiPGgzPkZlbGRlciBmw7xyIE9ydGUgd8OkaGxlbjo8L2gzPlwiO1xyXG5cdFx0bG9jYWxTdG9yYWdlLkZlbGRsaXN0ZUZ3TmFtZSA9IFwiRmVsZGxpc3RlT3J0RWRpdFwiO1xyXG5cdFx0RmVsZGxpc3RlVmlld25hbWUgPSBcIkZlbGRMaXN0ZU9ydFwiO1xyXG5cdFx0bG9jYWxTdG9yYWdlLktyaXRlcmllbkbDvHJadVfDpGhsZW5kZUZlbGRlciA9IFwiRmVsZC5IaWVyYXJjaGllc3R1ZmUgPT09ICdPcnQnICYmIEZlbGROYW1lICE9PSAnb05hbWUnICYmIEZlbGROYW1lICE9PSAnb1hLb29yZCcgJiYgRmVsZE5hbWUgIT09ICdvWUtvb3JkJyAmJiBGZWxkTmFtZSAhPT0gJ29MYWdlZ2VuYXVpZ2tlaXQnXCI7XHJcblx0XHRicmVhaztcclxuXHRjYXNlIFwiaFplaXRFZGl0XCI6XHJcblx0XHRUZXh0VWViZXJMaXN0ZV9GVyA9IFwiPGgzPkZlbGRlciBmw7xyIFplaXRlbiB3w6RobGVuOjwvaDM+XCI7XHJcblx0XHRsb2NhbFN0b3JhZ2UuRmVsZGxpc3RlRndOYW1lID0gXCJGZWxkbGlzdGVaZWl0RWRpdFwiO1xyXG5cdFx0RmVsZGxpc3RlVmlld25hbWUgPSBcIkZlbGRMaXN0ZVplaXRcIjtcclxuXHRcdGxvY2FsU3RvcmFnZS5Lcml0ZXJpZW5Gw7xyWnVXw6RobGVuZGVGZWxkZXIgPSBcIkZlbGQuSGllcmFyY2hpZXN0dWZlID09PSAnWmVpdCcgJiYgRmVsZC5GZWxkTmFtZSAhPT0gJ3pEYXR1bScgJiYgRmVsZC5GZWxkTmFtZSAhPT0gJ3pVaHJ6ZWl0J1wiO1xyXG5cdFx0YnJlYWs7XHJcblx0Y2FzZSBcImhBcnRFZGl0XCI6XHJcblx0XHRUZXh0VWViZXJMaXN0ZV9GVyA9IFwiPGgzPkZlbGRlciBmw7xyIEFydCB3w6RobGVuOjwvaDM+PHA+RGllIEZlbGRlciBkZXIgSGllcmFyY2hpZXN0dWZlIEFydCB3ZXJkZW4gbnVyIGluIGRlbiBpbiBkZXIgRmVsZHZlcndhbHR1bmcgZGVmaW5pZXJ0ZW4gQXJ0Z3J1cHBlbiBhbmdlemVpZ3QhPC9wPlwiO1xyXG5cdFx0bG9jYWxTdG9yYWdlLkZlbGRsaXN0ZUZ3TmFtZSA9IFwiRmVsZGxpc3RlaEFydEVkaXRcIjtcclxuXHRcdEZlbGRsaXN0ZVZpZXduYW1lID0gXCJGZWxkTGlzdGVBcnRcIjtcclxuXHRcdGxvY2FsU3RvcmFnZS5Lcml0ZXJpZW5Gw7xyWnVXw6RobGVuZGVGZWxkZXIgPSBcIkZlbGQuSGllcmFyY2hpZXN0dWZlID09PSAnQXJ0JyAmJiAoRmVsZC5GZWxkTmFtZSAhPT0gJ2FBcnRHcnVwcGUnKSAmJiAoRmVsZC5GZWxkTmFtZSAhPT0gJ2FBcnROYW1lJykgJiYgKEZlbGQuRmVsZE5hbWUgIT09ICdhQXJ0SWQnKVwiO1xyXG5cdFx0YnJlYWs7XHJcblx0Y2FzZSBcImhBcnRFZGl0TGlzdGVcIjpcclxuXHRcdFRleHRVZWJlckxpc3RlX0ZXID0gXCI8aDM+RmVsZGVyIGbDvHIgQXJ0bGlzdGUgd8OkaGxlbjo8L2gzPjxwPkRpZSBGZWxkZXIgZGVyIEhpZXJhcmNoaWVzdHVmZSBBcnQgd2VyZGVuIG51ciBpbiBkZW4gaW4gZGVyIEZlbGR2ZXJ3YWx0dW5nIGRlZmluaWVydGVuIEFydGdydXBwZW4gYW5nZXplaWd0ITwvcD5cIjtcclxuXHRcdGxvY2FsU3RvcmFnZS5GZWxkbGlzdGVGd05hbWUgPSBcIkZlbGRsaXN0ZWhBcnRFZGl0XCI7XHQvLyBkaWVzZWxiZSBMaXN0ZSB2ZXJ3ZW5kZW4sIHdlaWwgZGllIEVpbnN0ZWxsdW5nZW4gaW4gd2luZG93LmVtLkZlbGRsaXN0ZWhBcnRFZGl0IGJlaSBqZWRlciBXYWhsIGFuZ2VwYXNzdCB3ZXJkZW4sIGlua2wuIF9yZXYuIFVuZCBiZWltIEFucGFzc2VuIGRlciBsZXR6dGUgV2VydCBhdXMgd2luZG93LmVtLkZlbGRsaXN0ZWhBcnRFZGl0IGdlbm9tbWVuIHdpcmQsIG9obmUgZGllIERCIGFienVmcmFnZW4sIHdlaWwgZGFzIHNvbnN0IHp1IGxhbmdzYW0gaXN0XHJcblx0XHRGZWxkbGlzdGVWaWV3bmFtZSA9IFwiRmVsZExpc3RlQXJ0XCI7XHJcblx0XHRsb2NhbFN0b3JhZ2UuS3JpdGVyaWVuRsO8clp1V8OkaGxlbmRlRmVsZGVyID0gXCJGZWxkLkhpZXJhcmNoaWVzdHVmZSA9PT0gJ0FydCcgJiYgKEZlbGQuRmVsZE5hbWUgIT09ICdhQXJ0R3J1cHBlJykgJiYgKEZlbGQuRmVsZE5hbWUgIT09ICdhQXJ0TmFtZScpICYmIChGZWxkLkZlbGROYW1lICE9PSAnYUFydElkJylcIjtcclxuXHRcdGJyZWFrO1xyXG5cdGNhc2UgXCJCZW9iRWRpdFwiOlxyXG5cdFx0VGV4dFVlYmVyTGlzdGVfRlcgPSBcIjxoMz5GZWxkZXIgZsO8ciBCZW9iYWNodHVuZ2VuIHfDpGhsZW46PC9oMz48cD5EaWUgRmVsZGVyIGRlciBIaWVyYXJjaGllc3R1ZmUgQXJ0IHdlcmRlbiBudXIgaW4gZGVuIGluIGRlciBGZWxkdmVyd2FsdHVuZyBkZWZpbmllcnRlbiBBcnRncnVwcGVuIGFuZ2V6ZWlndCE8L3A+XCI7XHJcblx0XHRsb2NhbFN0b3JhZ2UuRmVsZGxpc3RlRndOYW1lID0gXCJGZWxkbGlzdGVCZW9iRWRpdFwiO1xyXG5cdFx0RmVsZGxpc3RlVmlld25hbWUgPSBcIkZlbGRMaXN0ZUJlb2JcIjtcclxuXHRcdGxvY2FsU3RvcmFnZS5Lcml0ZXJpZW5Gw7xyWnVXw6RobGVuZGVGZWxkZXIgPSBcIlsnYUFydEdydXBwZScsICdhQXJ0TmFtZScsICdhQXV0b3InLCAnYUF1dG9yJywgJ29YS29vcmQnLCAnb1lLb29yZCcsICdvTGFnZWdlbmF1aWdrZWl0JywgJ3pEYXR1bScsICd6VWhyemVpdCddLmluZGV4T2YoRmVsZE5hbWUpID09PSAtMVwiO1xyXG5cdFx0YnJlYWs7XHJcblx0fVxyXG5cdCQoXCIjVGV4dFVlYmVyTGlzdGVfRldcIikuaHRtbChUZXh0VWViZXJMaXN0ZV9GVyk7XHJcblx0Ly8gRmVsZGxpc3RlIG51ciBhYmZyYWdlbiwgd2VubiBzaWUgbmljaHQgc2Nob24gYWxzIGdsb2JhbGUgVmFyaWFibGUgZXhpc3RpZXJ0XHJcblx0Ly8gRsO8ciBGZWxkZXJXYWVobGVuLmh0bWwga8O2bm50ZSBhbiBzaWNoIGltbWVyIGRpZSB2b2xsc3TDpG5kaWdlIExpc3RlIHZlcndlbmRldCB3ZXJkZW5cclxuXHQvLyBiZXNzZXIgaXN0IGFiZXIsIGRpZXNlbGJlIExpc3RlIHp1IHRlaWxlbiwgZGllIGluIGRlcnNlbGJlbiBIaWVyYXJjaGllc3R1ZmUgZsO8ciBkaWUgQW56ZWlnZSBkZXIgRmVsZGVyIHZlcndlbmRldCB3aXJkXHJcblx0Ly8gZGFydW0gd2lyZCBoaWVyIGbDvHIgamVkZSBTZWl0ZSBlaW5lIGVpZ2VuZSB2ZXJ3ZW5kZXRcclxuXHRpZiAod2luZG93LmVtW2xvY2FsU3RvcmFnZS5GZWxkbGlzdGVGd05hbWVdKSB7XHJcblx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlRmVsZGVyV8OkaGxlbl8yKCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIGhvbHQgZGllIEZlbGRsaXN0ZSBhdXMgZGVyIERCXHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIudmlldygnZXZhYi8nICsgRmVsZGxpc3RlVmlld25hbWUgKyAnP2luY2x1ZGVfZG9jcz10cnVlJywge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0d2luZG93LmVtW2xvY2FsU3RvcmFnZS5GZWxkbGlzdGVGd05hbWVdID0gZGF0YTtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlRmVsZGVyV8OkaGxlbl8yKCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5pbml0aWllcmVGZWxkZXJXw6RobGVuXzIgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGh0bWxDb250YWluZXIgPSBcIjxkaXYgY2xhc3M9J3VpLWZpZWxkLWNvbnRhaW4nPlxcblxcdDxmaWVsZHNldCBkYXRhLXJvbGU9J2NvbnRyb2xncm91cCc+XCIsXHJcblx0XHRhbnpGZWxkZXIgPSAwLFxyXG5cdFx0RmVsZCxcclxuXHRcdEZlbGROYW1lLFxyXG5cdFx0RmVsZEJlc2NocmlmdHVuZyxcclxuXHRcdGxpc3RJdGVtO1xyXG5cdF8uZWFjaCh3aW5kb3cuZW1bbG9jYWxTdG9yYWdlLkZlbGRsaXN0ZUZ3TmFtZV0ucm93cywgZnVuY3Rpb24ocm93KSB7XHJcblx0XHRGZWxkID0gcm93LmRvYztcclxuXHRcdEZlbGROYW1lID0gRmVsZC5GZWxkTmFtZTtcclxuXHRcdC8vIE51ciBlaWdlbmUgdW5kIG9mZml6aWVsbGUgRmVsZGVyIGJlcsO8Y2tzaWNodGlnZW5cclxuXHRcdGlmIChGZWxkLlVzZXIgPT09IGxvY2FsU3RvcmFnZS5FbWFpbCB8fCBGZWxkLlVzZXIgPT09IFwiWmVudHJlbkJkS3RcIikge1xyXG5cdFx0XHQvLyBpbSBGb3JtdWxhciBmaXggaW50ZWdyaWVydGUgRmVsZGVyIG5pY2h0IGF1ZmJhdWVuXHJcblx0XHRcdGlmIChldmFsKGxvY2FsU3RvcmFnZS5Lcml0ZXJpZW5Gw7xyWnVXw6RobGVuZGVGZWxkZXIpKSB7XHJcblx0XHRcdFx0YW56RmVsZGVyICs9IDE7XHJcblx0XHRcdFx0RmVsZEJlc2NocmlmdHVuZyA9IEZlbGQuSGllcmFyY2hpZXN0dWZlICsgXCI6IFwiICsgRmVsZC5GZWxkQmVzY2hyaWZ0dW5nO1xyXG5cdFx0XHRcdGlmIChGZWxkLkhpZXJhcmNoaWVzdHVmZSA9PT0gXCJBcnRcIiAmJiBGZWxkLkFydEdydXBwZSAmJiBGZWxkLkFydEdydXBwZVswXSAhPT0gXCJhbGxlXCIgJiYgRmVsZC5BcnRHcnVwcGUuaW5kZXhPZihsb2NhbFN0b3JhZ2UuYUFydEdydXBwZSkgPT09IC0xKSB7XHJcblx0XHRcdFx0XHRGZWxkQmVzY2hyaWZ0dW5nICs9IFwiPHNwYW4gc3R5bGU9J2ZvbnQtd2VpZ2h0Om5vcm1hbDsnPiAobmljaHQgc2ljaHRiYXIgaW4gQXJ0Z3J1cHBlIFwiICsgbG9jYWxTdG9yYWdlLmFBcnRHcnVwcGUgKyBcIik8L3NwYW4+XCI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGxpc3RJdGVtID0gXCI8bGFiZWwgZm9yPSdcIjtcclxuXHRcdFx0XHRsaXN0SXRlbSArPSBGZWxkTmFtZTtcclxuXHRcdFx0XHRsaXN0SXRlbSArPSBcIic+XCI7XHJcblx0XHRcdFx0bGlzdEl0ZW0gKz0gRmVsZEJlc2NocmlmdHVuZztcclxuXHRcdFx0XHRsaXN0SXRlbSArPSBcIjwvbGFiZWw+PGlucHV0IHR5cGU9J2NoZWNrYm94JyBuYW1lPSdcIjtcclxuXHRcdFx0XHRsaXN0SXRlbSArPSBcIkZlbGRlclwiO1xyXG5cdFx0XHRcdGxpc3RJdGVtICs9IFwiJyBpZD0nXCI7XHJcblx0XHRcdFx0bGlzdEl0ZW0gKz0gRmVsZE5hbWU7XHJcblx0XHRcdFx0bGlzdEl0ZW0gKz0gXCInIEZlbGRJZD0nXCI7XHJcblx0XHRcdFx0bGlzdEl0ZW0gKz0gRmVsZC5faWQ7XHJcblx0XHRcdFx0bGlzdEl0ZW0gKz0gXCInIHZhbHVlPSdcIjtcclxuXHRcdFx0XHRsaXN0SXRlbSArPSBGZWxkTmFtZTtcclxuXHRcdFx0XHRsaXN0SXRlbSArPSBcIicgY2xhc3M9J2N1c3RvbSdcIjtcclxuXHRcdFx0XHRpZiAobG9jYWxTdG9yYWdlLkF1ZnJ1ZmVuZGVTZWl0ZUZXID09PSBcIkJlb2JFZGl0XCIpIHtcclxuXHRcdFx0XHRcdGlmIChGZWxkLlNpY2h0YmFySW1Nb2R1c0VpbmZhY2gpIHtcclxuXHRcdFx0XHRcdFx0aWYgKEZlbGQuU2ljaHRiYXJJbU1vZHVzRWluZmFjaC5pbmRleE9mKGxvY2FsU3RvcmFnZS5FbWFpbCkgIT09IC0xKSB7XHJcblx0XHRcdFx0XHRcdFx0Ly8gd2VubiBzaWNodGJhciwgYW56ZWlnZW5cclxuXHRcdFx0XHRcdFx0XHRsaXN0SXRlbSArPSBcIiBjaGVja2VkPSdjaGVja2VkJ1wiO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSBlbHNlIGlmIChsb2NhbFN0b3JhZ2UuQXVmcnVmZW5kZVNlaXRlRlcgPT09IFwiaEFydEVkaXRMaXN0ZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKEZlbGQuU2ljaHRiYXJJbkhBcnRFZGl0TGlzdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEZlbGQuU2ljaHRiYXJJbkhBcnRFZGl0TGlzdGUuaW5kZXhPZihsb2NhbFN0b3JhZ2UuRW1haWwpICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2VubiBzaWNodGJhciwgYW56ZWlnZW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RJdGVtICs9IFwiIGNoZWNrZWQ9J2NoZWNrZWQnXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG5cdFx0XHRcdFx0aWYgKEZlbGQuU2ljaHRiYXJJbU1vZHVzSGllcmFyY2hpc2NoKSB7XHJcblx0XHRcdFx0XHRcdGlmIChGZWxkLlNpY2h0YmFySW1Nb2R1c0hpZXJhcmNoaXNjaC5pbmRleE9mKGxvY2FsU3RvcmFnZS5FbWFpbCkgIT09IC0xKSB7XHJcblx0XHRcdFx0XHRcdFx0Ly8gd2VubiBzaWNodGJhciwgYW56ZWlnZW5cclxuXHRcdFx0XHRcdFx0XHRsaXN0SXRlbSArPSBcIiBjaGVja2VkPSdjaGVja2VkJ1wiO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGxpc3RJdGVtICs9IFwiLz5cIjtcclxuXHRcdFx0XHRodG1sQ29udGFpbmVyICs9IGxpc3RJdGVtO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSk7XHJcblx0JChcIiNGZWxkZXJXYWVobGVuUGFnZUhlYWRlclwiKVxyXG4gICAgICAgIC5maW5kKFwiLkZlbGRlcldhZWhsZW5QYWdlVGl0ZWxcIilcclxuICAgICAgICAudGV4dChhbnpGZWxkZXIgKyBcIiBGZWxkZXJcIik7XHJcblx0aHRtbENvbnRhaW5lciArPSBcIjwvZmllbGRzZXQ+PC9kaXY+XCI7XHJcblx0JChcIiNGZWxkbGlzdGVGV1wiKS5odG1sKGh0bWxDb250YWluZXIpLnRyaWdnZXIoXCJjcmVhdGVcIik7XHJcblx0JChcImlucHV0W25hbWU9J0ZlbGRlciddXCIpLmNoZWNrYm94cmFkaW8oKTtcclxuXHQvLyBsZXR6dGUgdXJsIHNwZWljaGVybiAtIGhpZXIgdW5kIG5pY2h0IGltIHBhZ2VzaG93LCBkYW1pdCBlcyBiZWkgamVkZW0gRGF0ZW5zYXR6d2VjaHNlbCBwYXNzaWVydFxyXG5cdHdpbmRvdy5lbS5zcGVpY2hlcmVMZXR6dGVVcmwoKTtcclxufTtcclxuXHJcbi8vIGtyZWllcnQgZWluIG5ldWVzIEZlbGRcclxuLy8gd2lyZCBiZW51dHp0IHZvbiBGZWxkTGlzdGUuaHRtbCB1bmQgRmVsZEVkaXQuaHRtbFxyXG53aW5kb3cuZW0ubmV1ZXNGZWxkID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBOZXVlc0ZlbGQgPSB7fSxcclxuXHRcdGhpZXJhcmNoaWVzdHVmZTtcclxuXHROZXVlc0ZlbGQuVHlwID0gXCJGZWxkXCI7XHJcblx0TmV1ZXNGZWxkLlVzZXIgPSBsb2NhbFN0b3JhZ2UuRW1haWw7XHJcblx0TmV1ZXNGZWxkLlNpY2h0YmFySW1Nb2R1c0VpbmZhY2ggPSBbXTtcclxuXHROZXVlc0ZlbGQuU2ljaHRiYXJJbU1vZHVzSGllcmFyY2hpc2NoID0gW107XHJcbiAgICBOZXVlc0ZlbGQuU2ljaHRiYXJJbkhBcnRFZGl0TGlzdGUgPSBbXTtcclxuXHQvLyBIaWVyYXJjaGllc3R1ZmUgYXVmZ3J1bmQgZGVyIEhlcmt1bmZ0IHfDpGhsZW5cclxuXHRzd2l0Y2ggKGxvY2FsU3RvcmFnZS56dXJ1ZWNrKSB7XHJcblx0XHRjYXNlIFwiaFByb2pla3RFZGl0Lmh0bWxcIjpcclxuXHRcdGNhc2UgXCJoUHJvamVrdExpc3RlLmh0bWxcIjpcclxuXHRcdFx0aGllcmFyY2hpZXN0dWZlID0gXCJQcm9qZWt0XCI7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSBcImhSYXVtRWRpdC5odG1sXCI6XHJcblx0XHRjYXNlIFwiaFJhdW1MaXN0ZS5odG1sXCI6XHJcblx0XHRcdGhpZXJhcmNoaWVzdHVmZSA9IFwiUmF1bVwiO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgXCJoT3J0RWRpdC5odG1sXCI6XHJcblx0XHRjYXNlIFwiaE9ydExpc3RlLmh0bWxcIjpcclxuXHRcdFx0aGllcmFyY2hpZXN0dWZlID0gXCJPcnRcIjtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlIFwiaFplaXRFZGl0Lmh0bWxcIjpcclxuXHRcdGNhc2UgXCJoWmVpdExpc3RlLmh0bWxcIjpcclxuXHRcdFx0aGllcmFyY2hpZXN0dWZlID0gXCJaZWl0XCI7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0ZGVmYXVsdDpcclxuXHRcdFx0aGllcmFyY2hpZXN0dWZlID0gXCJBcnRcIjtcclxuXHRcdFx0YnJlYWs7XHJcblx0fVxyXG5cdE5ldWVzRmVsZC5IaWVyYXJjaGllc3R1ZmUgPSBoaWVyYXJjaGllc3R1ZmU7XHJcblx0Ly8gRmVsZHR5cCB2b3J3w6RobGVuXHJcblx0TmV1ZXNGZWxkLkZvcm11bGFyZWxlbWVudCA9IFwidGV4dGlucHV0XCI7XHJcblx0TmV1ZXNGZWxkLklucHV0VHlwID0gXCJ0ZXh0XCI7XHJcblx0Ly8gZ2xlaWNoIHNpY2h0YmFyIHN0ZWxsZW5cclxuXHROZXVlc0ZlbGQuU2ljaHRiYXJJbU1vZHVzRWluZmFjaC5wdXNoKGxvY2FsU3RvcmFnZS5FbWFpbCk7XHJcblx0TmV1ZXNGZWxkLlNpY2h0YmFySW1Nb2R1c0hpZXJhcmNoaXNjaC5wdXNoKGxvY2FsU3RvcmFnZS5FbWFpbCk7XHJcbiAgICBOZXVlc0ZlbGQuU2ljaHRiYXJJbkhBcnRFZGl0TGlzdGUucHVzaChsb2NhbFN0b3JhZ2UuRW1haWwpO1xyXG5cdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHQkZGIuc2F2ZURvYyhOZXVlc0ZlbGQsIHtcclxuXHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0bG9jYWxTdG9yYWdlLkZlbGRJZCA9IGRhdGEuaWQ7XHJcblx0XHRcdE5ldWVzRmVsZC5faWQgPSBkYXRhLmlkO1xyXG5cdFx0XHROZXVlc0ZlbGQuX3JldiA9IGRhdGEucmV2O1xyXG5cdFx0XHR3aW5kb3cuZW0uRmVsZCA9IE5ldWVzRmVsZDtcclxuXHRcdFx0Ly8gRmVsZGxpc3RlIHNvbGwgbmV1IGF1ZmdlYmF1dCB3ZXJkZW5cclxuXHRcdFx0d2luZG93LmVtLmxlZXJlU3RvcmFnZUZlbGRMaXN0ZSgpO1xyXG5cdFx0XHQkKFwiOm1vYmlsZS1wYWdlY29udGFpbmVyXCIpLnBhZ2Vjb250YWluZXIoXCJjaGFuZ2VcIiwgXCJGZWxkRWRpdC5odG1sXCIsIHsgYWxsb3dTYW1lUGFnZVRyYW5zaXRpb24gOiB0cnVlIH0pO1xyXG5cdFx0fSxcclxuXHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRmVobGVyOiBGZWxkIG5pY2h0IGVyemV1Z3RcIik7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyBNT01FTlRBTiBOSUNIVCBCRU5VVFpUXHJcbndpbmRvdy5lbS5wcsO8ZmVBbm1lbGR1bmcgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gVXNlcm5hbWUgQW5tZWxkdW5nIMO8YmVycHLDvGZlblxyXG5cdC8vIFdlbm4gYW5nZW1lbGRldCwgZ2xvYmFsZSBWYXJpYWJsZSBVc2VybmFtZSBha3R1YWxpc2llcmVuXHJcblx0Ly8gV2VubiBuaWNodCBhbmdlbWVsZGV0LCBBbm1lbGRlZGlhbG9nIMO2ZmZuZW5cclxuXHRpZiAoIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0JC5hamF4KHtcclxuXHRcdFx0dXJsOiAnL19zZXNzaW9uJyxcclxuXHRcdFx0ZGF0YVR5cGU6ICdqc29uJyxcclxuXHRcdFx0YXN5bmM6IGZhbHNlXHJcblx0XHR9KS5kb25lKGZ1bmN0aW9uKHNlc3Npb24pIHtcclxuXHRcdFx0aWYgKHNlc3Npb24udXNlckN0eC5uYW1lICE9PSB1bmRlZmluZWQgJiYgc2Vzc2lvbi51c2VyQ3R4Lm5hbWUgIT09IG51bGwpIHtcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UuRW1haWwgPSBzZXNzaW9uLnVzZXJDdHgubmFtZTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UuVXNlclN0YXR1cyA9IFwibmV1XCI7XHJcblx0XHRcdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG4vLyBzZXR6dCBkaWUgT3J0SWQsIGRhbWl0IGhPcnRFZGl0Lmh0bWwgYW0gcmljaHRpZ2VuIE9ydCDDtmZmbmV0XHJcbi8vIHVuZCBydWZ0IGRhbm4gaE9ydEVkaXQuaHRtbCBhdWZcclxuLy8gd2lyZCB2b24gZGVuIExpbmtzIGluIGRlciBLYXJ0ZSBiZW51dHp0XHJcbndpbmRvdy5lbS7DtmZmbmVPcnQgPSBmdW5jdGlvbihPcnRJZCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuT3J0SWQgPSBPcnRJZDtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhPcnRFZGl0Lmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyBzZXR6dCBkaWUgQmVvYklkLCBkYW1pdCBCZW9iRWRpdC5odG1sIGFtIHJpY2h0aWdlbiBPcnQgw7ZmZm5ldFxyXG4vLyB1bmQgcnVmdCBkYW5uIEJlb2JFZGl0Lmh0bWwgYXVmXHJcbi8vIHdpcmQgdm9uIGRlbiBMaW5rcyBpbiBkZXIgS2FydGUgYXVmIEJlb2JMaXN0ZS5odG1sIGJlbnV0enRcclxud2luZG93LmVtLsO2ZmZuZUJlb2IgPSBmdW5jdGlvbihCZW9iSWQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLkJlb2JJZCA9IEJlb2JJZDtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkJlb2JFZGl0Lmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyB3aXJkIGJlbnV0enQgaW4gQXJ0ZW5saXN0ZS5odG1sXHJcbi8vIHdpcmQgZG9ydCBhdWZnZXJ1ZmVuIGF1cyBwYWdlc2hvdyB1bmQgcGFnZWluaXQsIGRhcnVtIGhpZXJoaW4gdmVybGFnZXJ0XHJcbi8vIGVyd2FydGV0IGVpbmVuIGZpbHRlcndlcnRcclxuLy8gV2VubiBtZWhybWFscyBuYWNoZWluYW5kZXIgZGllc2VsYmUgQXJ0ZW5saXN0ZSBhdWZnZXJ1ZmVuIHdpcmQsIHNvbGwgd2VubiBtw7ZnbGljaCBkaWUgYWx0ZSBMaXN0ZSB2ZXJ3ZW5kZXQgd2VyZGVuIGvDtm5uZW5cclxuLy8gbcO2Z2xpY2ggaXN0IGRpZXMgd2VubiBkaWVzZSBGYWt0b3JlbiBnbGVpY2ggc2luZDogQXJ0Z3J1cHBlLCBhbGxmw6RsbGlnZSBVbnRlcmF1c3dhaGxcclxud2luZG93LmVtLmluaXRpaWVyZUFydGVubGlzdGUgPSBmdW5jdGlvbihmaWx0ZXJ3ZXJ0KSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIHdlbm4gYWxsZSBkcmVpIEZha3RvcmVuIGdsZWljaCBzaW5kLCBkaXJla3QgZGllIEFydGVubGlzdGUgZXJzdGVsbGVuXHJcblx0Ly8gbnVyIHdlbm4gZWluZSBBcnRlbmxpc3RlIGV4aXN0aWVydC4gR3J1bmQ6IHdpbmRvdy5lbS5BcnRlbmxpc3RlIGxlYnQgbmljaHQgc28gbGFuZyB3aWUgbG9jYWxTdG9yYWdlXHJcblx0Ly8gYWJlciBkaWUgQXJ0ZW5saXN0ZSBhdXMgZGVyIGxvY2FsU3RvcmFnZSB6dSBwYXJzZW4gbWFjaHQgYXVjaCBrZWluZW4gc2lublxyXG5cdGlmICh3aW5kb3cuZW0uQXJ0ZW5saXN0ZSAmJiBsb2NhbFN0b3JhZ2UuYUFydEdydXBwZVp1bGV0enQgPT09IGxvY2FsU3RvcmFnZS5hQXJ0R3J1cHBlKSB7XHJcblx0XHR3aW5kb3cuZW0uZXJzdGVsbGVBcnRlbmxpc3RlKGZpbHRlcndlcnQpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBzb25zdCBhdXMgZGVyIERCIGhvbGVuXHJcblx0XHR3aW5kb3cuZW0uaG9sZUFydGVubGlzdGUoZmlsdGVyd2VydCk7XHJcblx0fVxyXG5cdC8vIGxldHp0ZSBBcnRncnVwcGUgYWt0dWFsaXNpZXJlblxyXG5cdGxvY2FsU3RvcmFnZS5hQXJ0R3J1cHBlWnVsZXR6dCA9IGxvY2FsU3RvcmFnZS5hQXJ0R3J1cHBlO1xyXG59O1xyXG5cclxuLy8gd2lyZCBiZW51dHp0IGluIEFydGVubGlzdGUuaHRtbFxyXG4vLyBhdWZnZXJ1ZmVuIHZvbiBpbml0aWllcmVBcnRlbmxpc3RlXHJcbndpbmRvdy5lbS5ob2xlQXJ0ZW5saXN0ZSA9IGZ1bmN0aW9uKGZpbHRlcndlcnQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIHZpZXduYW1lID0gJ2V2YWIvQXJ0bGlzdGU/c3RhcnRrZXk9W1wiJyArIGVuY29kZVVSSUNvbXBvbmVudChsb2NhbFN0b3JhZ2UuYUFydEdydXBwZSkgKyAnXCJdJmVuZGtleT1bXCInICsgZW5jb2RlVVJJQ29tcG9uZW50KGxvY2FsU3RvcmFnZS5hQXJ0R3J1cHBlKSArICdcIix7fSx7fV0maW5jbHVkZV9kb2NzPXRydWUnO1xyXG5cdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHQkZGIudmlldyh2aWV3bmFtZSwge1xyXG5cdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHR3aW5kb3cuZW0uQXJ0ZW5saXN0ZSA9IGRhdGEucm93cztcclxuXHRcdFx0d2luZG93LmVtLmVyc3RlbGxlQXJ0ZW5saXN0ZShmaWx0ZXJ3ZXJ0KTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbi8vIGJla29tbXQgZWluZSBBcnRlbmxpc3RlIHVuZCBiYXV0IGRhbWl0IGltIEZvcm11bGFyIGRpZSBBcnRlbmxpc3RlIGF1ZlxyXG4vLyBmaWx0ZXJ3ZXJ0OiDDvGJlcmdlYmVuZXIgVGVpbCBhdXMgZGVyIEFydGJlemVpY2hudW5nXHJcbndpbmRvdy5lbS5lcnN0ZWxsZUFydGVubGlzdGUgPSBmdW5jdGlvbihmaWx0ZXJ3ZXJ0KSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBodG1sID0gXCJcIixcclxuXHRcdEFydEJlemVpY2hudW5nLFxyXG5cdFx0YXJ0ZW5saXN0ZV9nZWZpbHRlcnQ7XHJcblx0Ly8gZ2VmaWx0ZXJ0IHdlcmRlbiBtdXNzIG51ciwgd2VubiBtZWhyIGFscyAyMDAgQXJ0ZW4gYXVmZ2VsaXN0ZXQgd8O8cmRlblxyXG5cdGlmICh3aW5kb3cuZW0uQXJ0ZW5saXN0ZS5sZW5ndGggPiAwKSB7XHJcblx0XHRpZiAoZmlsdGVyd2VydCkge1xyXG5cdFx0XHQvLyBhcnRlbmxpc3RlIGZpbHRlcm5cclxuXHRcdFx0YXJ0ZW5saXN0ZV9nZWZpbHRlcnQgPSBfLmZpbHRlcih3aW5kb3cuZW0uQXJ0ZW5saXN0ZSwgZnVuY3Rpb24oYXJ0KSB7XHJcblx0XHRcdFx0QXJ0QmV6ZWljaG51bmcgPSBhcnQua2V5WzJdO1xyXG5cdFx0XHRcdHJldHVybiBBcnRCZXplaWNobnVuZy50b0xvd2VyQ2FzZSgpLmluZGV4T2YoZmlsdGVyd2VydCkgPiAtMTtcclxuXHRcdFx0fSk7XHJcblx0XHRcdGlmIChhcnRlbmxpc3RlX2dlZmlsdGVydC5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0aWYgKGFydGVubGlzdGVfZ2VmaWx0ZXJ0Lmxlbmd0aCA+IDIwMCkge1xyXG5cdFx0XHRcdFx0aHRtbCA9ICc8bGkgY2xhc3M9XCJhcnRsaXN0ZW5oaW53ZWlzXCI+JyArIGFydGVubGlzdGVfZ2VmaWx0ZXJ0Lmxlbmd0aCArICcgQXJ0ZW4gZ2VmaWx0ZXJ0Ljxicj5VbSBNb2JpbGdlcsOkdGUgbmljaHQgenUgw7xiZXJmb3JkZXJuLCA8Yj53ZXJkZW4gbnVyIGRpZSBlcnN0ZW4gMjAwIGFuZ2V6ZWlndDwvYj4uPGJyPlZlcnN1Y2hlbiBTaWUgZWluZW4gc3RyZW5nZXJlbiBGaWx0ZXI8L2xpPic7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGh0bWwgPSAnPGxpIGNsYXNzPVwiYXJ0bGlzdGVuaGlud2Vpc1wiPicgKyBhcnRlbmxpc3RlX2dlZmlsdGVydC5sZW5ndGggKyAnIEFydGVuIGdlZmlsdGVydDwvbGk+JztcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Ly8gaHRtbCBkZXIgZXJzdGVuIDIwMCBhdWZiYXVlblxyXG5cdFx0XHRcdF8uZWFjaChfLmZpcnN0KGFydGVubGlzdGVfZ2VmaWx0ZXJ0LCAyMDApLCBmdW5jdGlvbihhcnRfcm93KSB7XHJcblx0XHRcdFx0XHRBcnRCZXplaWNobnVuZyA9IGFydF9yb3cua2V5WzJdO1xyXG5cdFx0XHRcdFx0aHRtbCArPSB3aW5kb3cuZW0uaG9sZUh0bWxGw7xyQXJ0SW5BcnRlbmxpc3RlKGFydF9yb3cuZG9jLCBBcnRCZXplaWNobnVuZyk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0aHRtbCA9ICc8bGkgY2xhc3M9XCJhcnRsaXN0ZW5oaW53ZWlzXCI+S2VpbmUgQXJ0ZW4gZ2VmdW5kZW48L2xpPic7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIGtlaW4gRmlsdGVyIGdlc2V0enRcclxuXHRcdFx0aWYgKHdpbmRvdy5lbS5BcnRlbmxpc3RlLmxlbmd0aCA+IDIwMCkge1xyXG5cdFx0XHRcdGh0bWwgPSAnPGxpIGNsYXNzPVwiYXJ0bGlzdGVuaGlud2Vpc1wiPkRpZSBBcnRlbmdydXBwZSBoYXQgJyArIHdpbmRvdy5lbS5BcnRlbmxpc3RlLmxlbmd0aCArICcgQXJ0ZW4uPGJyPlVtIE1vYmlsZ2Vyw6R0ZSBuaWNodCB6dSDDvGJlcmZvcmRlcm4sIDxiPndlcmRlbiBudXIgZGllIGVyc3RlbiAyMDAgYW5nZXplaWd0PC9iPi48YnI+VGlwcDogU2V0emVuIFNpZSBlaW5lbiBGaWx0ZXI8L2xpPic7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0aHRtbCA9ICc8bGkgY2xhc3M9XCJhcnRsaXN0ZW5oaW53ZWlzXCI+JyArIHdpbmRvdy5lbS5BcnRlbmxpc3RlLmxlbmd0aCArICcgQXJ0ZW48L2xpPic7XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gZXJzdGUgendlaWh1bmRlcnQgYW56ZWlnZW5cclxuXHRcdFx0Xy5lYWNoKF8uZmlyc3Qod2luZG93LmVtLkFydGVubGlzdGUsIDIwMCksIGZ1bmN0aW9uKGFydF9yb3cpIHtcclxuXHRcdFx0XHRBcnRCZXplaWNobnVuZyA9IGFydF9yb3cua2V5WzJdO1xyXG5cdFx0XHRcdGh0bWwgKz0gd2luZG93LmVtLmhvbGVIdG1sRsO8ckFydEluQXJ0ZW5saXN0ZShhcnRfcm93LmRvYywgQXJ0QmV6ZWljaG51bmcpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly9BcnRlbmxpc3RlLmxlbmd0aCA9PT09IDBcclxuXHRcdGh0bWwgPSAnPGxpIGNsYXNzPVwiYXJ0bGlzdGVuaGlud2Vpc1wiPkRpZSBBcnRlbmdydXBwZSBlbnRow6RsdCBrZWluZSBBcnRlbjwvbGk+JztcclxuXHR9XHJcblx0JChcIiNhbF9BcnRlbkxpc3RlXCIpXHJcbiAgICAgICAgLmh0bWwoaHRtbClcclxuICAgICAgICAuc2hvdygpXHJcbiAgICAgICAgLmxpc3R2aWV3KFwicmVmcmVzaFwiKTtcclxuXHQvLyBGb2t1cyBpbiBkYXMgU3VjaGZlbGQgc2V0emVuXHJcblx0JChcIiNBcnRlbmxpc3RlXCIpXHJcbiAgICAgICAgLmZpbmQoXCIudWktaW5wdXQtc2VhcmNoXCIpXHJcbiAgICAgICAgLmNoaWxkcmVuKFwiaW5wdXRcIilbMF1cclxuICAgICAgICAuZm9jdXMoKTtcclxuXHJcbn07XHJcblxyXG53aW5kb3cuZW0uaG9sZUh0bWxGw7xyQXJ0SW5BcnRlbmxpc3RlID0gZnVuY3Rpb24oQXJ0LCBBcnRCZXplaWNobnVuZykge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgaHRtbCA9IFwiPGxpIG5hbWU9J0FydExpc3RJdGVtJyBBcnRCZXplaWNobnVuZz0nXCI7XHJcblx0aHRtbCArPSBBcnRCZXplaWNobnVuZztcclxuXHRodG1sICs9IFwiJyBBcnRJZD0nXCI7XHJcblx0aHRtbCArPSBBcnQuX2lkO1xyXG5cdGh0bWwgKz0gXCInPlwiO1xyXG5cdGh0bWwgKz0gXCI8YSBocmVmPScjJz48aDM+XCI7XHJcblx0aHRtbCArPSBBcnRCZXplaWNobnVuZztcclxuXHRodG1sICs9IFwiPFxcL2gzPlwiO1xyXG5cdGlmIChBcnQuSGlud2Vpc1ZlcndhbmRzY2hhZnQpIHtcclxuXHRcdGh0bWwgKz0gXCI8cD5cIiArIEFydC5IaW53ZWlzVmVyd2FuZHNjaGFmdCArIFwiPFxcL3A+XCI7XHJcblx0fVxyXG5cdGh0bWwgKz0gXCI8XFwvYT48XFwvbGk+XCI7XHJcblx0cmV0dXJuIGh0bWw7XHJcbn07XHJcblxyXG4vLyB3aXJkIGJlbnV0enQgaW4gQXJ0Z3J1cHBlbmxpc3RlLmh0bWxcclxuLy8gYXVmZ2VydWZlbiB2b24gZXJzdGVsbGVBcnRncnVwcGVuTGlzdGVcclxud2luZG93LmVtLmVyc3RlbGxlQXJ0Z3J1cHBlbkxpc3RlID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIEFydGdydXBwZW5saXN0ZSB2ZXJmw7xnYmFyIG1hY2hlblxyXG5cdGlmICh3aW5kb3cuZW0uQXJ0Z3J1cHBlbmxpc3RlKSB7XHJcblx0XHR3aW5kb3cuZW0uZXJzdGVsbGVBcnRncnVwcGVuTGlzdGVfMigpO1xyXG5cdH0gZWxzZSBpZiAobG9jYWxTdG9yYWdlLkFydGdydXBwZW5saXN0ZSkge1xyXG5cdFx0d2luZG93LmVtLkFydGdydXBwZW5saXN0ZSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLkFydGdydXBwZW5saXN0ZSk7XHJcblx0XHR3aW5kb3cuZW0uZXJzdGVsbGVBcnRncnVwcGVuTGlzdGVfMigpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIudmlldygnZXZhYi9BcnRncnVwcGVuP2luY2x1ZGVfZG9jcz10cnVlJywge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0Ly8gQXJ0Z3J1cHBlbmxpc3RlIGJlcmVpdHN0ZWxsZW5cclxuXHRcdFx0XHR3aW5kb3cuZW0uQXJ0Z3J1cHBlbmxpc3RlID0gZGF0YTtcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UuQXJ0Z3J1cHBlbmxpc3RlID0gSlNPTi5zdHJpbmdpZnkod2luZG93LmVtLkFydGdydXBwZW5saXN0ZSk7XHJcblx0XHRcdFx0d2luZG93LmVtLmVyc3RlbGxlQXJ0Z3J1cHBlbkxpc3RlXzIoKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gd2lyZCBiZW51dHp0IGluIEFydGdydXBwZW5saXN0ZS5odG1sXHJcbi8vIGF1ZmdlcnVmZW4gdm9uIGVyc3RlbGxlQXJ0Z3J1cHBlbkxpc3RlXHJcbndpbmRvdy5lbS5lcnN0ZWxsZUFydGdydXBwZW5MaXN0ZV8yID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBodG1sID0gXCJcIixcclxuXHRcdEFydEdydXBwZSxcclxuXHRcdEFuekFydGVuO1xyXG5cdF8uZWFjaCh3aW5kb3cuZW0uQXJ0Z3J1cHBlbmxpc3RlLnJvd3MsIGZ1bmN0aW9uKHJvdykge1xyXG5cdFx0QXJ0R3J1cHBlID0gcm93LmtleTtcclxuXHRcdEFuekFydGVuID0gcm93LmRvYy5BbnpBcnRlbjtcclxuXHRcdGh0bWwgKz0gXCI8bGkgbmFtZT0nQXJ0Z3J1cHBlbkxpc3RJdGVtJyBBcnRHcnVwcGU9J1wiICsgQXJ0R3J1cHBlICsgXCInPlwiO1xyXG5cdFx0aHRtbCArPSBcIjxhIGhyZWY9JyMnPjxoMz5cIiArIEFydEdydXBwZSArIFwiPFxcL2gzPjxzcGFuIGNsYXNzPSd1aS1saS1jb3VudCc+XCIgKyBBbnpBcnRlbiArIFwiPC9zcGFuPjxcXC9hPjxcXC9saT5cIjtcclxuXHR9KTtcclxuXHQkKFwiI2FnbF9BcnRncnVwcGVuTGlzdGVcIilcclxuICAgICAgICAuaHRtbChodG1sKVxyXG4gICAgICAgIC5saXN0dmlldyhcInJlZnJlc2hcIik7XHJcblx0JChcIiNhZ2xfSGlud2Vpc3RleHRcIilcclxuICAgICAgICAuZW1wdHkoKVxyXG4gICAgICAgIC5yZW1vdmUoKTtcclxuXHQvLyBGb2t1cyBpbiBkYXMgU3VjaGZlbGQgc2V0emVuXHJcblx0JChcIiNBcnRncnVwcGVubGlzdGVcIilcclxuICAgICAgICAuZmluZChcIi51aS1pbnB1dC1zZWFyY2hcIilcclxuICAgICAgICAuY2hpbGRyZW4oXCJpbnB1dFwiKVswXVxyXG4gICAgICAgIC5mb2N1cygpO1xyXG59O1xyXG5cclxuLy8gU3RlbGx0IGRpZSBEYXRlbiBkZXMgVXNlcnMgYmVyZWl0XHJcbi8vIEluIGRlciBSZWdlbCBuYWNoIGdlbHVuZ2VuZXIgQW5tZWxkdW5nXHJcbi8vIEF1Y2ggd2VubiBlaW5lIFNlaXRlIGRpcmVrdCBnZcO2ZmZuZXQgd2lyZCB1bmQgZGllIFVzZXJkYXRlbiB2ZXJtaXNzdFxyXG4vLyBicmF1Y2h0IGRlbiBVc2VybmFtZW5cclxud2luZG93LmVtLnN0ZWxsZVVzZXJEYXRlbkJlcmVpdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cuZW0uaG9sZUF1dG9yKCk7XHJcblx0JC5jb3VjaC51c2VyRGIoZnVuY3Rpb24oZGIpIHtcclxuXHRcdGRiLm9wZW5Eb2MoXCJvcmcuY291Y2hkYi51c2VyOlwiICsgbG9jYWxTdG9yYWdlLkVtYWlsLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uIChkb2MpIHtcclxuXHRcdFx0XHRpZiAoZG9jLkRhdGVudmVyd2VuZHVuZykge1xyXG5cdFx0XHRcdFx0bG9jYWxTdG9yYWdlLkRhdGVudmVyd2VuZHVuZyA9IGRvYy5EYXRlbnZlcndlbmR1bmc7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdC8vIERhdGVudmVyd2VuZHVuZyBleGlzdGllcnQgbmljaHRcclxuXHRcdFx0XHRcdC8vIEthbm4gZXMgc2VpbiwgZGFzcyBkaWVzZXIgVXNlciBzZWluIEtvbnRvIHVyc3Byw7xuZ2xpY2ggaW4gQXJ0ZW5EYiBlcnN0ZWxsdCBoYXRcclxuXHRcdFx0XHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiVXNlckVkaXQuaHRtbFwiKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0d2luZG93LmVtLsO2ZmZuZVp1bGV0enRCZW51dHp0ZVNlaXRlKCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0pO1xyXG59O1xyXG5cclxuLy8gd2lyZCBiZW51dHp0IHZvbiB3aW5kb3cuZW0uc3RlbGxlVXNlckRhdGVuQmVyZWl0KClcclxuLy8gw7ZmZm5ldCBkaWUgenVsZXR6dCBiZW51dHp0ZSBTZWl0ZSBvZGVyIEJlb2JMaXN0ZS5odG1sXHJcbndpbmRvdy5lbS7DtmZmbmVadWxldHp0QmVudXR6dGVTZWl0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuICAgIHZhciBMZXR6dGVVcmw7XHJcblx0Ly8gdW5lbmRsaWNoZSBTY2hsYXVmZSB2ZXJoaW5kZXJuLCBmYWxscyBMZXR6dGVVcmwgYXVmIGRpZXNlIFNlaXRlIHZlcndlaXN0XHJcblx0aWYgKGxvY2FsU3RvcmFnZS5MZXR6dGVVcmwgJiYgbG9jYWxTdG9yYWdlLkxldHp0ZVVybCAhPT0gXCIvZXZhYi9fZGVzaWduL2V2YWIvaW5kZXguaHRtbFwiKSB7XHJcblx0XHRMZXR6dGVVcmwgPSBsb2NhbFN0b3JhZ2UuTGV0enRlVXJsO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRMZXR6dGVVcmwgPSBcIkJlb2JMaXN0ZS5odG1sXCI7XHJcblx0fVxyXG5cdCQubW9iaWxlLm5hdmlnYXRlKExldHp0ZVVybCk7XHJcbn07XHJcblxyXG4vLyBkaWUgbmFjaGZvbGdlbmRlbiBmdW5rdGlvbmVuIGJlcmVpbmlnZW4gZGllIGxvY2FsU3RvcmFnZSB1bmQgZGllIGdsb2JhbGVuIFZhcmlhYmVsblxyXG4vLyBzaWUgZW50ZmVybmVuIGRpZSBpbSBqZXdlaWxpZ2VuIEZvcm11bGFyIGVyZ8Okbnp0ZW4gbG9jYWxTdG9yYWdlLUVpbnRyw6RnZVxyXG4vLyBtaXRMYXRMbmdMaXN0ZSBnaWJ0IGFuLCBvYiBkaWUgTGlzdGUgZsO8ciBkaWUgS2FydGUgYXVjaCBlbnRmZXJudCB3ZXJkZW4gc29sbFxyXG5cclxud2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbiA9IGZ1bmN0aW9uKG9obmVDbGVhcikge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBvaG5lIGNsZWFyOiBuw7Z0aWcsIHdlbm4gbWFuIGluIEZlbGRlcldhZWhsZW4uaHRtbCBpc3QgdW5kIGtlaW5lIGF1ZnJ1ZmVuZGUgU2VpdGUga2VubnRcclxuXHQvLyBVc2VybmFtZSBzb2xsIGVyaGFsdGVuIGJsZWliZW5cclxuXHRpZiAoIW9obmVDbGVhcikge1xyXG5cdFx0bG9jYWxTdG9yYWdlLmNsZWFyKCk7XHJcblx0fVxyXG5cdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuQXV0b3I7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVByb2pla3RMaXN0ZShcIm1pdExhdExuZ0xpc3RlXCIpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VQcm9qZWt0RWRpdChcIm1pdExhdExuZ0xpc3RlXCIpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VSYXVtTGlzdGUoXCJtaXRMYXRMbmdMaXN0ZVwiKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUmF1bUVkaXQoXCJtaXRMYXRMbmdMaXN0ZVwiKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlT3J0TGlzdGUoXCJtaXRMYXRMbmdMaXN0ZVwiKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlT3J0RWRpdCgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VaZWl0TGlzdGUoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlWmVpdEVkaXQoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlaEFydExpc3RlKCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZWhBcnRFZGl0KCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZUJlb2JMaXN0ZSgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VCZW9iRWRpdCgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VGZWxkTGlzdGUoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlRmVsZEVkaXQoKTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5sZWVyZVN0b3JhZ2VQcm9qZWt0TGlzdGUgPSBmdW5jdGlvbihtaXRMYXRMbmdMaXN0ZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRkZWxldGUgd2luZG93LmVtLlByb2pla3RsaXN0ZTtcclxuXHRpZiAobWl0TGF0TG5nTGlzdGUpIHtcclxuXHRcdGRlbGV0ZSB3aW5kb3cuZW0uaE9ydGVMYXRMbmdQcm9qZWt0bGlzdGU7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gb2huZUlkIHdpcmQgYmVpbSBwYWdpbmF0ZW4gYmVudXR6dCwgZGEgZGllIElEIMO8YmVybWl0dGVsdCB3ZXJkZW4gbXVzc1xyXG53aW5kb3cuZW0ubGVlcmVTdG9yYWdlUHJvamVrdEVkaXQgPSBmdW5jdGlvbihtaXRMYXRMbmdMaXN0ZSwgb2huZUlkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghb2huZUlkKSB7XHJcblx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLlByb2pla3RJZDtcclxuXHR9XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5oUHJvamVrdDtcclxuXHRpZiAobWl0TGF0TG5nTGlzdGUpIHtcclxuXHRcdGRlbGV0ZSB3aW5kb3cuZW0uaE9ydGVMYXRMbmdQcm9qZWt0O1xyXG5cdH1cclxuXHQvLyBoaWVyYXJjaGlzY2ggdGllZmVyZSBMaXN0ZW4gbMO2c2NoZW5cclxuXHRkZWxldGUgd2luZG93LmVtLlJhZXVtZVZvblByb2pla3Q7XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5PcnRlVm9uUHJvamVrdDtcclxuXHRkZWxldGUgd2luZG93LmVtLk9ydGVWb25SYXVtO1xyXG5cdGRlbGV0ZSB3aW5kb3cuZW0uWmVpdGVuVm9uUHJvamVrdDtcclxuXHRkZWxldGUgd2luZG93LmVtLlplaXRlblZvblJhdW07XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5aZWl0ZW5Wb25PcnQ7XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5BcnRlblZvblByb2pla3Q7XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5BcnRlblZvblJhdW07XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5BcnRlblZvbk9ydDtcclxuXHRkZWxldGUgd2luZG93LmVtLkFydGVuVm9uWmVpdDtcclxufTtcclxuXHJcbndpbmRvdy5lbS5sZWVyZVN0b3JhZ2VSYXVtTGlzdGUgPSBmdW5jdGlvbihtaXRMYXRMbmdMaXN0ZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRkZWxldGUgd2luZG93LmVtLlJhdW1MaXN0ZTtcclxuXHRpZiAobWl0TGF0TG5nTGlzdGUpIHtcclxuXHRcdGRlbGV0ZSB3aW5kb3cuZW0uaE9ydGVMYXRMbmdQcm9qZWt0O1xyXG5cdH1cclxuXHRkZWxldGUgd2luZG93LmVtLlJhZXVtZVZvblByb2pla3Q7XHJcbn07XHJcblxyXG53aW5kb3cuZW0ubGVlcmVTdG9yYWdlUmF1bUVkaXQgPSBmdW5jdGlvbihtaXRMYXRMbmdMaXN0ZSwgb2huZUlkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghb2huZUlkKSB7XHJcblx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLlJhdW1JZDtcclxuXHR9XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5oUmF1bTtcclxuXHRpZiAobWl0TGF0TG5nTGlzdGUpIHtcclxuXHRcdGRlbGV0ZSB3aW5kb3cuZW0uaE9ydGVMYXRMbmdSYXVtO1xyXG5cdH1cclxuXHQvLyBoaWVyYXJjaGlzY2ggdGllZmVyZSBMaXN0ZW4gbMO2c2NoZW5cclxuXHRkZWxldGUgd2luZG93LmVtLk9ydGVWb25Qcm9qZWt0O1xyXG5cdGRlbGV0ZSB3aW5kb3cuZW0uT3J0ZVZvblJhdW07XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5aZWl0ZW5Wb25Qcm9qZWt0O1xyXG5cdGRlbGV0ZSB3aW5kb3cuZW0uWmVpdGVuVm9uUmF1bTtcclxuXHRkZWxldGUgd2luZG93LmVtLlplaXRlblZvbk9ydDtcclxuXHRkZWxldGUgd2luZG93LmVtLkFydGVuVm9uUHJvamVrdDtcclxuXHRkZWxldGUgd2luZG93LmVtLkFydGVuVm9uUmF1bTtcclxuXHRkZWxldGUgd2luZG93LmVtLkFydGVuVm9uT3J0O1xyXG5cdGRlbGV0ZSB3aW5kb3cuZW0uQXJ0ZW5Wb25aZWl0O1xyXG59O1xyXG5cclxud2luZG93LmVtLmxlZXJlU3RvcmFnZU9ydExpc3RlID0gZnVuY3Rpb24obWl0TGF0TG5nTGlzdGUpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5PcnRMaXN0ZTtcclxuXHRpZiAobWl0TGF0TG5nTGlzdGUpIHtcclxuXHRcdGRlbGV0ZSB3aW5kb3cuZW0uaE9ydGVMYXRMbmdSYXVtO1xyXG5cdH1cclxuXHRkZWxldGUgd2luZG93LmVtLk9ydGVWb25Qcm9qZWt0O1xyXG5cdGRlbGV0ZSB3aW5kb3cuZW0uT3J0ZVZvblJhdW07XHJcbn07XHJcblxyXG53aW5kb3cuZW0ubGVlcmVTdG9yYWdlT3J0RWRpdCA9IGZ1bmN0aW9uKG9obmVJZCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAoIW9obmVJZCkge1xyXG5cdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5PcnRJZDtcclxuXHR9XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5oT3J0O1xyXG5cdGRlbGV0ZSBsb2NhbFN0b3JhZ2Uub1hLb29yZDtcclxuXHRkZWxldGUgbG9jYWxTdG9yYWdlLm9ZS29vcmQ7XHJcblx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5vTGFnZWdlbmF1aWdrZWl0O1xyXG5cdGRlbGV0ZSBsb2NhbFN0b3JhZ2Uub0xhdGl0dWRlRGVjRGVnO1xyXG5cdGRlbGV0ZSBsb2NhbFN0b3JhZ2Uub0xvbmdpdHVkZURlY0RlZztcclxuXHRkZWxldGUgbG9jYWxTdG9yYWdlLmFBcnRJZDtcclxuXHRkZWxldGUgbG9jYWxTdG9yYWdlLmFBcnROYW1lO1xyXG5cdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuYUFydEdydXBwZTtcclxuXHQvLyBoaWVyYXJjaGlzY2ggdGllZmVyZSBMaXN0ZW4gbMO2c2NoZW5cclxuXHRkZWxldGUgd2luZG93LmVtLlplaXRlblZvblByb2pla3Q7XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5aZWl0ZW5Wb25SYXVtO1xyXG5cdGRlbGV0ZSB3aW5kb3cuZW0uWmVpdGVuVm9uT3J0O1xyXG5cdGRlbGV0ZSB3aW5kb3cuZW0uQXJ0ZW5Wb25Qcm9qZWt0O1xyXG5cdGRlbGV0ZSB3aW5kb3cuZW0uQXJ0ZW5Wb25SYXVtO1xyXG5cdGRlbGV0ZSB3aW5kb3cuZW0uQXJ0ZW5Wb25PcnQ7XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5BcnRlblZvblplaXQ7XHJcblx0Ly8gYWxsZsOkbGxpZ2UgTG9rYWxpc2llcnVuZyBhYmJyZWNoZW5cclxuXHRpZiAodHlwZW9mIHdpbmRvdy5lbS53YXRjaElEICE9PSBcInVuZGVmaW5lZFwiKSB7XHJcblx0XHR3aW5kb3cuZW0uc3RvcEdlb2xvY2F0aW9uKCk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLmxlZXJlU3RvcmFnZVplaXRMaXN0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRkZWxldGUgd2luZG93LmVtLlplaXRMaXN0ZTtcclxuXHRkZWxldGUgd2luZG93LmVtLlplaXRlblZvblByb2pla3Q7XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5aZWl0ZW5Wb25SYXVtO1xyXG5cdGRlbGV0ZSB3aW5kb3cuZW0uWmVpdGVuVm9uT3J0O1xyXG59O1xyXG5cclxud2luZG93LmVtLmxlZXJlU3RvcmFnZVplaXRFZGl0ID0gZnVuY3Rpb24ob2huZUlkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghb2huZUlkKSB7XHJcblx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLlplaXRJZDtcclxuXHR9XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5oWmVpdDtcclxuXHQvLyBoaWVyYXJjaGlzY2ggdGllZmVyZSBMaXN0ZW4gbMO2c2NoZW5cclxuXHRkZWxldGUgd2luZG93LmVtLkFydGVuVm9uUHJvamVrdDtcclxuXHRkZWxldGUgd2luZG93LmVtLkFydGVuVm9uUmF1bTtcclxuXHRkZWxldGUgd2luZG93LmVtLkFydGVuVm9uT3J0O1xyXG5cdGRlbGV0ZSB3aW5kb3cuZW0uQXJ0ZW5Wb25aZWl0O1xyXG59O1xyXG5cclxud2luZG93LmVtLmxlZXJlU3RvcmFnZWhBcnRMaXN0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRkZWxldGUgd2luZG93LmVtLmhBcnRMaXN0ZTtcclxuXHRkZWxldGUgd2luZG93LmVtLkFydGVuVm9uUHJvamVrdDtcclxuXHRkZWxldGUgd2luZG93LmVtLkFydGVuVm9uUmF1bTtcclxuXHRkZWxldGUgd2luZG93LmVtLkFydGVuVm9uT3J0O1xyXG5cdGRlbGV0ZSB3aW5kb3cuZW0uQXJ0ZW5Wb25aZWl0O1xyXG59O1xyXG5cclxud2luZG93LmVtLmxlZXJlU3RvcmFnZWhBcnRFZGl0ID0gZnVuY3Rpb24ob2huZUlkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghb2huZUlkKSB7XHJcblx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLmhBcnRJZDtcclxuXHR9XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5oQXJ0O1xyXG59O1xyXG5cclxud2luZG93LmVtLmxlZXJlU3RvcmFnZUJlb2JMaXN0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRkZWxldGUgd2luZG93LmVtLkJlb2JMaXN0ZTtcclxuXHRkZWxldGUgd2luZG93LmVtLkJlb2JMaXN0ZUxhdExuZztcclxufTtcclxuXHJcbndpbmRvdy5lbS5sZWVyZVN0b3JhZ2VCZW9iRWRpdCA9IGZ1bmN0aW9uKG9obmVJZCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAoIW9obmVJZCkge1xyXG5cdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5CZW9iSWQ7XHJcblx0fVxyXG5cdGRlbGV0ZSB3aW5kb3cuZW0uQmVvYmFjaHR1bmc7XHJcblx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5vWEtvb3JkO1xyXG5cdGRlbGV0ZSBsb2NhbFN0b3JhZ2Uub1lLb29yZDtcclxuXHRkZWxldGUgbG9jYWxTdG9yYWdlLm9MYWdlZ2VuYXVpZ2tlaXQ7XHJcblx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5vTGF0aXR1ZGVEZWNEZWc7XHJcblx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5vTG9uZ2l0dWRlRGVjRGVnO1xyXG5cdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuYUFydElkO1xyXG5cdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuYUFydE5hbWU7XHJcblx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5hQXJ0R3J1cHBlO1xyXG5cdC8vIGFsbGbDpGxsaWdlIExva2FsaXNpZXJ1bmcgYWJicmVjaGVuXHJcblx0aWYgKHR5cGVvZiB3aW5kb3cuZW0ud2F0Y2hJRCAhPT0gXCJ1bmRlZmluZWRcIikge1xyXG5cdFx0d2luZG93LmVtLnN0b3BHZW9sb2NhdGlvbigpO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5sZWVyZVN0b3JhZ2VGZWxkTGlzdGUgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5GZWxkbGlzdGU7XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5GZWxkbGlzdGVCZW9iRWRpdDtcclxuXHRkZWxldGUgd2luZG93LmVtLkZlbGRsaXN0ZWhBcnRFZGl0O1xyXG5cdGRlbGV0ZSB3aW5kb3cuZW0uRmVsZGxpc3RlaEFydEVkaXRMaXN0ZTtcclxuXHRkZWxldGUgd2luZG93LmVtLkZlbGRsaXN0ZVplaXRFZGl0O1xyXG5cdGRlbGV0ZSB3aW5kb3cuZW0uRmVsZGxpc3RlT3J0RWRpdDtcclxuXHRkZWxldGUgd2luZG93LmVtLkZlbGRsaXN0ZVJhdW1FZGl0O1xyXG5cdGRlbGV0ZSB3aW5kb3cuZW0uRmVsZGxpc3RlUHJvamVrdDtcclxufTtcclxuXHJcbndpbmRvdy5lbS5sZWVyZVN0b3JhZ2VGZWxkRWRpdCA9IGZ1bmN0aW9uKG9obmVJZCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAoIW9obmVJZCkge1xyXG5cdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5GZWxkSWQ7XHJcblx0fVxyXG5cdGRlbGV0ZSB3aW5kb3cuZW0uRmVsZDtcclxufTtcclxuXHJcbi8vIHNldHp0IGFsbGUgRmVsZGVyIGltIE1vZHVzIEhpZXJhcmNoaXNjaCBzaWNodGJhclxyXG4vLyBFcndhcnRldCBkaWUgRW1haWxcclxuLy8gTW9kdXMgZWluZmFjaCB3aXJkIGhpZXIgbmljaHQgZWluZ2VzdGVsbHQ6IERpZSBtaW5pbWFsZW4gRmVsZGVyIHNpbmQgZml4IHByb2dyYW1taWVydFxyXG4vLyB3aXJkIHZlcndlbmRldCBpbjogU2lnbnVwLmh0bWwsIFVzZXJFZGl0Lmh0bWxcclxud2luZG93LmVtLmVyc3RlbGxlU2ljaHRiYXJlRmVsZGVyID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciB2aWV3bmFtZSA9ICdldmFiL0ZlbGRMaXN0ZUZlbGROYW1lP2luY2x1ZGVfZG9jcz10cnVlJztcclxuXHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0JGRiLnZpZXcodmlld25hbWUsIHtcclxuXHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0dmFyIEZlbGQ7XHJcblx0XHRcdF8uZWFjaChkYXRhLnJvd3MsIGZ1bmN0aW9uKHJvdykge1xyXG5cdFx0XHRcdEZlbGQgPSByb3cuZG9jO1xyXG5cdFx0XHRcdC8vIE51ciBhdXNnZXfDpGhsdGUgb2ZmaXppZWxsZSBGZWxkZXIgYmVyw7xja3NpY2h0aWdlblxyXG5cdFx0XHRcdC8vIGlmIChGZWxkLlVzZXIgPT09IFwiWmVudHJlbkJkS3RcIikge1xyXG5cdFx0XHRcdGlmIChbXCJwQmVtZXJrdW5nZW5cIiwgXCJyQmVtZXJrdW5nZW5cIiwgXCJvTGF0aXR1ZGVEZWNEZWdcIiwgXCJvTG9uZ2l0dWRlRGVjRGVnXCIsIFwib0jDtmhlXCIsIFwib0jDtmhlR2VuYXVpZ2tlaXRcIiwgXCJvQmVtZXJrdW5nZW5cIiwgXCJ6QmVtZXJrdW5nZW5cIiwgXCJhQXJ0TmFtZVVuc2ljaGVyXCIsIFwiYUFydE5hbWVFaWdlbmVyXCIsIFwiYUFydE5hbWVCZW1lcmt1bmdlblwiLCBcImFNZW5nZVwiLCBcImFCZW1lcmt1bmdlblwiXS5pbmRleE9mKEZlbGQuRmVsZE5hbWUpID4gLTEpIHtcclxuXHRcdFx0XHRcdCRkYi5vcGVuRG9jKEZlbGQuX2lkLCB7XHJcblx0XHRcdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKEZlbGQpIHtcclxuXHRcdFx0XHRcdFx0XHR2YXIgVXNlcm5hbWUgPSBsb2NhbFN0b3JhZ2UuRW1haWw7XHJcblx0XHRcdFx0XHRcdFx0RmVsZC5TaWNodGJhckltTW9kdXNIaWVyYXJjaGlzY2gucHVzaChVc2VybmFtZSk7XHJcblx0XHRcdFx0XHRcdFx0JGRiLnNhdmVEb2MoRmVsZCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyBlcnN0ZWxsdCBkaWUgc2ljaHRiYXJlbiBGZWxkZXJcclxuLy8gd2lyZCBiZW51dHp0IHZvbjogU2lnbnVwLmh0bWxcclxud2luZG93LmVtLnNwZWljaGVyZUF1dG9yQWxzU3RhbmRhcmR3ZXJ0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHQkZGIub3BlbkRvYyhcImYxOWNkNDliZDdiN2ExNTBjODk1MDQxYTVkMDJhY2IwXCIsIHtcclxuXHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKEZlbGQpIHtcclxuXHRcdFx0Ly8gRmFsbHMgU3RhbmRhcmR3ZXJ0IG5vY2ggbmljaHQgZXhpc3RpZXJ0LCBcclxuXHRcdFx0Ly8gbXVzcyB6dWVyc3QgZGFzIE9iamVrdCBnZXNjaGFmZmVuIHdlcmRlblxyXG5cdFx0XHRpZiAoIUZlbGQuU3RhbmRhcmR3ZXJ0KSB7XHJcblx0XHRcdFx0RmVsZC5TdGFuZGFyZHdlcnQgPSB7fTtcclxuXHRcdFx0fVxyXG5cdFx0XHRGZWxkLlN0YW5kYXJkd2VydFtsb2NhbFN0b3JhZ2UuRW1haWxdID0gbG9jYWxTdG9yYWdlLkF1dG9yO1xyXG5cdFx0XHQkZGIuc2F2ZURvYyhGZWxkLCB7XHJcblx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHQvLyBGZWxkZXIgc2ljdGJhciBzY2hhbHRlblxyXG5cdFx0XHRcdFx0d2luZG93LmVtLmVyc3RlbGxlU2ljaHRiYXJlRmVsZGVyKCk7XHJcblx0XHRcdFx0XHQvLyBGZWxkbGlzdGUgc29sbCBuZXUgYXVmZ2ViYXV0IHdlcmRlblxyXG5cdFx0XHRcdFx0d2luZG93LmVtLmxlZXJlU3RvcmFnZUZlbGRMaXN0ZSgpO1xyXG5cdFx0XHRcdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJCZW9iTGlzdGUuaHRtbFwiKTtcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5lcnN0ZWxsZVNpY2h0YmFyZUZlbGRlcigpO1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiS29udG8gZXJmb2xncmVpY2ggZXJzdGVsbHRcXG5Bbm1lbGR1bmcgZ2VzY2hlaXRlcnRcXG5CaXR0ZSBtZWxkZW4gU2llIHNpY2ggbmV1IGFuXCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9LFxyXG5cdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR3aW5kb3cuZW0uZXJzdGVsbGVTaWNodGJhcmVGZWxkZXIoKTtcclxuXHRcdFx0d2luZG93LmVtLm1lbGRlKFwiS29udG8gZXJmb2xncmVpY2ggZXJzdGVsbHRcXG5Bbm1lbGR1bmcgZ2VzY2hlaXRlcnRcXG5CaXR0ZSBtZWxkZW4gU2llIHNpY2ggbmV1IGFuXCIpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxuXHJcbi8qXHJcbip2YWxpZGllcnQgZW1haWwtYWRyZXNzZW5cclxuKlF1ZWxsZTogaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8yNTA3MDMwL2VtYWlsLXZhbGlkYXRpb24tdXNpbmctanF1ZXJ5XHJcbiovXHJcbndpbmRvdy5lbS52YWxpZGF0ZUVtYWlsID0gZnVuY3Rpb24oZW1haWwpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGVtYWlsUmVnID0gL14oW1xcdy1cXC5dK0AoW1xcdy1dK1xcLikrW1xcdy1dezIsNH0pPyQvO1xyXG5cdHJldHVybiBlbWFpbFJlZy50ZXN0KGVtYWlsKTtcclxufTtcclxuXHJcblxyXG4vLyB0ZXN0ZXQsIG9iIGRpZSBsb2thbGUgVmVyc2lvbiBlcnJlaWNoYmFyIGlzdFxyXG4vLyB3ZW5uIGphLCB3aXJkIGRpZXNlIGdlw7ZmZm5ldCwgc29uc3QgYXJ0ZWlnZW5zY2hhZnRlbi5jaFxyXG53aW5kb3cuZW0uw7ZmZm5lRWlnZW5zY2hhZnRlblZvbkFydCA9IGZ1bmN0aW9uKGlkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciB1cmwsXHJcblx0XHQvLyBuZXVlcyBGZW5zdGVyIGpldHp0IHNjaG9uIGdyw7xuZGVuXHJcblx0XHQvLyB3ZW5uIG1hbiB3aW5kb3cub3BlbiBuYWNoIGRlbSBjYWxsYmFjayBhdXNmw7xocnQsIMO2ZmZuZXQgZGFzIEZlbnN0ZXIgYWxzIHBvcHVwXHJcblx0XHR3aW4gPSB3aW5kb3cub3BlbihcIlwiLCBcIl9ibGFua1wiKTtcclxuXHJcblx0JC5hamF4KHtcclxuXHRcdHR5cGU6ICdIRUFEJyxcclxuXHRcdHVybDogJ2h0dHA6Ly8xMjcuMC4wLjE6NTk4NC9hcnRlbmRiL19kZXNpZ24vYXJ0ZW5kYi9pbmRleC5odG1sJ1xyXG5cdH0pXHJcblx0LmRvbmUoZnVuY3Rpb24oKSB7XHJcblx0XHQvLyBsb2thbGUgZGIgaXN0IGVycmVpY2hiYXIsIGRpZXNlIHZlcndlbmRlblxyXG5cdFx0dXJsID0gXCJodHRwOi8vMTI3LjAuMC4xOjU5ODQvYXJ0ZW5kYi9fZGVzaWduL2FydGVuZGIvaW5kZXguaHRtbD9pZD1cIiArIGlkO1xyXG5cdFx0Ly8gdXJsIGRlcyBpbSBuZXVlbiB0YWIgZ2XDtmZmbmV0ZW4gRmVuc3RlcnMgYW5wYXNzZW5cclxuXHRcdHdpbi5sb2NhdGlvbi5ocmVmID0gdXJsO1xyXG5cdH0pXHJcblx0LmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHQvLyBsb2thbGUgZGIgaXN0IG5pY2h0IGVycmVpY2hiYXJcclxuXHRcdHVybCA9IFwiaHR0cDovL2FydGVpZ2Vuc2NoYWZ0ZW4uY2gvYXJ0ZW5kYi9fZGVzaWduL2FydGVuZGIvaW5kZXguaHRtbD9pZD1cIiArIGlkO1xyXG5cdFx0Ly8gdXJsIGRlcyBpbSBuZXVlbiB0YWIgZ2XDtmZmbmV0ZW4gRmVuc3RlcnMgYW5wYXNzZW5cclxuXHRcdHdpbi5sb2NhdGlvbi5ocmVmID0gdXJsO1xyXG5cdH0pO1xyXG59O1xyXG5cclxuLy8gd2VubiBBcnRlbmxpc3RlLmh0bWwgaW5pdGlpZXJ0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUFsUGFnZWluaXQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0JChkb2N1bWVudClcclxuICAgICAgICAub24oXCJrZXlwcmVzc1wiLCB3aW5kb3cuZW0uaGFuZGxlQWxLZXlwcmVzcyk7XHJcblxyXG4gICAgJChcIiNBcnRlbmxpc3RlXCIpXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIjYWxfZmlsdGVyX3NldHplblwiLCB3aW5kb3cuZW0uaGFuZGxlQWxBbEZpbHRlckNsaWNrKVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiLnVpLWljb24tZGVsZXRlXCIsIHdpbmRvdy5lbS5oYW5kbGVBbFVpSWNvbkRlbGV0ZUNsaWNrKVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiI2FsX3N0YW5kYXJkZ3J1cHBlXCIsIHdpbmRvdy5lbS5oYW5kbGVBbEFsU3RhbmRhcmRncnVwcGVDbGljayk7XHJcblxyXG5cdCQoXCIjYWxfQXJ0ZW5MaXN0ZVwiKVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiW25hbWU9J0FydExpc3RJdGVtJ11cIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZUFsQXJ0TGlzdEl0ZW1DbGljayh0aGlzKTtcclxuICAgICAgICB9KTtcclxufTtcclxuXHJcbi8vIHdlbm4gQXJ0ZW5saXN0ZS5odG1sIGdlemVpZ3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlQWxQYWdlc2hvdyA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cuZW0uaW5pdGlpZXJlQXJ0ZW5saXN0ZShcIlwiKTtcclxuXHRpZiAod2luZG93LmVtLmdydXBwZV9tZXJrZW4pIHtcclxuXHRcdCQoXCIjYWxfc3RhbmRhcmRncnVwcGVcIikucmVtb3ZlQ2xhc3MoJ3VpLWRpc2FibGVkJyk7XHJcblx0fSBlbHNlIHtcclxuXHRcdCQoXCIjYWxfc3RhbmRhcmRncnVwcGVcIikuYWRkQ2xhc3MoJ3VpLWRpc2FibGVkJyk7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gd2VubiBBcnRlbmxpc3RlLmh0bWwgdmVyc2Nod2luZGV0XHJcbndpbmRvdy5lbS5oYW5kbGVBbFBhZ2VoaWRlID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdCQoXCIjYWxfQXJ0ZW5MaXN0ZVwiKS5oaWRlKCk7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIEFydGVubGlzdGUuaHRtbCBlaW5lIFRhc3RlIGdlZHLDvGNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVBbEtleXByZXNzID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmIChldmVudC53aGljaCA9PSAxMykge1xyXG5cdFx0dmFyIGZpbHRlcndlcnQgPSAkKFwiI2FsX2ZpbHRlclwiKS52YWwoKS50b0xvd2VyQ2FzZSgpO1xyXG5cdFx0d2luZG93LmVtLmluaXRpaWVyZUFydGVubGlzdGUoZmlsdGVyd2VydCk7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gd2VubiBpbiBBcnRlbmxpc3RlLmh0bWwgI2FsX2ZpbHRlcl9zZXR6ZW4gZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlQWxBbEZpbHRlckNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBmaWx0ZXJ3ZXJ0ID0gJChcIiNhbF9maWx0ZXJcIikudmFsKCkudG9Mb3dlckNhc2UoKTtcclxuXHR3aW5kb3cuZW0uaW5pdGlpZXJlQXJ0ZW5saXN0ZShmaWx0ZXJ3ZXJ0KTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gQXJ0ZW5saXN0ZS5odG1sIC51aS1pY29uLWRlbGV0ZSBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVBbFVpSWNvbkRlbGV0ZUNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBmaWx0ZXJ3ZXJ0ID0gXCJcIjtcclxuXHR3aW5kb3cuZW0uaW5pdGlpZXJlQXJ0ZW5saXN0ZShmaWx0ZXJ3ZXJ0KTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gQXJ0ZW5saXN0ZS5odG1sICNhbF9zdGFuZGFyZGdydXBwZSBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVBbEFsU3RhbmRhcmRncnVwcGVDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRkZWxldGUgd2luZG93LmVtLmdydXBwZV9tZXJrZW47XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJBcnRncnVwcGVubGlzdGUuaHRtbFwiKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gQXJ0ZW5saXN0ZS5odG1sIFtuYW1lPSdBcnRMaXN0SXRlbSddIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUFsQXJ0TGlzdEl0ZW1DbGljayA9IGZ1bmN0aW9uKHRoYXQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIEFydEJlemVpY2hudW5nID0gJCh0aGF0KS5hdHRyKFwiQXJ0QmV6ZWljaG51bmdcIiksXHJcblx0XHRhcnRpZCA9ICQodGhhdCkuYXR0cihcImFydGlkXCIpLFxyXG4gICAgICAgIGhhcnRlbl9taXRfZ2xlaWNoZXJfYXJ0aWQgPSBbXTtcclxuXHJcblx0Ly8ga29udHJvbGxpZXJlbiwgb2IgZGllc2UgQXJ0IHNjaG9uIGVyZmFzc3Qgd3VyZGVcclxuXHQvLyBWb3JzaWNodDogd2luZG93LmVtLmhBcnRMaXN0ZSBleGlzdGllcnQgbmljaHQsIHdlbm4gaW4gaEFydEVkaXQgRjUgZ2VkcsO8Y2t0IHd1cmRlIVxyXG5cdGlmICh3aW5kb3cuZW0uaEFydExpc3RlICYmIHdpbmRvdy5lbS5oQXJ0TGlzdGUucm93cykge1xyXG4gICAgICAgIGhhcnRlbl9taXRfZ2xlaWNoZXJfYXJ0aWQgPSBfLmZpbHRlcih3aW5kb3cuZW0uaEFydExpc3RlLnJvd3MsIGZ1bmN0aW9uKHJvdykge1xyXG4gICAgICAgICAgIHJldHVybiAgcm93LmRvYy5hQXJ0SWQgPT09IGFydGlkICYmIGFydGlkICE9PSB1bmRlZmluZWQ7XHJcbiAgICAgICAgfSk7XHJcblx0fVxyXG5cclxuXHRpZiAoaGFydGVuX21pdF9nbGVpY2hlcl9hcnRpZC5sZW5ndGggPiAwKSB7XHJcblx0XHR3aW5kb3cuZW0ubWVsZGUoXCJEaWVzZSBBcnQgd3VyZGUgYmVyZWl0cyBlcmZhc3N0XCIpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRsb2NhbFN0b3JhZ2UuYUFydElkID0gYXJ0aWQ7XHJcblx0XHRpZiAobG9jYWxTdG9yYWdlLlN0YXR1cyA9PT0gXCJuZXVcIikge1xyXG5cdFx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlTmV1ZUJlb2IoQXJ0QmV6ZWljaG51bmcpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0d2luZG93LmVtLnNwZWljaGVyZUJlb2JOZXVlQXJ0Z3J1cHBlQXJ0KEFydEJlemVpY2hudW5nKTtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG4vLyB3ZW5uIEFydGdydXBwZW5saXN0ZS5odG1sIGVyc2NoZWludFxyXG53aW5kb3cuZW0uaGFuZGxlQWdsUGFnZXNob3cgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93LmVtLmVyc3RlbGxlQXJ0Z3J1cHBlbkxpc3RlKCk7XHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5ncnVwcGVfbWVya2VuO1xyXG59O1xyXG5cclxuLy8gd2VubiBBcnRncnVwcGVubGlzdGUuaHRtbCB2ZXJzY2h3aW5kZXRcclxud2luZG93LmVtLmhhbmRsZUFnbFBhZ2VoaWRlID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdCQoXCIjYWdsX3N0YW5kYXJkZ3J1cHBlXCIpLmh0bWwoXCJuw6RjaHN0ZSBHcnVwcGUgbWVya2VuXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBBcnRncnVwcGVubGlzdGUuaHRtbCBpbml0aWllcnQgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlQWdsUGFnZWluaXQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gVm9yc2ljaHQ6IEdlbmF1ZXIgYWxzIGJvZHkgZnVua3Rpb25pZXJ0IGhpZXIgbmljaHQsXHJcblx0Ly8gd2VpbCBkaWUgbmVzdGVkIExpc3QgaW0gRE9NIGplZGVzIG1hbCBlaW5lIGVpZ2VuZSBQYWdlIGF1ZmJhdXRcclxuXHQkKFwiYm9keVwiKVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiW25hbWU9J0FydGdydXBwZW5MaXN0SXRlbSddXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVBZ2xBcnRncnVwcGVuTGlzdEl0ZW1DbGljayh0aGlzKTtcclxuICAgICAgICB9KTtcclxuXHJcblx0JChcIiNBcnRncnVwcGVubGlzdGVcIilcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiNhZ2xfc3RhbmRhcmRncnVwcGVcIiwgd2luZG93LmVtLmhhbmRsZUFnbEFnbFN0YW5kYXJkZ3J1cHBlQ2xpY2spO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBBcnRncnVwcGVubGlzdGUuaHRtbCBbbmFtZT0nQXJ0Z3J1cHBlbkxpc3RJdGVtJ10gZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlQWdsQXJ0Z3J1cHBlbkxpc3RJdGVtQ2xpY2sgPSBmdW5jdGlvbih0aGF0KSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS5hQXJ0R3J1cHBlID0gJCh0aGF0KS5hdHRyKFwiQXJ0R3J1cHBlXCIpO1xyXG5cdC8vIHdlbm4gZGllIEdydXBwZSBnZW1lcmt0IHdlcmRlbiBzb2xsLCBzaWUgYWxzIGdsb2JhbGUgVmFyaWFibGUgc3BlaWNoZXJuXHJcblx0aWYgKHdpbmRvdy5lbS5ncnVwcGVfbWVya2VuKSB7XHJcblx0XHR3aW5kb3cuZW0uZ3J1cHBlX21lcmtlbiA9ICQodGhhdCkuYXR0cihcIkFydEdydXBwZVwiKTtcclxuXHR9XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJBcnRlbmxpc3RlLmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIEFydGdydXBwZW5saXN0ZS5odG1sICNhZ2xfc3RhbmRhcmRncnVwcGUgZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlQWdsQWdsU3RhbmRhcmRncnVwcGVDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAoJCh0aGlzKS5odG1sKCkgPT09IFwibsOkY2hzdGUgR3J1cHBlIG1lcmtlblwiKSB7XHJcblx0XHR3aW5kb3cuZW0uZ3J1cHBlX21lcmtlbiA9IHRydWU7XHJcblx0XHQkKHRoaXMpLmh0bWwoXCJuw6RjaHN0ZSBHcnVwcGUgd2lyZCBnZW1lcmt0XCIpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRkZWxldGUgd2luZG93LmVtLmdydXBwZV9tZXJrZW47XHJcblx0XHQkKHRoaXMpLmh0bWwoXCJuw6RjaHN0ZSBHcnVwcGUgbWVya2VuXCIpO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIHdlbm4gQmVvYkVkaXQuaHRtbCBlcnNjaGVpbnRcclxud2luZG93LmVtLmhhbmRsZUJlb2JFZGl0UGFnZXNob3cgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gU29sbHRlIGtlaW5lIGlkIHZvcmxpZWdlbiwgenUgQmVvYkxpc3RlLmh0bWwgd2VjaHNlbG5cclxuXHQvLyBkYXMga29tbXQgaW0gTm9ybWFsZmFsbCBudXIgdm9yLCB3ZW5uIGRlciBDYWNoZSBkZXMgQnJvd3NlcnMgZ2VsZWVydCB3dXJkZVxyXG5cdC8vIG9kZXIgaW4gZGVyIFp3aXNjaGVuemVpdCBhdWYgZWluZW0gYW5kZXJlbiBCcm93c2VyIGRpZXNlciBEYXRlbnNhdHogZ2Vsw7ZzY2h0IHd1cmRlXHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH0gZWxzZSBpZiAoKCFsb2NhbFN0b3JhZ2UuU3RhdHVzIHx8IGxvY2FsU3RvcmFnZS5TdGF0dXMgPT09IFwidW5kZWZpbmVkXCIpICYmICghbG9jYWxTdG9yYWdlLkJlb2JJZCB8fCBsb2NhbFN0b3JhZ2UuQmVvYklkID09PSBcInVuZGVmaW5lZFwiKSkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbihcIm9obmVDbGVhclwiKTtcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiQmVvYkxpc3RlLmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdHdpbmRvdy5lbS5pbml0aWllcmVCZW9iRWRpdCgpO1xyXG59O1xyXG5cclxuLy8gd2VubiBCZW9iRWRpdC5odG1sIHZlcnNjaHdpbmRldFxyXG53aW5kb3cuZW0uaGFuZGxlQmVvYkVkaXRQYWdlaGlkZSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAodHlwZW9mIHdpbmRvdy5lbS53YXRjaElEICE9PSBcInVuZGVmaW5lZFwiKSB7XHJcblx0XHR3aW5kb3cuZW0uc3RvcEdlb2xvY2F0aW9uKCk7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gd2VubiBCZW9iRWRpdC5odG1sIGluaXRpaWVydCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVCZW9iRWRpdFBhZ2Vpbml0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIFdpcmQgZGllc2UgU2VpdGUgZGlyZWt0IGF1ZmdlcnVmZW4gdW5kIGVzIGdpYnQga2VpbmVuIGxvY2FsU3RvcmFnZSxcclxuXHQvLyBtdXNzIGF1ZiBpbmRleC5odG1sIHVtZ2VsZWl0ZXQgd2VyZGVuXHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH0gZWxzZSBpZiAoKCFsb2NhbFN0b3JhZ2UuU3RhdHVzIHx8IGxvY2FsU3RvcmFnZS5TdGF0dXMgPT09IFwidW5kZWZpbmVkXCIpICYmICghbG9jYWxTdG9yYWdlLkJlb2JJZCB8fCBsb2NhbFN0b3JhZ2UuQmVvYklkID09PSBcInVuZGVmaW5lZFwiKSkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbihcIm9obmVDbGVhclwiKTtcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiQmVvYkxpc3RlLmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHQkKFwiI0Jlb2JFZGl0SGVhZGVyXCIpXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIjT2VmZm5lQmVvYkxpc3RlQmVvYkVkaXRcIiwgd2luZG93LmVtLmhhbmRsZU9lZmZuZUJlb2JMaXN0ZUJlb2JFZGl0Q2xpY2spO1xyXG5cclxuXHQkKFwiI0Jlb2JFZGl0Rm9ybVwiKVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiLmFBcnRHcnVwcGVcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZUJlb2JFZGl0QUFydEdydXBwZUNsaWNrKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5hQXJ0TmFtZScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVCZW9iRWRpdEFBcnRuYW1lQ2xpY2soKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vbihcImNoYW5nZVwiLCBcIi5zcGVpY2hlcm5cIiwgd2luZG93LmVtLmhhbmRsZUJlb2JFZGl0U3BlaWNoZXJuQ2hhbmdlKVxyXG4gICAgICAgIC8vIEVpbmdhYmUgaW0gWmFobGVuZmVsZCBhYmZhbmdlbiAoYmx1cilcclxuICAgICAgICAvLyBFbmRlIGRlcyBTY2hpZWJlbnMgYWJmYW5nZW4gKHNsaWRlc3RvcClcclxuICAgICAgICAub24oXCJibHVyIHNsaWRlc3RvcFwiLCAnLnNwZWljaGVyblNsaWRlcicsIHdpbmRvdy5lbS5zcGVpY2hlcmVCZW9iKVxyXG5cdCAgICAvLyBLbGlja2VuIGF1ZiBkZW4gUGZlaWxlbiBpbSBaYWhsZW5mZWxkIGFiZmFuZ2VuXHJcblx0ICAgIC5vbihcIm1vdXNldXBcIiwgJy51aS1zbGlkZXItaW5wdXQnLCB3aW5kb3cuZW0uc3BlaWNoZXJlQmVvYik7XHJcblxyXG4gICAgJChcIiNCZW9iRWRpdFBhZ2VGb290ZXJOYXZiYXJcIilcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiNOZXVlQmVvYkJlb2JFZGl0XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVOZXVlQmVvYkJlb2JFZGl0Q2xpY2soKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiI3dhZWhsZUZlbGRlckJlb2JFZGl0XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVXYWVobGVGZWxkZXJCZW9iRWRpdENsaWNrKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oJ2NsaWNrJywgXCIjT2VmZm5lS2FydGVCZW9iRWRpdFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlQmVvYkVkaXRPZWZmbmVLYXJ0ZUNsaWNrKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oJ2NsaWNrJywgXCIjdmVyb3J0ZUJlb2JCZW9iRWRpdFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uR2V0R2VvbG9jYXRpb24obG9jYWxTdG9yYWdlLkJlb2JJZCwgXCJCZW9iXCIpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcjTG9lc2NoZUJlb2JCZW9iRWRpdCcsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICQoXCIjYmVvYl9sw7ZzY2hlbl9tZWxkdW5nXCIpLnBvcHVwKFwib3BlblwiKTtcclxuICAgICAgICB9KTtcclxuXHJcblx0JChcIiNiZW9iX2zDtnNjaGVuX21lbGR1bmdcIilcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiNiZW9iX2zDtnNjaGVuX21lbGR1bmdfamFfbG9lc2NoZW5cIiwgd2luZG93LmVtLmzDtnNjaGVCZW9iKTtcclxuXHJcbiAgICAkKFwiI0Zvcm1BbmjDpG5nZUJFXCIpXHJcbiAgICAgICAgLm9uKFwiY2hhbmdlXCIsIFwiLnNwZWljaGVybkFuaGFuZ1wiLCB3aW5kb3cuZW0uaGFuZGxlQmVvYkVkaXRTcGVpY2hlcm5BbmhhbmdDaGFuZ2UpXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCJbbmFtZT0nTMO2c2NoZUFuaGFuZyddXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5sw7ZzY2hlQW5oYW5nKHRoaXMsIHdpbmRvdy5lbS5CZW9iYWNodHVuZywgbG9jYWxTdG9yYWdlLkJlb2JJZCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG5cdCQoXCIjQmVvYkVkaXRcIilcclxuICAgICAgICAub24oXCJzd2lwZWxlZnRcIiwgXCIjQmVvYkVkaXRDb250ZW50XCIsIHdpbmRvdy5lbS5oYW5kbGVCZW9iRWRpdENvbnRlbnRTd2lwZWxlZnQpXHJcbiAgICAgICAgLm9uKFwic3dpcGVyaWdodFwiLCBcIiNCZW9iRWRpdENvbnRlbnRcIiwgd2luZG93LmVtLmhhbmRsZUJlb2JFZGl0Q29udGVudFN3aXBlcmlnaHQpXHJcbiAgICAgICAgLm9uKFwidmNsaWNrXCIsIFwiLnVpLXBhZ2luYXRpb24tcHJldlwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAvLyB6dW0gdm9yaWdlbiBEYXRlbnNhdHogd2VjaHNlbG5cclxuICAgICAgICAgICAgd2luZG93LmVtLm7DpGNoc3RlVm9yaWdlQmVvYigndm9yaWdlJyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJ2Y2xpY2tcIiwgXCIudWktcGFnaW5hdGlvbi1uZXh0XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIC8vIHp1bSBuw6RjaHN0ZW4gRGF0ZW5zYXR6IHdlY2hzZWxuXHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5uw6RjaHN0ZVZvcmlnZUJlb2IoJ27DpGNoc3RlJyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJrZXl1cFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICAndXNlIHN0cmljdCc7XHJcbiAgICAgICAgICAgIC8vIFdlY2hzZWwgendpc2NoZW4gRGF0ZW5zw6R0emVuIHZpYSBQZmVpbHRhc3RlbiBzdGV1ZXJuXHJcbiAgICAgICAgICAgIC8vIG5pY2h0IGluIHNlcGFyYXRlIEZ1bmt0aW9uIGF1c2xhZ2Vybiwgd2VpbCBJRTkgZXZlbnQucHJldmVudERlZmF1bHQgbmljaHQga2VubiAodW5kIGhpZXIgalF1ZXJ5IGRhcyBhYmbDpG5ndClcclxuICAgICAgICAgICAgLy8gbnVyIHJlYWdpZXJlbiwgd2VubiBCZW9iRWRpdCBzaWNodGJhciB1bmQgRm9rdXMgbmljaHQgaW4gZWluZW0gRmVsZFxyXG4gICAgICAgICAgICBpZiAoISQoZXZlbnQudGFyZ2V0KS5pcyhcImlucHV0LCB0ZXh0YXJlYSwgc2VsZWN0LCBidXR0b25cIikgJiYgJCgnI0Jlb2JFZGl0JykuaXMoJzp2aXNpYmxlJykpIHtcclxuICAgICAgICAgICAgICAgIC8vIExlZnQgYXJyb3dcclxuICAgICAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAkLm1vYmlsZS5rZXlDb2RlLkxFRlQpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZW0ubsOkY2hzdGVWb3JpZ2VCZW9iKCd2b3JpZ2UnKTtcclxuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gUmlnaHQgYXJyb3dcclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV2ZW50LmtleUNvZGUgPT09ICQubW9iaWxlLmtleUNvZGUuUklHSFQpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZW0ubsOkY2hzdGVWb3JpZ2VCZW9iKCduw6RjaHN0ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcblx0JCgnI01lbnVCZW9iRWRpdCcpXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9hcnRlaWdlbnNjaGFmdGVuJywgd2luZG93LmVtLmhhbmRsZUJlb2JFZGl0TWVudUFydGVpZ2Vuc2NoYWZ0ZW5DbGljaylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2hpZXJhcmNoaXNjaGVyX21vZHVzJywgd2luZG93LmVtLmhhbmRsZUJlb2JFZGl0TWVudUhpZXJhcmNoaXNjaGVyTW9kdXNDbGljaylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2ZlbGRlcl92ZXJ3YWx0ZW4nLCB3aW5kb3cuZW0uaGFuZGxlQmVvYkVkaXRNZW51RmVsZGVyVmVyd2FsdGVuQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9iZW9iX2V4cG9ydGllcmVuJywgd2luZG93LmVtLmhhbmRsZUJlb2JFZGl0TWVudUJlb2JFeHBvcnRpZXJlbkNsaWNrKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfZWluc3RlbGx1bmdlbicsIHdpbmRvdy5lbS5oYW5kbGVCZW9iRWRpdE1lbnVFaW5zdGVsbHVuZ2VuQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9uZXVfYW5tZWxkZW4nLCB3aW5kb3cuZW0ubWVsZGVOZXVBbilcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2FydGVuZ3J1cHBlbl9pbXBvcnRpZXJlbicsIHdpbmRvdy5lbS7DtmZmbmVBcnRlbmdydXBwZW5JbXBvcnRpZXJlbilcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2FydGVuX2ltcG9ydGllcmVuJywgd2luZG93LmVtLsO2ZmZuZUFydGVuSW1wb3J0aWVyZW4pXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9hZG1pbicsIHdpbmRvdy5lbS7DtmZmbmVBZG1pbik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIEJlb2JFZGl0Lmh0bWwgI09lZmZuZUJlb2JMaXN0ZUJlb2JFZGl0IGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZU9lZmZuZUJlb2JMaXN0ZUJlb2JFZGl0Q2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZUJlb2JFZGl0KCk7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJCZW9iTGlzdGUuaHRtbFwiKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gQmVvYkVkaXQuaHRtbCAjTmV1ZUJlb2JCZW9iRWRpdCBnZWtsaWNrdCB3aXJkXHJcbi8vIG5ldWUgQmVvYmFjaHR1bmcgZXJmYXNzZW5cclxud2luZG93LmVtLmhhbmRsZU5ldWVCZW9iQmVvYkVkaXRDbGljayA9IGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cdC8vIEdsb2JhbGUgVmFyaWFibGUgZsO8ciBCZW9iTGlzdGUgenVyw7xja3NldHplbiwgZGFtaXQgZGllIExpc3RlIG5ldSBhdWZnZWJhdXQgd2lyZFxyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VCZW9iTGlzdGUoKTtcclxuXHRsb2NhbFN0b3JhZ2UuU3RhdHVzID0gXCJuZXVcIjtcclxuXHRsb2NhbFN0b3JhZ2UuVm9uID0gXCJCZW9iRWRpdFwiO1xyXG5cdGlmICh3aW5kb3cuZW0uZ3J1cHBlX21lcmtlbikge1xyXG5cdFx0Ly8gQXJ0Z3J1cHBlbmxpc3RlIGF1c2xhc3NlblxyXG5cdFx0Ly8gbG9jYWxTdG9yYWdlLkFydEdydXBwZSBpc3Qgc2Nob24gZ2VzZXR6dFxyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJBcnRlbmxpc3RlLmh0bWxcIik7XHJcblx0fSBlbHNlIHtcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiQXJ0Z3J1cHBlbmxpc3RlLmh0bWxcIik7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gd2VubiBpbiBCZW9iRWRpdC5odG1sIC5hQXJ0R3J1cHBlIGdla2xpY2t0IHdpcmRcclxuLy8gRWRpdGllcmVuIHZvbiBCZW9iYWNodHVuZ2VuIG1hbmFnZW4sIGF1c2dlaGVuZCB2b24gQXJ0Z3J1cHBlXHJcbndpbmRvdy5lbS5oYW5kbGVCZW9iRWRpdEFBcnRHcnVwcGVDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBHbG9iYWxlIFZhcmlhYmxlbiBmw7xyIEJlb2JMaXN0ZSB6dXLDvGNrc2V0emVuLCBkYW1pdCBkaWUgTGlzdGUgbmV1IGF1ZmdlYmF1dCB3aXJkXHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZUJlb2JMaXN0ZSgpO1xyXG5cdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuU3RhdHVzO1x0Ly8gamEga2VpbiBTdGF0dXMgbmV1XHJcblx0bG9jYWxTdG9yYWdlLlZvbiA9IFwiQmVvYkVkaXRcIjtcclxuXHRpZiAod2luZG93LmVtLmdydXBwZV9tZXJrZW4pIHtcclxuXHRcdC8vIEFydGdydXBwZW5saXN0ZSBhdXNsYXNzZW5cclxuXHRcdC8vIGxvY2FsU3RvcmFnZS5hQXJ0R3J1cHBlIGlzdCBzY2hvbiBnZXNldHp0XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkFydGVubGlzdGUuaHRtbFwiKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJBcnRncnVwcGVubGlzdGUuaHRtbFwiKTtcclxuXHR9XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIEJlb2JFZGl0Lmh0bWwgI3dhZWhsZUZlbGRlckJlb2JFZGl0IGdla2xpY2t0IHdpcmRcclxuLy8gc2ljaHRiYXJlIEZlbGRlciB3w6RobGVuXHJcbndpbmRvdy5lbS5oYW5kbGVXYWVobGVGZWxkZXJCZW9iRWRpdENsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS5BdWZydWZlbmRlU2VpdGVGVyA9IFwiQmVvYkVkaXRcIjtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkZlbGRlcldhZWhsZW4uaHRtbFwiKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gQmVvYkVkaXQuaHRtbCAuYUFydE5hbWUgZ2VrbGlja3Qgd2lyZFxyXG4vLyBFZGl0aWVyZW4gdm9uIEJlb2JhY2h0dW5nZW4gbWFuYWdlbiwgYXVzZ2VoZW5kIHZvbiBBcnROYW1lXHJcbndpbmRvdy5lbS5oYW5kbGVCZW9iRWRpdEFBcnRuYW1lQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gR2xvYmFsZSBWYXJpYWJsZW4gZsO8ciBCZW9iTGlzdGUgenVyw7xja3NldHplbiwgZGFtaXQgZGllIExpc3RlIG5ldSBhdWZnZWJhdXQgd2lyZFxyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VCZW9iTGlzdGUoKTtcclxuXHRsb2NhbFN0b3JhZ2UuVm9uID0gXCJCZW9iRWRpdFwiO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiQXJ0ZW5saXN0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBCZW9iRWRpdC5odG1sIC5zcGVpY2hlcm4gZ2XDpG5kZXJ0IHdpcmRcclxuLy8gRsO8ciBqZWRlcyBGZWxkIGJlaSDDhG5kZXJ1bmcgc3BlaWNoZXJuXHJcbndpbmRvdy5lbS5oYW5kbGVCZW9iRWRpdFNwZWljaGVybkNoYW5nZSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuICAgIHZhciAkb1hLb29yZCA9ICQoXCJbbmFtZT0nb1hLb29yZCddXCIpLFxyXG4gICAgICAgICRvWUtvb3JkID0gJChcIltuYW1lPSdvWUtvb3JkJ11cIiksXHJcbiAgICAgICAgQ2hUb1dnc0xuZyA9IHJlcXVpcmUoJy4vdXRpbC9jaFRvV2dzTG5nJyksXHJcbiAgICAgICAgQ2hUb1dnc0xhdCA9IHJlcXVpcmUoJy4vdXRpbC9jaFRvV2dzTGF0Jyk7XHJcblx0aWYgKFsnb1hLb29yZCcsICdvWUtvb3JkJ10uaW5kZXhPZih0aGlzLm5hbWUpID4gLTEgJiYgJG9YS29vcmQudmFsKCkgJiYgJG9ZS29vcmQudmFsKCkpIHtcclxuXHRcdC8vIFdlbm4gS29vcmRpbmF0ZW4gdW5kIGJlaWRlIGVyZmFzc3RcclxuXHRcdGxvY2FsU3RvcmFnZS5vWEtvb3JkID0gJG9YS29vcmQudmFsKCk7XHJcblx0XHRsb2NhbFN0b3JhZ2Uub1lLb29yZCA9ICRvWUtvb3JkLnZhbCgpO1xyXG5cdFx0Ly8gTMOkbmdlbi0gdW5kIEJyZWl0ZW5ncmFkZSBiZXJlY2huZW5cclxuXHRcdGxvY2FsU3RvcmFnZS5vTG9uZ2l0dWRlRGVjRGVnID0gQ2hUb1dnc0xuZyhsb2NhbFN0b3JhZ2Uub1lLb29yZCwgbG9jYWxTdG9yYWdlLm9YS29vcmQpO1xyXG5cdFx0bG9jYWxTdG9yYWdlLm9MYXRpdHVkZURlY0RlZyA9IENoVG9XZ3NMYXQobG9jYWxTdG9yYWdlLm9ZS29vcmQsIGxvY2FsU3RvcmFnZS5vWEtvb3JkKTtcclxuXHRcdGxvY2FsU3RvcmFnZS5vTGFnZWdlbmF1aWdrZWl0ID0gbnVsbDtcclxuXHRcdC8vIHVuZCBLb29yZGluYXRlbiBzcGVpY2hlcm5cclxuXHRcdHdpbmRvdy5lbS5zcGVpY2hlcmVLb29yZGluYXRlbihsb2NhbFN0b3JhZ2UuQmVvYklkLCBcIkJlb2JhY2h0dW5nXCIpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlQmVvYih0aGlzKTtcclxuXHR9XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIEJlb2JFZGl0Lmh0bWwgLnNwZWljaGVybkFuaGFuZyBnZcOkbmRlcnQgd2lyZFxyXG4vLyDDhG5kZXJ1bmdlbiBpbSBGb3JtdWxhciBmw7xyIEFuaMOkbmdlIHNwZWljaGVyblxyXG53aW5kb3cuZW0uaGFuZGxlQmVvYkVkaXRTcGVpY2hlcm5BbmhhbmdDaGFuZ2UgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIF9hdHRhY2htZW50cyA9ICQoXCIjX2F0dGFjaG1lbnRzQkVcIikudmFsKCk7XHJcblx0aWYgKF9hdHRhY2htZW50cyAmJiBfYXR0YWNobWVudHMubGVuZ3RoICE9PSAwKSB7XHJcblx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlQW5ow6RuZ2UobG9jYWxTdG9yYWdlLkJlb2JJZCwgd2luZG93LmVtLkJlb2JhY2h0dW5nLCBcIkJFXCIpO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIHdlbm4gaW4gQmVvYkVkaXQuaHRtbCAjT2VmZm5lS2FydGVCZW9iRWRpdCBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVCZW9iRWRpdE9lZmZuZUthcnRlQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLnp1cnVlY2sgPSBcIkJlb2JFZGl0XCI7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJLYXJ0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBCZW9iRWRpdC5odG1sIGF1ZiAjQmVvYkVkaXRDb250ZW50IG5hY2ggbGlua3MgZ2V3aXNjaHQgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlQmVvYkVkaXRDb250ZW50U3dpcGVsZWZ0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghJChcIio6Zm9jdXNcIikuYXR0cihcImFyaWEtdmFsdWVub3dcIikpIHtcclxuXHRcdC8vIGtlaW4gc2xpZGVyXHJcblx0XHR3aW5kb3cuZW0ubsOkY2hzdGVWb3JpZ2VCZW9iKFwibsOkY2hzdGVcIik7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gd2VubiBpbiBCZW9iRWRpdC5odG1sIGF1ZiAjQmVvYkVkaXRDb250ZW50IG5hY2ggcmVjaHRzIGdld2lzY2h0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUJlb2JFZGl0Q29udGVudFN3aXBlcmlnaHQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKCEkKFwiKjpmb2N1c1wiKS5hdHRyKFwiYXJpYS12YWx1ZW5vd1wiKSkge1xyXG5cdFx0Ly8ga2VpbiBzbGlkZXJcclxuXHRcdHdpbmRvdy5lbS5uw6RjaHN0ZVZvcmlnZUJlb2IoXCJ2b3JpZ2VcIik7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gd2VubiBpbiBCZW9iRWRpdC5odG1sIC5tZW51X2FydGVpZ2Vuc2NoYWZ0ZW4gZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlQmVvYkVkaXRNZW51QXJ0ZWlnZW5zY2hhZnRlbkNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHdpbmRvdy5lbS7DtmZmbmVFaWdlbnNjaGFmdGVuVm9uQXJ0KGxvY2FsU3RvcmFnZS5hQXJ0SWQpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBCZW9iRWRpdC5odG1sIC5tZW51X2hpZXJhcmNoaXNjaGVyX21vZHVzIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUJlb2JFZGl0TWVudUhpZXJhcmNoaXNjaGVyTW9kdXNDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlQmVvYkVkaXQoKTtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhQcm9qZWt0TGlzdGUuaHRtbFwiKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gQmVvYkVkaXQuaHRtbCAubWVudV9mZWxkZXJfdmVyd2FsdGVuIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUJlb2JFZGl0TWVudUZlbGRlclZlcndhbHRlbkNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS56dXJ1ZWNrID0gXCJCZW9iRWRpdC5odG1sXCI7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJGZWxkTGlzdGUuaHRtbFwiKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gQmVvYkVkaXQuaHRtbCAubWVudV9iZW9iX2V4cG9ydGllcmVuIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUJlb2JFZGl0TWVudUJlb2JFeHBvcnRpZXJlbkNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHdpbmRvdy5vcGVuKCdfbGlzdC9FeHBvcnRCZW9iL0V4cG9ydEJlb2I/c3RhcnRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5FbWFpbCArICdcIl0mZW5ka2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCIse30se31dJmluY2x1ZGVfZG9jcz10cnVlJyk7XHJcblx0JChcIiNNZW51QmVvYkVkaXRcIilcclxuICAgICAgICAvLyB2w7ZsbGlnIHVubG9naXNjaDogZGFzIGJlcmVpdHMgb2ZmZW5lIHBvcHVwIG11c3MgenVlcnN0IGluaXRpYWxpc2llcnQgd2VyZGVuLi4uXHJcbiAgICAgICAgLnBvcHVwKClcclxuICAgICAgICAvLyAuLi5iZXZvciBlcyBnZXNjaGxvc3NlbiB3ZXJkZW4gbXVzcywgd2VpbCBlcyBzb25zdCBvZmZlbiBibGVpYnRcclxuICAgICAgICAucG9wdXAoXCJjbG9zZVwiKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gQmVvYkVkaXQuaHRtbCAubWVudV9laW5zdGVsbHVuZ2VuIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUJlb2JFZGl0TWVudUVpbnN0ZWxsdW5nZW5DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuenVydWVjayA9IFwiQmVvYkVkaXQuaHRtbFwiO1xyXG5cdHdpbmRvdy5lbS7DtmZmbmVNZWluZUVpbnN0ZWxsdW5nZW4oKTtcclxufTtcclxuXHJcbi8vIHdlbm4gQmVvYkxpc3RlLmh0bWwgZXJzY2hlaW50XHJcbndpbmRvdy5lbS5oYW5kbGVCZW9iTGlzdGVQYWdlc2hvdyA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAobG9jYWxTdG9yYWdlLmxlbmd0aCA9PT0gMCB8fCAhbG9jYWxTdG9yYWdlLkVtYWlsKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKCk7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImluZGV4Lmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdHdpbmRvdy5lbS5pbml0aWllcmVCZW9ibGlzdGUoKTtcclxufTtcclxuXHJcbi8vIFdlbm4gQmVvYkxpc3RlLmh0bWwgaW5pdGlpZXJ0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUJlb2JMaXN0ZVBhZ2Vpbml0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIFdpcmQgZGllc2UgU2VpdGUgZGlyZWt0IGF1ZmdlcnVmZW4gdW5kIGVzIGdpYnQga2VpbmVuIGxvY2FsU3RvcmFnZSxcclxuXHQvLyBtdXNzIGF1ZiBpbmRleC5odG1sIHVtZ2VsZWl0ZXQgd2VyZGVuXHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHJcbiAgICAkKFwiI0Jlb2JMaXN0ZVBhZ2VGb290ZXJcIilcclxuICAgICAgICAub24oJ2NsaWNrJywgJyNPZWZmbmVLYXJ0ZUJlb2JMaXN0ZScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVCZW9iTGlzdGVPZWZmbmVLYXJ0ZUJlb2JMaXN0ZUNsaWNrKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgJChcIiNCZW9iTGlzdGVQYWdlSGVhZGVyXCIpXHJcbiAgICAgICAgLm9uKCdjbGljaycsIFwiI09lZmZuZVByb2pla3RMaXN0ZUJlb2JMaXN0ZVwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAkLm1vYmlsZS5uYXZpZ2F0ZShcImhQcm9qZWt0TGlzdGUuaHRtbFwiKTtcclxuICAgICAgICB9KTtcclxuXHJcblx0JChcIiNCZW9ibGlzdGVCTFwiKVxyXG4gICAgICAgIC5vbihcInN3aXBlbGVmdCBjbGlja1wiLCBcIi5iZW9iXCIsIHdpbmRvdy5lbS5oYW5kbGVCZW9iTGlzdGVCZW9iU3dpcGVsZWZ0Q2xpY2spXHJcbiAgICAgICAgLm9uKFwidGFwaG9sZFwiLCBcIi5iZW9iXCIsIHdpbmRvdy5lbS5oYW5kbGVCZW9iTGlzdGVCZW9iVGFwaG9sZClcclxuICAgICAgICAub24oXCJzd2lwZWxlZnRcIiwgXCIuZXJzdGVcIiwgd2luZG93LmVtLmVyc3RlbGxlTmV1ZUJlb2JfMV9BcnRncnVwcGVubGlzdGUpO1xyXG5cclxuXHQkKFwiI0Jlb2JMaXN0ZVwiKVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiLk5ldWVCZW9iQmVvYkxpc3RlXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5lcnN0ZWxsZU5ldWVCZW9iXzFfQXJ0Z3J1cHBlbmxpc3RlKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJzd2lwZXJpZ2h0XCIsIFwiI0Jlb2JMaXN0ZVBhZ2VDb250ZW50XCIsIHdpbmRvdy5lbS5oYW5kbGVCZW9iTGlzdGVCZW9iTGlzdGVQYWdlQ29udGVudFN3aXBlcmlnaHQpO1xyXG5cclxuXHQkKCcjTWVudUJlb2JMaXN0ZScpXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9oaWVyYXJjaGlzY2hlcl9tb2R1cycsIHdpbmRvdy5lbS5oYW5kbGVCZW9iTGlzdGVNZW51SGllcmFyY2hpc2NoZXJNb2R1c0NsaWNrKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfZmVsZGVyX3ZlcndhbHRlbicsIHdpbmRvdy5lbS5oYW5kbGVCZW9iTGlzdGVNZW51RmVsZGVyVmVyd2FsdGVuQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9iZW9iX2V4cG9ydGllcmVuJywgd2luZG93LmVtLmhhbmRsZUJlb2JMaXN0ZU1lbnVCZW9iRXhwb3J0aWVyZW5DbGljaylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2VpbnN0ZWxsdW5nZW4nLCB3aW5kb3cuZW0uaGFuZGxlQmVvYkxpc3RlTWVudUVpbnN0ZWxsdW5nZW5DbGljaylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X25ldV9hbm1lbGRlbicsIHdpbmRvdy5lbS5tZWxkZU5ldUFuKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfYXJ0ZW5ncnVwcGVuX2ltcG9ydGllcmVuJywgd2luZG93LmVtLsO2ZmZuZUFydGVuZ3J1cHBlbkltcG9ydGllcmVuKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfYXJ0ZW5faW1wb3J0aWVyZW4nLCB3aW5kb3cuZW0uw7ZmZm5lQXJ0ZW5JbXBvcnRpZXJlbilcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2FkbWluJywgd2luZG93LmVtLsO2ZmZuZUFkbWluKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gQmVvYkxpc3RlLmh0bWwgLmJlb2IgZ2VrbGlja3Qgb2RlciBuYWNoIGxpbmtzIGdlc3dpcGVkIHdpcmRcclxud2luZG93LmVtLmhhbmRsZUJlb2JMaXN0ZUJlb2JTd2lwZWxlZnRDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdGxvY2FsU3RvcmFnZS5CZW9iSWQgPSAkKHRoaXMpLmF0dHIoJ2lkJyk7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJCZW9iRWRpdC5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBCZW9iTGlzdGUuaHRtbCAuYmVvYiB0YXBob2xkXHJcbndpbmRvdy5lbS5oYW5kbGVCZW9iTGlzdGVCZW9iVGFwaG9sZCA9IGZ1bmN0aW9uKCkge1xyXG5cdC8vIEZVTktUSU9OSUVSVCBOSUNIVCwgV0VJTCBKUVVFUlkgTU9CSUxFIE5BQ0ggVEFQSE9MRCBJTU1FUiBFSU5FTiBUQVAgQVVTRsOcSFJUISEhISEhISEhISEhISEhXHRcclxuXHRjb25zb2xlLmxvZygndGFwaG9sZCcpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBCZW9iTGlzdGUuaHRtbCAjT2VmZm5lS2FydGVCZW9iTGlzdGUgZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlQmVvYkxpc3RlT2VmZm5lS2FydGVCZW9iTGlzdGVDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuenVydWVjayA9IFwiQmVvYkxpc3RlXCI7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJLYXJ0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBCZW9iTGlzdGUuaHRtbCAjQmVvYkxpc3RlUGFnZUNvbnRlbnQgbmFjaCByZWNodHMgZ2V3aXNjaHQgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlQmVvYkxpc3RlQmVvYkxpc3RlUGFnZUNvbnRlbnRTd2lwZXJpZ2h0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiaFByb2pla3RMaXN0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBCZW9iTGlzdGUuaHRtbCAubWVudV9oaWVyYXJjaGlzY2hlcl9tb2R1cyBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVCZW9iTGlzdGVNZW51SGllcmFyY2hpc2NoZXJNb2R1c0NsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiaFByb2pla3RMaXN0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBCZW9iTGlzdGUuaHRtbCAubWVudV9mZWxkZXJfdmVyd2FsdGVuIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUJlb2JMaXN0ZU1lbnVGZWxkZXJWZXJ3YWx0ZW5DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuenVydWVjayA9IFwiQmVvYkxpc3RlLmh0bWxcIjtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkZlbGRMaXN0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBCZW9iTGlzdGUuaHRtbCAubWVudV9iZW9iX2V4cG9ydGllcmVuIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUJlb2JMaXN0ZU1lbnVCZW9iRXhwb3J0aWVyZW5DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cub3BlbignX2xpc3QvRXhwb3J0QmVvYi9FeHBvcnRCZW9iP3N0YXJ0a2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCJdJmVuZGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiLHt9LHt9XSZpbmNsdWRlX2RvY3M9dHJ1ZScpO1xyXG5cdCQoXCIjTWVudUJlb2JMaXN0ZVwiKVxyXG4gICAgICAgIC8vIHbDtmxsaWcgdW5sb2dpc2NoOiBkYXMgYmVyZWl0cyBvZmZlbmUgcG9wdXAgbXVzcyB6dWVyc3QgaW5pdGlhbGlzaWVydCB3ZXJkZW4uLi5cclxuICAgICAgICAucG9wdXAoKVxyXG4gICAgICAgIC8vIC4uLmJldm9yIGVzIGdlc2NobG9zc2VuIHdlcmRlbiBtdXNzLCB3ZWlsIGVzIHNvbnN0IG9mZmVuIGJsZWlidFxyXG4gICAgICAgIC5wb3B1cChcImNsb3NlXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBCZW9iTGlzdGUuaHRtbCAubWVudV9laW5zdGVsbHVuZ2VuIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUJlb2JMaXN0ZU1lbnVFaW5zdGVsbHVuZ2VuQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLnp1cnVlY2sgPSBcIkJlb2JMaXN0ZS5odG1sXCI7XHJcblx0d2luZG93LmVtLsO2ZmZuZU1laW5lRWluc3RlbGx1bmdlbigpO1xyXG59O1xyXG5cclxuLy8gd2VubiBGZWxkRWRpdC5odG1sIGVyc2NoZWludFxyXG4vLyBTb2xsdGUga2VpbmUgaWQgdm9ybGllZ2VuLCB6dSBGZWxkTGlzdGUuaHRtbCB3ZWNoc2VsblxyXG4vLyBkYXMga29tbXQgaW0gTm9ybWFsZmFsbCBudXIgdm9yLCB3ZW5uIGRlciBDYWNoZSBkZXMgQnJvd3NlcnMgZ2VsZWVydCB3dXJkZVxyXG4vLyBvZGVyIGluIGRlciBad2lzY2hlbnplaXQgYXVmIGVpbmVtIGFuZGVyZW4gQnJvd3NlciBkaWVzZXIgRGF0ZW5zYXR6IGdlbMO2c2NodCB3dXJkZVxyXG53aW5kb3cuZW0uaGFuZGxlRmVsZEVkaXRQYWdlc2hvdyA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAobG9jYWxTdG9yYWdlLmxlbmd0aCA9PT0gMCB8fCAhbG9jYWxTdG9yYWdlLkVtYWlsKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKCk7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImluZGV4Lmh0bWxcIik7XHJcblx0fSBlbHNlIGlmICgoIWxvY2FsU3RvcmFnZS5TdGF0dXMgfHwgbG9jYWxTdG9yYWdlLlN0YXR1cyA9PT0gXCJ1bmRlZmluZWRcIikgJiYgKCFsb2NhbFN0b3JhZ2UuRmVsZElkIHx8IGxvY2FsU3RvcmFnZS5GZWxkSWQgPT09IFwidW5kZWZpbmVkXCIpKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKFwib2huZUNsZWFyXCIpO1xyXG5cdFx0d2luZG93LmVtLmdlaGVadXJ1ZWNrRkUoKTtcclxuXHR9XHJcblx0d2luZG93LmVtLmluaXRpaWVyZUZlbGRFZGl0KCk7XHJcbn07XHJcblxyXG4vLyB3ZW5uIEZlbGRFZGl0Lmh0bWwgaW5pdGlpZXJ0IHdpcmRcclxuLy8gQ29kZSwgZGVyIG51ciBiZWltIGVyc3RlbiBBdWZydWYgZGVyIFNlaXRlIGxhdWZlbiBzb2xsXHJcbndpbmRvdy5lbS5oYW5kbGVGZWxkRWRpdFBhZ2Vpbml0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIFdpcmQgZGllc2UgU2VpdGUgZGlyZWt0IGF1ZmdlcnVmZW4gdW5kIGVzIGdpYnQga2VpbmVuIGxvY2FsU3RvcmFnZSxcclxuXHQvLyBtdXNzIGF1ZiBpbmRleC5odG1sIHVtZ2VsZWl0ZXQgd2VyZGVuXHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdH0gZWxzZSBpZiAoKCFsb2NhbFN0b3JhZ2UuU3RhdHVzIHx8IGxvY2FsU3RvcmFnZS5TdGF0dXMgPT09IFwidW5kZWZpbmVkXCIpICYmICghbG9jYWxTdG9yYWdlLkZlbGRJZCB8fCBsb2NhbFN0b3JhZ2UuRmVsZElkID09PSBcInVuZGVmaW5lZFwiKSkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbihcIm9obmVDbGVhclwiKTtcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiQmVvYkxpc3RlLmh0bWxcIik7XHJcblx0fVxyXG5cclxuICAgICQoXCIjRmVsZEVkaXRIZWFkZXJcIilcclxuICAgICAgICAub24oJ2NsaWNrJywgJyN6dXJ1ZWNrRmVsZEVkaXQnLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uZ2VoZVp1cnVlY2tGRSgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICQoXCIjVXNlckZlbGRGb3JtXCIpXHJcbiAgICAgICAgLm9uKFwiY2hhbmdlXCIsIFwiLm1laW5lRWluc3RlbGx1bmdlblwiLCB3aW5kb3cuZW0uaGFuZGxlRmVsZEVkaXRNZWluZUVpbnN0ZWxsdW5nZW5DaGFuZ2UpXHJcbiAgICAgICAgLm9uKFwiY2hhbmdlXCIsIFwiI1N0YW5kYXJkd2VydFwiLCB3aW5kb3cuZW0uaGFuZGxlRmVsZEVkaXRTdGFuZGFyZHdlcnRDaGFuZ2UpO1xyXG5cclxuXHQkKFwiI0ZlbGRFZGl0Rm9ybVwiKVxyXG4gICAgICAgIC5vbihcImNoYW5nZVwiLCBcIi5GZWxkZWlnZW5zY2hhZnRlblwiLCB3aW5kb3cuZW0uaGFuZGxlRmVsZEVkaXRGZWxkZWlnZW5zY2hhZnRlbkNoYW5nZSlcclxuICAgICAgICAub24oXCJjaGFuZ2VcIiwgXCIjRmVsZEZvbGd0TmFjaFwiLCB3aW5kb3cuZW0uaGFuZGxlRmVsZEVkaXRGZWxkRm9sZ3ROYWNoQ2hhbmdlKTtcclxuXHJcblx0JChcIiNmZV9sw7ZzY2hlbl9tZWxkdW5nXCIpXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIjZmVfbMO2c2NoZW5fbWVsZHVuZ19qYV9sb2VzY2hlblwiLCB3aW5kb3cuZW0uaGFuZGxlRmVsZEVkaXRGZUxvZXNjaGVuTWVsZHVuZ0phQ2xpY2spO1xyXG5cclxuXHQkKFwiI0ZlbGRFZGl0XCIpXHJcbiAgICAgICAgLm9uKFwic3dpcGVsZWZ0XCIsIFwiI0ZlbGRFZGl0Q29udGVudFwiLCB3aW5kb3cuZW0uZ2VoZVp1bU7DpGNoc3RlbkZlbGQpXHJcbiAgICAgICAgLm9uKFwic3dpcGVyaWdodFwiLCBcIiNGZWxkRWRpdENvbnRlbnRcIiwgd2luZG93LmVtLmdlaGVadW1Wb3JpZ2VuRmVsZClcclxuICAgICAgICAub24oXCJ2Y2xpY2tcIiwgXCIudWktcGFnaW5hdGlvbi1wcmV2XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5nZWhlWnVtVm9yaWdlbkZlbGQoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vbihcInZjbGlja1wiLCBcIi51aS1wYWdpbmF0aW9uLW5leHRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmdlaGVadW1Ow6RjaHN0ZW5GZWxkKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJrZXl1cFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICAndXNlIHN0cmljdCc7XHJcbiAgICAgICAgICAgIC8vIHdlbm4gaW4gRmVsZEVkaXQuaHRtIGVpbmUgVGFzdGUgZ2VkcsO8Y2t0IHdpcmRcclxuICAgICAgICAgICAgLy8gbWl0IFBmZWlsdGFzdGVuIERhdGVuc8OkdHplIHdlY2hzZWxuXHJcbiAgICAgICAgICAgIC8vIG51ciByZWFnaWVyZW4sIHdlbm4gaFByb2pla3RFZGl0IHNpY2h0YmFyIHVuZCBGb2t1cyBuaWNodCBpbiBlaW5lbSBGZWxkXHJcbiAgICAgICAgICAgIGlmICghJChldmVudC50YXJnZXQpLmlzKFwiaW5wdXQsIHRleHRhcmVhLCBzZWxlY3QsIGJ1dHRvblwiKSAmJiAkKCcjRmVsZEVkaXQnKS5pcygnOnZpc2libGUnKSkge1xyXG4gICAgICAgICAgICAgICAgLy8gTGVmdCBhcnJvd1xyXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09ICQubW9iaWxlLmtleUNvZGUuTEVGVCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5lbS5nZWhlWnVtVm9yaWdlbkZlbGQoKTtcclxuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gUmlnaHQgYXJyb3dcclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV2ZW50LmtleUNvZGUgPT09ICQubW9iaWxlLmtleUNvZGUuUklHSFQpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZW0uZ2VoZVp1bU7DpGNoc3RlbkZlbGQoKTtcclxuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgJChcIiNGZWxkRWRpdEZvb3RlclwiKVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiI05ldWVzRmVsZEZlbGRFZGl0XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5uZXVlc0ZlbGQoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnI0xvZXNjaGVGZWxkRmVsZEVkaXQnLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlRmVsZEVkaXRMb2VzY2hlRmVsZEZlbGRFZGl0Q2xpY2soKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAkKCcjTWVudUZlbGRFZGl0JylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2RhdGVuZmVsZGVyX2V4cG9ydGllcmVuJywgd2luZG93LmVtLmhhbmRsZUZlbGRFZGl0TWVudURhdGVuZmVsZGVyRXhwb3J0aWVyZW5DbGljayk7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlRmVsZEVkaXRNZWluZUVpbnN0ZWxsdW5nZW5DaGFuZ2UgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGZlbGRuYW1lID0gdGhpcy5uYW1lLFxyXG5cdFx0ZmVsZHdlcnQgPSB0aGlzLnZhbHVlO1xyXG5cdC8vIHByw7xmZW4sIG9iIGRhcyBGZWxkIGFscyBPYmpla3Qgdm9ybGllZ3RcclxuXHRpZiAod2luZG93LmVtLkZlbGQpIHtcclxuXHRcdC8vIGJlc3RlaGVuZGVzIE9iamVrdCB2ZXJ3ZW5kZW5cclxuXHRcdHdpbmRvdy5lbS5oYW5kbGVGZWxkRWRpdE1laW5lRWluc3RlbGx1bmdlbkNoYW5nZV8yKGZlbGRuYW1lLCBmZWxkd2VydCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIE9iamVrdCBhdXMgZGVyIERCIGhvbGVuXHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIub3BlbkRvYyhsb2NhbFN0b3JhZ2UuRmVsZElkLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uRmVsZCA9IGRhdGE7XHJcblx0XHRcdFx0d2luZG93LmVtLmhhbmRsZUZlbGRFZGl0TWVpbmVFaW5zdGVsbHVuZ2VuQ2hhbmdlXzIoZmVsZG5hbWUsIGZlbGR3ZXJ0KTtcclxuXHRcdFx0fSxcclxuXHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkZlaGxlcjogRGllIGxldHp0ZSDDhG5kZXJ1bmcgd3VyZGUgbmljaHQgZ2VzcGVpY2hlcnRcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVGZWxkRWRpdE1laW5lRWluc3RlbGx1bmdlbkNoYW5nZV8yID0gZnVuY3Rpb24oZmVsZG5hbWUsIGZlbGR3ZXJ0KSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIFNpY2h0YmFya2VpdHNlaW5zdGVsbHVuZ2VuOiBJbiBlaW5lbSBBcnJheSB3ZXJkZW4gZGllIFVzZXIgYXVmZ2VsaXN0ZXQsIHdlbGNoZSBkYXMgRmVsZCBzZWhlblxyXG5cdC8vIEVzIG11c3MgZ2VwcsO8ZnQgd2VyZGVuLCBvYiBkZXIgYWt0dWVsbGUgVXNlciBpbiBkaWVzZW0gQXJyYXkgZW50aGFsdGVuIGlzdFxyXG5cdGlmIChmZWxkd2VydCA9PT0gXCJqYVwiKSB7XHJcblx0XHQvLyBVc2VyIGVyZ8Okbnplbiwgd2VubiBub2NoIG5pY2h0IGVudGhhbHRlblxyXG5cdFx0d2luZG93LmVtLkZlbGRbZmVsZG5hbWVdID0gXy51bmlvbih3aW5kb3cuZW0uRmVsZFtmZWxkbmFtZV0sIGxvY2FsU3RvcmFnZS5FbWFpbCk7XHJcblx0fSBlbHNlIGlmIChmZWxkd2VydCA9PT0gXCJuZWluXCIpIHtcclxuXHRcdC8vIFVzZXIgZW50ZmVybmVuLCB3ZW5uIGVudGhhbHRlblxyXG5cdFx0d2luZG93LmVtLkZlbGRbZmVsZG5hbWVdID0gXy53aXRob3V0KHdpbmRvdy5lbS5GZWxkW2ZlbGRuYW1lXSwgbG9jYWxTdG9yYWdlLkVtYWlsKTtcclxuXHR9XHJcblx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdCRkYi5zYXZlRG9jKHdpbmRvdy5lbS5GZWxkLCB7XHJcblx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdHdpbmRvdy5lbS5GZWxkLl9yZXYgPSBkYXRhLnJldjtcclxuXHRcdH0sXHJcblx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkZlaGxlcjogRGllIGxldHp0ZSDDhG5kZXJ1bmcgd3VyZGUgbmljaHQgZ2VzcGVpY2hlcnRcIik7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIEZlbGRFZGl0Lmh0bSAuRmVsZGVpZ2Vuc2NoYWZ0ZW4gZ2XDpG5kZXJ0IHdpcmRcclxuLy8gamVkZXMgRmVsZCBhdXMgRmVsZGVpZ2Vuc2NoYWZ0ZW4gYmVpIMOEbmRlcnVuZyBzcGVpY2hlcm5cclxud2luZG93LmVtLmhhbmRsZUZlbGRFZGl0RmVsZGVpZ2Vuc2NoYWZ0ZW5DaGFuZ2UgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLkZlbGRXZXJ0ID0gdGhpcy52YWx1ZTtcclxuXHRpZiAodGhpcy5uYW1lKSB7XHJcblx0XHRsb2NhbFN0b3JhZ2UuRmVsZE5hbWUgPSB0aGlzLm5hbWU7XHJcblx0XHRsb2NhbFN0b3JhZ2UuQWx0ZXJGZWxkV2VydCA9IHdpbmRvdy5lbS5GZWxkW3RoaXMubmFtZV07XHJcblx0fSBlbHNlIHtcclxuXHRcdGxvY2FsU3RvcmFnZS5GZWxkTmFtZSA9IHRoaXMuaWQ7XHJcblx0XHRsb2NhbFN0b3JhZ2UuQWx0ZXJGZWxkV2VydCA9IHdpbmRvdy5lbS5GZWxkW3RoaXMuaWRdO1xyXG5cdH1cclxuXHQvLyBGZWxkZXIgZGVyIERhdGVuemVudHJlbiBkw7xyZmVuIG5pY2h0IHZlcsOkbmRlcnQgd2VyZGVuXHJcblx0Ly8gYXVzc2VyIFN0YW5kYXJkd2VydCwgZGVzc2VuIMOEbmRlcnVuZyB3aXJkIGFiZXIgaW4gZWluZXIgYW5kZXJlbiBGdW5rdGlvbiB2ZXJhcmJlaXRldFxyXG5cdC8vIGFiZXI6IERlciBCZW51dHplciBzb2xsIHfDpGhsZW4ga8O2bm5lbiwgaW4gd2VsY2hlbiBBcnRncnVwcGVuIGVyIGVpbiBzb2xjaGVzIEZlbGQgYW56ZWlndFxyXG5cdGlmICh3aW5kb3cuZW0uRmVsZC5Vc2VyID09PSBcIlplbnRyZW5CZEt0XCIgJiYgbG9jYWxTdG9yYWdlLkZlbGROYW1lICE9PSBcIkFydEdydXBwZVwiKSB7XHJcblx0XHQvLyBmZWxkd2VydCB6dXLDvGNrc2V0emVuXHJcblx0XHRpZiAobG9jYWxTdG9yYWdlLkFsdGVyRmVsZFdlcnQpIHtcclxuXHRcdFx0JChcIiNcIiArIGxvY2FsU3RvcmFnZS5GZWxkTmFtZSkudmFsKGxvY2FsU3RvcmFnZS5BbHRlckZlbGRXZXJ0KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdCQoXCIjXCIgKyBsb2NhbFN0b3JhZ2UuRmVsZE5hbWUpLnZhbChcIlwiKTtcclxuXHRcdH1cclxuXHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuRmVsZE5hbWU7XHJcblx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLkZlbGRXZXJ0O1xyXG5cdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5BbHRlckZlbGRXZXJ0O1xyXG5cdFx0d2luZG93LmVtLm1lbGRlKFwiRGllcyBpc3QgZWluIGdlc2Now7x0enRlcyBGZWxkIGVpbmVzIMO2ZmZlbnRsaWNoZW4gRGF0ZW56ZW50cnVtczxicj48YnI+U3RhdHQgZGllc2VzIHp1IMOkbmRlcm4ga8O2bm5lbiBTaWUgZWluIGVpZ2VuZXMgRmVsZCBlcnN0ZWxsZW5cIik7XHJcblx0fSBlbHNlIGlmIChsb2NhbFN0b3JhZ2UuRmVsZE5hbWUgPT09IFwiRmVsZE5hbWVcIikge1xyXG5cdFx0Ly8gV2VubiBlaWdlbmVyIEZlbGRuYW1lIHZlcsOkbmRlcnQgd2lyZCwga29udHJvbGxpZXJlbiwgZGFzcyBlciBuaWNodCBzY2hvbiB2ZXJ3ZW5kZXQgd3VyZGVcclxuXHRcdC8vIG9obmUgZXhwbGl6aXQgYXVmIHVuZGVmaW5lZCB6dSBwcsO8ZmVuLCBha3plcHRpZXJ0ZSBkaWUgQmVkaW5ndW5nIGVpbmVuIGFsdGVuIGZlbGR3ZXJ0IHZvblxyXG5cdFx0Ly8gdW5kZWZpbmVkIGFscyBvLmsuISEhIVxyXG5cdFx0aWYgKGxvY2FsU3RvcmFnZS5BbHRlckZlbGRXZXJ0ICE9PSBcInVuZGVmaW5lZFwiICYmIGxvY2FsU3RvcmFnZS5BbHRlckZlbGRXZXJ0KSB7XHJcblx0XHRcdC8vIHdlbm4gZWluIGFsdGVyIEZlbGRuYW1lIGV4aXN0aWVydCxcclxuXHRcdFx0Ly8gesOkaGxlbiwgaW4gd2lldmllbGVuIERhdGVuc8OkdHplbiBkYXMgRmVsZCB2ZXJ3ZW5kZXQgd2lyZFxyXG5cdFx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHRcdCRkYi52aWV3KCdldmFiL0ZlbGRTdWNoZT9rZXk9XCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiJmluY2x1ZGVfZG9jcz10cnVlJywge1xyXG5cdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRcdHZhciBhbnpWb3Jrb21tZW4gPSAwLFxyXG5cdFx0XHRcdFx0XHREYXRlbnNhdHosXHJcblx0XHRcdFx0XHRcdGZlbGRuYW1lLFxyXG5cdFx0XHRcdFx0XHRkcztcclxuXHRcdFx0XHRcdC8vIHrDpGhsZW4sIGluIHdpZXZpZWxlbiBEYXRlbnPDpHR6ZW4gZGFzIGJpc2hlcmlnZSBGZWxkIHZlcndlbmRldCB3aXJkXHJcblx0XHRcdFx0XHRfLmVhY2goZGF0YS5yb3dzLCBmdW5jdGlvbihyb3cpIHtcclxuXHRcdFx0XHRcdFx0RGF0ZW5zYXR6ID0gcm93LmRvYztcclxuXHRcdFx0XHRcdFx0ZmVsZG5hbWUgPSBEYXRlbnNhdHpbbG9jYWxTdG9yYWdlLkFsdGVyRmVsZFdlcnRdO1xyXG5cdFx0XHRcdFx0XHRpZiAoZmVsZG5hbWUpIHtcclxuXHRcdFx0XHRcdFx0XHRhbnpWb3Jrb21tZW4gKys7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0aWYgKGFuelZvcmtvbW1lbiA9PT0gMCkge1xyXG5cdFx0XHRcdFx0XHQvLyBhbHRlciBGZWxkbmFtZSB3dXJkZSBub2NoIGluIGtlaW5lbSBEYXRlbnNhdHogdmVyd2VuZGV0XHJcblx0XHRcdFx0XHRcdC8vIHByw7xmZW4sIG9iIGRlciBuZXVlIEZlbGRuYW1lIHNjaG9uIGV4aXN0aWVydFxyXG5cdFx0XHRcdFx0XHQvLyB3ZW5uIGphOiBtZWxkZW4sIHp1csO8Y2tzdGVsbGVuXHJcblx0XHRcdFx0XHRcdC8vIHdlbm4gbmVpbjogc3BlaWNoZXJuXHJcblx0XHRcdFx0XHRcdHdpbmRvdy5lbS5wcsO8ZmVGZWxkTmFtZW4oKTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdC8vIEZlbGRuYW1lIHdpcmQgc2Nob24gdmVyd2VuZGV0ID4gbWVsZGVuLCB6dXLDvGNrc3RlbGxlblxyXG5cdFx0XHRcdFx0XHRkcyA9IFwiRGF0ZW5zw6R0emVuXCI7XHJcblx0XHRcdFx0XHRcdGlmIChhbnpWb3Jrb21tZW4gPT09IDEpIHtcclxuXHRcdFx0XHRcdFx0XHRkcyA9IFwiRGF0ZW5zYXR6XCI7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0JChcIiNGZWxkTmFtZVwiKS52YWwobG9jYWxTdG9yYWdlLkFsdGVyRmVsZFdlcnQpO1xyXG5cdFx0XHRcdFx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLkZlbGROYW1lO1xyXG5cdFx0XHRcdFx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLkZlbGRXZXJ0O1xyXG5cdFx0XHRcdFx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLkFsdGVyRmVsZFdlcnQ7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkRpZXNlcyBGZWxkIHdpcmQgaW4gXCIgKyBhbnpWb3Jrb21tZW4gKyBcIiBcIiArIGRzICsgXCIgdmVyd2VuZGV0Ljxicj5FcyBrYW5uIGRlc2hhbGIgbmljaHQgdmVyw6RuZGVydCB3ZXJkZW4uPGJyPkJlcmVpbmlnZW4gU2llIHp1ZXJzdCBkaWUgRGF0ZW4uXCIpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQvLyBWb3JoZXIgZ2FiIGVzIGtlaW5lbiBGZWxkbmFtZW5cclxuXHRcdFx0Ly8gcHLDvGZlbiwgb2IgZGVyIG5ldWUgRmVsZG5hbWUgc2Nob24gZXhpc3RpZXJ0XHJcblx0XHRcdC8vIHdlbm4gamE6IG1lbGRlbiwgenVyw7xja3N0ZWxsZW5cclxuXHRcdFx0Ly8gd2VubiBuZWluOiBzcGVpY2hlcm5cclxuXHRcdFx0d2luZG93LmVtLnByw7xmZUZlbGROYW1lbigpO1xyXG5cdFx0fVxyXG5cdH0gZWxzZSBpZiAobG9jYWxTdG9yYWdlLkZlbGROYW1lID09PSBcIkhpZXJhcmNoaWVzdHVmZVwiICYmIGxvY2FsU3RvcmFnZS5GZWxkV2VydCA9PT0gXCJBcnRcIikge1xyXG5cdFx0JChcIi5GZWxkRWRpdEhlYWRlclRpdGVsXCIpLnRleHQobG9jYWxTdG9yYWdlLkZlbGRXZXJ0ICsgXCI6IFwiICsgd2luZG93LmVtLkZlbGQuRmVsZEJlc2NocmlmdHVuZyk7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlRmVsZExpc3RlKCk7XHJcblx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlRmVsZGVpZ2Vuc2NoYWZ0ZW4oKTtcclxuXHRcdC8vIFdlbm4gZGllIEhpZXJhcmNoaWVzdHVmZSB6dSBBcnQgZ2XDpG5kZXJ0IHdpcmQsIG11c3MgZGFzIEZlbGQgZsO8ciBkaWUgQXJ0Z3J1cHBlIGF1ZmdlYmF1dCB3ZXJkZW5cclxuXHRcdHdpbmRvdy5lbS5BcnRHcnVwcGVBdWZiYXVlbkZlbGRFZGl0KCk7XHJcblx0XHR3aW5kb3cuZW0ubWVsZGUoXCJKZXR6dCBtw7xzc2VuIFNpZSB3w6RobGVuLCBpbiB3ZWxjaGVuIEFydGdydXBwZW4gZGllc2VzIEZlbGQgYW5nZXplaWd0IHdlcmRlbiBrYW5uXCIpO1xyXG5cdH0gZWxzZSBpZiAobG9jYWxTdG9yYWdlLkZlbGROYW1lID09PSBcIkhpZXJhcmNoaWVzdHVmZVwiICYmIGxvY2FsU3RvcmFnZS5GZWxkV2VydCAhPT0gXCJBcnRcIikge1xyXG5cdFx0JChcIi5GZWxkRWRpdEhlYWRlclRpdGVsXCIpLnRleHQobG9jYWxTdG9yYWdlLkZlbGRXZXJ0ICsgXCI6IFwiICsgd2luZG93LmVtLkZlbGQuRmVsZEJlc2NocmlmdHVuZyk7XHJcblx0XHRpZiAod2luZG93LmVtLkZlbGQuSGllcmFyY2hpZXN0dWZlID09PSBcIkFydFwiKSB7XHJcblx0XHRcdC8vIFdlbm4gZGllIEhpZXJhcmNoaWVzdHVmZSBBcnQgd2FyIHVuZCBnZcOkbmRlcnQgd2lyZCwgbXVzcyBkYXMgRmVsZCBmw7xyIGRpZSBBcnRncnVwcGUgZW50ZmVybnQgd2VyZGVuXHJcblx0XHRcdCQoXCIjQXJ0Z3J1cHBlbmxpc3RlX0ZlbGRFZGl0XCIpLmVtcHR5KCk7XHJcbiAgICAgICAgICAgICQoXCIjU2ljaHRiYXJJbkhBcnRFZGl0TGlzdGVGaWVsZENvbnRhaW5cIikuaGlkZSgpO1xyXG5cdFx0fVxyXG5cdFx0d2luZG93LmVtLmxlZXJlU3RvcmFnZUZlbGRMaXN0ZSgpO1xyXG5cdFx0d2luZG93LmVtLnNwZWljaGVyZUZlbGRlaWdlbnNjaGFmdGVuKCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdGlmIChsb2NhbFN0b3JhZ2UuRmVsZE5hbWUgPT09IFwiRmVsZEJlc2NocmlmdHVuZ1wiKSB7XHJcblx0XHRcdCQoXCIuRmVsZEVkaXRIZWFkZXJUaXRlbFwiKS50ZXh0KHdpbmRvdy5lbS5GZWxkLkhpZXJhcmNoaWVzdHVmZSArIFwiOiBcIiArIGxvY2FsU3RvcmFnZS5GZWxkV2VydCk7XHJcblx0XHR9XHJcblx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlRmVsZGVpZ2Vuc2NoYWZ0ZW4oKTtcclxuXHR9XHJcblx0d2luZG93LmVtLmJsZW5kZURhdGVudHlwYWJow6RuZ2lnZUZlbGRlcigpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmJsZW5kZURhdGVudHlwYWJow6RuZ2lnZUZlbGRlciA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuICAgIHZhciAkZmVsZGVkaXRfaW5wdXR0eXAgPSAkKFwiI2ZlbGRlZGl0X2lucHV0dHlwXCIpLFxyXG4gICAgICAgICRmZWxkZWRpdF9vcHRpb25lbiA9ICQoXCIjZmVsZGVkaXRfb3B0aW9uZW5cIiksXHJcbiAgICAgICAgJGZlbGRlZGl0X3NsaWRlciA9ICQoXCIuZmVsZGVkaXRfc2xpZGVyXCIpO1xyXG5cdHN3aXRjaCAod2luZG93LmVtLkZlbGQuRm9ybXVsYXJlbGVtZW50KSB7XHJcblx0XHRjYXNlIFwidGV4dGlucHV0XCI6XHJcblx0XHRcdCRmZWxkZWRpdF9pbnB1dHR5cC5zaG93KCk7XHJcblx0XHRcdCRmZWxkZWRpdF9vcHRpb25lbi5oaWRlKCk7XHJcblx0XHRcdCRmZWxkZWRpdF9zbGlkZXIuaGlkZSgpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgXCJzZWxlY3RtZW51XCI6XHJcblx0XHRjYXNlIFwibXVsdGlwbGVzZWxlY3RcIjpcclxuXHRcdGNhc2UgXCJyYWRpb1wiOlxyXG5cdFx0Y2FzZSBcImNoZWNrYm94XCI6XHJcblx0XHRcdCRmZWxkZWRpdF9vcHRpb25lbi5zaG93KCk7XHJcblx0XHRcdCRmZWxkZWRpdF9pbnB1dHR5cC5oaWRlKCk7XHJcblx0XHRcdCRmZWxkZWRpdF9zbGlkZXIuaGlkZSgpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgXCJzbGlkZXJcIjpcclxuXHRcdFx0JGZlbGRlZGl0X3NsaWRlci5zaG93KCk7XHJcblx0XHRcdCRmZWxkZWRpdF9pbnB1dHR5cC5oaWRlKCk7XHJcblx0XHRcdCRmZWxkZWRpdF9vcHRpb25lbi5oaWRlKCk7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0ZGVmYXVsdDpcclxuXHRcdFx0JGZlbGRlZGl0X3NsaWRlci5oaWRlKCk7XHJcblx0XHRcdCRmZWxkZWRpdF9pbnB1dHR5cC5oaWRlKCk7XHJcblx0XHRcdCRmZWxkZWRpdF9vcHRpb25lbi5oaWRlKCk7XHJcblx0XHRcdGJyZWFrO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIHdlbm4gaW4gRmVsZEVkaXQuaHRtICNGZWxkRm9sZ3ROYWNoIGdlw6RuZGVydCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVGZWxkRWRpdEZlbGRGb2xndE5hY2hDaGFuZ2UgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93LmVtLnNldHplUmVpaGVuZm9sZ2VNaXRWb3Jnw6RuZ2VyKHRoaXMudmFsdWUpO1xyXG5cdC8vIEZlbGRsaXN0ZSBzb2xsIG5ldSBhdWZnZWJhdXQgd2VyZGVuXHJcblx0ZGVsZXRlIHdpbmRvdy5lbS5GZWxkbGlzdGU7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIEZlbGRFZGl0Lmh0bSAjU3RhbmRhcmR3ZXJ0IGdlw6RuZGVydCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVGZWxkRWRpdFN0YW5kYXJkd2VydENoYW5nZSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgb3B0aW9uZW4gPSAkKFwiI09wdGlvbmVuXCIpLnZhbCgpIHx8IFtdLFx0Ly8gdW5kZWZpbmVkIHZlcmhpbmRlcm5cclxuXHRcdEZlbGR3ZXJ0ID0gdGhpcy52YWx1ZSB8fCBbXSxcdC8vIHVuZGVmaW5lZCB2ZXJoaW5kZXJuXHJcblx0XHRMZXR6dGVyRmVsZHdlcnQsXHJcblx0XHRTdGFuZGFyZHdlcnRPcHRpb25lbixcclxuICAgICAgICAkU3RhbmRhcmR3ZXJ0ID0gJChcIiNTdGFuZGFyZHdlcnRcIik7XHJcblx0aWYgKG9wdGlvbmVuLmxlbmd0aCA+IDApIHtcclxuXHRcdC8vIGVzIGdpYnQgT3B0aW9uZW4uIERlciBTdGFuZGFyZHdlcnQgbXVzcyBlaW5lIG9kZXIgYWxsZW5mYWxscyBtZWhyZXJlIE9wdGlvbmVuIHNlaW5cclxuXHRcdExldHp0ZXJGZWxkd2VydCA9IFtdO1xyXG5cdFx0aWYgKHdpbmRvdy5lbS5GZWxkLlN0YW5kYXJkd2VydCkge1xyXG5cdFx0XHRpZiAod2luZG93LmVtLkZlbGQuU3RhbmRhcmR3ZXJ0W2xvY2FsU3RvcmFnZS5FbWFpbF0pIHtcclxuXHRcdFx0XHRMZXR6dGVyRmVsZHdlcnQgPSB3aW5kb3cuZW0uRmVsZC5TdGFuZGFyZHdlcnRbbG9jYWxTdG9yYWdlLkVtYWlsXTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0Ly8gU3RhbmRhcmR3ZXJ0IGluIEFycmF5IHZlcndhbmRlbG5cclxuXHRcdFN0YW5kYXJkd2VydE9wdGlvbmVuID0gW107XHJcblx0XHRpZiAoRmVsZHdlcnQubGVuZ3RoID4gMCkge1xyXG5cdFx0XHQvLyBGZWhsZXIgdmVyaGluZGVybiwgZmFsbHMgZmVsZHdlcnQgdW5kZWZpbmVkIGlzdFxyXG5cdFx0XHRTdGFuZGFyZHdlcnRPcHRpb25lbiA9IEZlbGR3ZXJ0LnNwbGl0KFwiLFwiKTtcclxuXHRcdH1cclxuXHRcdGlmIChbXCJtdWx0aXBsZXNlbGVjdFwiLCBcImNoZWNrYm94XCJdLmluZGV4T2Yod2luZG93LmVtLkZlbGQuRm9ybXVsYXJlbGVtZW50KSA+IC0xKSB7XHJcblx0XHRcdC8vIGFsbGUgU3RhbmRhcmR3ZXJ0T3B0aW9uZW4gbcO8c3NlbiBPcHRpb25lbiBzZWluXHJcblx0XHRcdF8uZWFjaChTdGFuZGFyZHdlcnRPcHRpb25lbiwgZnVuY3Rpb24oc3RhbmRhcmR3ZXJ0b3B0aW9uKSB7XHJcblx0XHRcdFx0aWYgKG9wdGlvbmVuLmluZGV4T2Yoc3RhbmRhcmR3ZXJ0b3B0aW9uKSA9PT0gLTEpIHtcclxuXHRcdFx0XHRcdC8vIGVpbiBXZXJ0IGlzdCBrZWluZSBPcHRpb24sIGFiYnJlY2hlblxyXG5cdFx0XHRcdFx0JFN0YW5kYXJkd2VydC52YWwoTGV0enRlckZlbGR3ZXJ0KTtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkJpdHRlIHfDpGhsZW4gU2llIGVpbmUgb2RlciBtZWhyZXJlIGRlciBPcHRpb25lblwiKTtcclxuXHRcdFx0XHRcdC8vIHJldHVybiBpc3QgaGllciBuaWNodCBuw7Z0aWdcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHQvLyBhbGxlIFdlcnRlIHNpbmQgT3B0aW9uZW5cclxuXHRcdFx0d2luZG93LmVtLnNwZWljaGVyZVN0YW5kYXJkd2VydCgpO1xyXG5cdFx0fSBlbHNlIGlmIChbXCJ0b2dnbGVzd2l0Y2hcIiwgXCJzZWxlY3RtZW51XCIsIFwicmFkaW9cIl0uaW5kZXhPZih3aW5kb3cuZW0uRmVsZC5Gb3JtdWxhcmVsZW1lbnQpID4gLTEpIHtcclxuXHRcdFx0Ly8gQXJyYXkgZGFyZiBudXIgZWluIEVsZW1lbnQgZW50aGFsdGVuXHJcblx0XHRcdGlmIChTdGFuZGFyZHdlcnRPcHRpb25lbi5sZW5ndGggPiAxKSB7XHJcblx0XHRcdFx0Ly8gQXJyYXkgZW50aMOkbHQgbWVocmVyZSBPcHRpb25lbiwgbmljaHQgenVsw6Rzc2lnXHJcblx0XHRcdFx0JFN0YW5kYXJkd2VydC52YWwoTGV0enRlckZlbGR3ZXJ0KTtcclxuXHRcdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJCaXR0ZSB3w6RobGVuIFNpZSBudXIgRUlORSBkZXIgT3B0aW9uZW5cIik7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly8gQXJyYXkgZW50aMOkbHQgZWluZSBlaW56aWdlIE9wdGlvblxyXG5cdFx0XHRcdF8uZWFjaChTdGFuZGFyZHdlcnRPcHRpb25lbiwgZnVuY3Rpb24oc3RhbmRhcmR3ZXJ0b3B0aW9uKSB7XHJcblx0XHRcdFx0XHRpZiAob3B0aW9uZW4uaW5kZXhPZihzdGFuZGFyZHdlcnRvcHRpb24pID09PSAtMSkge1xyXG5cdFx0XHRcdFx0XHQvLyBkZXIgV2VydCBpc3Qga2VpbmUgT3B0aW9uLCBhYmJyZWNoZW5cclxuXHRcdFx0XHRcdFx0JFN0YW5kYXJkd2VydC52YWwoTGV0enRlckZlbGR3ZXJ0KTtcclxuXHRcdFx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiQml0dGUgd8OkaGxlbiBTaWUgZWluZSBkZXIgT3B0aW9uZW5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJldHVybiBpc3QgaGllciBuaWNodCBuw7Z0aWdcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHQvLyBhbGxlIFdlcnRlIHNpbmQgT3B0aW9uZW5cclxuXHRcdFx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlU3RhbmRhcmR3ZXJ0KCk7XHJcbiAgICAgICAgICAgICAgICAvLyByZXR1cm4gaXN0IGhpZXIgbmljaHQgbsO2dGlnXHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIE9wdGlvbmVuIHNpbmQgZXJmYXNzdCwgRmVsZCBicmF1Y2h0IGFiZXIga2VpbmUuIEFsbGUgV2VydGUgYWt6ZXB0aWVyZW5cclxuXHRcdFx0d2luZG93LmVtLnNwZWljaGVyZVN0YW5kYXJkd2VydCgpO1xyXG5cdFx0fVxyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBFcyBnaWJ0IGtlaW5lIE9wdGlvbmVuLiBBbGxlIFN0YW5kYXJkd2VydGUgYWt6ZXB0aWVyZW5cclxuXHRcdHdpbmRvdy5lbS5zcGVpY2hlcmVTdGFuZGFyZHdlcnQoKTtcclxuXHR9XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIEZlbGRFZGl0Lmh0bSAjTG9lc2NoZUZlbGRGZWxkRWRpdCBnZWtsaWNrdCB3aXJkXHJcbi8vIEJlaW0gTMO2c2NoZW4gcsO8Y2tmcmFnZW5cclxud2luZG93LmVtLmhhbmRsZUZlbGRFZGl0TG9lc2NoZUZlbGRGZWxkRWRpdENsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICh3aW5kb3cuZW0uRmVsZC5Vc2VyID09PSBcIlplbnRyZW5CZEt0XCIpIHtcclxuXHRcdHdpbmRvdy5lbS5tZWxkZShcIkRpZXMgaXN0IGVpbiBGZWxkIGVpbmVzIG5hdGlvbmFsZW4gRGF0ZW56ZW50cnVtczxicj48YnI+RXMga2FubiBuaWNodCBnZWzDtnNjaHQgd2VyZGVuPGJyPjxicj5TaWUga8O2bm5lbiBlcyBhdXNibGVuZGVuXCIpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQkKFwiI2ZlX2zDtnNjaGVuX21lbGR1bmdcIikucG9wdXAoXCJvcGVuXCIpO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIHdlbm4gaW4gRmVsZEVkaXQuaHRtICNmZV9sw7ZzY2hlbl9tZWxkdW5nX2phX2xvZXNjaGVuIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUZlbGRFZGl0RmVMb2VzY2hlbk1lbGR1bmdKYUNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghd2luZG93LmVtLkZlbGQuRmVsZE5hbWUpIHtcclxuXHRcdC8vIE9obmUgRmVsZG5hbWUga2FubiBuaWNodCBrb250cm9sbGllcnQgd2VyZGVuLCBpbiB3aWV2aWVsZW4gRGF0ZW5zw6R0emVuIGRhcyBGZWxkIHZvcmtvbW10XHJcblx0XHR3aW5kb3cuZW0ubMO2c2NoZUZlbGQoKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0Ly8gesOkaGxlbiwgaW4gd2lldmllbGVuIERhdGVuc8OkdHplbiBkYXMgRmVsZCB2ZXJ3ZW5kZXQgd2lyZFxyXG5cdFx0JGRiLnZpZXcoJ2V2YWIvRmVsZFN1Y2hlP2tleT1cIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCImaW5jbHVkZV9kb2NzPXRydWUnLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR2YXIgYW56Vm9ya29tbWVuID0gMCxcclxuXHRcdFx0XHRcdERhdGVuc2F0eixcclxuXHRcdFx0XHRcdGZlbGRuYW1lLFxyXG5cdFx0XHRcdFx0ZHM7XHJcblx0XHRcdFx0Xy5lYWNoKGRhdGEucm93cywgZnVuY3Rpb24ocm93KSB7XHJcblx0XHRcdFx0XHREYXRlbnNhdHogPSByb3cuZG9jO1xyXG5cdFx0XHRcdFx0ZmVsZG5hbWUgPSBEYXRlbnNhdHpbd2luZG93LmVtLkZlbGQuRmVsZE5hbWVdO1xyXG5cdFx0XHRcdFx0aWYgKGZlbGRuYW1lKSB7XHJcblx0XHRcdFx0XHRcdGFuelZvcmtvbW1lbiArKztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRpZiAoYW56Vm9ya29tbWVuID09PSAwKSB7XHJcblx0XHRcdFx0XHR3aW5kb3cuZW0ubMO2c2NoZUZlbGQoKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0ZHMgPSBcIkRhdGVuc8OkdHplblwiO1xyXG5cdFx0XHRcdFx0aWYgKGFuelZvcmtvbW1lbiA9PT0gMSkge1xyXG5cdFx0XHRcdFx0XHRkcyA9IFwiRGF0ZW5zYXR6XCI7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJMw7ZzY2hlbiBhYmdlYnJvY2hlbjo8YnI+RGllc2VzIEZlbGQgd2lyZCBpbiBcIiArIGFuelZvcmtvbW1lbiArIFwiIFwiICsgZHMgKyBcIiB2ZXJ3ZW5kZXQ8YnI+QmVyZWluaWdlbiBTaWUgenVlcnN0IGRpZSBEYXRlblwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIHdlbm4gaW4gRmVsZEVkaXQuaHRtIC5tZW51X2RhdGVuZmVsZGVyX2V4cG9ydGllcmVuIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUZlbGRFZGl0TWVudURhdGVuZmVsZGVyRXhwb3J0aWVyZW5DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cub3BlbihcIl9saXN0L0ZlbGRFeHBvcnQvRmVsZExpc3RlP2luY2x1ZGVfZG9jcz10cnVlXCIpO1xyXG5cdCQoXCIjTWVudUZlbGRFZGl0XCIpXHJcbiAgICAgICAgLy8gdsO2bGxpZyB1bmxvZ2lzY2g6IGRhcyBiZXJlaXRzIG9mZmVuZSBwb3B1cCBtdXNzIHp1ZXJzdCBpbml0aWFsaXNpZXJ0IHdlcmRlbi4uLlxyXG4gICAgICAgIC5wb3B1cCgpXHJcbiAgICAgICAgLy8gLi4uYmV2b3IgZXMgZ2VzY2hsb3NzZW4gd2VyZGVuIG11c3MsIHdlaWwgZXMgc29uc3Qgb2ZmZW4gYmxlaWJ0XHJcbiAgICAgICAgLnBvcHVwKFwiY2xvc2VcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIEZlbGRlcldhZWhsZW4uaHRtbCBlcnNjaGVpbnRcclxud2luZG93LmVtLmhhbmRsZUZlbGRlclfDpGhsZW5QYWdlc2hvdyA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBTb2xsdGUga2VpbmUgaWQgdm9ybGllZ2VuLCB6dSBCZW9iTGlzdGUuaHRtbCB3ZWNoc2VsblxyXG5cdC8vIGRhcyBrb21tdCBpbSBOb3JtYWxmYWxsIG51ciB2b3IsIHdlbm4gZGVyIENhY2hlIGRlcyBCcm93c2VycyBnZWxlZXJ0IHd1cmRlXHJcblx0Ly8gb2RlciBpbiBkZXIgWndpc2NoZW56ZWl0IGF1ZiBlaW5lbSBhbmRlcmVuIEJyb3dzZXIgZGllc2VyIERhdGVuc2F0eiBnZWzDtnNjaHQgd3VyZGVcclxuXHRpZiAobG9jYWxTdG9yYWdlLmxlbmd0aCA9PT0gMCB8fCAhbG9jYWxTdG9yYWdlLkVtYWlsKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKCk7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImluZGV4Lmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fSBlbHNlIGlmICghbG9jYWxTdG9yYWdlLkF1ZnJ1ZmVuZGVTZWl0ZUZXIHx8IGxvY2FsU3RvcmFnZS5BdWZydWZlbmRlU2VpdGVGVyA9PT0gXCJ1bmRlZmluZWRcIikge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbihcIm9obmVDbGVhclwiKTtcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiQmVvYkxpc3RlLmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdHdpbmRvdy5lbS5pbml0aWllcmVGZWxkZXJXw6RobGVuKCk7XHJcbn07XHJcblxyXG4vLyB3ZW5uIEZlbGRlcldhZWhsZW4uaHRtbCB2ZXJzY2h3aW5kZXRcclxud2luZG93LmVtLmhhbmRsZUZlbGRlclfDpGhsZW5QYWdlaGlkZSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBnbG9iYWxlIFZhcmlhYmxlbiBhdWZyw6R1bWVuXHJcblx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5GZWxkbGlzdGVGd05hbWU7XHJcblx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5Lcml0ZXJpZW5Gw7xyWnVXw6RobGVuZGVGZWxkZXI7XHJcblx0Ly8gYXVzZ2VzY2hhbHRldCwgd2VpbCBlcyBkYXMgYnJhdWNodCwgd2VubiBtYW4gdm9uIEZlbGRlcldhaGxlbiBkaXJla3QgbmFjaCBGZWxkRWRpdCBzcHJpbmd0IHVuZCBkYW5uIHp1IEZlbGRXYWVobGVuIHp1csO8Y2tcclxuXHQvL2RlbGV0ZSBsb2NhbFN0b3JhZ2UuQXVmcnVmZW5kZVNlaXRlRlc7XHJcblx0Ly8gdmVyaGluZGVybiwgZGFzcyBiZWltIG7DpGNoc3RlbiBNYWwgenVlcnN0IGRpZSBhbHRlbiBGZWxkZXIgYW5nZXplaWd0IHdlcmRlblxyXG5cdCQoXCIjRmVsZGxpc3RlRldcIikuZW1wdHkoKTtcclxufTtcclxuXHJcbi8vIHdlbm4gRmVsZGVyV2FlaGxlbi5odG1sIGluaXRpaWVydCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVGZWxkZXJXw6RobGVuUGFnZWluaXQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gV2lyZCBkaWVzZSBTZWl0ZSBkaXJla3QgYXVmZ2VydWZlbiB1bmQgZXMgZ2lidCBrZWluZW4gbG9jYWxTdG9yYWdlLFxyXG5cdC8vIG11c3MgYXVmIGluZGV4Lmh0bWwgdW1nZWxlaXRldCB3ZXJkZW5cclxuXHRpZiAobG9jYWxTdG9yYWdlLmxlbmd0aCA9PT0gMCB8fCAhbG9jYWxTdG9yYWdlLkVtYWlsKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKCk7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImluZGV4Lmh0bWxcIik7XHJcblx0fSBlbHNlIGlmICghbG9jYWxTdG9yYWdlLkF1ZnJ1ZmVuZGVTZWl0ZUZXIHx8IGxvY2FsU3RvcmFnZS5BdWZydWZlbmRlU2VpdGVGVyA9PT0gXCJ1bmRlZmluZWRcIikge1xyXG5cdFx0Ly8gb2gsIGtlaW4genVyw7xjayBiZWthbm50XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKFwib2huZUNsZWFyXCIpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJCZW9iTGlzdGUuaHRtbFwiKTtcclxuXHR9XHJcblxyXG5cdCQoXCIjRmVsZGVyV2FlaGxlblBhZ2VcIilcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiNGZWxkZXJXYWVobGVuUGFnZV9iYWNrXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICQubW9iaWxlLm5hdmlnYXRlKGxvY2FsU3RvcmFnZS5BdWZydWZlbmRlU2VpdGVGVyArIFwiLmh0bWxcIik7XHJcbiAgICAgICAgfSk7XHJcblxyXG5cdCQoXCIjRmVsZGxpc3RlRldcIilcclxuICAgICAgICAub24oXCJjaGFuZ2VcIiwgXCJpbnB1dFtuYW1lPSdGZWxkZXInXVwiLCB3aW5kb3cuZW0uaGFuZGxlRmVsZGVyV8OkaGxlbklucHV0RmVsZGVyQ2hhbmdlKVxyXG5cdCAgICAvLyBhdXMgdW5iZWthbm50ZW0gR3J1bmQgZnVua3Rpb25pZXJ0IC5vbiBuaWNodCBhYmVyIC5iaW5kIHNjaG9uXHJcblx0ICAgIC5iaW5kKFwidGFwaG9sZFwiLCBcImlucHV0W25hbWU9J0ZlbGRlciddXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICd1c2Ugc3RyaWN0JztcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgLy8gZXZlbnQudGFyZ2V0IGlzdCBpbW1lciBkYXMgbGFiZWxcclxuICAgICAgICAgICAgdmFyIEZlbGROYW1lID0gJChldmVudC50YXJnZXQpLnByb3AoXCJmb3JcIik7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS7DtmZmbmVGZWxkKEZlbGROYW1lKTtcclxuICAgICAgICB9KTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gRmVsZGVyV2FlaGxlbi5odG1sIGlucHV0W25hbWU9J0ZlbGRlciddIGdlw6RuZGVydCB3aXJkXHJcbi8vIEZlbGRlciBzcGVpY2hlcm4gKGNoZWNrYm94KVxyXG53aW5kb3cuZW0uaGFuZGxlRmVsZGVyV8OkaGxlbklucHV0RmVsZGVyQ2hhbmdlID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBGZWxkTmFtZSA9ICQodGhpcykucHJvcChcImlkXCIpLFxyXG5cdFx0RmVsZElkID0gJCh0aGlzKS5hdHRyKFwiZmVsZGlkXCIpLFxyXG5cdFx0RmVsZCxcclxuXHRcdGZlbGRyb3csXHJcblx0XHRmZWxkX21pdF9zaWNodGJhcmtlaXQsXHJcblx0XHRzaWNodGJhcl9mw7xyX2JlbnV0emVyO1xyXG5cdGZlbGRyb3cgPSBfLmZpbmQod2luZG93LmVtW2xvY2FsU3RvcmFnZS5GZWxkbGlzdGVGd05hbWVdLnJvd3MsIGZ1bmN0aW9uKHJvdykge1xyXG5cdFx0cmV0dXJuIHJvdy5kb2MuX2lkID09PSBGZWxkSWQ7XHJcblx0fSk7XHJcblx0RmVsZCA9IGZlbGRyb3cuZG9jO1xyXG5cdC8vIEJlaSBCZW9iRWRpdC5odG1sIG11c3MgU2ljaHRiYXJJbU1vZHVzRWluZmFjaCBnZXNldHp0IHdlcmRlbiwgc29uc3QgU2ljaHRiYXJJbU1vZHVzSGllcmFyY2hpc2NoXHJcblx0aWYgKGxvY2FsU3RvcmFnZS5BdWZydWZlbmRlU2VpdGVGVyA9PT0gXCJCZW9iRWRpdFwiKSB7XHJcblx0XHRmZWxkX21pdF9zaWNodGJhcmtlaXQgPSBcIlNpY2h0YmFySW1Nb2R1c0VpbmZhY2hcIjtcclxuXHR9IGVsc2UgaWYgKGxvY2FsU3RvcmFnZS5BdWZydWZlbmRlU2VpdGVGVyA9PT0gXCJoQXJ0RWRpdExpc3RlXCIpIHtcclxuICAgICAgICBmZWxkX21pdF9zaWNodGJhcmtlaXQgPSBcIlNpY2h0YmFySW5IQXJ0RWRpdExpc3RlXCI7XHJcblx0fSBlbHNlIHtcclxuICAgICAgICAvLyBlaW5lcyBkZXIgaGllcmFyY2hpc2NoZW4gRm9ybXVsYXJlXHJcbiAgICAgICAgZmVsZF9taXRfc2ljaHRiYXJrZWl0ID0gXCJTaWNodGJhckltTW9kdXNIaWVyYXJjaGlzY2hcIjtcclxuXHR9XHJcblx0c2ljaHRiYXJfZsO8cl9iZW51dHplciA9IEZlbGRbZmVsZF9taXRfc2ljaHRiYXJrZWl0XSB8fCBbXTtcclxuXHRpZiAoJChcIiNcIiArIEZlbGROYW1lKS5wcm9wKFwiY2hlY2tlZFwiKSA9PT0gdHJ1ZSkge1xyXG5cdFx0c2ljaHRiYXJfZsO8cl9iZW51dHplci5wdXNoKGxvY2FsU3RvcmFnZS5FbWFpbCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdHNpY2h0YmFyX2bDvHJfYmVudXR6ZXIgPSBfLndpdGhvdXQoc2ljaHRiYXJfZsO8cl9iZW51dHplciwgbG9jYWxTdG9yYWdlLkVtYWlsKTtcclxuXHR9XHJcblx0RmVsZFtmZWxkX21pdF9zaWNodGJhcmtlaXRdID0gc2ljaHRiYXJfZsO8cl9iZW51dHplcjtcclxuXHQvLyDDhG5kZXJ1bmcgaW4gREIgc3BlaWNoZXJuXHJcbiAgICB2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0JGRiLnNhdmVEb2MoRmVsZCwge1xyXG5cdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHQvLyBuZXVlIHJldiBob2xlbiAoYWt0dWFsaXNpZXJ0IGF1Y2ggRmVsZGxpc3RlLU9iamVrdClcclxuXHRcdFx0RmVsZC5fcmV2ID0gZGF0YS5yZXY7XHJcblx0XHR9LFxyXG5cdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJGZWhsZXI6IG5pY2h0IGdlc3BlaWNoZXJ0PGJyPlZpZWxsZWljaHQga2xpY2tlbiBTaWUgenUgc2NobmVsbD9cIik7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uw7ZmZm5lRmVsZCA9IGZ1bmN0aW9uKEZlbGROYW1lKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHQkZGIudmlldygnZXZhYi9GZWxkTGlzdGVGZWxkTmFtZT9rZXk9XCInICsgRmVsZE5hbWUgKyAnXCImaW5jbHVkZV9kb2NzPXRydWUnLCB7XHJcblx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdGxvY2FsU3RvcmFnZS5GZWxkSWQgPSBkYXRhLnJvd3NbMF0uZG9jLl9pZDtcclxuXHRcdFx0bG9jYWxTdG9yYWdlLnp1cnVlY2sgPSBcIkZlbGRlcldhZWhsZW4uaHRtbFwiO1xyXG5cdFx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkZlbGRFZGl0Lmh0bWxcIik7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyB3ZW5uIEZlbGRMaXN0ZS5odG1sIGVyc2NoZWludFxyXG53aW5kb3cuZW0uaGFuZGxlRmVsZExpc3RlUGFnZXNob3cgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdH1cclxuXHR3aW5kb3cuZW0uaW5pdGlpZXJlRmVsZGxpc3RlKCk7XHJcbn07XHJcblxyXG4vLyB3ZW5uIEZlbGRMaXN0ZS5odG1sIGluaXRpaWVydCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVGZWxkTGlzdGVQYWdlaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBXaXJkIGRpZXNlIFNlaXRlIGRpcmVrdCBhdWZnZXJ1ZmVuIHVuZCBlcyBnaWJ0IGtlaW5lbiBsb2NhbFN0b3JhZ2UsXHJcblx0Ly8gbXVzcyBhdWYgaW5kZXguaHRtbCB1bWdlbGVpdGV0IHdlcmRlblxyXG5cdGlmIChsb2NhbFN0b3JhZ2UubGVuZ3RoID09PSAwIHx8ICFsb2NhbFN0b3JhZ2UuRW1haWwpIHtcclxuXHRcdHdpbmRvdy5lbS5sZWVyZUFsbGVWYXJpYWJlbG4oKTtcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiaW5kZXguaHRtbFwiKTtcclxuXHR9XHJcblxyXG5cdC8vIHNpY2hlcnN0ZWxsZW4sIGRhc3MgenVydWVjayBuaWUgbGVlciBpc3RcclxuXHRpZiAoIWxvY2FsU3RvcmFnZS56dXJ1ZWNrKSB7XHJcblx0XHRsb2NhbFN0b3JhZ2UuenVydWVjayA9IFwiQmVvYkxpc3RlLmh0bWxcIjtcclxuXHR9XHJcblxyXG5cdCQoXCIjRmVsZExpc3RlRkxcIilcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5GZWxkJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZUZlbGRMaXN0ZUZlbGRDbGljayh0aGlzKTtcclxuICAgICAgICB9KTtcclxuXHJcblx0JChcIiNGZWxkTGlzdGVGb290ZXJcIilcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiNOZXVlc0ZlbGRGZWxkTGlzdGVcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLm5ldWVzRmVsZCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHQkKCcjTWVudUZlbGRMaXN0ZScpXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9kYXRlbmZlbGRlcl9leHBvcnRpZXJlbicsIHdpbmRvdy5lbS5oYW5kbGVGZWxkTGlzdGVNZW51RGF0ZW5mZWxkZXJFeHBvcnRpZXJlbkNsaWNrKTtcclxuXHJcblx0JChcIiNGZWxkTGlzdGVIZWFkZXJcIilcclxuICAgICAgICAub24oJ2NsaWNrJywgJyNGZWxkTGlzdGVCYWNrQnV0dG9uJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZUZlbGRMaXN0ZUJhY2tCdXR0b25DbGljaygpO1xyXG4gICAgICAgIH0pO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBGZWxkTGlzdGUuaHRtbCAuRmVsZCBnZWtsaWNrdCB3aXJkXHJcbi8vIEZlbGQgw7ZmZm5lblxyXG53aW5kb3cuZW0uaGFuZGxlRmVsZExpc3RlRmVsZENsaWNrID0gZnVuY3Rpb24odGhhdCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuRmVsZElkID0gJCh0aGF0KS5hdHRyKCdGZWxkSWQnKTtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkZlbGRFZGl0Lmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIEZlbGRMaXN0ZS5odG1sIC5tZW51X2RhdGVuZmVsZGVyX2V4cG9ydGllcmVuIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUZlbGRMaXN0ZU1lbnVEYXRlbmZlbGRlckV4cG9ydGllcmVuQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93Lm9wZW4oXCJfbGlzdC9GZWxkRXhwb3J0L0ZlbGRMaXN0ZT9pbmNsdWRlX2RvY3M9dHJ1ZVwiKTtcclxuXHQvLyB2w7ZsbGlnIHVubG9naXNjaDogZGFzIGJlcmVpdHMgb2ZmZW5lIHBvcHVwIG11c3MgenVlcnN0IGluaXRpYWxpc2llcnQgd2VyZGVuLi4uXHJcbiAgICAvLyAuLi5iZXZvciBlcyBnZXNjaGxvc3NlbiB3ZXJkZW4gbXVzcywgd2VpbCBlcyBzb25zdCBvZmZlbiBibGVpYnRcclxuXHQkKFwiI01lbnVGZWxkTGlzdGVcIikucG9wdXAoKS5wb3B1cChcImNsb3NlXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBGZWxkTGlzdGUuaHRtbCAjRmVsZExpc3RlQmFja0J1dHRvbiBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVGZWxkTGlzdGVCYWNrQnV0dG9uQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcbiAgICBpZiAobG9jYWxTdG9yYWdlLmhBcnRTaWNodCA9PT0gXCJsaXN0ZVwiICYmIGxvY2FsU3RvcmFnZS56dXJ1ZWNrID09PSBcImhBcnRFZGl0Lmh0bWxcIikge1xyXG4gICAgICAgICQubW9iaWxlLm5hdmlnYXRlKFwiaEFydEVkaXRMaXN0ZS5odG1sXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICAkLm1vYmlsZS5uYXZpZ2F0ZShsb2NhbFN0b3JhZ2UuenVydWVjayk7XHJcbiAgICB9XHJcblx0ZGVsZXRlIGxvY2FsU3RvcmFnZS56dXJ1ZWNrO1xyXG59O1xyXG5cclxuLy8gd2VubiBoQXJ0RWRpdC5odG1sIGVyc2NoZWludFxyXG53aW5kb3cuZW0uaGFuZGxlSEFydEVkaXRQYWdlc2hvdyA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBTb2xsdGUga2VpbmUgaWQgdm9ybGllZ2VuLCB6dSBoUHJvamVrdExpc3RlLmh0bWwgd2VjaHNlbG5cclxuXHQvLyBkYXMga29tbXQgaW0gTm9ybWFsZmFsbCBudXIgdm9yLCB3ZW5uIGRlciBDYWNoZSBkZXMgQnJvd3NlcnMgZ2VsZWVydCB3dXJkZVxyXG5cdC8vIG9kZXIgaW4gZGVyIFp3aXNjaGVuemVpdCBhdWYgZWluZW0gYW5kZXJlbiBCcm93c2VyIGRpZXNlciBEYXRlbnNhdHogZ2Vsw7ZzY2h0IHd1cmRlXHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH0gZWxzZSBpZiAoIWxvY2FsU3RvcmFnZS5TdGF0dXMgJiYgIWxvY2FsU3RvcmFnZS5oQXJ0SWQpIHtcclxuXHRcdHdpbmRvdy5lbS5sZWVyZUFsbGVWYXJpYWJlbG4oXCJvaG5lQ2xlYXJcIik7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhQcm9qZWt0TGlzdGUuaHRtbFwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0d2luZG93LmVtLmluaXRpaWVyZWhBcnRFZGl0KCk7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGhBcnRFZGl0Lmh0bWwgaW5pdGlpZXJ0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhBcnRFZGl0UGFnZWluaXQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gV2lyZCBkaWVzZSBTZWl0ZSBkaXJla3QgYXVmZ2VydWZlbiB1bmQgZXMgZ2lidCBrZWluZW4gbG9jYWxTdG9yYWdlLFxyXG5cdC8vIG11c3MgYXVmIGluZGV4Lmh0bWwgdW1nZWxlaXRldCB3ZXJkZW5cclxuXHRpZiAobG9jYWxTdG9yYWdlLmxlbmd0aCA9PT0gMCB8fCAhbG9jYWxTdG9yYWdlLkVtYWlsKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKCk7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImluZGV4Lmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fSBlbHNlIGlmICgoIWxvY2FsU3RvcmFnZS5TdGF0dXMgfHwgbG9jYWxTdG9yYWdlLlN0YXR1cyA9PT0gXCJ1bmRlZmluZWRcIikgJiYgKCFsb2NhbFN0b3JhZ2UuaEFydElkIHx8IGxvY2FsU3RvcmFnZS5oQXJ0SWQgPT09IFwidW5kZWZpbmVkXCIpKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKFwib2huZUNsZWFyXCIpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJoUHJvamVrdExpc3RlLmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHQkKFwiI2hBcnRFZGl0UGFnZUhlYWRlclwiKVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiW25hbWU9J09lZmZuZUFydExpc3RlaEFydEVkaXQnXVwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlSEFydEVkaXTDlmZmbmVBcnRMaXN0ZWhBcnRFZGl0Q2xpY2soKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiLk9lZmZuZVplaXRoQXJ0RWRpdFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlSEFydEVkaXTDlmZmbmVaZWl0aEFydEVkaXRDbGljaygpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIuT2VmZm5lT3J0aEFydEVkaXRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZUhBcnRFZGl0w5ZmZm5lT3J0aEFydEVkaXRDbGljaygpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIuT2VmZm5lUmF1bWhBcnRFZGl0XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVIQXJ0RWRpdMOWZmZuZVJhdW1oQXJ0RWRpdENsaWNrKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIi5PZWZmbmVQcm9qZWt0aEFydEVkaXRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZUhBcnRFZGl0w5ZmZm5lUHJvamVrdGhBcnRFZGl0Q2xpY2soKTtcclxuICAgICAgICB9KTtcclxuXHJcblx0JChcIiNoQXJ0RWRpdEZvcm1cIilcclxuICAgICAgICAvLyBGw7xyIGplZGVzIEZlbGQgYmVpIMOEbmRlcnVuZyBzcGVpY2hlcm5cclxuICAgICAgICAub24oXCJjaGFuZ2VcIiwgXCIuc3BlaWNoZXJuXCIsIHdpbmRvdy5lbS5zcGVpY2hlcmVIQXJ0KVxyXG5cdCAgICAvLyBFaW5nYWJlIGltIFphaGxlbmZlbGQgYWJmYW5nZW5cclxuICAgICAgICAub24oXCJibHVyXCIsICcuc3BlaWNoZXJuU2xpZGVyJywgd2luZG93LmVtLnNwZWljaGVyZUhBcnQpXHJcblx0ICAgIC8vIEtsaWNrZW4gYXVmIGRlbiBQZmVpbGVuIGltIFphaGxlbmZlbGQgYWJmYW5nZW5cclxuXHQgICAgLm9uKFwibW91c2V1cFwiLCAnLnVpLXNsaWRlci1pbnB1dCcsIHdpbmRvdy5lbS5zcGVpY2hlcmVIQXJ0KVxyXG5cdCAgICAvLyBFbmRlIGRlcyBTY2hpZWJlbnMgYWJmYW5nZW5cclxuXHQgICAgLm9uKFwic2xpZGVzdG9wXCIsICcuc3BlaWNoZXJuU2xpZGVyJywgd2luZG93LmVtLnNwZWljaGVyZUhBcnQpXHJcblx0ICAgIC8vIEVkaXRpZXJlbiB2b24gQmVvYmFjaHR1bmdlbiBtYW5hZ2VuLCBhdXNnZWhlbmQgdm9uIEFydGdydXBwZVxyXG5cdCAgICAub24oXCJjbGlja1wiLCBcIi5hQXJ0R3J1cHBlXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS56dUFydGdydXBwZW5saXN0ZSgpO1xyXG4gICAgICAgIH0pXHJcblx0ICAgIC8vIEVkaXRpZXJlbiB2b24gQmVvYmFjaHR1bmdlbiBtYW5hZ2VuLCBhdXNnZWhlbmQgdm9uIEFydE5hbWVcclxuXHQgICAgLm9uKFwiY2xpY2tcIiwgXCIuYUFydE5hbWVcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLnp1QXJ0bGlzdGUoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAkKFwiI2hBcnRFZGl0UGFnZUZvb3RlclwiKVxyXG4gICAgICAgIC8vIE5ldWUgQmVvYmFjaHR1bmcgbWFuYWdlblxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiI05ldWVCZW9iaEFydEVkaXRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZUhBcnRFZGl0TmV1ZUJlb2JoQXJ0RWRpdENsaWNrKCk7XHJcbiAgICAgICAgfSlcclxuXHQgICAgLy8gc2ljaHRiYXJlIEZlbGRlciB3w6RobGVuXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIjd2FlaGxlRmVsZGVyaEFydEVkaXRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZUhBcnRFZGl0V8OkaGxlRmVsZGVyQ2xpY2soKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC8vIENvZGUgZsO8ciBkZW4gQXJ0LUzDtnNjaGVuLURpYWxvZ1xyXG4gICAgICAgIC5vbignY2xpY2snLCAnI0xvZXNjaGVCZW9iaEFydEVkaXQnLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAkKFwiI2hhZV9sw7ZzY2hlbl9tZWxkdW5nXCIpLnBvcHVwKFwib3BlblwiKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC8vIENvZGUgZsO8ciBkZW4gQXJ0LUzDtnNjaGVuLURpYWxvZ1xyXG4gICAgICAgIC5vbignY2xpY2snLCAnI8O2ZmZuZWhBcnRFZGl0TGlzdGUnLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAkLm1vYmlsZS5uYXZpZ2F0ZShcImhBcnRFZGl0TGlzdGUuaHRtbFwiKTtcclxuICAgICAgICB9KTtcclxuXHJcblx0JChcIiNoYWVfbMO2c2NoZW5fbWVsZHVuZ1wiKVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiI2hhZV9sw7ZzY2hlbl9tZWxkdW5nX2phX2xvZXNjaGVuXCIsIHdpbmRvdy5lbS5sw7ZzY2hlSEFydCk7XHJcblxyXG5cdCQoXCIjaEFydEVkaXRcIilcclxuICAgICAgICAub24oXCJzd2lwZWxlZnRcIiwgd2luZG93LmVtLmhhbmRsZUhBcnRFZGl0U3dpcGVsZWZ0KVxyXG4gICAgICAgIC5vbihcInN3aXBlcmlnaHRcIiwgd2luZG93LmVtLmhhbmRsZUhBcnRFZGl0U3dpcGVyaWdodClcclxuXHQgICAgLy8gUGFnaW5hdGlvbiBQZmVpbCB2b3JpZ2VyIGluaXRpYWxpc2llcmVuXHJcblx0ICAgIC5vbihcInZjbGlja1wiLCBcIi51aS1wYWdpbmF0aW9uLXByZXZcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLm7DpGNoc3RlVm9yaWdlQXJ0KFwidm9yaWdlXCIpO1xyXG4gICAgICAgIH0pXHJcblx0ICAgIC8vIFBhZ2luYXRpb24gUGZlaWwgbsOkY2hzdGVyIGluaXRpYWxpc2llcmVuXHJcbiAgICAgICAgLm9uKFwidmNsaWNrXCIsIFwiLnVpLXBhZ2luYXRpb24tbmV4dFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0ubsOkY2hzdGVWb3JpZ2VBcnQoXCJuw6RjaHN0ZVwiKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC8vIFBhZ2luYXRpb24gUGZlaWx0YXN0ZW4gaW5pdGlhbGlzaWVyZW5cclxuICAgICAgICAub24oXCJrZXl1cFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICAndXNlIHN0cmljdCc7XHJcbiAgICAgICAgICAgIC8vIG51ciByZWFnaWVyZW4sIHdlbm4gaEFydEVkaXQgc2ljaHRiYXIgdW5kIEZva3VzIG5pY2h0IGluIGVpbmVtIEZlbGRcclxuICAgICAgICAgICAgaWYgKCEkKGV2ZW50LnRhcmdldCkuaXMoXCJpbnB1dCwgdGV4dGFyZWEsIHNlbGVjdCwgYnV0dG9uXCIpICYmICQoJyNoQXJ0RWRpdCcpLmlzKCc6dmlzaWJsZScpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBMZWZ0IGFycm93XHJcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gJC5tb2JpbGUua2V5Q29kZS5MRUZUKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmVtLm7DpGNoc3RlVm9yaWdlQXJ0KFwidm9yaWdlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBSaWdodCBhcnJvd1xyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZXZlbnQua2V5Q29kZSA9PT0gJC5tb2JpbGUua2V5Q29kZS5SSUdIVCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5lbS5uw6RjaHN0ZVZvcmlnZUFydChcIm7DpGNoc3RlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcblx0JChcIiNGb3JtQW5ow6RuZ2VoQUVcIilcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIltuYW1lPSdMw7ZzY2hlQW5oYW5nJ11cIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZUhBcnRFZGl0TMO2c2NoZUFuaGFuZ0NsaWNrKHRoaXMpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLy8gw4RuZGVydW5nZW4gaW0gRm9ybXVsYXIgZsO8ciBBbmjDpG5nZSBzcGVpY2hlcm5cclxuICAgICAgICAub24oXCJjaGFuZ2VcIiwgXCIuc3BlaWNoZXJuQW5oYW5nXCIsIHdpbmRvdy5lbS5oYW5kbGVIQXJ0RWRpdFNwZWljaGVybkFuaGFuZ0NoYW5nZSk7XHJcblxyXG5cdCQoJyNNZW51aEFydEVkaXQnKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfYXJ0ZWlnZW5zY2hhZnRlbicsIHdpbmRvdy5lbS5oYW5kbGVIQXJ0RWRpdE1lbnVBcnRlaWdlbnNjaGFmdGVuQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9laW5mYWNoZXJfbW9kdXMnLCB3aW5kb3cuZW0uaGFuZGxlSEFydEVkaXRNZW51RWluZmFjaGVyTW9kdXNDbGljaylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2ZlbGRlcl92ZXJ3YWx0ZW4nLCB3aW5kb3cuZW0uaGFuZGxlSEFydEVkaXRNZW51RmVsZGVyVmVyd2FsdGVuQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9iZW9iX2V4cG9ydGllcmVuJywgd2luZG93LmVtLmhhbmRsZUhBcnRFZGl0TWVudUJlb2JFeHBvcnRpZXJlbkNsaWNrKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfZWluc3RlbGx1bmdlbicsIHdpbmRvdy5lbS5oYW5kbGVIQXJ0RWRpdE1lbnVFaW5zdGVsbHVuZ2VuQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9uZXVfYW5tZWxkZW4nLCB3aW5kb3cuZW0ubWVsZGVOZXVBbilcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2FydGVuZ3J1cHBlbl9pbXBvcnRpZXJlbicsIHdpbmRvdy5lbS7DtmZmbmVBcnRlbmdydXBwZW5JbXBvcnRpZXJlbilcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2FydGVuX2ltcG9ydGllcmVuJywgd2luZG93LmVtLsO2ZmZuZUFydGVuSW1wb3J0aWVyZW4pXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9hZG1pbicsIHdpbmRvdy5lbS7DtmZmbmVBZG1pbik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGhBcnRFZGl0TGlzdGUuaHRtbCBlcnNjaGVpbnRcclxud2luZG93LmVtLmhhbmRsZUhBcnRFZGl0TGlzdGVQYWdlc2hvdyA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBTb2xsdGUga2VpbmUgaWQgdm9ybGllZ2VuLCB6dSBoUHJvamVrdExpc3RlLmh0bWwgd2VjaHNlbG5cclxuXHQvLyBkYXMga29tbXQgaW0gTm9ybWFsZmFsbCBudXIgdm9yLCB3ZW5uIGRlciBDYWNoZSBkZXMgQnJvd3NlcnMgZ2VsZWVydCB3dXJkZVxyXG5cdC8vIG9kZXIgaW4gZGVyIFp3aXNjaGVuemVpdCBhdWYgZWluZW0gYW5kZXJlbiBCcm93c2VyIGRpZXNlciBEYXRlbnNhdHogZ2Vsw7ZzY2h0IHd1cmRlXHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH0gZWxzZSBpZiAoIWxvY2FsU3RvcmFnZS5TdGF0dXMgJiYgIWxvY2FsU3RvcmFnZS5oQXJ0SWQpIHtcclxuXHRcdHdpbmRvdy5lbS5sZWVyZUFsbGVWYXJpYWJlbG4oXCJvaG5lQ2xlYXJcIik7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhQcm9qZWt0TGlzdGUuaHRtbFwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0d2luZG93LmVtLmluaXRpaWVyZWhBcnRFZGl0TGlzdGUoKTtcclxufTtcclxuXHJcblxyXG5cclxuLy8gbWFuYWd0IGRlbiBBdWZiYXUgYWxsZXIgRGF0ZW4gdW5kIEZlbGRlciBmw7xyIGhBcnRFZGl0TGlzdGUuaHRtbFxyXG4vLyBBcnRsaXN0ZSB1bmQgaEFydCBob2xlblxyXG53aW5kb3cuZW0uaW5pdGlpZXJlaEFydEVkaXRMaXN0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBtYXJraWVyZW4sIGRhc3MgZGllIExpc3RlbnNpY2h0IGFrdGl2IGlzdFxyXG5cdGxvY2FsU3RvcmFnZS5oQXJ0U2ljaHQgPSBcImxpc3RlXCI7XHJcblx0Ly8gaGF0IGhBcnRFZGl0Lmh0bWwgZWluZSBoQXJ0TGlzdGUgw7xiZXJnZWJlbj9cclxuXHQvKmlmICh3aW5kb3cuZW0uaEFydExpc3RlKSB7XHJcblx0XHQvLyBCZW9ibGlzdGUgYXVzIGdsb2JhbGVyIFZhcmlhYmxlIGhvbGVuIC0gbXVzcyBuaWNodCBnZXBhcnN0IHdlcmRlblxyXG5cdFx0d2luZG93LmVtLmluaXRpaWVyZWhBcnRFZGl0TGlzdGVfMigpO1xyXG5cdH0gZWxzZSB7Ki9cclxuXHRcdC8vIEJlb2JsaXN0ZSBhdXMgREIgaG9sZW5cclxuXHRcdC8vIFByb2JsZW06IFdlbm4gaW4gaEFydEVkaXQgZWluIFdlcnQgZ2XDpG5kZXJ0IHd1cmRlLCBpc3QgZXIgc29uc3QgbmljaHQgYWt0dWVsbFxyXG5cdFx0Ly8gQWx0ZXJuYXRpdmU6IEJlaW0gU3BlaWNoZXJuIHdpbmRvdy5lbS5oQXJ0TGlzdGUgbmFjaGbDvGhyZW5cclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi52aWV3KCdldmFiL2hBcnRMaXN0ZT9zdGFydGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiLCBcIicgKyBsb2NhbFN0b3JhZ2UuWmVpdElkICsgJ1wiXSZlbmRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5FbWFpbCArICdcIiwgXCInICsgbG9jYWxTdG9yYWdlLlplaXRJZCArICdcIiAse31dJmluY2x1ZGVfZG9jcz10cnVlJywge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0dmFyIGhhcnRfcm93O1xyXG5cdFx0XHRcdC8vIExpc3RlIGJlcmVpdHN0ZWxsZW4sIHVtIERhdGVuYmFua3p1Z3JpZmZlIHp1IHJlZHV6aWVyZW5cclxuXHRcdFx0XHR3aW5kb3cuZW0uaEFydExpc3RlID0gZGF0YTtcclxuXHRcdFx0XHQvLyB3aW5kb3cuZW0uaEFydCBoZXJzdGVsbGVuLCBmYWxscyBuaWNodCB2b3JoYW5kZW5cclxuXHRcdFx0XHRpZiAoIXdpbmRvdy5lbS5oQXJ0ICYmIGxvY2FsU3RvcmFnZS5oQXJ0SWQpIHtcclxuXHRcdFx0XHRcdGhhcnRfcm93ID0gXy5maW5kKHdpbmRvdy5lbS5oQXJ0TGlzdGUucm93cywgZnVuY3Rpb24ocm93KSB7XHJcblx0XHRcdFx0XHRcdHJldHVybiByb3cuZG9jLl9pZCA9PT0gbG9jYWxTdG9yYWdlLmhBcnRJZDtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLmhBcnQgPSBoYXJ0X3Jvdy5kb2M7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLmFBcnRJZCA9IHdpbmRvdy5lbS5oQXJ0LmFBcnRJZDtcclxuICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UuYUFydE5hbWUgPSB3aW5kb3cuZW0uaEFydC5hQXJ0TmFtZTtcclxuICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UuYUFydEdydXBwZSA9IHdpbmRvdy5lbS5oQXJ0LmFBcnRHcnVwcGU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHdpbmRvdy5lbS5pbml0aWllcmVoQXJ0RWRpdExpc3RlXzIoKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0Ly99XHJcbn07XHJcblxyXG4vLyBBcnRncnVwcGUgZXJtaXR0ZWxuXHJcbndpbmRvdy5lbS5pbml0aWllcmVoQXJ0RWRpdExpc3RlXzIgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGFuekFydCA9IHdpbmRvdy5lbS5oQXJ0TGlzdGUucm93cy5sZW5ndGgsXHJcblx0XHRUaXRlbDIsXHJcblx0XHRhcnRncnVwcGVuID0gW10sXHJcblx0XHRhcnRncnVwcGU7XHJcblxyXG5cdC8vIEltIFRpdGVsIGRlciBTZWl0ZSBkaWUgQW56YWhsIEFydGVuIGFuemVpZ2VuXHJcblx0VGl0ZWwyID0gXCIgQXJ0ZW5cIjtcclxuXHRpZiAoYW56QXJ0ID09PSAxKSB7XHJcblx0XHRUaXRlbDIgPSBcIiBBcnRcIjtcclxuXHR9XHJcblx0JChcIiNoQXJ0RWRpdExpc3RlUGFnZUhlYWRlclwiKVxyXG4gICAgICAgIC5maW5kKFwiLmhBcnRFZGl0TGlzdGVQYWdlVGl0ZWxcIilcclxuICAgICAgICAudGV4dChhbnpBcnQgKyBUaXRlbDIpO1xyXG5cclxuXHRpZiAoYW56QXJ0ID09PSAwKSB7XHJcblx0XHQvLyBTb2xsdGUgbmljaHQgdm9ya29tbWVuLCB3ZWlsIG1hbiBudXIgYXVzIGVpbmVyIGV4aXN0aWVyZW5kZW4gQmVvYmFjaHR1bmcgaW4gZGllIExpc3RlIHdlY2hzZWxuIGthbm5cclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gRmVsZGVyIGJlc3RpbW1lbiwgZGllIGluIGRlciBUYWJlbGxlIGFuZ2V6ZWlndCB3ZXJkZW4ga8O2bm5lblxyXG5cdFx0Ly8gRXMgc2luZCBhbGxlIEVJTkVSIEFSVEVOR1JVUFBFXHJcblx0XHQvLyB3ZW5uIGFsc28gZGllIExpc3RlIG1laHIgYWxzIGVpbmUgQXJ0ZW5ncnVwcGUgZW50aMOkbHQsIG11c3MgZGVyIEJlbnV0emVyIGVpbmUgZGF2b24gd8OkaGxlblxyXG5cdFx0Ly8gYWxzbyB6dWVyc3QgZWluZSBMaXN0ZSBkZXIgQXJ0ZW5ncnVwcGVuIGVyc3RlbGxlblxyXG5cdFx0Xy5lYWNoKHdpbmRvdy5lbS5oQXJ0TGlzdGUucm93cywgZnVuY3Rpb24ocm93KSB7XHJcblx0XHRcdGlmIChyb3cuZG9jLmFBcnRHcnVwcGUpIHtcclxuXHRcdFx0XHRhcnRncnVwcGVuLnB1c2gocm93LmRvYy5hQXJ0R3J1cHBlKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHQvLyBhcnRncnVwcGVuLWFycmF5IHJlZHV6aWVyZW4sIGRhbWl0IGplZGUgQXJ0Z3J1cHBlIG51ciBlaW4gbWFsIHZvcmtvbW10XHJcblx0XHRhcnRncnVwcGVuID0gXy51bmlxKGFydGdydXBwZW4pO1xyXG5cdFx0aWYgKCghd2luZG93LmVtLmhBcnQgfHwgIXdpbmRvdy5lbS5oQXJ0LmFBcnRHcnVwcGUpICYmIGFydGdydXBwZW4ubGVuZ3RoID4gMSkge1xyXG5cdFx0XHQvLyBCZW51dHplciBtdXNzIGVpbmUgQXJ0Z3J1cHBlIHfDpGhsZW5cclxuXHRcdFx0JChcIiNoYWVsX2FydGdydXBwZW5fcG9wdXBfZmllbGRjb250YWluXCIpLmh0bWwod2luZG93LmVtLmVyc3RlbGxlSHRtbEbDvHJIYWVsQXJ0Z3J1cHBlblBvcHVwUmFkaW9ncm91cChhcnRncnVwcGVuKSkudHJpZ2dlcihcImNyZWF0ZVwiKTtcclxuXHRcdFx0JChcIiNoYWVsX2FydGdydXBwZW5fcG9wdXBcIikucG9wdXAoKS5wb3B1cChcIm9wZW5cIik7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQvLyBkaWUgQXJ0Z3J1cHBlbiBkZXIgenVsZXR6dCBnZXfDpGhsdGVuIEFydCBuZWhtZW5cclxuXHRcdFx0YXJ0Z3J1cHBlID0gd2luZG93LmVtLmhBcnQuYUFydEdydXBwZTtcclxuXHRcdFx0d2luZG93LmVtLmluaXRpaWVyZWhBcnRFZGl0TGlzdGVfMyhhcnRncnVwcGUpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxufTtcclxuXHJcbi8vIEZlbGRsaXN0ZSBob2xlblxyXG53aW5kb3cuZW0uaW5pdGlpZXJlaEFydEVkaXRMaXN0ZV8zID0gZnVuY3Rpb24oYXJ0Z3J1cHBlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIHByw7xmZW4sIG9iIGRpZSBGZWxkbGlzdGUgc2Nob24gZ2Vob2x0IHd1cmRlXHJcblx0Ly8gd2VubiBqYTogZGVyZW4gZ2xvYmFsZSBWYXJpYWJsZSB2ZXJ3ZW5kZW5cclxuXHQvLyBpbW1lciBuZXUgaG9sZW4sIHNvbnN0IGhhdCBtYW4gdmVyYWx0ZXRlIERhdGVuLCB3ZW5uIHp1dm9yIGluIGhBcnRFZGl0IEZlbGRlciBnZcOkbmRlcnQgd3VyZGVuXHJcblx0LyppZiAod2luZG93LmVtLkZlbGRsaXN0ZWhBcnRFZGl0TGlzdGUpIHtcclxuXHRcdHdpbmRvdy5lbS5pbml0aWllcmVoQXJ0RWRpdExpc3RlXzQoYXJ0Z3J1cHBlKTtcclxuXHR9IGVsc2UgeyovXHJcblx0XHQvLyBGZWxkbGlzdGUgYXVzIGRlciBEQiBob2xlblxyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLnZpZXcoJ2V2YWIvRmVsZExpc3RlQXJ0P2luY2x1ZGVfZG9jcz10cnVlJywge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLkZlbGRsaXN0ZWhBcnRFZGl0TGlzdGUgPSBkYXRhO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5pbml0aWllcmVoQXJ0RWRpdExpc3RlXzQoYXJ0Z3J1cHBlKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0Ly99XHJcblx0XHJcbn07XHJcblxyXG4vLyBiYXV0IGRhcyBIVE1MIGbDvHIgZGllIGhBcnRFZGl0TGlzdGVGb3JtIGF1ZlxyXG53aW5kb3cuZW0uaW5pdGlpZXJlaEFydEVkaXRMaXN0ZV80ID0gZnVuY3Rpb24oYXJ0Z3J1cHBlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBodG1sQ29udGFpbmVyID0gJzx0YWJsZSBpZD1cImhBcnRFZGl0TGlzdGVUYWJsZVwiIGRhdGEtcm9sZT1cInRhYmxlXCIgY2xhc3M9XCJ1aS1ib2R5LWQgdWktcmVzcG9uc2l2ZSBmZWxkZXJfdGFiZWxsZVwiIGRhdGEtbW9kZT1cInJlZmxvd1wiPicsXHJcblx0XHRodG1sQ29udGFpbmVySGVhZCxcclxuXHRcdGh0bWxDb250YWluZXJCb2R5LFxyXG5cdFx0ZmVsZGxpc3RlID0gW10sXHJcblx0XHRiZW9iX2Rlcl9nZXfDpGhsdGVuX2FydGdydXBwZV9yb3dzO1xyXG5cclxuXHQvLyB6dWVyc3QgbWFsIGVybWl0dGVsbiwgd2VsY2hlIEZlbGRlciBmw7xyIGRpZXNlIEFydGdydXBwZSB1bmQgZGllc2VuIFVzZXIgaW0gRm9ybXVsYXIgZWluZ2VibGVuZGV0IHdlcmRlbiBzb2xsZW5cclxuXHRfLmVhY2god2luZG93LmVtLkZlbGRsaXN0ZWhBcnRFZGl0TGlzdGUucm93cywgZnVuY3Rpb24ocm93KSB7XHJcblx0XHR2YXIgRmVsZCA9IHJvdy5kb2MsXHJcblx0XHRcdEZlbGROYW1lID0gRmVsZC5GZWxkTmFtZTtcclxuXHRcdGlmIChGZWxkLkhpZXJhcmNoaWVzdHVmZSA9PT0gXCJBcnRcIiAmJiAoRmVsZC5Vc2VyID09PSBsb2NhbFN0b3JhZ2UuRW1haWwgfHwgRmVsZC5Vc2VyID09PSBcIlplbnRyZW5CZEt0XCIpICYmIEZlbGQuU2ljaHRiYXJJbkhBcnRFZGl0TGlzdGUgJiYgRmVsZC5TaWNodGJhckluSEFydEVkaXRMaXN0ZS5pbmRleE9mKGxvY2FsU3RvcmFnZS5FbWFpbCkgIT09IC0xICYmICh0eXBlb2YgRmVsZC5BcnRHcnVwcGUgIT09IFwidW5kZWZpbmVkXCIgJiYgKEZlbGQuQXJ0R3J1cHBlLmluZGV4T2YoYXJ0Z3J1cHBlKSA+PSAwIHx8IEZlbGQuQXJ0R3J1cHBlWzBdID09PSBcImFsbGVcIikpICYmIChGZWxkTmFtZSAhPT0gXCJhQXJ0SWRcIikgJiYgKEZlbGROYW1lICE9PSBcImFBcnRHcnVwcGVcIikgJiYgKEZlbGROYW1lICE9PSBcImFBcnROYW1lXCIpKSB7XHJcblx0XHRcdGZlbGRsaXN0ZS5wdXNoKEZlbGQpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHQvLyBtaXQgZGllc2VuIEZlbGRlcm4gZGVuIEhlYWQgYXVmYmF1ZW5cclxuXHQvLyBkYXp1IHdpcmQgZGVyIEZlbGRuYW1lIGdlYnJhdWNodFxyXG5cdC8vIERpZSBBcnQgd2lyZCBpbW1lciBhbmdlemVpZ3RcclxuXHRodG1sQ29udGFpbmVySGVhZCA9ICc8dGhlYWQ+PHRyIGNsYXNzPVwidWktYmFyLWRcIj48dGggZGF0YS1wcmlvcml0eT1cIjFcIj5BcnQ8L3RoPic7XHJcblx0Xy5lYWNoKGZlbGRsaXN0ZSwgZnVuY3Rpb24oZmVsZCkge1xyXG5cdFx0aHRtbENvbnRhaW5lckhlYWQgKz0gJzx0aD4nO1xyXG5cdFx0aHRtbENvbnRhaW5lckhlYWQgKz0gZmVsZC5GZWxkQmVzY2hyaWZ0dW5nO1xyXG5cdFx0aHRtbENvbnRhaW5lckhlYWQgKz0gJzwvdGg+JztcclxuXHR9KTtcclxuXHRodG1sQ29udGFpbmVySGVhZCArPSAnPC90cj48L3RoZWFkPic7XHJcblxyXG5cdC8vIERlbiBCb2R5IGF1ZmJhdWVuXHJcblx0aHRtbENvbnRhaW5lckJvZHkgPSAnPHRib2R5Pic7XHJcblx0Ly8gQmVvYmFjaHR1bmdlbiBkZXIgZ2V3w6RobHRlbiBBcnRncnVwcGUgd8OkaGxlblxyXG5cdGJlb2JfZGVyX2dld8OkaGx0ZW5fYXJ0Z3J1cHBlX3Jvd3MgPSBfLmZpbHRlcih3aW5kb3cuZW0uaEFydExpc3RlLnJvd3MsIGZ1bmN0aW9uKHJvdykge1xyXG5cdFx0cmV0dXJuIHJvdy5kb2MuYUFydEdydXBwZSA9PT0gYXJ0Z3J1cHBlO1xyXG5cdH0pO1xyXG5cdC8vIHBybyBoQXJ0IGRhcyBodG1sIGVyemV1Z2VuXHJcblx0Xy5lYWNoKGJlb2JfZGVyX2dld8OkaGx0ZW5fYXJ0Z3J1cHBlX3Jvd3MsIGZ1bmN0aW9uKHJvdykge1xyXG5cdFx0dmFyIGhhcnQgPSByb3cuZG9jLFxyXG5cdFx0XHRvcHRpb25lbiA9IFtdLFxyXG5cdFx0XHRhcnRuYW1lID0gaGFydC5hQXJ0TmFtZTtcclxuXHRcdG9wdGlvbmVuLnB1c2goaGFydC5hQXJ0TmFtZSk7XHJcblx0XHRodG1sQ29udGFpbmVyQm9keSArPSAnPHRyIGNsYXNzPVwiaGFydFwiIGhhcnRpZD1cIic7XHJcblx0XHRodG1sQ29udGFpbmVyQm9keSArPSBoYXJ0Ll9pZDtcclxuXHRcdGh0bWxDb250YWluZXJCb2R5ICs9ICdcIj4nO1xyXG5cdFx0Ly8gQXJ0bmFtZSBlcmfDpG56ZW5cclxuXHRcdGh0bWxDb250YWluZXJCb2R5ICs9ICc8dGQ+JztcclxuXHRcdGh0bWxDb250YWluZXJCb2R5ICs9IHdpbmRvdy5lbS5nZW5lcmllcmVIdG1sRsO8clNlbGVjdG1lbnUoXCJhQXJ0TmFtZV9oYWVsXCIsIFwiXCIsIGFydG5hbWUsIG9wdGlvbmVuLCBcIlNpbmdsZVNlbGVjdFwiLCB0cnVlLCBcImFycm93LXJcIik7XHJcblx0XHRodG1sQ29udGFpbmVyQm9keSArPSAnPC90ZD4nO1xyXG5cdFx0Ly8gZHluYW1pc2NoZSBGZWxkZXIgc2V0emVuXHJcblx0XHRfLmVhY2goZmVsZGxpc3RlLCBmdW5jdGlvbihmZWxkKSB7XHJcblx0XHRcdHZhciBGZWxkTmFtZSA9IGZlbGQuRmVsZE5hbWUsXHJcblx0XHRcdFx0RmVsZFdlcnQ7XHJcblx0XHRcdC8vIGZlbGR3ZXJ0IHNldHplblxyXG5cdFx0XHRpZiAod2luZG93LmVtLmhBcnRbRmVsZE5hbWVdICYmIGxvY2FsU3RvcmFnZS5TdGF0dXMgPT09IFwibmV1XCIgJiYgZmVsZC5TdGFuZGFyZHdlcnQgJiYgZmVsZC5TdGFuZGFyZHdlcnRbd2luZG93LmVtLmhBcnQuVXNlcl0pIHtcclxuXHRcdFx0XHRGZWxkV2VydCA9IGZlbGQuU3RhbmRhcmR3ZXJ0W3dpbmRvdy5lbS5oQXJ0LlVzZXJdO1xyXG5cdFx0XHRcdC8vIE9iamVrdCB3aW5kb3cuZW0uaEFydCB1bSBkZW4gU3RhbmRhcmR3ZXJ0IGVyZ8OkbnplbiwgdW0gc3DDpHRlciB6dSBzcGVpY2hlcm5cclxuXHRcdFx0XHR3aW5kb3cuZW0uaEFydFtGZWxkTmFtZV0gPSBGZWxkV2VydDtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvL1wiXCIgdmVyaGluZGVydCwgZGFzcyBpbSBGZWxkIHVuZGVmaW5lZCBlcnNjaGVpbnRcclxuXHRcdFx0XHRGZWxkV2VydCA9IGhhcnRbRmVsZE5hbWVdIHx8IFwiXCI7XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gaHRtbCBnZW5lcmllcmVuXHJcblx0XHRcdGh0bWxDb250YWluZXJCb2R5ICs9ICc8dGQ+JztcclxuXHRcdFx0aHRtbENvbnRhaW5lckJvZHkgKz0gd2luZG93LmVtLmdlbmVyaWVyZUh0bWxGw7xyRm9ybXVsYXJlbGVtZW50KGZlbGQsIEZlbGRXZXJ0LCB0cnVlKTtcclxuXHRcdFx0aHRtbENvbnRhaW5lckJvZHkgKz0gJzwvdGQ+JztcclxuXHRcdH0pO1xyXG5cdFx0Ly8gVGFiZWxsZW56ZWlsZSBhYnNjaGxpZXNzZW5cclxuXHRcdGh0bWxDb250YWluZXJCb2R5ICs9ICc8L3RyPic7XHJcblx0fSk7XHJcblx0XHRcclxuXHRodG1sQ29udGFpbmVyQm9keSArPSAnPC90Ym9keT4nO1xyXG5cclxuXHQvLyBoZWFkIHVuZCBib2R5IHp1c2FtbWVuc2V0emVuXHJcblx0aHRtbENvbnRhaW5lciArPSBodG1sQ29udGFpbmVySGVhZDtcclxuXHRodG1sQ29udGFpbmVyICs9IGh0bWxDb250YWluZXJCb2R5O1xyXG5cdC8vIFRhYmVsbGUgYWJzY2hsaWVzc2VuXHJcblx0aHRtbENvbnRhaW5lciArPSAnPC90YWJsZT4nO1xyXG5cclxuXHQvLyBodG1sQ29udGFpbmVyIGluIEZvcm11bGFyIHNldHplblxyXG5cdCQoXCIjaEFydEVkaXRMaXN0ZUZvcm1cIikuaHRtbChodG1sQ29udGFpbmVyKS50cmlnZ2VyKFwiY3JlYXRlXCIpLnRyaWdnZXIoXCJyZWZyZXNoXCIpO1xyXG5cdCQoXCIjaEFydEVkaXRMaXN0ZVRhYmxlXCIpLnRhYmxlKCkudGFibGUoXCJyZWZyZXNoXCIpO1xyXG4gICAgLy8gamV0enQgYWxsZSBGbGlwc3dpdHNjaGVzLCBkaWUgXCJuZWluXCIgc2luZCwgYWt0aXYgc2V0emVuXHJcbiAgICBfLmVhY2goYmVvYl9kZXJfZ2V3w6RobHRlbl9hcnRncnVwcGVfcm93cywgZnVuY3Rpb24ocm93KSB7XHJcbiAgICAgICAgd2luZG93LmVtLmFrdGl2aWVyZUZsaXBzd2l0Y2hlcyhcIltoYXJ0aWQ9J1wiICsgcm93LmlkICsgXCInXVwiLCByb3cuZG9jKTtcclxuICAgIH0pO1xyXG5cdC8vIE1lbnVzIGJsZW5kZW4gdW5kIGxldHp0ZSB1cmwgc3BlaWNoZXJuXHJcblx0d2luZG93LmVtLmJsZW5kZU1lbnVzKCk7XHJcblx0d2luZG93LmVtLnNwZWljaGVyZUxldHp0ZVVybCgpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmVyc3RlbGxlSHRtbEbDvHJIYWVsQXJ0Z3J1cHBlblBvcHVwUmFkaW9ncm91cCA9IGZ1bmN0aW9uKGFydGdydXBwZW4pIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGh0bWwgPSAnPGZpZWxkc2V0IGlkPVwiaGFlbF9hcnRncnVwcGVuX3BvcHVwX2ZpZWxkc2V0XCIgZGF0YS1yb2xlPVwiY29udHJvbGdyb3VwXCI+JztcclxuXHRfLmVhY2goYXJ0Z3J1cHBlbiwgZnVuY3Rpb24oYXJ0Z3J1cHBlKSB7XHJcblx0XHRodG1sICs9ICc8aW5wdXQgdHlwZT1cInJhZGlvXCIgbmFtZT1cImhhZWxfYXJ0Z3J1cHBlbl9wb3B1cF9pbnB1dFwiIGlkPVwiaGFlbF8nO1xyXG5cdFx0aHRtbCArPSBhcnRncnVwcGU7XHJcblx0XHRodG1sICs9ICdcIiB2YWx1ZT1cIic7XHJcblx0XHRodG1sICs9IGFydGdydXBwZTtcclxuXHRcdGh0bWwgKz0gJ1wiIGNsYXNzPVwiaGFlbF9hcnRncnVwcGVuX3BvcHVwX2lucHV0XCI+JztcclxuXHRcdGh0bWwgKz0gJzxsYWJlbCBmb3I9XCJoYWVsXyc7XHJcblx0XHRodG1sICs9IGFydGdydXBwZTtcclxuXHRcdGh0bWwgKz0gJ1wiIGNsYXNzPVwiaGFlbF9hcnRncnVwcGVuX3BvcHVwX2lucHV0X2xhYmVsXCIgYXJ0Z3J1cHBlPVwiJztcclxuXHRcdGh0bWwgKz0gYXJ0Z3J1cHBlO1xyXG5cdFx0aHRtbCArPSAnXCI+JztcclxuXHRcdGh0bWwgKz0gYXJ0Z3J1cHBlO1xyXG5cdFx0aHRtbCArPSAnPC9sYWJlbD4nO1xyXG5cdH0pO1xyXG5cdGh0bWwgKz0gJzwvZmllbGRzZXQ+JztcclxuXHRyZXR1cm4gaHRtbDtcclxufTtcclxuXHJcbi8vIG1hbmFndCBkYXMgSW5pdGlhbGlzaWVyZW4gZWluZXIgQXJ0IGluIGhBcnRFZGl0TGlzdGUuaHRtbFxyXG4vLyBlcndhcnRldCBkaWUgaEFydElkXHJcbi8vIHdpcmQgYXVmZ2VydWZlbiB2b24gaEFydEVkaXRMaXN0ZS5odG1sLCB3ZW5uIGRlciBGb2t1cyBpbiBlaW5lbiBEYXRlbnNhdHoga29tbXRcclxud2luZG93LmVtLmluaXRpaWVyZWhBcnRFZGl0TGlzdGVBcnQgPSBmdW5jdGlvbihoYXJ0aWQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gSW5mb3MgenVyIEFydCBob2xlblxyXG5cdC8vIGFjaHR1bmc6IHdlbm4gc29lYmVuIGRpZSBBcnQgZ2XDpG5kZXJ0IHd1cmRlLCBtw7xzc2VuIEFydElkIHVuZCBBcnROYW1lIG5ldSBnZWhvbHQgd2VyZGVuXHJcblx0aWYgKHdpbmRvdy5lbS5oQXJ0ICYmIHdpbmRvdy5lbS5oQXJ0Ll9pZCA9PT0gaGFydGlkICYmICghbG9jYWxTdG9yYWdlLlZvbiB8fCBsb2NhbFN0b3JhZ2UuVm9uICE9PSBcImhBcnRFZGl0XCIpKSB7XHJcblx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlaEFydEVkaXRMaXN0ZUFydF8yKHdpbmRvdy5lbS5oQXJ0KTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLm9wZW5Eb2MoaGFydGlkLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaEFydCA9IGRhdGE7XHJcblx0XHRcdFx0d2luZG93LmVtLmluaXRpaWVyZWhBcnRFZGl0TGlzdGVBcnRfMihkYXRhKTtcclxuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5hQXJ0SWQgPSB3aW5kb3cuZW0uaEFydC5hQXJ0SWQ7XHJcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UuYUFydE5hbWUgPSB3aW5kb3cuZW0uaEFydC5hQXJ0TmFtZTtcclxuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5hQXJ0R3J1cHBlID0gd2luZG93LmVtLmhBcnQuYUFydEdydXBwZTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLmluaXRpaWVyZWhBcnRFZGl0TGlzdGVBcnRfMiA9IGZ1bmN0aW9uKGhhcnQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gYmVpIG5ldWVuIGhBcnQgaGF0IGRhcyBPYmpla3Qgbm9jaCBrZWluZSBJRFxyXG5cdGlmIChoYXJ0Ll9pZCkge1xyXG5cdFx0bG9jYWxTdG9yYWdlLmhBcnRJZCA9IGhhcnQuX2lkO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRsb2NhbFN0b3JhZ2UuaEFydElkID0gXCJuZXVcIjtcclxuXHR9XHJcblx0bG9jYWxTdG9yYWdlLmFBcnRHcnVwcGUgPSBoYXJ0LmFBcnRHcnVwcGU7XHJcblx0bG9jYWxTdG9yYWdlLmFBcnROYW1lID0gaGFydC5hQXJ0TmFtZTtcclxuXHRsb2NhbFN0b3JhZ2UuYUFydElkID0gaGFydC5hQXJ0SWQ7XHJcbn07XHJcblxyXG4vLyBnZW5lcmllcnQgZHluYW1pc2NoIGRpZSBBcnRncnVwcGVuLWFiaMOkbmdpZ2VuIEZlbGRlclxyXG4vLyBNaXRnZWJlbjogRmVsZGxpc3RlLCBCZW9iYWNodHVuZ1xyXG53aW5kb3cuZW0uZXJzdGVsbGVEeW5hbWlzY2hlRmVsZGVyaEFydEVkaXRMaXN0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgaHRtbENvbnRhaW5lciA9IHdpbmRvdy5lbS5nZW5lcmllcmVIdG1sRsO8cmhBcnRFZGl0TGlzdGVGb3JtKCk7XHJcblx0Ly8gTGluaWUgbnVyIGFuZsO8Z2VuLCB3ZW5uIEZlbGRlciBlcnN0ZWxsdCB3dXJkZW5cclxuXHRpZiAoaHRtbENvbnRhaW5lcikge1xyXG5cdFx0aHRtbENvbnRhaW5lciA9IFwiPGhyIC8+XCIgKyBodG1sQ29udGFpbmVyO1xyXG5cdH1cclxuXHQkKFwiI2hBcnRFZGl0TGlzdGVGb3JtSHRtbFwiKS5odG1sKGh0bWxDb250YWluZXIpLnRyaWdnZXIoXCJjcmVhdGVcIikudHJpZ2dlcihcInJlZnJlc2hcIik7XHJcblx0d2luZG93LmVtLmJsZW5kZU1lbnVzKCk7XHJcblx0Ly8gbGV0enRlIHVybCBzcGVpY2hlcm4gLSBoaWVyIHVuZCBuaWNodCBpbSBwYWdlc2hvdywgZGFtaXQgZXMgYmVpIGplZGVtIERhdGVuc2F0endlY2hzZWwgcGFzc2llcnRcclxuXHR3aW5kb3cuZW0uc3BlaWNoZXJlTGV0enRlVXJsKCk7XHJcbn07XHJcblxyXG4vLyBnZW5lcmllcnQgZGFzIEh0bWwgZsO8ciBGb3JtdWxhciBpbiBoQXJ0RWRpdC5odG1sXHJcbi8vIGVyd2FydGV0IEFydEdydXBwZTsgRmVsZGxpc3RlIGFscyBPYmpla3Q7IEJlb2JhY2h0dW5nIGFscyBPYmpla3RcclxuLy8gZGVyIGh0bWxDb250YWluZXIgd2lyZCB6dXLDvGNrIGdlZ2ViZW5cclxud2luZG93LmVtLmdlbmVyaWVyZUh0bWxGw7xyaEFydEVkaXRMaXN0ZUZvcm0gPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIEZlbGQgPSB7fSxcclxuXHRcdEZlbGROYW1lLFxyXG4gICAgICAgIEZlbGRXZXJ0LFxyXG5cdFx0aHRtbENvbnRhaW5lciA9IFwiXCIsXHJcblx0XHRBcnRHcnVwcGUgPSB3aW5kb3cuZW0uaEFydC5hQXJ0R3J1cHBlO1xyXG5cdF8uZWFjaCh3aW5kb3cuZW0uRmVsZGxpc3RlaEFydEVkaXRMaXN0ZS5yb3dzLCBmdW5jdGlvbihyb3cpIHtcclxuXHRcdEZlbGQgPSByb3cuZG9jO1xyXG5cdFx0RmVsZE5hbWUgPSBGZWxkLkZlbGROYW1lO1xyXG5cdFx0Ly8gbnVyIHNpY2h0YmFyZSBlaWdlbmUgRmVsZGVyLiBCZXJlaXRzIGltIEZvcm11bGFyIGludGVncmllcnRlIEZlbGRlciBuaWNodCBhbnplaWdlblxyXG5cdFx0Ly8gVm9yc2ljaHQ6IEVyZmFzc3QgamVtYW5kIGVpbiBGZWxkIGRlciBIaWVyYXJjaGllc3R1ZmUgQXJ0IG9obmUgQXJ0Z3J1cHBlLCBzb2xsdGUgZGFzIGtlaW5lbiBGZWhsZXIgYXVzbMO2c2VuXHJcblx0XHRpZiAoKEZlbGQuVXNlciA9PT0gd2luZG93LmVtLmhBcnQuVXNlciB8fCBGZWxkLlVzZXIgPT09IFwiWmVudHJlbkJkS3RcIikgJiYgRmVsZC5TaWNodGJhckluSEFydEVkaXRMaXN0ZS5pbmRleE9mKHdpbmRvdy5lbS5oQXJ0LlVzZXIpICE9PSAtMSAmJiAodHlwZW9mIEZlbGQuQXJ0R3J1cHBlICE9PSBcInVuZGVmaW5lZFwiICYmIChGZWxkLkFydEdydXBwZS5pbmRleE9mKEFydEdydXBwZSkgPj0gMCB8fCBGZWxkLkFydEdydXBwZVswXSA9PT0gXCJhbGxlXCIpKSAmJiAoRmVsZE5hbWUgIT09IFwiYUFydElkXCIpICYmIChGZWxkTmFtZSAhPT0gXCJhQXJ0R3J1cHBlXCIpICYmIChGZWxkTmFtZSAhPT0gXCJhQXJ0TmFtZVwiKSkge1xyXG5cdFx0XHRpZiAod2luZG93LmVtLmhBcnRbRmVsZE5hbWVdICYmIGxvY2FsU3RvcmFnZS5TdGF0dXMgPT09IFwibmV1XCIgJiYgRmVsZC5TdGFuZGFyZHdlcnQgJiYgRmVsZC5TdGFuZGFyZHdlcnRbd2luZG93LmVtLmhBcnQuVXNlcl0pIHtcclxuXHRcdFx0XHRGZWxkV2VydCA9IEZlbGQuU3RhbmRhcmR3ZXJ0W3dpbmRvdy5lbS5oQXJ0LlVzZXJdO1xyXG5cdFx0XHRcdC8vIE9iamVrdCB3aW5kb3cuZW0uaEFydCB1bSBkZW4gU3RhbmRhcmR3ZXJ0IGVyZ8OkbnplbiwgdW0gc3DDpHRlciB6dSBzcGVpY2hlcm5cclxuXHRcdFx0XHR3aW5kb3cuZW0uaEFydFtGZWxkTmFtZV0gPSBGZWxkV2VydDtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvL1wiXCIgdmVyaGluZGVydCwgZGFzcyBpbSBGZWxkIHVuZGVmaW5lZCBlcnNjaGVpbnRcclxuXHRcdFx0XHRGZWxkV2VydCA9IHdpbmRvdy5lbS5oQXJ0W0ZlbGROYW1lXSB8fCBcIlwiO1xyXG5cdFx0XHR9XHJcblx0XHRcdGh0bWxDb250YWluZXIgKz0gd2luZG93LmVtLmdlbmVyaWVyZUh0bWxGw7xyRm9ybXVsYXJlbGVtZW50KEZlbGQsIEZlbGRXZXJ0KTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHRpZiAobG9jYWxTdG9yYWdlLlN0YXR1cyA9PT0gXCJuZXVcIikge1xyXG5cdFx0Ly8gaW4gbmV1ZW4gRGF0ZW5zw6R0emVuIGR5bmFtaXNjaCBlcnN0ZWxsdGUgU3RhbmRhcmR3ZXJ0ZSBzcGVpY2hlcm5cclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi5zYXZlRG9jKHdpbmRvdy5lbS5oQXJ0LCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaEFydC5faWQgPSBkYXRhLmlkO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5oQXJ0Ll9yZXYgPSBkYXRhLnJldjtcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UuaEFydElkID0gZGF0YS5pZDtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLlN0YXR1cztcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gTmV1ZSBEYXRlbnPDpHR6ZSBoYWJlbiBrZWluZSBBbmjDpG5nZVxyXG5cdFx0d2luZG93LmVtLnplaWdlQXR0YWNobWVudHMod2luZG93LmVtLmhBcnQsIFwiaEFFXCIpO1xyXG5cdH1cclxuXHRyZXR1cm4gaHRtbENvbnRhaW5lcjtcclxufTtcclxuXHJcbi8vIHdlbm4gaEFydEVkaXRMaXN0ZS5odG1sIGluaXRpaWVydCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIQXJ0RWRpdExpc3RlUGFnZWluaXQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gV2lyZCBkaWVzZSBTZWl0ZSBkaXJla3QgYXVmZ2VydWZlbiB1bmQgZXMgZ2lidCBrZWluZW4gbG9jYWxTdG9yYWdlLFxyXG5cdC8vIG11c3MgYXVmIGluZGV4Lmh0bWwgdW1nZWxlaXRldCB3ZXJkZW5cclxuXHRpZiAobG9jYWxTdG9yYWdlLmxlbmd0aCA9PT0gMCB8fCAhbG9jYWxTdG9yYWdlLkVtYWlsKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKCk7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImluZGV4Lmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fSBlbHNlIGlmICgoIWxvY2FsU3RvcmFnZS5TdGF0dXMgfHwgbG9jYWxTdG9yYWdlLlN0YXR1cyA9PT0gXCJ1bmRlZmluZWRcIikgJiYgKCFsb2NhbFN0b3JhZ2UuaEFydElkIHx8IGxvY2FsU3RvcmFnZS5oQXJ0SWQgPT09IFwidW5kZWZpbmVkXCIpKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKFwib2huZUNsZWFyXCIpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJoUHJvamVrdExpc3RlLmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHQkKFwiI2hBcnRFZGl0TGlzdGVQYWdlSGVhZGVyXCIpXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCJbbmFtZT0nT2VmZm5lQXJ0TGlzdGVoQXJ0RWRpdCddXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVIQXJ0RWRpdMOWZmZuZUFydExpc3RlaEFydEVkaXRDbGljaygpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIuT2VmZm5lWmVpdGhBcnRFZGl0XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVIQXJ0RWRpdMOWZmZuZVplaXRoQXJ0RWRpdENsaWNrKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIi5PZWZmbmVPcnRoQXJ0RWRpdFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlSEFydEVkaXTDlmZmbmVPcnRoQXJ0RWRpdENsaWNrKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIi5PZWZmbmVSYXVtaEFydEVkaXRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZUhBcnRFZGl0w5ZmZm5lUmF1bWhBcnRFZGl0Q2xpY2soKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiLk9lZmZuZVByb2pla3RoQXJ0RWRpdFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlSEFydEVkaXTDlmZmbmVQcm9qZWt0aEFydEVkaXRDbGljaygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHQkKFwiI2hBcnRFZGl0TGlzdGVGb3JtXCIpXHJcbiAgICAgICAgLy8gRsO8ciBqZWRlcyBGZWxkIGJlaSDDhG5kZXJ1bmcgc3BlaWNoZXJuXHJcbiAgICAgICAgLm9uKFwiY2hhbmdlXCIsIFwiLnNwZWljaGVyblwiLCB3aW5kb3cuZW0uc3BlaWNoZXJlSEFydClcclxuICAgICAgICAvLyBFaW5nYWJlIGltIFphaGxlbmZlbGQgYWJmYW5nZW5cclxuICAgICAgICAub24oXCJibHVyXCIsICcuc3BlaWNoZXJuU2xpZGVyJywgd2luZG93LmVtLnNwZWljaGVyZUhBcnQpXHJcbiAgICAgICAgLy8gS2xpY2tlbiBhdWYgZGVuIFBmZWlsZW4gaW0gWmFobGVuZmVsZCBhYmZhbmdlblxyXG4gICAgICAgIC5vbihcIm1vdXNldXBcIiwgJy51aS1zbGlkZXItaW5wdXQnLCB3aW5kb3cuZW0uc3BlaWNoZXJlSEFydClcclxuICAgICAgICAvLyBFbmRlIGRlcyBTY2hpZWJlbnMgYWJmYW5nZW5cclxuICAgICAgICAub24oXCJzbGlkZXN0b3BcIiwgJy5zcGVpY2hlcm5TbGlkZXInLCB3aW5kb3cuZW0uc3BlaWNoZXJlSEFydClcclxuICAgICAgICAvLyBTb2JhbGQgYXVmIGVpbmVuIERhdGVuc2F0eiBnZWtsaWNrdCB3aXJkLCBpaG4gaW5pdGlpZXJlbiAtIGZhbGxzIG5vY2ggbmljaHQgZ2VzY2hlaGVuXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIuaGFydFwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgICAgICAgICB2YXIgaGFydGlkID0gJCh0aGlzKS5hdHRyKFwiaGFydGlkXCIpO1xyXG4gICAgICAgICAgICBpZiAoIWxvY2FsU3RvcmFnZS5oQXJ0SWQgfHwgbG9jYWxTdG9yYWdlLmhBcnRJZCAhPT0gaGFydGlkKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBkaWUgQXJ0IG11c3MgaW5pdGlpZXJ0IHdlcmRlblxyXG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLmhBcnRJZCA9IGhhcnRpZDtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5lbS5pbml0aWllcmVoQXJ0RWRpdExpc3RlQXJ0KGhhcnRpZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcblx0JChcIiNoQXJ0RWRpdExpc3RlUGFnZUZvb3RlclwiKVxyXG4gICAgICAgIC8vIE5ldWUgQmVvYmFjaHR1bmcgbWFuYWdlblxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiI05ldWVCZW9iaEFydEVkaXRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZUhBcnRFZGl0TmV1ZUJlb2JoQXJ0RWRpdENsaWNrKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAvLyBzaWNodGJhcmUgRmVsZGVyIHfDpGhsZW5cclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiN3YWVobGVGZWxkZXJoQXJ0RWRpdExpc3RlXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVIQXJ0RWRpdExpc3RlV8OkaGxlRmVsZGVyQ2xpY2soKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC8vIEluIEVpbnplbGFuc2ljaHQgd2VjaHNlbG5cclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiNoQXJ0RWRpdExpc3RlRWluemVsc2ljaHRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgJC5tb2JpbGUubmF2aWdhdGUoXCJoQXJ0RWRpdC5odG1sXCIpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHQkKFwiI2hBcnRFZGl0TGlzdGVcIilcclxuICAgICAgICAvLyBFZGl0aWVyZW4gdm9uIEJlb2JhY2h0dW5nZW4gbWFuYWdlbiwgYXVzZ2VoZW5kIHZvbiBBcnROYW1lXHJcbiAgICAgICAgLy8gaXJnZW5kd2llIGZ1bmt0aW9uaWVydCBkYXMgaGllciBuaWNodC4gS2VpbmUgQWhudW5nIHdpZXNvXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCJbbmFtZT0nYUFydE5hbWVfaGFlbCddXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS56dUFydGxpc3RlKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAvLyBkYXJ1bSBzbyBnZWdyaWZmZW46XHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIuaGFydCBbcm9sZT0nYnV0dG9uJ11cIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgaWYgKCQodGhpcykubmV4dChcInNlbGVjdFwiKS5hdHRyKFwibmFtZVwiKSA9PT0gXCJhQXJ0TmFtZV9oYWVsXCIpIHtcclxuICAgICAgICAgICAgICAgIC8vIGphLCBkYXMgaXN0IGRpZSBBcnRcclxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuZW0uenVBcnRsaXN0ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIi5oYWVsX2FydGdydXBwZW5fcG9wdXBfaW5wdXRfbGFiZWxcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5pbml0aWllcmVoQXJ0RWRpdExpc3RlXzMoJCh0aGlzKS5hdHRyKFwiYXJ0Z3J1cHBlXCIpKTtcclxuICAgICAgICAgICAgJChcIiNoYWVsX2FydGdydXBwZW5fcG9wdXBcIikucG9wdXAoXCJjbG9zZVwiKTtcclxuICAgICAgICB9KTtcclxuXHJcblx0JCgnI01lbnVoQXJ0RWRpdExpc3RlJylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2VpbmZhY2hlcl9tb2R1cycsIHdpbmRvdy5lbS5oYW5kbGVIQXJ0RWRpdE1lbnVFaW5mYWNoZXJNb2R1c0NsaWNrKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfZmVsZGVyX3ZlcndhbHRlbicsIHdpbmRvdy5lbS5oYW5kbGVIQXJ0RWRpdE1lbnVGZWxkZXJWZXJ3YWx0ZW5DbGljaylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2Jlb2JfZXhwb3J0aWVyZW4nLCB3aW5kb3cuZW0uaGFuZGxlSEFydEVkaXRNZW51QmVvYkV4cG9ydGllcmVuQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9laW5zdGVsbHVuZ2VuJywgd2luZG93LmVtLmhhbmRsZUhBcnRFZGl0TWVudUVpbnN0ZWxsdW5nZW5DbGljaylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X25ldV9hbm1lbGRlbicsIHdpbmRvdy5lbS5tZWxkZU5ldUFuKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfYXJ0ZW5ncnVwcGVuX2ltcG9ydGllcmVuJywgd2luZG93LmVtLsO2ZmZuZUFydGVuZ3J1cHBlbkltcG9ydGllcmVuKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfYXJ0ZW5faW1wb3J0aWVyZW4nLCB3aW5kb3cuZW0uw7ZmZm5lQXJ0ZW5JbXBvcnRpZXJlbilcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2FkbWluJywgd2luZG93LmVtLsO2ZmZuZUFkbWluKTtcclxufTtcclxuXHJcblxyXG4vLyB3ZW5uIGluIGhBcnRFZGl0TGlzdGUuaHRtbCAjd2FlaGxlRmVsZGVyaEFydEVkaXRMaXN0ZSBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIQXJ0RWRpdExpc3RlV8OkaGxlRmVsZGVyQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLkF1ZnJ1ZmVuZGVTZWl0ZUZXID0gXCJoQXJ0RWRpdExpc3RlXCI7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJGZWxkZXJXYWVobGVuLmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGhBcnRMaXN0ZS5odG1sIGVyc2NoZWludFxyXG53aW5kb3cuZW0uaGFuZGxlSEFydExpc3RlUGFnZXNob3cgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gU29sbHRlIGtlaW5lIGlkIHZvcmxpZWdlbiwgenUgaFByb2pla3RMaXN0ZS5odG1sIHdlY2hzZWxuXHJcblx0Ly8gZGFzIGtvbW10IGltIE5vcm1hbGZhbGwgbnVyIHZvciwgd2VubiBkZXIgQ2FjaGUgZGVzIEJyb3dzZXJzIGdlbGVlcnQgd3VyZGVcclxuXHQvLyBvZGVyIGluIGRlciBad2lzY2hlbnplaXQgYXVmIGVpbmVtIGFuZGVyZW4gQnJvd3NlciBkaWVzZXIgRGF0ZW5zYXR6IGdlbMO2c2NodCB3dXJkZVxyXG5cdGlmIChsb2NhbFN0b3JhZ2UubGVuZ3RoID09PSAwIHx8ICFsb2NhbFN0b3JhZ2UuRW1haWwpIHtcclxuXHRcdHdpbmRvdy5lbS5sZWVyZUFsbGVWYXJpYWJlbG4oKTtcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiaW5kZXguaHRtbFwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9IGVsc2UgaWYgKCFsb2NhbFN0b3JhZ2UuWmVpdElkIHx8IGxvY2FsU3RvcmFnZS5aZWl0SWQgPT09IFwidW5kZWZpbmVkXCIpIHtcclxuXHRcdHdpbmRvdy5lbS5sZWVyZUFsbGVWYXJpYWJlbG4oXCJvaG5lQ2xlYXJcIik7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhQcm9qZWt0TGlzdGUuaHRtbFwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0d2luZG93LmVtLmluaXRpaWVyZWhBcnRMaXN0ZSgpO1xyXG59O1xyXG5cclxuLy8gd2VubiBoQXJ0TGlzdGUuaHRtbCBpbml0aWllcnQgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSEFydExpc3RlUGFnZWluaXQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gV2lyZCBkaWVzZSBTZWl0ZSBkaXJla3QgYXVmZ2VydWZlbiB1bmQgZXMgZ2lidCBrZWluZW4gbG9jYWxTdG9yYWdlLFxyXG5cdC8vIG11c3MgYXVmIGluZGV4Lmh0bWwgdW1nZWxlaXRldCB3ZXJkZW5cclxuXHRpZiAobG9jYWxTdG9yYWdlLmxlbmd0aCA9PT0gMCB8fCAhbG9jYWxTdG9yYWdlLkVtYWlsKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKCk7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImluZGV4Lmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fSBlbHNlIGlmICghbG9jYWxTdG9yYWdlLlplaXRJZCB8fCBsb2NhbFN0b3JhZ2UuWmVpdElkID09PSBcInVuZGVmaW5lZFwiKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKFwib2huZUNsZWFyXCIpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJoUHJvamVrdExpc3RlLmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHQkKFwiI2hBcnRMaXN0ZVBhZ2VIZWFkZXJcIilcclxuICAgICAgICAvLyBMaW5rIHp1IFJhdW0gaW4gTmF2YmFyIHVuZCBUaXRlbGxlaXN0ZVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiW25hbWU9J09lZmZuZVplaXRoQXJ0TGlzdGUnXVwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlSEFydExpc3RlT2VmZm5lWmVpdENsaWNrKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiNPZWZmbmVPcnRoQXJ0TGlzdGVcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZUhBcnRMaXN0ZcOWZmZuZU9ydENsaWNrKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiNPZWZmbmVSYXVtaEFydExpc3RlXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVIQXJ0TGlzdGXDlmZmbmVSYXVtQ2xpY2soKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiI09lZmZuZVByb2pla3RoQXJ0TGlzdGVcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZUhBcnRMaXN0ZcOWZmZuZVByb2pla3RDbGljaygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHQkKFwiI2hBcnRMaXN0ZVwiKVxyXG4gICAgICAgIC8vIE5ldWUgQmVvYmFjaHR1bmcgbWFuYWdlblxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiLk5ldWVCZW9iaEFydExpc3RlXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS7DtmZmbmVBcnRncnVwcGVubGlzdGVfaGFsKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJzd2lwZXJpZ2h0XCIsIHdpbmRvdy5lbS5oYW5kbGVIQXJ0TGlzdGVTd2lwZXJpZ2h0KTtcclxuXHJcblx0JChcIiNBcnRsaXN0ZWhBTFwiKVxyXG4gICAgICAgIC5vbihcInN3aXBlbGVmdFwiLCBcIi5lcnN0ZVwiLCB3aW5kb3cuZW0uw7ZmZm5lQXJ0Z3J1cHBlbmxpc3RlX2hhbClcclxuICAgICAgICAub24oXCJzd2lwZWxlZnQgY2xpY2tcIiwgXCIuYmVvYlwiLCB3aW5kb3cuZW0uaGFuZGxlSEFydExpc3RlQmVvYkNsaWNrKTtcclxuXHJcblx0JCgnI01lbnVoQXJ0TGlzdGUnKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfZWluZmFjaGVyX21vZHVzJywgd2luZG93LmVtLmhhbmRsZUhBcnRMaXN0ZU1lbnVFaW5mYWNoZXJNb2R1c0NsaWNrKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfZmVsZGVyX3ZlcndhbHRlbicsIHdpbmRvdy5lbS5oYW5kbGVIQXJ0TGlzdGVNZW51RmVsZGVyVmVyd2FsdGVuQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9iZW9iX2V4cG9ydGllcmVuJywgd2luZG93LmVtLmhhbmRsZUhBcnRMaXN0ZU1lbnVGZWxkZXJWZXJ3YWx0ZW5DbGljaylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2VpbnN0ZWxsdW5nZW4nLCB3aW5kb3cuZW0uaGFuZGxlSEFydExpc3RlTWVudUVpbnN0ZWxsdW5nZW5DbGljaylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X25ldV9hbm1lbGRlbicsIHdpbmRvdy5lbS5tZWxkZU5ldUFuKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfYXJ0ZW5ncnVwcGVuX2ltcG9ydGllcmVuJywgd2luZG93LmVtLsO2ZmZuZUFydGVuZ3J1cHBlbkltcG9ydGllcmVuKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfYXJ0ZW5faW1wb3J0aWVyZW4nLCB3aW5kb3cuZW0uw7ZmZm5lQXJ0ZW5JbXBvcnRpZXJlbilcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2FkbWluJywgd2luZG93LmVtLsO2ZmZuZUFkbWluKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gaEFydExpc3RlLmh0bWwgW25hbWU9J09lZmZuZVplaXRoQXJ0TGlzdGUnXSBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIQXJ0TGlzdGVPZWZmbmVaZWl0Q2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZWhBcnRMaXN0ZSgpO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiaFplaXRFZGl0Lmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhBcnRMaXN0ZS5odG1sICNPZWZmbmVPcnRoQXJ0TGlzdGUgZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSEFydExpc3Rlw5ZmZm5lT3J0Q2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZWhBcnRMaXN0ZSgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VaZWl0RWRpdCgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VaZWl0TGlzdGUoKTtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhPcnRFZGl0Lmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhBcnRMaXN0ZS5odG1sICNPZWZmbmVSYXVtaEFydExpc3RlIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhBcnRMaXN0ZcOWZmZuZVJhdW1DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlaEFydExpc3RlKCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVplaXRFZGl0KCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVplaXRMaXN0ZSgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VPcnRFZGl0KCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZU9ydExpc3RlKCk7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJoUmF1bUVkaXQuaHRtbFwiKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gaEFydExpc3RlLmh0bWwgI09lZmZuZVByb2pla3RoQXJ0TGlzdGUgZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSEFydExpc3Rlw5ZmZm5lUHJvamVrdENsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VoQXJ0TGlzdGUoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlWmVpdEVkaXQoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlWmVpdExpc3RlKCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZU9ydEVkaXQoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlT3J0TGlzdGUoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUmF1bUVkaXQoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUmF1bUxpc3RlKCk7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJoUHJvamVrdEVkaXQuaHRtbFwiKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gaEFydExpc3RlLmh0bWwgLmJlb2IgZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSEFydExpc3RlQmVvYkNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS5oQXJ0SWQgPSAkKHRoaXMpLmF0dHIoJ2hBcnRJZCcpO1xyXG5cdGlmIChsb2NhbFN0b3JhZ2UuaEFydFNpY2h0ID09PSBcImxpc3RlXCIpIHtcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiaEFydEVkaXRMaXN0ZS5odG1sXCIpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhBcnRFZGl0Lmh0bWxcIik7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoQXJ0TGlzdGUuaHRtbCBuYWNoIHJlY2h0cyBnZXdpc2NodCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIQXJ0TGlzdGVTd2lwZXJpZ2h0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiaFplaXRMaXN0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoQXJ0TGlzdGUuaHRtbCAubWVudV9laW5mYWNoZXJfbW9kdXMgZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSEFydExpc3RlTWVudUVpbmZhY2hlck1vZHVzQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZWhBcnRMaXN0ZSgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VaZWl0RWRpdCgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VaZWl0TGlzdGUoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlT3J0RWRpdCgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VPcnRMaXN0ZSgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VSYXVtRWRpdCgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VSYXVtTGlzdGUoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUHJvamVrdEVkaXQoKTtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkJlb2JMaXN0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoQXJ0TGlzdGUuaHRtbCAubWVudV9mZWxkZXJfdmVyd2FsdGVuIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhBcnRMaXN0ZU1lbnVGZWxkZXJWZXJ3YWx0ZW5DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuenVydWVjayA9IFwiaEFydExpc3RlLmh0bWxcIjtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkZlbGRMaXN0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoQXJ0TGlzdGUuaHRtbCAubWVudV9iZW9iX2V4cG9ydGllcmVuIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhBcnRMaXN0ZU1lbnVCZW9iRXhwb3J0aWVyZW5DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cub3BlbignX2xpc3QvRXhwb3J0QmVvYi9FeHBvcnRCZW9iP3N0YXJ0a2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCJdJmVuZGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiLHt9LHt9XSZpbmNsdWRlX2RvY3M9dHJ1ZScpO1xyXG5cdCQoXCIjTWVudWhBcnRMaXN0ZVwiKVxyXG4gICAgICAgIC8vIHbDtmxsaWcgdW5sb2dpc2NoOiBkYXMgYmVyZWl0cyBvZmZlbmUgcG9wdXAgbXVzcyB6dWVyc3QgaW5pdGlhbGlzaWVydCB3ZXJkZW4uLi5cclxuICAgICAgICAucG9wdXAoKVxyXG4gICAgICAgIC8vIC4uLmJldm9yIGVzIGdlc2NobG9zc2VuIHdlcmRlbiBtdXNzLCB3ZWlsIGVzIHNvbnN0IG9mZmVuIGJsZWlidFxyXG4gICAgICAgIC5wb3B1cChcImNsb3NlXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoQXJ0TGlzdGUuaHRtbCAubWVudV9laW5zdGVsbHVuZ2VuIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhBcnRMaXN0ZU1lbnVFaW5zdGVsbHVuZ2VuQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLnp1cnVlY2sgPSBcImhBcnRMaXN0ZS5odG1sXCI7XHJcblx0d2luZG93LmVtLsO2ZmZuZU1laW5lRWluc3RlbGx1bmdlbigpO1xyXG59O1xyXG5cclxuLy8gd2VubiBoT3J0RWRpdC5odG1sIGVyc2NoZWludFxyXG53aW5kb3cuZW0uaGFuZGxlSE9ydEVkaXRQYWdlc2hvdyA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBTb2xsdGUga2VpbmUgaWQgdm9ybGllZ2VuLCB6dSBoUHJvamVrdExpc3RlLmh0bWwgd2VjaHNlbG5cclxuXHQvLyBkYXMga29tbXQgaW0gTm9ybWFsZmFsbCBudXIgdm9yLCB3ZW5uIGRlciBDYWNoZSBkZXMgQnJvd3NlcnMgZ2VsZWVydCB3dXJkZVxyXG5cdC8vIG9kZXIgaW4gZGVyIFp3aXNjaGVuemVpdCBhdWYgZWluZW0gYW5kZXJlbiBCcm93c2VyIGRpZXNlciBEYXRlbnNhdHogZ2Vsw7ZzY2h0IHd1cmRlXHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH0gZWxzZSBpZiAoKCFsb2NhbFN0b3JhZ2UuU3RhdHVzIHx8IGxvY2FsU3RvcmFnZS5TdGF0dXMgPT09IFwidW5kZWZpbmVkXCIpICYmICghbG9jYWxTdG9yYWdlLk9ydElkIHx8IGxvY2FsU3RvcmFnZS5PcnRJZCA9PT0gXCJ1bmRlZmluZWRcIikpIHtcclxuXHRcdHdpbmRvdy5lbS5sZWVyZUFsbGVWYXJpYWJlbG4oXCJvaG5lQ2xlYXJcIik7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhQcm9qZWt0TGlzdGUuaHRtbFwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0d2luZG93LmVtLmluaXRpaWVyZU9ydEVkaXQoKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaE9ydEVkaXQuaHRtbCB2ZXJzY2h3aW5kZXRcclxud2luZG93LmVtLmhhbmRsZUhPcnRFZGl0UGFnZWhpZGUgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKHR5cGVvZiB3aW5kb3cuZW0ud2F0Y2hJRCAhPT0gXCJ1bmRlZmluZWRcIikge1xyXG5cdFx0d2luZG93LmVtLnN0b3BHZW9sb2NhdGlvbigpO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIHdlbm4gaE9ydEVkaXQuaHRtbCBpbml0aWllcnQgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSE9ydEVkaXRQYWdlaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBXaXJkIGRpZXNlIFNlaXRlIGRpcmVrdCBhdWZnZXJ1ZmVuIHVuZCBlcyBnaWJ0IGtlaW5lbiBsb2NhbFN0b3JhZ2UsXHJcblx0Ly8gbXVzcyBhdWYgaW5kZXguaHRtbCB1bWdlbGVpdGV0IHdlcmRlblxyXG5cdGlmIChsb2NhbFN0b3JhZ2UubGVuZ3RoID09PSAwIHx8ICFsb2NhbFN0b3JhZ2UuRW1haWwpIHtcclxuXHRcdHdpbmRvdy5lbS5sZWVyZUFsbGVWYXJpYWJlbG4oKTtcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiaW5kZXguaHRtbFwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9IGVsc2UgaWYgKCghbG9jYWxTdG9yYWdlLlN0YXR1cyB8fCBsb2NhbFN0b3JhZ2UuU3RhdHVzID09PSBcInVuZGVmaW5lZFwiKSAmJiAoIWxvY2FsU3RvcmFnZS5PcnRJZCB8fCBsb2NhbFN0b3JhZ2UuT3J0SWQgPT09IFwidW5kZWZpbmVkXCIpKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKFwib2huZUNsZWFyXCIpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJoUHJvamVrdExpc3RlLmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHQvLyBpbmFrdGl2ZSB0YWJzIGluYWt0aXZpZXJlblxyXG5cdCQoZG9jdW1lbnQpXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIudGFiX2luYWt0aXZcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG5cdCQoXCIjT3J0RWRpdEhlYWRlclwiKVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiW25hbWU9J09lZmZuZU9ydExpc3RlT3J0RWRpdCddXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVIT3J0RWRpdMOWZmZuZU9ydExpc3RlQ2xpY2soKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiI09lZmZuZVJhdW1PcnRFZGl0XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVIT3J0RWRpdMOWZmZuZVJhdW1DbGljaygpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIjT2VmZm5lWmVpdExpc3RlT3J0RWRpdFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAkLm1vYmlsZS5uYXZpZ2F0ZShcImhaZWl0TGlzdGUuaHRtbFwiKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiI09lZmZuZVByb2pla3RPcnRFZGl0XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVIT3J0RWRpdMOWZmZuZVByb2pla3RDbGljaygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHQkKFwiI2hPcnRFZGl0Rm9ybVwiKVxyXG4gICAgICAgIC8vIEbDvHIgamVkZXMgRmVsZCBiZWkgw4RuZGVydW5nIHNwZWljaGVyblxyXG4gICAgICAgIC5vbihcImNoYW5nZVwiLCBcIi5zcGVpY2hlcm5cIiwgd2luZG93LmVtLmhhbmRsZUhPcnRFZGl0U3BlaWNoZXJuQ2hhbmdlKVxyXG4gICAgICAgIC8vIEVpbmdhYmUgaW0gWmFobGVuZmVsZCBhYmZhbmdlblxyXG4gICAgICAgIC5vbihcImJsdXJcIiwgJy5zcGVpY2hlcm5TbGlkZXInLCB3aW5kb3cuZW0uc3BlaWNoZXJlSE9ydEVkaXQpXHJcbiAgICAgICAgLy8gS2xpY2tlbiBhdWYgZGVuIFBmZWlsZW4gaW0gWmFobGVuZmVsZCBhYmZhbmdlblxyXG4gICAgICAgIC5vbihcIm1vdXNldXBcIiwgJy51aS1zbGlkZXItaW5wdXQnLCB3aW5kb3cuZW0uc3BlaWNoZXJlSE9ydEVkaXQpXHJcbiAgICAgICAgLy8gRW5kZSBkZXMgU2NoaWViZW5zIGFiZmFuZ2VuXHJcbiAgICAgICAgLm9uKFwic2xpZGVzdG9wXCIsICcuc3BlaWNoZXJuU2xpZGVyJywgd2luZG93LmVtLnNwZWljaGVyZUhPcnRFZGl0KTtcclxuXHJcblx0JChcIiNGb3JtQW5ow6RuZ2VoT0VcIilcclxuICAgICAgICAvLyDDhG5kZXJ1bmdlbiBpbSBGb3JtdWxhciBmw7xyIEFuaMOkbmdlIHNwZWljaGVyblxyXG4gICAgICAgIC5vbihcImNoYW5nZVwiLCBcIi5zcGVpY2hlcm5BbmhhbmdcIiwgd2luZG93LmVtLmhhbmRsZUhPcnRFZGl0U3BlaWNoZXJuQW5oYW5nQ2hhbmdlKVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiW25hbWU9J0zDtnNjaGVBbmhhbmcnXVwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0ubMO2c2NoZUFuaGFuZyh0aGlzLCB3aW5kb3cuZW0uaE9ydCwgbG9jYWxTdG9yYWdlLk9ydElkKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAkKFwiI2hPcnRFZGl0XCIpXHJcbiAgICAgICAgLm9uKFwic3dpcGVsZWZ0XCIsIFwiI09ydEVkaXRDb250ZW50XCIsIHdpbmRvdy5lbS5oYW5kbGVIT3J0RWRpdENvbnRlbnRTd2lwZWxlZnQpXHJcbiAgICAgICAgLm9uKFwic3dpcGVyaWdodFwiLCBcIiNPcnRFZGl0Q29udGVudFwiLCB3aW5kb3cuZW0uaGFuZGxlSE9ydEVkaXRDb250ZW50U3dpcGVyaWdodClcclxuICAgICAgICAvLyBQYWdpbmF0aW9uIFBmZWlsIHZvcmlnZXIgaW5pdGlhbGlzaWVyZW5cclxuICAgICAgICAub24oXCJ2Y2xpY2tcIiwgXCIudWktcGFnaW5hdGlvbi1wcmV2XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5uw6RjaHN0ZXJWb3JpZ2VyT3J0KFwidm9yaWdlclwiKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC8vIFBhZ2luYXRpb24gUGZlaWwgbsOkY2hzdGVyIGluaXRpYWxpc2llcmVuXHJcbiAgICAgICAgLm9uKFwidmNsaWNrXCIsIFwiLnVpLXBhZ2luYXRpb24tbmV4dFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0ubsOkY2hzdGVyVm9yaWdlck9ydChcIm7DpGNoc3RlclwiKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC8vIFBhZ2luYXRpb24gUGZlaWx0YXN0ZW4gaW5pdGlhbGlzaWVyZW5cclxuICAgICAgICAub24oXCJrZXl1cFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICAndXNlIHN0cmljdCc7XHJcbiAgICAgICAgICAgIC8vIG51ciByZWFnaWVyZW4sIHdlbm4gaFByb2pla3RFZGl0IHNpY2h0YmFyIHVuZCBGb2t1cyBuaWNodCBpbiBlaW5lbSBGZWxkXHJcbiAgICAgICAgICAgIGlmICghJChldmVudC50YXJnZXQpLmlzKFwiaW5wdXQsIHRleHRhcmVhLCBzZWxlY3QsIGJ1dHRvblwiKSAmJiAkKCcjaE9ydEVkaXQnKS5pcygnOnZpc2libGUnKSkge1xyXG4gICAgICAgICAgICAgICAgLy8gTGVmdCBhcnJvd1xyXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09ICQubW9iaWxlLmtleUNvZGUuTEVGVCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5lbS5uw6RjaHN0ZXJWb3JpZ2VyT3J0KFwidm9yaWdlclwiKTtcclxuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gUmlnaHQgYXJyb3dcclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV2ZW50LmtleUNvZGUgPT09ICQubW9iaWxlLmtleUNvZGUuUklHSFQpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZW0ubsOkY2hzdGVyVm9yaWdlck9ydChcIm7DpGNoc3RlclwiKTtcclxuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG5cdCQoXCIjT3J0RWRpdEZvb3RlclwiKVxyXG4gICAgICAgIC8vIG5ldWVuIE9ydCBlcnN0ZWxsZW5cclxuICAgICAgICAub24oJ2NsaWNrJywgJyNOZXVlck9ydE9ydEVkaXQnLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uZXJzdGVsbGVOZXVlbk9ydCgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLy8gc2ljaHRiYXJlIEZlbGRlciB3w6RobGVuXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIjd2FlaGxlRmVsZGVyT3J0RWRpdFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlSE9ydEVkaXRXw6RobGVGZWxkZXJDbGljaygpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLy8gQ29kZSBmw7xyIGRlbiBPcnQtTMO2c2NoZW4tRGlhbG9nXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcjTG9lc2NoZU9ydE9ydEVkaXQnLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlSE9ydEVkaXRMw7ZzY2hlT3J0Q2xpY2sodGhpcyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAvLyBLYXJ0ZSBtYW5hZ2VuXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcjS2FydGVPZWZmbmVuT3J0RWRpdCcsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVIT3J0RWRpdEthcnRlw5ZmZm5lbkNsaWNrKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oJ2NsaWNrJywgJyNWZXJvcnR1bmdPcnRFZGl0JywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLkdldEdlb2xvY2F0aW9uKGxvY2FsU3RvcmFnZS5PcnRJZCwgXCJPcnRcIik7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgJChcIiNob2VfbMO2c2NoZW5fbWVsZHVuZ1wiKVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiI2hvZV9sw7ZzY2hlbl9tZWxkdW5nX2phX2xvZXNjaGVuXCIsIHdpbmRvdy5lbS5oYW5kbGVIT3J0RWRpdEzDtnNjaGVuTWVsZHVuZ0phQ2xpY2spO1xyXG5cclxuXHQkKCcjTWVudU9ydEVkaXQnKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfZWluZmFjaGVyX21vZHVzJywgd2luZG93LmVtLmhhbmRsZUhPcnRFZGl0TWVudUVpbmZhY2hlck1vZHVzQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9mZWxkZXJfdmVyd2FsdGVuJywgd2luZG93LmVtLmhhbmRsZUhPcnRFZGl0TWVudUZlbGRlclZlcndhbHRlbkNsaWNrKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfb3J0ZV9leHBvcnRpZXJlbicsIHdpbmRvdy5lbS5oYW5kbGVIT3J0RWRpdE1lbnVPcnRlRXhwb3J0aWVyZW5DbGljaylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2VpbnN0ZWxsdW5nZW4nLCB3aW5kb3cuZW0uaGFuZGxlSE9ydEVkaXRNZW51RWluc3RlbGx1bmdlbkNsaWNrKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfbmV1X2FubWVsZGVuJywgd2luZG93LmVtLm1lbGRlTmV1QW4pXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9hcnRlbmdydXBwZW5faW1wb3J0aWVyZW4nLCB3aW5kb3cuZW0uw7ZmZm5lQXJ0ZW5ncnVwcGVuSW1wb3J0aWVyZW4pXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9hZG1pbicsIHdpbmRvdy5lbS7DtmZmbmVBZG1pbik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhPcnRFZGl0Lmh0bWwgW25hbWU9J09lZmZuZU9ydExpc3RlT3J0RWRpdCddIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhPcnRFZGl0w5ZmZm5lT3J0TGlzdGVDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlT3J0RWRpdCgpO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiaE9ydExpc3RlLmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhPcnRFZGl0Lmh0bWwgI09lZmZuZVJhdW1PcnRFZGl0IGdla2xpY2t0IHd1cmRlXHJcbndpbmRvdy5lbS5oYW5kbGVIT3J0RWRpdMOWZmZuZVJhdW1DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBzb25zdCB3aXJkIGJlaSBSw7xja2tlaHIgZGllIGFsdGUgTGlzdGUgYW5nZXplaWd0LCBlZ2FsIHZvbiB3ZWxjaGVtIFJhdW0gbWFuIGtvbW10IVxyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VPcnRMaXN0ZSgpO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiaFJhdW1FZGl0Lmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhPcnRFZGl0Lmh0bWwgI09lZmZuZVByb2pla3RPcnRFZGl0IGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhPcnRFZGl0w5ZmZm5lUHJvamVrdENsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIHNvbnN0IHdpcmQgYmVpIFLDvGNra2VociBkaWUgYWx0ZSBMaXN0ZSBhbmdlemVpZ3QsIGVnYWwgdm9uIHdlbGNoZW0gUmF1bSBtYW4ga29tbXQhXHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZU9ydExpc3RlKCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVJhdW1MaXN0ZSgpO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiaFByb2pla3RFZGl0Lmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhPcnRFZGl0Lmh0bWwgLnNwZWljaGVybiBnZcOkbmRlcnQgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSE9ydEVkaXRTcGVpY2hlcm5DaGFuZ2UgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIEZlbGRuYW1lID0gdGhpcy5uYW1lLFxyXG4gICAgICAgICRvWEtvb3JkID0gJChcIltuYW1lPSdvWEtvb3JkJ11cIiksXHJcbiAgICAgICAgJG9ZS29vcmQgPSAkKFwiW25hbWU9J29ZS29vcmQnXVwiKSxcclxuICAgICAgICBDaFRvV2dzTG5nID0gcmVxdWlyZSgnLi91dGlsL2NoVG9XZ3NMbmcnKSxcclxuICAgICAgICBDaFRvV2dzTGF0ID0gcmVxdWlyZSgnLi91dGlsL2NoVG9XZ3NMYXQnKTtcclxuXHRpZiAoWydvWEtvb3JkJywgJ29ZS29vcmQnXS5pbmRleE9mKEZlbGRuYW1lKSA+IC0xICYmICRvWEtvb3JkLnZhbCgpICYmICRvWUtvb3JkLnZhbCgpKSB7XHJcblx0XHQvLyBXZW5uIEtvb3JkaW5hdGVuIHVuZCBiZWlkZSBlcmZhc3N0XHJcblx0XHRsb2NhbFN0b3JhZ2Uub1hLb29yZCA9ICRvWEtvb3JkLnZhbCgpO1xyXG5cdFx0bG9jYWxTdG9yYWdlLm9ZS29vcmQgPSAkb1lLb29yZC52YWwoKTtcclxuXHRcdC8vIEzDpG5nZW4tIHVuZCBCcmVpdGVuZ3JhZGUgYmVyZWNobmVuXHJcblx0XHRsb2NhbFN0b3JhZ2Uub0xvbmdpdHVkZURlY0RlZyA9IENoVG9XZ3NMbmcobG9jYWxTdG9yYWdlLm9ZS29vcmQsIGxvY2FsU3RvcmFnZS5vWEtvb3JkKTtcclxuXHRcdGxvY2FsU3RvcmFnZS5vTGF0aXR1ZGVEZWNEZWcgPSBDaFRvV2dzTGF0KGxvY2FsU3RvcmFnZS5vWUtvb3JkLCBsb2NhbFN0b3JhZ2Uub1hLb29yZCk7XHJcblx0XHRsb2NhbFN0b3JhZ2Uub0xhZ2VnZW5hdWlna2VpdCA9IG51bGw7XHJcblx0XHQvLyB1bmQgS29vcmRpbmF0ZW4gc3BlaWNoZXJuXHJcblx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlS29vcmRpbmF0ZW4obG9jYWxTdG9yYWdlLk9ydElkLCBcImhPcnRcIik7XHJcblx0fSBlbHNlIHtcclxuXHRcdHdpbmRvdy5lbS5zcGVpY2hlcmVIT3J0RWRpdCh0aGlzKTtcclxuXHR9XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhPcnRFZGl0Lmh0bWwgLnNwZWljaGVybkFuaGFuZyDDpG5kZXJ0XHJcbndpbmRvdy5lbS5oYW5kbGVIT3J0RWRpdFNwZWljaGVybkFuaGFuZ0NoYW5nZSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgX2F0dGFjaG1lbnRzID0gJChcIiNfYXR0YWNobWVudHNoT0VcIikudmFsKCk7XHJcblx0aWYgKF9hdHRhY2htZW50cyAmJiBfYXR0YWNobWVudHMubGVuZ3RoICE9PSAwKSB7XHJcblx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlQW5ow6RuZ2UobG9jYWxTdG9yYWdlLk9ydElkLCB3aW5kb3cuZW0uaE9ydCwgXCJoT0VcIik7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoT3J0RWRpdC5odG1sICN3YWVobGVGZWxkZXJPcnRFZGl0IGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhPcnRFZGl0V8OkaGxlRmVsZGVyQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLkF1ZnJ1ZmVuZGVTZWl0ZUZXID0gXCJoT3J0RWRpdFwiO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiRmVsZGVyV2FlaGxlbi5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoT3J0RWRpdC5odG1sICNMb2VzY2hlT3J0T3J0RWRpdCBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIT3J0RWRpdEzDtnNjaGVPcnRDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBBbnphaGwgWmVpdGVuIHZvbiBPcnQgesOkaGxlblxyXG5cdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHQkZGIudmlldygnZXZhYi9oWmVpdElkVm9uT3J0P3N0YXJ0a2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuT3J0SWQgKyAnXCJdJmVuZGtleT1bXCInICsgbG9jYWxTdG9yYWdlLk9ydElkICsgJ1wiLHt9LHt9XScsIHtcclxuXHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKFplaXRlbikge1xyXG5cdFx0XHR2YXIgYW56WmVpdGVuID0gWmVpdGVuLnJvd3MubGVuZ3RoO1xyXG5cdFx0XHQkZGIudmlldygnZXZhYi9oQXJ0SWRWb25PcnQ/c3RhcnRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5PcnRJZCArICdcIl0mZW5ka2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuT3J0SWQgKyAnXCIse30se31dJywge1xyXG5cdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKEFydGVuKSB7XHJcblx0XHRcdFx0XHR2YXIgYW56QXJ0ZW4gPSBBcnRlbi5yb3dzLmxlbmd0aCwgXHJcblx0XHRcdFx0XHRcdCRob2VfbMO2c2NoZW5fbWVsZHVuZyA9ICQoXCIjaG9lX2zDtnNjaGVuX21lbGR1bmdcIiksXHJcblx0XHRcdFx0XHRcdHplaXRlbl90ZXh0ID0gKGFuelplaXRlbiA9PT0gMSA/ICcgWmVpdCB1bmQgJyA6ICcgWmVpdGVuIHVuZCAnKSxcclxuXHRcdFx0XHRcdFx0YXJ0ZW5fdGV4dCA9IChhbnpBcnRlbiA9PT0gMSA/ICcgQXJ0JyA6ICcgQXJ0ZW4nKSwgXHJcblx0XHRcdFx0XHRcdG1lbGR1bmcgPSAnT3J0IGlua2x1c2l2ZSAnICsgYW56WmVpdGVuICsgemVpdGVuX3RleHQgKyBhbnpBcnRlbiArIGFydGVuX3RleHQgKyAnIGzDtnNjaGVuPyc7XHJcblx0XHRcdFx0XHQkKFwiI2hvZV9sw7ZzY2hlbl9tZWxkdW5nX21lbGR1bmdcIikuaHRtbChtZWxkdW5nKTtcclxuXHRcdFx0XHRcdC8vIExpc3RlbiBhbmjDpG5nZW4sIGRhbWl0IG9obmUgREItQWJmcmFnZSBnZWzDtnNjaHQgd2VyZGVuIGthbm5cclxuXHRcdFx0XHRcdCRob2VfbMO2c2NoZW5fbWVsZHVuZy5kYXRhKCdBcnRlbicsIEFydGVuKTtcclxuXHRcdFx0XHRcdCRob2VfbMO2c2NoZW5fbWVsZHVuZy5kYXRhKCdaZWl0ZW4nLCBaZWl0ZW4pO1xyXG5cdFx0XHRcdFx0Ly8gcG9wdXAgw7ZmZm5lblxyXG4gICAgICAgICAgICAgICAgICAgICRob2VfbMO2c2NoZW5fbWVsZHVuZy5wb3B1cChcIm9wZW5cIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gaE9ydEVkaXQuaHRtbCAjaG9lX2zDtnNjaGVuX21lbGR1bmdfamFfbG9lc2NoZW4gZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSE9ydEVkaXRMw7ZzY2hlbk1lbGR1bmdKYUNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciAkaG9lX2zDtnNjaGVuX21lbGR1bmcgPSAkKFwiI2hvZV9sw7ZzY2hlbl9tZWxkdW5nXCIpWzBdO1xyXG5cdHdpbmRvdy5lbS5sw7ZzY2hlT3J0KCQuZGF0YSgkaG9lX2zDtnNjaGVuX21lbGR1bmcsICdBcnRlbicpLCAkLmRhdGEoJGhvZV9sw7ZzY2hlbl9tZWxkdW5nLCAnWmVpdGVuJykpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoT3J0RWRpdC5odG1sICNLYXJ0ZU9lZmZuZW5PcnRFZGl0IGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhPcnRFZGl0S2FydGXDlmZmbmVuQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLnp1cnVlY2sgPSBcImhPcnRFZGl0XCI7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJLYXJ0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoT3J0RWRpdC5odG1sICNPcnRFZGl0Q29udGVudCBuYWNoIGxpbmtzIGdld2lzY2h0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhPcnRFZGl0Q29udGVudFN3aXBlbGVmdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAoISQoXCIqOmZvY3VzXCIpLmF0dHIoXCJhcmlhLXZhbHVlbm93XCIpKSB7XHJcblx0XHQvLyBrZWluIHNsaWRlclxyXG5cdFx0d2luZG93LmVtLm7DpGNoc3RlclZvcmlnZXJPcnQoXCJuw6RjaHN0ZXJcIik7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoT3J0RWRpdC5odG1sICNPcnRFZGl0Q29udGVudCBuYWNoIHJlY2h0cyBnZXdpc2NodCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIT3J0RWRpdENvbnRlbnRTd2lwZXJpZ2h0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghJChcIio6Zm9jdXNcIikuYXR0cihcImFyaWEtdmFsdWVub3dcIikpIHtcclxuXHRcdC8vIGtlaW4gc2xpZGVyXHJcblx0XHR3aW5kb3cuZW0ubsOkY2hzdGVyVm9yaWdlck9ydChcInZvcmlnZXJcIik7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoT3J0RWRpdC5odG1sIC5tZW51X2VpbmZhY2hlcl9tb2R1cyBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIT3J0RWRpdE1lbnVFaW5mYWNoZXJNb2R1c0NsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VPcnRFZGl0KCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZU9ydExpc3RlKCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVJhdW1FZGl0KCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVJhdW1MaXN0ZSgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VQcm9qZWt0RWRpdCgpO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiQmVvYkxpc3RlLmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhPcnRFZGl0Lmh0bWwgLm1lbnVfZmVsZGVyX3ZlcndhbHRlbiBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIT3J0RWRpdE1lbnVGZWxkZXJWZXJ3YWx0ZW5DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuenVydWVjayA9IFwiaE9ydEVkaXQuaHRtbFwiO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiRmVsZExpc3RlLmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhPcnRFZGl0Lmh0bWwgLm1lbnVfb3J0ZV9leHBvcnRpZXJlbiBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIT3J0RWRpdE1lbnVPcnRlRXhwb3J0aWVyZW5DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cub3BlbignX2xpc3QvRXhwb3J0T3J0L0V4cG9ydE9ydD9zdGFydGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiXSZlbmRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5FbWFpbCArICdcIix7fSx7fV0maW5jbHVkZV9kb2NzPXRydWUnKTtcclxuXHQkKFwiI01lbnVPcnRFZGl0XCIpXHJcbiAgICAgICAgLy8gdsO2bGxpZyB1bmxvZ2lzY2g6IGRhcyBiZXJlaXRzIG9mZmVuZSBwb3B1cCBtdXNzIHp1ZXJzdCBpbml0aWFsaXNpZXJ0IHdlcmRlbi4uLlxyXG4gICAgICAgIC5wb3B1cCgpXHJcbiAgICAgICAgLy8gLi4uYmV2b3IgZXMgZ2VzY2hsb3NzZW4gd2VyZGVuIG11c3MsIHdlaWwgZXMgc29uc3Qgb2ZmZW4gYmxlaWJ0XHJcbiAgICAgICAgLnBvcHVwKFwiY2xvc2VcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhPcnRFZGl0Lmh0bWwgLm1lbnVfZWluc3RlbGx1bmdlbiBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIT3J0RWRpdE1lbnVFaW5zdGVsbHVuZ2VuQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLnp1cnVlY2sgPSBcImhPcnRFZGl0Lmh0bWxcIjtcclxuXHR3aW5kb3cuZW0uw7ZmZm5lTWVpbmVFaW5zdGVsbHVuZ2VuKCk7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGhPcnRMaXN0ZS5odG1sIGVyc2NoZWludFxyXG53aW5kb3cuZW0uaGFuZGxlSE9ydExpc3RlUGFnZXNob3cgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gU29sbHRlIGtlaW5lIGlkIHZvcmxpZWdlbiwgenUgaFByb2pla3RMaXN0ZS5odG1sIHdlY2hzZWxuXHJcblx0Ly8gZGFzIGtvbW10IGltIE5vcm1hbGZhbGwgbnVyIHZvciwgd2VubiBkZXIgQ2FjaGUgZGVzIEJyb3dzZXJzIGdlbGVlcnQgd3VyZGVcclxuXHQvLyBvZGVyIGluIGRlciBad2lzY2hlbnplaXQgYXVmIGVpbmVtIGFuZGVyZW4gQnJvd3NlciBkaWVzZXIgRGF0ZW5zYXR6IGdlbMO2c2NodCB3dXJkZVxyXG5cdGlmIChsb2NhbFN0b3JhZ2UubGVuZ3RoID09PSAwIHx8ICFsb2NhbFN0b3JhZ2UuRW1haWwpIHtcclxuXHRcdHdpbmRvdy5lbS5sZWVyZUFsbGVWYXJpYWJlbG4oKTtcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiaW5kZXguaHRtbFwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9IGVsc2UgaWYgKCFsb2NhbFN0b3JhZ2UuUmF1bUlkIHx8IGxvY2FsU3RvcmFnZS5SYXVtSWQgPT09IFwidW5kZWZpbmVkXCIpIHtcclxuXHRcdHdpbmRvdy5lbS5sZWVyZUFsbGVWYXJpYWJlbG4oXCJvaG5lQ2xlYXJcIik7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhQcm9qZWt0TGlzdGUuaHRtbFwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0d2luZG93LmVtLmluaXRpaWVyZU9ydExpc3RlKCk7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGhPcnRMaXN0ZS5odG1sIGluaXRpaWVydCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIT3J0TGlzdGVQYWdlaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBXaXJkIGRpZXNlIFNlaXRlIGRpcmVrdCBhdWZnZXJ1ZmVuIHVuZCBlcyBnaWJ0IGtlaW5lbiBsb2NhbFN0b3JhZ2UsXHJcblx0Ly8gbXVzcyBhdWYgaW5kZXguaHRtbCB1bWdlbGVpdGV0IHdlcmRlblxyXG5cdGlmIChsb2NhbFN0b3JhZ2UubGVuZ3RoID09PSAwIHx8ICFsb2NhbFN0b3JhZ2UuRW1haWwpIHtcclxuXHRcdHdpbmRvdy5lbS5sZWVyZUFsbGVWYXJpYWJlbG4oKTtcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiaW5kZXguaHRtbFwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9IGVsc2UgaWYgKCFsb2NhbFN0b3JhZ2UuUmF1bUlkIHx8IGxvY2FsU3RvcmFnZS5SYXVtSWQgPT09IFwidW5kZWZpbmVkXCIpIHtcclxuXHRcdHdpbmRvdy5lbS5sZWVyZUFsbGVWYXJpYWJlbG4oXCJvaG5lQ2xlYXJcIik7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhQcm9qZWt0TGlzdGUuaHRtbFwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG5cdC8vIGluYWt0aXZlIHRhYnMgaW5ha3RpdmllcmVuXHJcblx0JChkb2N1bWVudClcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIi50YWJfaW5ha3RpdlwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB9KTtcclxuXHJcblx0JChcIiNoT3J0TGlzdGVQYWdlSGVhZGVyXCIpXHJcbiAgICAgICAgLy8gTGluayB6dSBSYXVtIGluIE5hdmJhciB1bmQgVGl0ZWxsZWlzdGVcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIltuYW1lPSdPZWZmbmVSYXVtT3J0TGlzdGUnXVwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlSE9ydExpc3Rlw5ZmZm5lUmF1bUNsaWNrKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiNPZWZmbmVQcm9qZWt0T3J0TGlzdGVcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZUhPcnRMaXN0ZcOWZmZuZVByb2pla3RDbGljaygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHQkKFwiI2hPcnRMaXN0ZVwiKVxyXG4gICAgICAgIC8vIG5ldWVuIE9ydCBlcnN0ZWxsZW5cclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIi5OZXVlck9ydE9ydExpc3RlXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5lcnN0ZWxsZU5ldWVuT3J0KCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJzd2lwZXJpZ2h0XCIsIFwiI2hPcnRMaXN0ZVBhZ2VDb250ZW50XCIsIHdpbmRvdy5lbS5oYW5kbGVIT3J0TGlzdGVQYWdlQ29udGVudFN3aXBlcmlnaHQpO1xyXG5cclxuXHQkKFwiI09ydGxpc3RlaE9MXCIpXHJcbiAgICAgICAgLm9uKFwic3dpcGVsZWZ0XCIsIFwiLk9ydFwiLCB3aW5kb3cuZW0uaGFuZGxlSE9ydExpc3RlU3dpcGVsZWZ0KVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiLk9ydFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlSE9ydExpc3RlT3J0Q2xpY2sodGhpcyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJzd2lwZWxlZnRcIiwgXCIuZXJzdGVcIiwgd2luZG93LmVtLmVyc3RlbGxlTmV1ZW5PcnQpO1xyXG5cclxuXHQkKFwiI2hPcnRMaXN0ZVBhZ2VGb290ZXJcIilcclxuICAgICAgICAub24oJ2NsaWNrJywgJyNPZWZmbmVLYXJ0ZU9ydExpc3RlJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZUhPcnRMaXN0ZcOWZmZuZUthcnRlQ2xpY2soKTtcclxuICAgICAgICB9KTtcclxuXHJcblx0JCgnI01lbnVPcnRMaXN0ZScpXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9laW5mYWNoZXJfbW9kdXMnLCB3aW5kb3cuZW0uaGFuZGxlSE9ydExpc3RlTWVudUVpbmZhY2hlck1vZHVzQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9mZWxkZXJfdmVyd2FsdGVuJywgd2luZG93LmVtLmhhbmRsZUhPcnRMaXN0ZU1lbnVGZWxkZXJWZXJ3YWx0ZW5DbGljaylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X29ydGVfZXhwb3J0aWVyZW4nLCB3aW5kb3cuZW0uaGFuZGxlSE9ydExpc3RlTWVudU9ydGVFeHBvcnRpZXJlbkNsaWNrKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfZWluc3RlbGx1bmdlbicsIHdpbmRvdy5lbS5oYW5kbGVIT3J0TGlzdGVNZW51RWluc3RlbGx1bmdlbkNsaWNrKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfbmV1X2FubWVsZGVuJywgd2luZG93LmVtLm1lbGRlTmV1QW4pXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9hcnRlbmdydXBwZW5faW1wb3J0aWVyZW4nLCB3aW5kb3cuZW0uw7ZmZm5lQXJ0ZW5ncnVwcGVuSW1wb3J0aWVyZW4pXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9hZG1pbicsIHdpbmRvdy5lbS7DtmZmbmVBZG1pbik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhPcnRMaXN0ZS5odG1sIFtuYW1lPSdPZWZmbmVSYXVtT3J0TGlzdGUnXSBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIT3J0TGlzdGXDlmZmbmVSYXVtQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZU9ydExpc3RlKCk7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJoUmF1bUVkaXQuaHRtbFwiKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gaE9ydExpc3RlLmh0bWwgI09lZmZuZVByb2pla3RPcnRMaXN0ZSBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIT3J0TGlzdGXDlmZmbmVQcm9qZWt0Q2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZU9ydExpc3RlKCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVJhdW1FZGl0KCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVJhdW1MaXN0ZSgpO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiaFByb2pla3RFZGl0Lmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhPcnRMaXN0ZS5odG1sIG5hY2ggbGlua3MgZ2V3aXNjaHQgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSE9ydExpc3RlU3dpcGVsZWZ0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS5PcnRJZCA9ICQodGhpcykuYXR0cignT3J0SWQnKTtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhaZWl0TGlzdGUuaHRtbFwiKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gaE9ydExpc3RlLmh0bWwgLk9ydCBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIT3J0TGlzdGVPcnRDbGljayA9IGZ1bmN0aW9uKHRoYXQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLk9ydElkID0gJCh0aGF0KS5hdHRyKCdPcnRJZCcpO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiaE9ydEVkaXQuaHRtbFwiKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gaE9ydExpc3RlLmh0bWwgI2hPcnRMaXN0ZVBhZ2VDb250ZW50IG5hY2ggcmVjaHRzIGdld2lzY2h0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhPcnRMaXN0ZVBhZ2VDb250ZW50U3dpcGVyaWdodCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlT3J0TGlzdGUoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUmF1bUVkaXQoKTtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhSYXVtTGlzdGUuaHRtbFwiKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gaE9ydExpc3RlLmh0bWwgI09lZmZuZUthcnRlT3J0TGlzdGUgZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSE9ydExpc3Rlw5ZmZm5lS2FydGVDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuenVydWVjayA9IFwiaE9ydExpc3RlXCI7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJLYXJ0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoT3J0TGlzdGUuaHRtbCAubWVudV9laW5mYWNoZXJfbW9kdXMgZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSE9ydExpc3RlTWVudUVpbmZhY2hlck1vZHVzQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZU9ydExpc3RlKCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVJhdW1FZGl0KCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVJhdW1MaXN0ZSgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VQcm9qZWt0RWRpdCgpO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiQmVvYkxpc3RlLmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhPcnRMaXN0ZS5odG1sIC5tZW51X2ZlbGRlcl92ZXJ3YWx0ZW4gZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSE9ydExpc3RlTWVudUZlbGRlclZlcndhbHRlbkNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS56dXJ1ZWNrID0gXCJoT3J0TGlzdGUuaHRtbFwiO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiRmVsZExpc3RlLmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhPcnRMaXN0ZS5odG1sIC5tZW51X29ydGVfZXhwb3J0aWVyZW4gZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSE9ydExpc3RlTWVudU9ydGVFeHBvcnRpZXJlbkNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHdpbmRvdy5vcGVuKCdfbGlzdC9FeHBvcnRPcnQvRXhwb3J0T3J0P3N0YXJ0a2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCJdJmVuZGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiLHt9LHt9XSZpbmNsdWRlX2RvY3M9dHJ1ZScpO1xyXG5cdCQoXCIjTWVudU9ydExpc3RlXCIpXHJcbiAgICAgICAgLy8gdsO2bGxpZyB1bmxvZ2lzY2g6IGRhcyBiZXJlaXRzIG9mZmVuZSBwb3B1cCBtdXNzIHp1ZXJzdCBpbml0aWFsaXNpZXJ0IHdlcmRlbi4uLlxyXG4gICAgICAgIC5wb3B1cCgpXHJcbiAgICAgICAgLy8gLi4uYmV2b3IgZXMgZ2VzY2hsb3NzZW4gd2VyZGVuIG11c3MsIHdlaWwgZXMgc29uc3Qgb2ZmZW4gYmxlaWJ0XHJcbiAgICAgICAgLnBvcHVwKFwiY2xvc2VcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhPcnRMaXN0ZS5odG1sIC5tZW51X2VpbnN0ZWxsdW5nZW4gZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSE9ydExpc3RlTWVudUVpbnN0ZWxsdW5nZW5DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuenVydWVjayA9IFwiaE9ydExpc3RlLmh0bWxcIjtcclxuXHR3aW5kb3cuZW0uw7ZmZm5lTWVpbmVFaW5zdGVsbHVuZ2VuKCk7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGhQcm9qZWt0RWRpdC5odG1sIGFuZ2V6ZWlndCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIUHJvamVrdEVkaXRQYWdlc2hvdyA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBTb2xsdGUga2VpbmUgaWQgdm9ybGllZ2VuLCB6dSBoUHJvamVrdExpc3RlLmh0bWwgd2VjaHNlbG5cclxuXHQvLyBkYXMga29tbXQgaW0gTm9ybWFsZmFsbCBudXIgdm9yLCB3ZW5uIGRlciBDYWNoZSBkZXMgQnJvd3NlcnMgZ2VsZWVydCB3dXJkZVxyXG5cdC8vIG9kZXIgaW4gZGVyIFp3aXNjaGVuemVpdCBhdWYgZWluZW0gYW5kZXJlbiBCcm93c2VyIGRpZXNlciBEYXRlbnNhdHogZ2Vsw7ZzY2h0IHd1cmRlXHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH0gZWxzZSBpZiAoKCFsb2NhbFN0b3JhZ2UuU3RhdHVzIHx8IGxvY2FsU3RvcmFnZS5TdGF0dXMgPT09IFwidW5kZWZpbmVkXCIpICYmICghbG9jYWxTdG9yYWdlLlByb2pla3RJZCB8fCBsb2NhbFN0b3JhZ2UuUHJvamVrdElkID09PSBcInVuZGVmaW5lZFwiKSkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbihcIm9obmVDbGVhclwiKTtcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiaFByb2pla3RMaXN0ZS5odG1sXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHR3aW5kb3cuZW0uaW5pdGlpZXJlUHJvamVrdEVkaXQoKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaFByb2pla3RFZGl0Lmh0bWwgaW5pdGlpZXJ0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhQcm9qZWt0RWRpdFBhZ2Vpbml0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIFdpcmQgZGllc2UgU2VpdGUgZGlyZWt0IGF1ZmdlcnVmZW4gdW5kIGVzIGdpYnQga2VpbmVuIGxvY2FsU3RvcmFnZSxcclxuXHQvLyBtdXNzIGF1ZiBpbmRleC5odG1sIHVtZ2VsZWl0ZXQgd2VyZGVuXHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH0gZWxzZSBpZiAoKCFsb2NhbFN0b3JhZ2UuU3RhdHVzIHx8IGxvY2FsU3RvcmFnZS5TdGF0dXMgPT09IFwidW5kZWZpbmVkXCIpICYmICghbG9jYWxTdG9yYWdlLlByb2pla3RJZCB8fCBsb2NhbFN0b3JhZ2UuUHJvamVrdElkID09PSBcInVuZGVmaW5lZFwiKSkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbihcIm9obmVDbGVhclwiKTtcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiaFByb2pla3RMaXN0ZS5odG1sXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHJcblx0JChkb2N1bWVudClcclxuICAgICAgICAvLyBpbmFrdGl2ZSB0YWJzIGluYWt0aXZpZXJlblxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiLnRhYl9pbmFrdGl2XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHQkKFwiI2hQcm9qZWt0RWRpdEhlYWRlclwiKVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiW25hbWU9J09lZmZuZVByb2pla3RMaXN0ZVByb2pla3RFZGl0J11cIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZUhQcm9qZWt0RWRpdMOWZmZuZVByb2pla3RMaXN0ZUNsaWNrKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiNPZWZmbmVSYXVtTGlzdGVQcm9qZWt0RWRpdFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAkLm1vYmlsZS5uYXZpZ2F0ZShcImhSYXVtTGlzdGUuaHRtbFwiKTtcclxuICAgICAgICB9KTtcclxuXHJcblx0JChcIiNoUHJvamVrdEVkaXRGb3JtXCIpXHJcbiAgICAgICAgLy8gRsO8ciBqZWRlcyBGZWxkIGJlaSDDhG5kZXJ1bmcgc3BlaWNoZXJuXHJcbiAgICAgICAgLm9uKFwiY2hhbmdlXCIsIFwiLnNwZWljaGVyblwiLCB3aW5kb3cuZW0uc3BlaWNoZXJlSFByb2pla3RFZGl0KVxyXG4gICAgICAgIC8vIEVpbmdhYmUgaW0gWmFobGVuZmVsZCBhYmZhbmdlblxyXG4gICAgICAgIC8vIEVuZGUgZGVzIFNjaGllYmVucyBhYmZhbmdlblxyXG4gICAgICAgIC5vbihcImJsdXIgc2xpZGVzdG9wXCIsICcuc3BlaWNoZXJuU2xpZGVyJywgd2luZG93LmVtLnNwZWljaGVyZUhQcm9qZWt0RWRpdClcclxuICAgICAgICAvLyBLbGlja2VuIGF1ZiBkZW4gUGZlaWxlbiBpbSBaYWhsZW5mZWxkIGFiZmFuZ2VuXHJcbiAgICAgICAgLm9uKFwibW91c2V1cFwiLCAnLnVpLXNsaWRlci1pbnB1dCcsIHdpbmRvdy5lbS5zcGVpY2hlcmVIUHJvamVrdEVkaXQpO1xyXG5cclxuXHQkKFwiI0Zvcm1BbmjDpG5nZWhQRVwiKVxyXG4gICAgICAgIC8vIMOEbmRlcnVuZ2VuIGltIEZvcm11bGFyIGbDvHIgQW5ow6RuZ2Ugc3BlaWNoZXJuXHJcbiAgICAgICAgLm9uKFwiY2hhbmdlXCIsIFwiLnNwZWljaGVybkFuaGFuZ1wiLCB3aW5kb3cuZW0uaGFuZGxlSFByb2pla3RFZGl0U3BlaWNoZXJuQW5oYW5nQ2hhbmdlKVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiW25hbWU9J0zDtnNjaGVBbmhhbmcnXVwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0ubMO2c2NoZUFuaGFuZyh0aGlzLCB3aW5kb3cuZW0uaFByb2pla3QsIGxvY2FsU3RvcmFnZS5Qcm9qZWt0SWQpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHQkKFwiI2hQcm9qZWt0RWRpdFwiKVxyXG4gICAgICAgIC5vbihcInN3aXBlbGVmdFwiLCBcIiNoUHJvamVrdEVkaXRDb250ZW50XCIsIHdpbmRvdy5lbS5oYW5kbGVIUHJvamVrdEVkaXRDb250ZW50U3dpcGVsZWZ0KVxyXG4gICAgICAgIC5vbihcInN3aXBlcmlnaHRcIiwgXCIjaFByb2pla3RFZGl0Q29udGVudFwiLCB3aW5kb3cuZW0uaGFuZGxlSFByb2pla3RFZGl0Q29udGVudFN3aXBlcmlnaHQpXHJcbiAgICAgICAgLy8gUGFnaW5hdGlvbiBQZmVpbCB2b3JpZ2VyIGluaXRpYWxpc2llcmVuXHJcbiAgICAgICAgLm9uKFwidmNsaWNrXCIsIFwiLnVpLXBhZ2luYXRpb24tcHJldlwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0ubsOkY2hzdGVzVm9yaWdlc1Byb2pla3QoXCJ2b3JpZ2VzXCIpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLy8gUGFnaW5hdGlvbiBQZmVpbCBuw6RjaHN0ZXIgaW5pdGlhbGlzaWVyZW5cclxuICAgICAgICAub24oXCJ2Y2xpY2tcIiwgXCIudWktcGFnaW5hdGlvbi1uZXh0XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5uw6RjaHN0ZXNWb3JpZ2VzUHJvamVrdChcIm7DpGNoc3Rlc1wiKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC8vIFBhZ2luYXRpb24gUGZlaWx0YXN0ZW4gaW5pdGlhbGlzaWVyZW5cclxuICAgICAgICAub24oXCJrZXl1cFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICAndXNlIHN0cmljdCc7XHJcbiAgICAgICAgICAgIC8vIG51ciByZWFnaWVyZW4sIHdlbm4gaFByb2pla3RFZGl0IHNpY2h0YmFyIHVuZCBGb2t1cyBuaWNodCBpbiBlaW5lbSBGZWxkXHJcbiAgICAgICAgICAgIGlmICghJChldmVudC50YXJnZXQpLmlzKFwiaW5wdXQsIHRleHRhcmVhLCBzZWxlY3QsIGJ1dHRvblwiKSAmJiAkKCcjaFByb2pla3RFZGl0JykuaXMoJzp2aXNpYmxlJykpIHtcclxuICAgICAgICAgICAgICAgIC8vIExlZnQgYXJyb3dcclxuICAgICAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAkLm1vYmlsZS5rZXlDb2RlLkxFRlQpIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZW0ubsOkY2hzdGVzVm9yaWdlc1Byb2pla3QoXCJ2b3JpZ2VzXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBSaWdodCBhcnJvd1xyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZXZlbnQua2V5Q29kZSA9PT0gJC5tb2JpbGUua2V5Q29kZS5SSUdIVCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5lbS5uw6RjaHN0ZXNWb3JpZ2VzUHJvamVrdChcIm7DpGNoc3Rlc1wiKTtcclxuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgJCgnI2hQcm9qZWt0RWRpdEZvb3RlcicpXHJcbiAgICAgICAgLy8gQ29kZSBmw7xyIGRlbiBQcm9qZWt0LUzDtnNjaGVuLURpYWxvZ1xyXG4gICAgICAgIC5vbignY2xpY2snLCAnI0zDtnNjaGVQcm9qZWt0UHJvamVrdEVkaXQnLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlSFByb2pla3RFZGl0TMO2c2NoZVByb2pla3RDbGljayh0aGlzKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC8vIG5ldWVzIFByb2pla3QgZXJzdGVsbGVuXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIjTmV1ZXNQcm9qZWt0UHJvamVrdEVkaXRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmVyc3RlbGxlTmV1ZXNQcm9qZWt0KCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAvLyBzaWNodGJhcmUgRmVsZGVyIHfDpGhsZW5cclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiN3YWVobGVGZWxkZXJQcm9qZWt0RWRpdFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlSFByb2pla3RFZGl0V8OkaGxlRmVsZGVyQ2xpY2soKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnI0thcnRlT2VmZm5lblByb2pla3RFZGl0JywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZUhQcm9qZWt0RWRpdEthcnRlw5ZmZm5lbkNsaWNrKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgJChcIiNocGVfbMO2c2NoZW5fbWVsZHVuZ1wiKVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiI2hwZV9sw7ZzY2hlbl9tZWxkdW5nX2phX2xvZXNjaGVuXCIsIHdpbmRvdy5lbS5oYW5kbGVIUHJvamVrdEVkaXRMw7ZzY2hlbk1lbGR1bmdKYUNsaWNrKTtcclxuXHJcblx0JCgnI01lbnVQcm9qZWt0RWRpdCcpXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9laW5mYWNoZXJfbW9kdXMnLCB3aW5kb3cuZW0uaGFuZGxlSFByb2pla3RFZGl0TWVudUVpbmZhY2hlck1vZHVzQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9mZWxkZXJfdmVyd2FsdGVuJywgd2luZG93LmVtLmhhbmRsZUhQcm9qZWt0RWRpdE1lbnVGZWxkZXJWZXJ3YWx0ZW5DbGljaylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X3Byb2pla3RlX2V4cG9ydGllcmVuJywgd2luZG93LmVtLmhhbmRsZUhQcm9qZWt0RWRpdE1lbnVQcm9qZWt0ZUV4cG9ydGllcmVuQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9laW5zdGVsbHVuZ2VuJywgd2luZG93LmVtLmhhbmRsZUhQcm9qZWt0RWRpdE1lbnVFaW5zdGVsbHVuZ2VuQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9uZXVfYW5tZWxkZW4nLCB3aW5kb3cuZW0ubWVsZGVOZXVBbilcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2FydGVuZ3J1cHBlbl9pbXBvcnRpZXJlbicsIHdpbmRvdy5lbS7DtmZmbmVBcnRlbmdydXBwZW5JbXBvcnRpZXJlbilcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2FkbWluJywgd2luZG93LmVtLsO2ZmZuZUFkbWluKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gaFByb2pla3RFZGl0Lmh0bWwgW25hbWU9J09lZmZuZVByb2pla3RMaXN0ZVByb2pla3RFZGl0J10gZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSFByb2pla3RFZGl0w5ZmZm5lUHJvamVrdExpc3RlQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVByb2pla3RFZGl0KCk7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJoUHJvamVrdExpc3RlLmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhQcm9qZWt0RWRpdC5odG1sIC5zcGVpY2hlcm5BbmhhbmcgZ2XDpG5kZXJ0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhQcm9qZWt0RWRpdFNwZWljaGVybkFuaGFuZ0NoYW5nZSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgX2F0dGFjaG1lbnRzID0gJChcIiNfYXR0YWNobWVudHNoUEVcIikudmFsKCk7XHJcblx0aWYgKF9hdHRhY2htZW50cyAmJiBfYXR0YWNobWVudHMubGVuZ3RoID4gMCkge1xyXG5cdFx0d2luZG93LmVtLnNwZWljaGVyZUFuaMOkbmdlKGxvY2FsU3RvcmFnZS5Qcm9qZWt0SWQsIHdpbmRvdy5lbS5oUHJvamVrdCwgXCJoUEVcIik7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoUHJvamVrdEVkaXQuaHRtbCAjTMO2c2NoZVByb2pla3RQcm9qZWt0RWRpdCBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIUHJvamVrdEVkaXRMw7ZzY2hlUHJvamVrdENsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIEFuemFobCBSw6R1bWUgZGVzIFByb2pla3RzIHrDpGhsZW5cclxuXHQvLyBkaWUgQWJmcmFnZSB2ZXJ3ZW5kZW4sIHVtIGRpZSBEYXRlbnPDpHR6ZSBzcMOkdGVyIGRpcmVrdCB6dSBsw7ZzY2hlbiwgb2huZSB3ZWl0ZXJlIERCLUFiZnJhZ2VcclxuXHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0JGRiLnZpZXcoJ2V2YWIvaFJhdW1JZFZvblByb2pla3Q/c3RhcnRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5Qcm9qZWt0SWQgKyAnXCJdJmVuZGtleT1bXCInICsgbG9jYWxTdG9yYWdlLlByb2pla3RJZCArICdcIix7fSx7fV0nLCB7XHJcblx0XHRzdWNjZXNzOiBmdW5jdGlvbihSYWV1bWUpIHtcclxuXHRcdFx0dmFyIGFuelJhZXVtZSA9IFJhZXVtZS5yb3dzLmxlbmd0aDtcclxuXHRcdFx0Ly8gQW56YWhsIE9ydGUgZGVzIFByb2pla3RzIHrDpGhsZW5cclxuXHRcdFx0JGRiLnZpZXcoJ2V2YWIvaE9ydElkVm9uUHJvamVrdD9zdGFydGtleT1bXCInICsgbG9jYWxTdG9yYWdlLlByb2pla3RJZCArICdcIl0mZW5ka2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuUHJvamVrdElkICsgJ1wiLHt9LHt9XScsIHtcclxuXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihPcnRlKSB7XHJcblx0XHRcdFx0XHR2YXIgYW56T3J0ZSA9IE9ydGUucm93cy5sZW5ndGg7XHJcblx0XHRcdFx0XHQvLyBBbnphaGwgWmVpdGVuIGRlcyBQcm9qZWt0cyB6w6RobGVuXHJcblx0XHRcdFx0XHQkZGIudmlldygnZXZhYi9oWmVpdElkVm9uUHJvamVrdD9zdGFydGtleT1bXCInICsgbG9jYWxTdG9yYWdlLlByb2pla3RJZCArICdcIl0mZW5ka2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuUHJvamVrdElkICsgJ1wiLHt9LHt9XScsIHtcclxuXHRcdFx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oWmVpdGVuKSB7XHJcblx0XHRcdFx0XHRcdFx0dmFyIGFuelplaXRlbiA9IFplaXRlbi5yb3dzLmxlbmd0aDtcclxuXHRcdFx0XHRcdFx0XHQvLyBBbnphaGwgQXJ0ZW4gZGVzIFByb2pla3RzIHrDpGhsZW5cclxuXHRcdFx0XHRcdFx0XHQkZGIudmlldygnZXZhYi9oQXJ0SWRWb25Qcm9qZWt0P3N0YXJ0a2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuUHJvamVrdElkICsgJ1wiXSZlbmRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5Qcm9qZWt0SWQgKyAnXCIse30se31dJywge1xyXG5cdFx0XHRcdFx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oQXJ0ZW4pIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIGFuekFydGVuID0gQXJ0ZW4ucm93cy5sZW5ndGgsIFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCRob2VfbMO2c2NoZW5fbWVsZHVuZyA9ICQoXCIjaG9lX2zDtnNjaGVuX21lbGR1bmdcIiksXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0csOkdW1lX3RleHQgPSAoYW56UmFldW1lID09PSAxID8gJyBSYXVtLCAnIDogJyBSw6R1bWUsICcpLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdG9ydGVfdGV4dCA9IChhbnpPcnRlID09PSAxID8gJyBPcnQsICcgOiAnIE9ydGUsICcpLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHplaXRlbl90ZXh0ID0gKGFuelplaXRlbiA9PT0gMSA/ICcgWmVpdCB1bmQgJyA6ICcgWmVpdGVuIHVuZCAnKSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRhcnRlbl90ZXh0ID0gKGFuekFydGVuID09PSAxID8gJyBBcnQnIDogJyBBcnRlbicpLCBcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRtZWxkdW5nID0gJ1Byb2pla3QgaW5rbHVzaXZlICcgKyBhbnpSYWV1bWUgKyByw6R1bWVfdGV4dCArIGFuek9ydGUgKyBvcnRlX3RleHQgKyBhbnpaZWl0ZW4gKyB6ZWl0ZW5fdGV4dCArIGFuekFydGVuICsgYXJ0ZW5fdGV4dCArICcgbMO2c2NoZW4/JztcclxuXHRcdFx0XHRcdFx0XHRcdFx0JChcIiNocGVfbMO2c2NoZW5fbWVsZHVuZ19tZWxkdW5nXCIpLmh0bWwobWVsZHVuZyk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIExpc3RlbiBhbmjDpG5nZW4sIGRhbWl0IG9obmUgREItQWJmcmFnZSBnZWzDtnNjaHQgd2VyZGVuIGthbm5cclxuXHRcdFx0XHRcdFx0XHRcdFx0JGhvZV9sw7ZzY2hlbl9tZWxkdW5nLmRhdGEoJ0FydGVuJywgQXJ0ZW4pO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQkaG9lX2zDtnNjaGVuX21lbGR1bmcuZGF0YSgnWmVpdGVuJywgWmVpdGVuKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0JGhvZV9sw7ZzY2hlbl9tZWxkdW5nLmRhdGEoJ09ydGUnLCBPcnRlKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0JGhvZV9sw7ZzY2hlbl9tZWxkdW5nLmRhdGEoJ1JhZXVtZScsIFJhZXVtZSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIHBvcHVwIMO2ZmZuZW5cclxuXHRcdFx0XHRcdFx0XHRcdFx0JChcIiNocGVfbMO2c2NoZW5fbWVsZHVuZ1wiKS5wb3B1cChcIm9wZW5cIik7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhQcm9qZWt0RWRpdC5odG1sICNocGVfbMO2c2NoZW5fbWVsZHVuZ19qYV9sb2VzY2hlbiBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIUHJvamVrdEVkaXRMw7ZzY2hlbk1lbGR1bmdKYUNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciAkaHBlX2zDtnNjaGVuX21lbGR1bmcgPSAkKFwiI2hwZV9sw7ZzY2hlbl9tZWxkdW5nXCIpWzBdO1xyXG5cdHdpbmRvdy5lbS5sw7ZzY2hlUHJvamVrdChqUXVlcnkuZGF0YSgkaHBlX2zDtnNjaGVuX21lbGR1bmcsICdBcnRlbicpLCBqUXVlcnkuZGF0YSgkaHBlX2zDtnNjaGVuX21lbGR1bmcsICdaZWl0ZW4nKSwgalF1ZXJ5LmRhdGEoJGhwZV9sw7ZzY2hlbl9tZWxkdW5nLCAnT3J0ZScpLCBqUXVlcnkuZGF0YSgkaHBlX2zDtnNjaGVuX21lbGR1bmcsICdSYWV1bWUnKSk7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhQcm9qZWt0RWRpdC5odG1sICN3YWVobGVGZWxkZXJQcm9qZWt0RWRpdCBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIUHJvamVrdEVkaXRXw6RobGVGZWxkZXJDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuQXVmcnVmZW5kZVNlaXRlRlcgPSBcImhQcm9qZWt0RWRpdFwiO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiRmVsZGVyV2FlaGxlbi5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoUHJvamVrdEVkaXQuaHRtbCAjaFByb2pla3RFZGl0Q29udGVudCBuYWNoIGxpbmtzIGdld2lzY2h0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhQcm9qZWt0RWRpdENvbnRlbnRTd2lwZWxlZnQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKCEkKFwiKjpmb2N1c1wiKS5hdHRyKFwiYXJpYS12YWx1ZW5vd1wiKSkge1xyXG5cdFx0Ly8ga2VpbiBzbGlkZXJcclxuXHRcdHdpbmRvdy5lbS5uw6RjaHN0ZXNWb3JpZ2VzUHJvamVrdChcIm7DpGNoc3Rlc1wiKTtcclxuXHR9XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhQcm9qZWt0RWRpdC5odG1sICNoUHJvamVrdEVkaXRDb250ZW50IG5hY2ggcmVjaHRzIGdld2lzY2h0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhQcm9qZWt0RWRpdENvbnRlbnRTd2lwZXJpZ2h0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghJChcIio6Zm9jdXNcIikuYXR0cihcImFyaWEtdmFsdWVub3dcIikpIHtcclxuXHRcdC8vIGtlaW4gc2xpZGVyXHJcblx0XHR3aW5kb3cuZW0ubsOkY2hzdGVzVm9yaWdlc1Byb2pla3QoXCJ2b3JpZ2VzXCIpO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIHdlbm4gaW4gaFByb2pla3RFZGl0Lmh0bWwgI0thcnRlT2VmZm5lblByb2pla3RFZGl0IGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhQcm9qZWt0RWRpdEthcnRlw5ZmZm5lbkNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS56dXJ1ZWNrID0gXCJoUHJvamVrdEVkaXRcIjtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkthcnRlLmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhQcm9qZWt0RWRpdC5odG1sIC5tZW51X2VpbmZhY2hlcl9tb2R1cyBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIUHJvamVrdEVkaXRNZW51RWluZmFjaGVyTW9kdXNDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUHJvamVrdEVkaXQoKTtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkJlb2JMaXN0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoUHJvamVrdEVkaXQuaHRtbCAubWVudV9mZWxkZXJfdmVyd2FsdGVuIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhQcm9qZWt0RWRpdE1lbnVGZWxkZXJWZXJ3YWx0ZW5DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuenVydWVjayA9IFwiaFByb2pla3RFZGl0Lmh0bWxcIjtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkZlbGRMaXN0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoUHJvamVrdEVkaXQuaHRtbCAubWVudV9wcm9qZWt0ZV9leHBvcnRpZXJlbiBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIUHJvamVrdEVkaXRNZW51UHJvamVrdGVFeHBvcnRpZXJlbkNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHdpbmRvdy5vcGVuKCdfbGlzdC9FeHBvcnRQcm9qZWt0L0V4cG9ydFByb2pla3Q/c3RhcnRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5FbWFpbCArICdcIix7fSx7fSx7fSx7fSx7fV0mZW5ka2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCJdJmRlc2NlbmRpbmc9dHJ1ZSZpbmNsdWRlX2RvY3M9dHJ1ZScpO1xyXG5cdCQoXCIjTWVudVByb2pla3RFZGl0XCIpXHJcbiAgICAgICAgLy8gdsO2bGxpZyB1bmxvZ2lzY2g6IGRhcyBiZXJlaXRzIG9mZmVuZSBwb3B1cCBtdXNzIHp1ZXJzdCBpbml0aWFsaXNpZXJ0IHdlcmRlbi4uLlxyXG4gICAgICAgIC5wb3B1cCgpXHJcbiAgICAgICAgLy8gLi4uYmV2b3IgZXMgZ2VzY2hsb3NzZW4gd2VyZGVuIG11c3MsIHdlaWwgZXMgc29uc3Qgb2ZmZW4gYmxlaWJ0XHJcbiAgICAgICAgLnBvcHVwKFwiY2xvc2VcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhQcm9qZWt0RWRpdC5odG1sIC5tZW51X2VpbnN0ZWxsdW5nZW4gZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSFByb2pla3RFZGl0TWVudUVpbnN0ZWxsdW5nZW5DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuenVydWVjayA9IFwiaFByb2pla3RFZGl0Lmh0bWxcIjtcclxuXHR3aW5kb3cuZW0uw7ZmZm5lTWVpbmVFaW5zdGVsbHVuZ2VuKCk7XHJcbn07XHJcblxyXG4vLyDDlmZmbmV0IGRhcyB2b3JpZ2Ugb2RlciBuw6RjaHN0ZSBQcm9qZWt0XHJcbi8vIHZvcmlnZXMgZGVzIGVyc3RlbiA9PiBoUHJvamVrdExpc3RlLmh0bWxcclxuLy8gbsOkY2hzdGVzIGRlcyBsZXR6dGVuID0+IG1lbGRlblxyXG4vLyBlcndhcnRldCBkaWUgSUQgZGVzIGFrdHVlbGxlbiBEYXRlbnNhdHplcyB1bmQgb2IgbsOkY2hzdGVyIG9kZXIgdm9yaWdlciBnZXN1Y2h0IHdpcmRcclxuLy8gd2lyZCBiZW51dHp0IGluIGhQcm9qZWt0RWRpdC5odG1sXHJcbndpbmRvdy5lbS5uw6RjaHN0ZXNWb3JpZ2VzUHJvamVrdCA9IGZ1bmN0aW9uKE7DpGNoc3Rlc09kZXJWb3JpZ2VzKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIHByw7xmZW4sIG9iIFByb2pla3RsaXN0ZSBzY2hvbiBleGlzdGllcnRcclxuXHQvLyBudXIgYWJmcmFnZW4sIHdlbm4gc2llIG5vY2ggbmljaHQgZXhpc3RpZXJ0XHJcblx0aWYgKHdpbmRvdy5lbS5Qcm9qZWt0bGlzdGUpIHtcclxuXHRcdC8vIGdsb2JhbGUgVmFyaWFibGUgUHJvamVrdGxpc3RlIGV4aXN0aWVydCBub2NoXHJcblx0XHR3aW5kb3cuZW0ubsOkY2hzdGVzVm9yaWdlc1Byb2pla3RfMihOw6RjaHN0ZXNPZGVyVm9yaWdlcyk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIGtlaW5lIFByb2pla3RsaXN0ZSDDvGJlcmdlYmVuXHJcblx0XHQvLyBuZXUgYXVzIERCIGVyc3RlbGxlblxyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLnZpZXcoJ2V2YWIvaFByb2pMaXN0ZT9zdGFydGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiXSZlbmRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5FbWFpbCArICdcIix7fV0maW5jbHVkZV9kb2NzPXRydWUnLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHQvLyBQcm9qZWt0bGlzdGUgYmVyZWl0c3RlbGxlblxyXG5cdFx0XHRcdHdpbmRvdy5lbS5Qcm9qZWt0bGlzdGUgPSBkYXRhO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5uw6RjaHN0ZXNWb3JpZ2VzUHJvamVrdF8yKE7DpGNoc3Rlc09kZXJWb3JpZ2VzKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLm7DpGNoc3Rlc1ZvcmlnZXNQcm9qZWt0XzIgPSBmdW5jdGlvbihOw6RjaHN0ZXNPZGVyVm9yaWdlcykge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgaSxcclxuXHRcdFByb2pJZEFrdHVlbGwsXHJcblx0XHRBbnpQcm9qO1xyXG5cdGZvciAoaT0wOyB3aW5kb3cuZW0uUHJvamVrdGxpc3RlLnJvd3MubGVuZ3RoOyBpKyspIHtcclxuXHRcdFByb2pJZEFrdHVlbGwgPSB3aW5kb3cuZW0uUHJvamVrdGxpc3RlLnJvd3NbaV0uZG9jLl9pZDtcclxuXHRcdEFuelByb2ogPSB3aW5kb3cuZW0uUHJvamVrdGxpc3RlLnJvd3MubGVuZ3RoIC0xOyAgLy8gdm9yc2ljaHQ6IE9iamVrdGUgesOkaGxlbiBFbGVtZW50ZSBhYiAxLCBBcnJheXMgYWIgMCFcclxuXHRcdGlmIChQcm9qSWRBa3R1ZWxsID09PSBsb2NhbFN0b3JhZ2UuUHJvamVrdElkKSB7XHJcblx0XHRcdHN3aXRjaCAoTsOkY2hzdGVzT2RlclZvcmlnZXMpIHtcclxuXHRcdFx0Y2FzZSBcIm7DpGNoc3Rlc1wiOlxyXG5cdFx0XHRcdGlmIChpIDwgQW56UHJvaikge1xyXG5cdFx0XHRcdFx0bG9jYWxTdG9yYWdlLlByb2pla3RJZCA9IHdpbmRvdy5lbS5Qcm9qZWt0bGlzdGUucm93c1tpKzFdLmRvYy5faWQ7XHJcblx0XHRcdFx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUHJvamVrdEVkaXQoXCJtaXRMYXRMbmdMaXN0ZVwiLCBcIm9obmVJZFwiKTtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5pbml0aWllcmVQcm9qZWt0RWRpdCgpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJEYXMgaXN0IGRhcyBsZXR6dGUgUHJvamVrdFwiKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgXCJ2b3JpZ2VzXCI6XHJcblx0XHRcdFx0aWYgKGkgPiAwKSB7XHJcblx0XHRcdFx0XHRsb2NhbFN0b3JhZ2UuUHJvamVrdElkID0gd2luZG93LmVtLlByb2pla3RsaXN0ZS5yb3dzW2ktMV0uZG9jLl9pZDtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VQcm9qZWt0RWRpdChcIm1pdExhdExuZ0xpc3RlXCIsIFwib2huZUlkXCIpO1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLmluaXRpaWVyZVByb2pla3RFZGl0KCk7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VQcm9qZWt0RWRpdCgpO1xyXG5cdFx0XHRcdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJoUHJvamVrdExpc3RlLmh0bWxcIik7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG59O1xyXG5cclxuLy8gd2lyZCBiZW51dHp0IGluIGhQcm9qZWt0RWRpdC5odG1sXHJcbndpbmRvdy5lbS5sw7ZzY2hlUHJvamVrdCA9IGZ1bmN0aW9uKEFydGVuLCBaZWl0ZW4sIE9ydGUsIFJhZXVtZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBudXIgbMO2c2NoZW4sIHdvIERhdGVuc8OkdHplIHZvcmtvbW1lblxyXG5cdGlmIChSYWV1bWUucm93cy5sZW5ndGggPiAwKSB7XHJcblx0XHR3aW5kb3cuZW0ubG9lc2NoZUlkSWRSZXZMaXN0ZShSYWV1bWUpO1xyXG5cdH1cclxuXHRpZiAoT3J0ZS5yb3dzLmxlbmd0aCA+IDApIHtcclxuXHRcdHdpbmRvdy5lbS5sb2VzY2hlSWRJZFJldkxpc3RlKE9ydGUpO1xyXG5cdH1cclxuXHRpZiAoWmVpdGVuLnJvd3MubGVuZ3RoID4gMCkge1xyXG5cdFx0d2luZG93LmVtLmxvZXNjaGVJZElkUmV2TGlzdGUoWmVpdGVuKTtcclxuXHR9XHJcblx0aWYgKEFydGVuLnJvd3MubGVuZ3RoID4gMCkge1xyXG5cdFx0d2luZG93LmVtLmxvZXNjaGVJZElkUmV2TGlzdGUoQXJ0ZW4pO1xyXG5cdH1cclxuXHQvLyB6dWxldHp0IGRhcyBQcm9qZWt0XHJcblx0aWYgKHdpbmRvdy5lbS5oUHJvamVrdCkge1xyXG5cdFx0Ly8gT2JqZWt0IHZlcndlbmRlblxyXG5cdFx0d2luZG93LmVtLmzDtnNjaGVQcm9qZWt0XzIoKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gT2JqZWt0IGF1cyBEQiBob2xlblxyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLm9wZW5Eb2MobG9jYWxTdG9yYWdlLlByb2pla3RJZCwge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLmhQcm9qZWt0ID0gZGF0YTtcclxuXHRcdFx0XHR3aW5kb3cuZW0ubMO2c2NoZVByb2pla3RfMigpO1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRmVobGVyOiBQcm9qZWt0IG5pY2h0IGdlbMO2c2NodFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLmzDtnNjaGVQcm9qZWt0XzIgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdCRkYi5yZW1vdmVEb2Mod2luZG93LmVtLmhQcm9qZWt0LCB7XHJcblx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdC8vIExpc3RlIGFucGFzc2VuLiBWb3JzaWNodDogQmVpIHJlZnJlc2gga2FubiBzaWUgZmVobGVuXHJcblx0XHRcdGlmICh3aW5kb3cuZW0uUHJvamVrdGxpc3RlICYmIHdpbmRvdy5lbS5Qcm9qZWt0bGlzdGUucm93cykge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5Qcm9qZWt0bGlzdGUucm93cyA9IF8ucmVqZWN0KHdpbmRvdy5lbS5Qcm9qZWt0bGlzdGUucm93cywgZnVuY3Rpb24ocm93KSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gcm93LmRvYy5faWQgPT09IGRhdGEuaWQ7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly8gS2VpbmUgUHJvamVrdGxpc3RlIG1laHIuIFN0b3JhZ2UgbMO2c2NoZW5cclxuXHRcdFx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUHJvamVrdExpc3RlKFwibWl0TGF0TG5nTGlzdGVcIik7XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gUHJvamVrdGVkaXQgenVyw7xja3NldHplblxyXG5cdFx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUHJvamVrdEVkaXQoXCJtaXRMYXRMbmdMaXN0ZVwiKTtcclxuXHRcdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJoUHJvamVrdExpc3RlLmh0bWxcIik7XHJcblx0XHRcdC8vJChcIjptb2JpbGUtcGFnZWNvbnRhaW5lclwiKS5wYWdlY29udGFpbmVyKFwiY2hhbmdlXCIsIFwiaFByb2pla3RMaXN0ZS5odG1sXCIpO1xyXG5cdFx0XHQvLyQoXCI6bW9iaWxlLXBhZ2Vjb250YWluZXJcIikucGFnZWNvbnRhaW5lcihcImNoYW5nZVwiLCBcImhQcm9qZWt0TGlzdGUuaHRtbFwiLCB7cmVsb2FkOiB0cnVlfSk7XHJcblx0XHR9LFxyXG5cdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJGZWhsZXI6IFByb2pla3QgbmljaHQgZ2Vsw7ZzY2h0XCIpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxuLy8gd2lyZCBiZW51dHp0IGluIGhQcm9qZWt0RWRpdC5odG1sXHJcbndpbmRvdy5lbS52YWxpZGllcmVoUHJvamVrdEVkaXQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKCEkKFwiW25hbWU9J3BOYW1lJ11cIikudmFsKCkpIHtcclxuXHRcdHdpbmRvdy5lbS5tZWxkZShcIkJpdHRlIFByb2pla3RuYW1lbiBlaW5nZWJlblwiKTtcclxuXHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IFxyXG5cdFx0XHQkKFwiW25hbWU9J3BOYW1lJ11cIikuZm9jdXMoKTsgXHJcblx0XHR9LCA1MCk7ICAvLyBuZWVkIHRvIHVzZSBhIHRpbWVyIHNvIHRoYXQgLmJsdXIoKSBjYW4gZmluaXNoIGJlZm9yZSB5b3UgZG8gLmZvY3VzKClcclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9XHJcblx0cmV0dXJuIHRydWU7XHJcbn07XHJcblxyXG4vLyB3aXJkIGJlbnV0enQgaW4gaFByb2pla3RFZGl0Lmh0bWxcclxud2luZG93LmVtLnNwZWljaGVyZUhQcm9qZWt0RWRpdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgdGhhdCA9IHRoaXM7XHJcblx0aWYgKHdpbmRvdy5lbS5oUHJvamVrdCkge1xyXG5cdFx0d2luZG93LmVtLnNwZWljaGVyZUhQcm9qZWt0RWRpdF8yKHRoYXQpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIub3BlbkRvYyhsb2NhbFN0b3JhZ2UuUHJvamVrdElkLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaFByb2pla3QgPSBkYXRhO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5zcGVpY2hlcmVIUHJvamVrdEVkaXRfMih0aGF0KTtcclxuXHRcdFx0fSxcclxuXHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkZlaGxlcjogw4RuZGVydW5nIGluIFwiICsgdGhhdC5uYW1lICsgXCIgbmljaHQgZ2VzcGVpY2hlcnRcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5zcGVpY2hlcmVIUHJvamVrdEVkaXRfMiA9IGZ1bmN0aW9uKHRoYXQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcbiAgICB2YXIgRmVsZG5hbWVEYixcclxuICAgICAgICBGZWxkd2VydCxcclxuICAgICAgICBmZWxkaW5mb3M7XHJcbiAgICAvLyBGZWxkbmFtZSB1bmQgLXdlcnQgZXJtaXR0ZWxuXHJcbiAgICBmZWxkaW5mb3MgPSB3aW5kb3cuZW0uaG9sZUZlbGRJbmZvc1ZvbkVsZW1lbnQodGhhdCk7XHJcbiAgICBGZWxkbmFtZURiID0gZmVsZGluZm9zLmZlbGRuYW1lX2RiO1xyXG4gICAgRmVsZHdlcnQgPSBmZWxkaW5mb3MuZmVsZHdlcnQ7XHJcblx0aWYgKHdpbmRvdy5lbS52YWxpZGllcmVoUHJvamVrdEVkaXQoKSkge1xyXG5cdFx0aWYgKEZlbGRuYW1lRGIgPT09IFwicE5hbWVcIikge1xyXG5cdFx0XHQvLyBWYXJpYWJsZW4gZsO8ciBQcm9qZWt0bGlzdGUgenVyw7xja3NldHplbiwgZGFtaXQgc2llIGJlaW0gbsOkY2hzdGVuIEF1ZnJ1ZiBuZXUgYXVmZ2ViYXV0IHdpcmRcclxuXHRcdFx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVByb2pla3RMaXN0ZShcIm1pdExhdExuZ0xpc3RlXCIpO1xyXG5cdFx0fVxyXG5cdFx0aWYgKEZlbGR3ZXJ0KSB7XHJcblx0XHRcdGlmICh3aW5kb3cuZW0ubXlUeXBlT2YoRmVsZHdlcnQpID09PSBcImZsb2F0XCIpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaFByb2pla3RbRmVsZG5hbWVEYl0gPSBwYXJzZUZsb2F0KEZlbGR3ZXJ0KTtcclxuXHRcdFx0fSBlbHNlIGlmICh3aW5kb3cuZW0ubXlUeXBlT2YoRmVsZHdlcnQpID09PSBcImludGVnZXJcIikge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5oUHJvamVrdFtGZWxkbmFtZURiXSA9IHBhcnNlSW50KEZlbGR3ZXJ0KTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaFByb2pla3RbRmVsZG5hbWVEYl0gPSBGZWxkd2VydDtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIGlmICh3aW5kb3cuZW0uaFByb2pla3RbRmVsZG5hbWVEYl0pIHtcclxuXHRcdFx0ZGVsZXRlIHdpbmRvdy5lbS5oUHJvamVrdFtGZWxkbmFtZURiXVxyXG5cdFx0fVxyXG5cdFx0Ly8gYWxsZXMgc3BlaWNoZXJuXHJcbiAgICAgICAgdmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLnNhdmVEb2Mod2luZG93LmVtLmhQcm9qZWt0LCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaFByb2pla3QuX3JldiA9IGRhdGEucmV2O1xyXG5cdFx0XHRcdC8vIHdpbmRvdy5adWxldHp0R2VzcGVpY2hlcnRlUHJvamVrdElkIHdpcmQgYmVudXR6dCwgZGFtaXQgYXVjaCBuYWNoIGVpbmVtXHJcblx0XHRcdFx0Ly8gRGF0ZW5zYXR6d2VjaHNlbCBkaWUgTGlzdGVuIG5pY2h0IChpbW1lcikgYXVzIGRlciBEQiBnZWhvbHQgd2VyZGVuIG3DvHNzZW5cclxuXHRcdFx0XHQvLyBadWxldHp0IGdlc3BlaWNoZXJ0ZSBQcm9qZWt0SWQgTkFDSCBkZW0gc3BlaWNoZXJuIHNldHplblxyXG5cdFx0XHRcdC8vIHNpY2hlcnN0ZWxsZW4sIGRhc3MgYmlzIGRhaGluIG5pY2h0IHNjaG9uIGVpbmUgbsOkY2hzdGUgdmV3ZW5kZXQgd2lyZFxyXG5cdFx0XHRcdC8vIGRhcnVtIHp3aXNjaGVuc3BlaWNoZXJuXHJcblx0XHRcdFx0d2luZG93LmVtLmhQcm9qZWt0SWRad2lzY2hlbnNwZWljaGVyID0gbG9jYWxTdG9yYWdlLlByb2pla3RJZDtcclxuXHRcdFx0XHQvL3NldFRpbWVvdXQoXCJ3aW5kb3cuWnVsZXR6dEdlc3BlaWNoZXJ0ZVByb2pla3RJZCA9IHdpbmRvdy5lbS5oUHJvamVrdElkWndpc2NoZW5zcGVpY2hlclwiLCAxMDAwKTtcdEFVU0dFU0NIQUxURVQsIERBIFp1bGV0enRHZXNwZWljaGVydGVQcm9qZWt0SWQgTklSR0VORFMgVkVSV0VOREVUIFdJUkRcclxuXHRcdFx0XHRzZXRUaW1lb3V0KFwiZGVsZXRlIHdpbmRvdy5lbS5oUHJvamVrdElkWndpc2NoZW5zcGVpY2hlclwiLCAxNTAwKTtcclxuXHRcdFx0XHQvLyBuaWNodCBha3R1YWxpc2llcnRlIGhpZXJhcmNoaXNjaCB0aWVmZXJlIExpc3RlbiBsw7ZzY2hlblxyXG5cdFx0XHRcdGRlbGV0ZSB3aW5kb3cuZW0uT3J0ZVZvblJhdW07XHJcblx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5lbS5aZWl0ZW5Wb25SYXVtO1xyXG5cdFx0XHRcdGRlbGV0ZSB3aW5kb3cuZW0uWmVpdGVuVm9uT3J0O1xyXG5cdFx0XHRcdGRlbGV0ZSB3aW5kb3cuZW0uQXJ0ZW5Wb25SYXVtO1xyXG5cdFx0XHRcdGRlbGV0ZSB3aW5kb3cuZW0uQXJ0ZW5Wb25PcnQ7XHJcblx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5lbS5BcnRlblZvblplaXQ7XHJcblx0XHRcdH0sXHJcblx0XHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyIGluIGZ1bmN0aW9uIHNwZWljaGVyZUhQcm9qZWt0RWRpdF8yKHRoYXQpJyk7XHJcblx0XHRcdFx0Ly9tZWxkZShcIkZlaGxlcjogw4RuZGVydW5nIGluIFwiICsgRmVsZG5hbWVEYiArIFwiIG5pY2h0IGdlc3BlaWNoZXJ0XCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG4vLyDDlmZmbmV0IGRlbiB2b3JpZ2VuIG9kZXIgbsOkY2hzdGVuIE9ydFxyXG4vLyB2b3JpZ2VyIGRlcyBlcnN0ZW4gPT4gT3J0TGlzdGVcclxuLy8gbsOkY2hzdGVyIGRlcyBsZXR6dGVuID0+IG1lbGRlblxyXG4vLyBlcndhcnRldCBkaWUgSUQgZGVzIGFrdHVlbGxlbiBEYXRlbnNhdHplcyB1bmQgb2IgbsOkY2hzdGVyIG9kZXIgdm9yaWdlciBnZXN1Y2h0IHdpcmRcclxuLy8gd2lyZCBiZW51dHp0IGluIGhPcnRFZGl0Lmh0bWxcclxud2luZG93LmVtLm7DpGNoc3RlclZvcmlnZXJPcnQgPSBmdW5jdGlvbihOw6RjaHN0ZXJPZGVyVm9yaWdlcikge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBwcsO8ZmVuLCBvYiBPcnRMaXN0ZSBzY2hvbiBleGlzdGllcnRcclxuXHQvLyBudXIgYWJmcmFnZW4sIHdlbm4gc2llIG5vY2ggbmljaHQgZXhpc3RpZXJ0XHJcblx0aWYgKHdpbmRvdy5lbS5PcnRMaXN0ZSkge1xyXG5cdFx0Ly8gT3J0bGlzdGUgbGllZ3QgYWxzIFZhcmlhYmxlIHZvclxyXG5cdFx0d2luZG93LmVtLm7DpGNoc3RlclZvcmlnZXJPcnRfMihOw6RjaHN0ZXJPZGVyVm9yaWdlcik7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIGtlaW5lIE9ydGxpc3RlIHZvcmhhbmRlblxyXG5cdFx0Ly8gbmV1IGF1cyBEQiBlcnN0ZWxsZW5cclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi52aWV3KCdldmFiL2hPcnRMaXN0ZT9zdGFydGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiLCBcIicgKyBsb2NhbFN0b3JhZ2UuUmF1bUlkICsgJ1wiXSZlbmRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5FbWFpbCArICdcIiwgXCInICsgbG9jYWxTdG9yYWdlLlJhdW1JZCArICdcIiAse31dJmluY2x1ZGVfZG9jcz10cnVlJywge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0Ly8gT3J0TGlzdGUgZsO8ciBoT3J0TGlzdGUuaHRtbCBiZXJlaXRzdGVsbGVuXHJcblx0XHRcdFx0d2luZG93LmVtLk9ydExpc3RlID0gZGF0YTtcclxuXHRcdFx0XHR3aW5kb3cuZW0ubsOkY2hzdGVyVm9yaWdlck9ydF8yKE7DpGNoc3Rlck9kZXJWb3JpZ2VyKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLm7DpGNoc3RlclZvcmlnZXJPcnRfMiA9IGZ1bmN0aW9uKE7DpGNoc3Rlck9kZXJWb3JpZ2VyKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBpLFxyXG5cdFx0T3J0SWRBa3R1ZWxsLFxyXG5cdFx0QW56T3J0O1xyXG5cdGZvciAoaT0wOyB3aW5kb3cuZW0uT3J0TGlzdGUucm93cy5sZW5ndGg7IGkrKykge1xyXG5cdFx0T3J0SWRBa3R1ZWxsID0gd2luZG93LmVtLk9ydExpc3RlLnJvd3NbaV0uZG9jLl9pZDtcclxuXHRcdEFuek9ydCA9IHdpbmRvdy5lbS5PcnRMaXN0ZS5yb3dzLmxlbmd0aCAtMTsgIC8vIHZvcnNpY2h0OiBPYmpla3RlIHrDpGhsZW4gRWxlbWVudGUgYWIgMSwgQXJyYXlzIGFiIDAhXHJcblx0XHRpZiAoT3J0SWRBa3R1ZWxsID09PSBsb2NhbFN0b3JhZ2UuT3J0SWQpIHtcclxuXHRcdFx0c3dpdGNoIChOw6RjaHN0ZXJPZGVyVm9yaWdlcikge1xyXG5cdFx0XHRjYXNlIFwibsOkY2hzdGVyXCI6XHJcblx0XHRcdFx0aWYgKGkgPCBBbnpPcnQpIHtcclxuXHRcdFx0XHRcdGxvY2FsU3RvcmFnZS5PcnRJZCA9IHdpbmRvdy5lbS5PcnRMaXN0ZS5yb3dzW2krMV0uZG9jLl9pZDtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VPcnRFZGl0KFwib2huZUlkXCIpO1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLmluaXRpaWVyZU9ydEVkaXQoKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRGFzIGlzdCBkZXIgbGV0enRlIE9ydFwiKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgXCJ2b3JpZ2VyXCI6XHJcblx0XHRcdFx0aWYgKGkgPiAwKSB7XHJcblx0XHRcdFx0XHRsb2NhbFN0b3JhZ2UuT3J0SWQgPSB3aW5kb3cuZW0uT3J0TGlzdGUucm93c1tpLTFdLmRvYy5faWQ7XHJcblx0XHRcdFx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlT3J0RWRpdChcIm9obmVJZFwiKTtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5pbml0aWllcmVPcnRFZGl0KCk7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VPcnRFZGl0KCk7XHJcblx0XHRcdFx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhPcnRMaXN0ZS5odG1sXCIpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxufTtcclxuXHJcbi8vIHdpcmQgYmVudXR6dCBpbiBoT3J0RWRpdC5odG1sXHJcbndpbmRvdy5lbS52YWxpZGF0ZWhPcnRFZGl0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghJChcIltuYW1lPSdvTmFtZSddXCIpLnZhbCgpKSB7XHJcblx0XHR3aW5kb3cuZW0ubWVsZGUoXCJCaXR0ZSBPcnRuYW1lbiBlaW5nZWJlblwiKTtcclxuXHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IFxyXG5cdFx0XHQkKFwiW25hbWU9J29OYW1lJ11cIikuZm9jdXMoKTsgXHJcblx0XHR9LCA1MCk7ICAvLyBuZWVkIHRvIHVzZSBhIHRpbWVyIHNvIHRoYXQgLmJsdXIoKSBjYW4gZmluaXNoIGJlZm9yZSB5b3UgZG8gLmZvY3VzKClcclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9XHJcblx0cmV0dXJuIHRydWU7XHJcbn07XHJcblxyXG4vLyB3aXJkIGJlbnV0enQgaW4gaE9ydEVkaXQuaHRtbFxyXG53aW5kb3cuZW0uc3BlaWNoZXJlSE9ydEVkaXQgPSBmdW5jdGlvbih0aGF0KSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIGRpZSBldmVudGhhbmRsZXIgw7xiZXJnZWJlbiB0aGlzIG5pY2h0IMO8YmVyIGRpZSBLbGFtbWVyXHJcblx0dmFyIF90aGlzID0gdGhhdCB8fCB0aGlzO1xyXG5cdC8vIHByw7xmZW4sIG9iIE9ydCBleGlzdGllcnRcclxuXHRpZiAod2luZG93LmVtLmhPcnQpIHtcclxuXHRcdC8vIGJlc3RlaGVkZXMgT2JqZWt0IHZlcndlbmRlblxyXG5cdFx0d2luZG93LmVtLnNwZWljaGVyZUhPcnRFZGl0XzIoX3RoaXMpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBrZWluIE9ydCA+IGF1cyBEQiBob2xlblxyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLm9wZW5Eb2MobG9jYWxTdG9yYWdlLk9ydElkLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaE9ydCA9IGRhdGE7XHJcblx0XHRcdFx0d2luZG93LmVtLnNwZWljaGVyZUhPcnRFZGl0XzIoX3RoaXMpO1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlciBpbiBmdW5jdGlvbiBzcGVpY2hlcmVIT3J0RWRpdCcpO1xyXG5cdFx0XHRcdC8vbWVsZGUoXCJGZWhsZXI6IMOEbmRlcnVuZyBpbiBcIiArIEZlbGRuYW1lICsgXCIgbmljaHQgZ2VzcGVpY2hlcnRcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5zcGVpY2hlcmVIT3J0RWRpdF8yID0gZnVuY3Rpb24odGhhdCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuICAgIHZhciBGZWxkbmFtZURiLFxyXG4gICAgICAgIEZlbGR3ZXJ0LFxyXG4gICAgICAgIGZlbGRpbmZvcztcclxuICAgIC8vIEZlbGRuYW1lIHVuZCAtd2VydCBlcm1pdHRlbG5cclxuICAgIGZlbGRpbmZvcyA9IHdpbmRvdy5lbS5ob2xlRmVsZEluZm9zVm9uRWxlbWVudCh0aGF0KTtcclxuICAgIEZlbGRuYW1lRGIgPSBmZWxkaW5mb3MuZmVsZG5hbWVfZGI7XHJcbiAgICBGZWxkd2VydCA9IGZlbGRpbmZvcy5mZWxkd2VydDtcclxuXHRpZiAod2luZG93LmVtLnZhbGlkYXRlaE9ydEVkaXQoKSkge1xyXG5cdFx0aWYgKEZlbGRuYW1lRGIgPT09IFwib05hbWVcIikge1xyXG5cdFx0XHQvLyBWYXJpYWJsZW4gZsO8ciBPcnRMaXN0ZSB6dXLDvGNrc2V0emVuLCBkYW1pdCBkaWUgTGlzdGUgYmVpbSBuw6RjaHN0ZW4gQXVmcnVmIG5ldSBhdWZnZWJhdXQgd2lyZFxyXG5cdFx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlT3J0TGlzdGUoXCJtaXRMYXRMbmdMaXN0ZVwiKTtcclxuXHRcdH1cclxuXHRcdC8vIFdlcnRlIGF1cyBkZW0gRm9ybXVsYXIgYWt0dWFsaXNpZXJlblxyXG5cdFx0aWYgKEZlbGR3ZXJ0KSB7XHJcblx0XHRcdGlmICh3aW5kb3cuZW0ubXlUeXBlT2YoRmVsZHdlcnQpID09PSBcImZsb2F0XCIpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaE9ydFtGZWxkbmFtZURiXSA9IHBhcnNlRmxvYXQoRmVsZHdlcnQpO1xyXG5cdFx0XHR9IGVsc2UgaWYgKHdpbmRvdy5lbS5teVR5cGVPZihGZWxkd2VydCkgPT09IFwiaW50ZWdlclwiKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLmhPcnRbRmVsZG5hbWVEYl0gPSBwYXJzZUludChGZWxkd2VydCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0d2luZG93LmVtLmhPcnRbRmVsZG5hbWVEYl0gPSBGZWxkd2VydDtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIGlmICh3aW5kb3cuZW0uaE9ydFtGZWxkbmFtZURiXSkge1xyXG5cdFx0XHRkZWxldGUgd2luZG93LmVtLmhPcnRbRmVsZG5hbWVEYl1cclxuXHRcdH1cclxuXHRcdC8vIGFsbGVzIHNwZWljaGVyblxyXG4gICAgICAgIHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi5zYXZlRG9jKHdpbmRvdy5lbS5oT3J0LCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaE9ydC5fcmV2ID0gZGF0YS5yZXY7XHJcblx0XHRcdFx0Ly8gd2luZG93Llp1bGV0enRHZXNwZWljaGVydGVPcnRJZCB3aXJkIGJlbnV0enQsIGRhbWl0IGF1Y2ggbmFjaCBlaW5lbVxyXG5cdFx0XHRcdC8vIERhdGVuc2F0endlY2hzZWwgZGllIExpc3RlbiBuaWNodCAoaW1tZXIpIGF1cyBkZXIgREIgZ2Vob2x0IHdlcmRlbiBtw7xzc2VuXHJcblx0XHRcdFx0Ly8gWnVsZXR6dCBnZXNwZWljaGVydGUgT3J0SWQgTkFDSCBkZW0gc3BlaWNoZXJuIHNldHplblxyXG5cdFx0XHRcdC8vIHNpY2hlcnN0ZWxsZW4sIGRhc3MgYmlzIGRhaGluIG5pY2h0IHNjaG9uIGVpbmUgbsOkY2hzdGUgdmV3ZW5kZXQgd2lyZFxyXG5cdFx0XHRcdC8vIGRhcnVtIHp3aXNjaGVuc3BlaWNoZXJuXHJcblx0XHRcdFx0d2luZG93LmVtLk9ydElkWndpc2NoZW5zcGVpY2hlciA9IGxvY2FsU3RvcmFnZS5PcnRJZDtcclxuXHRcdFx0XHQvL3NldFRpbWVvdXQoXCJ3aW5kb3cuWnVsZXR6dEdlc3BlaWNoZXJ0ZU9ydElkID0gd2luZG93LmVtLk9ydElkWndpc2NoZW5zcGVpY2hlclwiLCAxMDAwKTtcdEFVU0dFU0NIQUxURVQsIERBIFp1bGV0enRHZXNwZWljaGVydGVPcnRJZCBOSVJHRU5EUyBCRU5VVFpUIFdJUkRcclxuXHRcdFx0XHRzZXRUaW1lb3V0KFwiZGVsZXRlIHdpbmRvdy5lbS5PcnRJZFp3aXNjaGVuc3BlaWNoZXJcIiwgMTUwMCk7XHJcblx0XHRcdFx0Ly8gbmljaHQgYWt0dWFsaXNpZXJ0ZSBoaWVyYXJjaGlzY2ggdGllZmVyZSBMaXN0ZW4gbMO2c2NoZW5cclxuXHRcdFx0XHRkZWxldGUgd2luZG93LmVtLlplaXRlblZvblByb2pla3Q7XHJcblx0XHRcdFx0ZGVsZXRlIHdpbmRvdy5lbS5aZWl0ZW5Wb25SYXVtO1xyXG5cdFx0XHRcdGRlbGV0ZSB3aW5kb3cuZW0uQXJ0ZW5Wb25Qcm9qZWt0O1xyXG5cdFx0XHRcdGRlbGV0ZSB3aW5kb3cuZW0uQXJ0ZW5Wb25SYXVtO1xyXG5cdFx0XHRcdGRlbGV0ZSB3aW5kb3cuZW0uQXJ0ZW5Wb25aZWl0O1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlciBpbiBmdW5jdGlvbiBzcGVpY2hlcmVIT3J0RWRpdF8yKHRoYXQpJyk7XHJcblx0XHRcdFx0Ly9tZWxkZShcIkZlaGxlcjogw4RuZGVydW5nIGluIFwiICsgRmVsZG5hbWVEYiArIFwiIG5pY2h0IGdlc3BlaWNoZXJ0XCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG4vLyB3aXJkIGJlbnV0enQgaW4gaE9ydEVkaXQuaHRtbFxyXG53aW5kb3cuZW0ubMO2c2NoZU9ydCA9IGZ1bmN0aW9uKEFydGVuLCBaZWl0ZW4pIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gbnVyIGzDtnNjaGVuLCB3byBEYXRlbnPDpHR6ZSB2b3Jrb21tZW5cclxuXHRpZiAoWmVpdGVuLnJvd3MubGVuZ3RoID4gMCkge1xyXG5cdFx0d2luZG93LmVtLmxvZXNjaGVJZElkUmV2TGlzdGUoWmVpdGVuKTtcclxuXHR9XHJcblx0aWYgKEFydGVuLnJvd3MubGVuZ3RoID4gMCkge1xyXG5cdFx0d2luZG93LmVtLmxvZXNjaGVJZElkUmV2TGlzdGUoQXJ0ZW4pO1xyXG5cdH1cclxuXHQvLyB6dWxldHp0IGRlbiBPcnQgbMO2c2NoZW5cclxuXHRpZiAod2luZG93LmVtLmhPcnQpIHtcclxuXHRcdC8vIE9iamVrdCBudXR6ZW5cclxuXHRcdHdpbmRvdy5lbS5sw7ZzY2hlT3J0XzIoKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gT2JqZWt0IGF1cyBEQiBob2xlblxyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLm9wZW5Eb2MobG9jYWxTdG9yYWdlLk9ydElkLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaE9ydCA9IGRhdGE7XHJcblx0XHRcdFx0d2luZG93LmVtLmzDtnNjaGVPcnRfMigpO1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRmVobGVyOiBEZXIgT3J0IHd1cmRlIG5pY2h0IGdlbMO2c2NodFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLmzDtnNjaGVPcnRfMiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0JGRiLnJlbW92ZURvYyh3aW5kb3cuZW0uaE9ydCwge1xyXG5cdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHQvLyBMaXN0ZSBhbnBhc3Nlbi4gVm9yc2ljaHQ6IEJlaSByZWZyZXNoIGthbm4gc2llIGZlaGxlblxyXG5cdFx0XHRpZiAod2luZG93LmVtLk9ydExpc3RlICYmIHdpbmRvdy5lbS5PcnRMaXN0ZS5yb3dzKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLk9ydExpc3RlLnJvd3MgPSBfLnJlamVjdCh3aW5kb3cuZW0uT3J0TGlzdGUucm93cywgZnVuY3Rpb24ocm93KSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gcm93LmRvYy5faWQgPT09IGRhdGEuaWQ7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly8gS2VpbmUgT3J0bGlzdGUgbWVoci4gU3RvcmFnZSBsw7ZzY2hlblxyXG5cdFx0XHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VPcnRMaXN0ZShcIm1pdExhdExuZ0xpc3RlXCIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VPcnRFZGl0KFwibWl0TGF0TG5nTGlzdGVcIik7XHJcblx0XHRcdCQubW9iaWxlLm5hdmlnYXRlKCdoT3J0TGlzdGUuaHRtbCcpO1xyXG5cdFx0fSxcclxuXHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRmVobGVyOiBEZXIgT3J0IHd1cmRlIG5pY2h0IGdlbMO2c2NodFwiKTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbi8vIHdpcmQgdmVyd2VuZGV0IGluIGhBcnRMaXN0ZS5odG1sXHJcbndpbmRvdy5lbS7DtmZmbmVBcnRncnVwcGVubGlzdGVfaGFsID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIEdsb2JhbGUgVmFyaWFibGVuIGbDvHIgaEFydExpc3RlIHp1csO8Y2tzZXR6ZW4sIGRhbWl0IGRpZSBMaXN0ZSBiZWltIG7DpGNoc3RlbiBBdWZydWYgbmV1IGF1ZmdlYmF1dCB3aXJkXHJcblx0Ly93aW5kb3cuZW0ubGVlcmVTdG9yYWdlaEFydExpc3RlKCk7XHJcblx0bG9jYWxTdG9yYWdlLlN0YXR1cyA9IFwibmV1XCI7XHJcblx0bG9jYWxTdG9yYWdlLlZvbiA9IFwiaEFydExpc3RlXCI7XHJcblx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5hQXJ0R3J1cHBlO1x0Ly8gdmVyaGluZGVybiwgZGFzcyBlaW5lIEFydGdydXBwZSDDvGJlcmdlYmVuIHdpcmRcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkFydGdydXBwZW5saXN0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoQXJ0RWRpdC5odG1sIGF1ZiBbbmFtZT0nT2VmZm5lQXJ0TGlzdGVoQXJ0RWRpdCddIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhBcnRFZGl0w5ZmZm5lQXJ0TGlzdGVoQXJ0RWRpdENsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VoQXJ0RWRpdCgpO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiaEFydExpc3RlLmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhBcnRFZGl0Lmh0bWwgYXVmIC5PZWZmbmVaZWl0aEFydEVkaXQgZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSEFydEVkaXTDlmZmbmVaZWl0aEFydEVkaXRDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlaEFydEVkaXQoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlaEFydExpc3RlKCk7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJoWmVpdEVkaXQuaHRtbFwiKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gaEFydEVkaXQuaHRtbCAuT2VmZm5lT3J0aEFydEVkaXQgZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSEFydEVkaXTDlmZmbmVPcnRoQXJ0RWRpdENsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VoQXJ0RWRpdCgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VoQXJ0TGlzdGUoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlWmVpdEVkaXQoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlWmVpdExpc3RlKCk7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJoT3J0RWRpdC5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoQXJ0RWRpdC5odG1sIC5PZWZmbmVSYXVtaEFydEVkaXQgZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSEFydEVkaXTDlmZmbmVSYXVtaEFydEVkaXRDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlaEFydEVkaXQoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlaEFydExpc3RlKCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVplaXRFZGl0KCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVplaXRMaXN0ZSgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VPcnRFZGl0KCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZU9ydExpc3RlKCk7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJoUmF1bUVkaXQuaHRtbFwiKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gaEFydEVkaXQuaHRtbCAuT2VmZm5lUHJvamVrdGhBcnRFZGl0IGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhBcnRFZGl0w5ZmZm5lUHJvamVrdGhBcnRFZGl0Q2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZWhBcnRFZGl0KCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZWhBcnRMaXN0ZSgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VaZWl0RWRpdCgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VaZWl0TGlzdGUoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlT3J0RWRpdCgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VPcnRMaXN0ZSgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VSYXVtRWRpdCgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VSYXVtTGlzdGUoKTtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhQcm9qZWt0RWRpdC5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoQXJ0RWRpdC5odG1sIC5zcGVpY2hlcm5BbmhhbmcgZ2XDpG5kZXJ0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhBcnRFZGl0U3BlaWNoZXJuQW5oYW5nQ2hhbmdlID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBfYXR0YWNobWVudHMgPSAkKFwiI19hdHRhY2htZW50c2hBRVwiKS52YWwoKTtcclxuXHRpZiAoX2F0dGFjaG1lbnRzICYmIF9hdHRhY2htZW50cy5sZW5ndGggIT09IDApIHtcclxuXHRcdHdpbmRvdy5lbS5zcGVpY2hlcmVBbmjDpG5nZShsb2NhbFN0b3JhZ2UuaEFydElkLCB3aW5kb3cuZW0uaEFydCwgXCJoQUVcIik7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoQXJ0RWRpdC5odG1sICNOZXVlQmVvYmhBcnRFZGl0IGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhBcnRFZGl0TmV1ZUJlb2JoQXJ0RWRpdENsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS5TdGF0dXMgPSBcIm5ldVwiO1xyXG5cdHdpbmRvdy5lbS56dUFydGdydXBwZW5saXN0ZSgpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoQXJ0RWRpdC5odG1sICN3YWVobGVGZWxkZXJoQXJ0RWRpdCBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIQXJ0RWRpdFfDpGhsZUZlbGRlckNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS5BdWZydWZlbmRlU2VpdGVGVyA9IFwiaEFydEVkaXRcIjtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkZlbGRlcldhZWhsZW4uaHRtbFwiKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gaEFydEVkaXQuaHRtbCBuYWNoIGxpbmtzIGdld2lzY2h0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhBcnRFZGl0U3dpcGVsZWZ0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghJChcIio6Zm9jdXNcIikuYXR0cihcImFyaWEtdmFsdWVub3dcIikpIHtcclxuXHRcdC8vIGtlaW4gc2xpZGVyXHJcblx0XHR3aW5kb3cuZW0ubsOkY2hzdGVWb3JpZ2VBcnQoXCJuw6RjaHN0ZVwiKTtcclxuXHR9XHJcbn07XHJcblxyXG4vLyB3ZW5uIGluIGhBcnRFZGl0Lmh0bWwgbmFjaCByZWNodHMgZ2V3aXNjaHQgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSEFydEVkaXRTd2lwZXJpZ2h0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghJChcIio6Zm9jdXNcIikuYXR0cihcImFyaWEtdmFsdWVub3dcIikpIHtcclxuXHRcdC8vIGtlaW4gc2xpZGVyXHJcblx0XHR3aW5kb3cuZW0ubsOkY2hzdGVWb3JpZ2VBcnQoXCJ2b3JpZ2VcIik7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoQXJ0RWRpdC5odG1sIFtuYW1lPSdMw7ZzY2hlQW5oYW5nJ10gZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSEFydEVkaXRMw7ZzY2hlQW5oYW5nQ2xpY2sgPSBmdW5jdGlvbih0aGF0KSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHdpbmRvdy5lbS5sw7ZzY2hlQW5oYW5nKHRoYXQsIHdpbmRvdy5lbS5oQXJ0LCBsb2NhbFN0b3JhZ2UuaEFydElkKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gaEFydEVkaXQuaHRtbCAubWVudV9hcnRlaWdlbnNjaGFmdGVuIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhBcnRFZGl0TWVudUFydGVpZ2Vuc2NoYWZ0ZW5DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cuZW0uw7ZmZm5lRWlnZW5zY2hhZnRlblZvbkFydCh3aW5kb3cuZW0uaEFydC5hQXJ0SWQpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoQXJ0RWRpdC5odG1sIC5tZW51X2VpbmZhY2hlcl9tb2R1cyBnZWtsaWNrdCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIQXJ0RWRpdE1lbnVFaW5mYWNoZXJNb2R1c0NsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VoQXJ0RWRpdCgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VoQXJ0TGlzdGUoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlWmVpdEVkaXQoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlWmVpdExpc3RlKCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZU9ydEVkaXQoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlT3J0TGlzdGUoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUmF1bUVkaXQoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUmF1bUxpc3RlKCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVByb2pla3RFZGl0KCk7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJCZW9iTGlzdGUuaHRtbFwiKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gaEFydEVkaXQuaHRtbCAubWVudV9mZWxkZXJfdmVyd2FsdGVuIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhBcnRFZGl0TWVudUZlbGRlclZlcndhbHRlbkNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS56dXJ1ZWNrID0gXCJoQXJ0RWRpdC5odG1sXCI7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJGZWxkTGlzdGUuaHRtbFwiKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gaEFydEVkaXQuaHRtbCAubWVudV9iZW9iX2V4cG9ydGllcmVuIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhBcnRFZGl0TWVudUJlb2JFeHBvcnRpZXJlbkNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHdpbmRvdy5vcGVuKCdfbGlzdC9FeHBvcnRCZW9iL0V4cG9ydEJlb2I/c3RhcnRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5FbWFpbCArICdcIl0mZW5ka2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCIse30se31dJmluY2x1ZGVfZG9jcz10cnVlJyk7XHJcblx0JChcIiNNZW51aEFydEVkaXRcIilcclxuICAgICAgICAvLyB2w7ZsbGlnIHVubG9naXNjaDogZGFzIGJlcmVpdHMgb2ZmZW5lIHBvcHVwIG11c3MgenVlcnN0IGluaXRpYWxpc2llcnQgd2VyZGVuLi4uXHJcbiAgICAgICAgLnBvcHVwKClcclxuICAgICAgICAvLyAuLi5iZXZvciBlcyBnZXNjaGxvc3NlbiB3ZXJkZW4gbXVzcywgd2VpbCBlcyBzb25zdCBvZmZlbiBibGVpYnRcclxuICAgICAgICAucG9wdXAoXCJjbG9zZVwiKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaW4gaEFydEVkaXQuaHRtbCAubWVudV9laW5zdGVsbHVuZ2VuIGdla2xpY2t0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZUhBcnRFZGl0TWVudUVpbnN0ZWxsdW5nZW5DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuenVydWVjayA9IFwiaEFydEVkaXQuaHRtbFwiO1xyXG5cdHdpbmRvdy5lbS7DtmZmbmVNZWluZUVpbnN0ZWxsdW5nZW4oKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaFByb2pla3RMaXN0ZSBlcnNjaGVpbnRcclxud2luZG93LmVtLmhhbmRsZUhQcm9qZWt0TGlzdGVQYWdlc2hvdyA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAobG9jYWxTdG9yYWdlLmxlbmd0aCA9PT0gMCB8fCAhbG9jYWxTdG9yYWdlLkVtYWlsKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKCk7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImluZGV4Lmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdHdpbmRvdy5lbS5pbml0aWllcmVQcm9qZWt0bGlzdGUoKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaFByb2pla3RMaXN0ZSBpbml0aWllcnQgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSFByb2pla3RMaXN0ZVBhZ2Vpbml0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIFdpcmQgZGllc2UgU2VpdGUgZGlyZWt0IGF1ZmdlcnVmZW4gdW5kIGVzIGdpYnQga2VpbmVuIGxvY2FsU3RvcmFnZSxcclxuXHQvLyBtdXNzIGF1ZiBpbmRleC5odG1sIHVtZ2VsZWl0ZXQgd2VyZGVuXHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHJcbiAgICAkKGRvY3VtZW50KVxyXG4gICAgICAgIC8vIGluYWt0aXZlIHRhYnMgaW5ha3RpdmllcmVuXHJcbiAgICAgICAgLy8gQkVaVUcgQVVGIERPQ1VNRU5ULCBXRUlMIEVTIE1JVCBCRVpVRyBBVUYgaWQgZGVzIGhlYWRlciBOSUNIVCBGVU5LVElPTklFUlRFISEhPz8/XHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIudGFiX2luYWt0aXZcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG5cdCQoXCIjaFByb2pla3RMaXN0ZVBhZ2VIZWFkZXJcIilcclxuICAgICAgICAub24oJ2NsaWNrJywgJyNPZWZmbmVQcm9qZWt0TGlzdGVQcm9qZWt0TGlzdGUnLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnI09lZmZuZUJlb2JMaXN0ZVByb2pla3RMaXN0ZScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICQubW9iaWxlLm5hdmlnYXRlKFwiQmVvYkxpc3RlLmh0bWxcIik7XHJcbiAgICAgICAgfSk7XHJcblxyXG5cdCQoXCIjaFByb2pla3RMaXN0ZVwiKVxyXG4gICAgICAgIC8vIG5ldWVzIFByb2pla3QgZXJzdGVsbGVuXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIuTmV1ZXNQcm9qZWt0UHJvamVrdExpc3RlXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5lcnN0ZWxsZU5ldWVzUHJvamVrdCgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLm9uKFwic3dpcGVyaWdodFwiLCB3aW5kb3cuZW0uaGFuZGxlUHJvamVrdExpc3RlU3dpcGVyaWdodCk7XHJcblxyXG5cdCQoXCIjUHJvamVrdGxpc3RlaFBMXCIpXHJcbiAgICAgICAgLm9uKFwic3dpcGVsZWZ0XCIsIFwiLlByb2pla3RcIiwgd2luZG93LmVtLmhhbmRsZVByb2pla3RMaXN0ZVN3aXBlbGVmdClcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIi5Qcm9qZWt0XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVQcm9qZWt0TGlzdGVQcm9qZWt0Q2xpY2sodGhpcyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJzd2lwZWxlZnRcIiwgXCIuZXJzdGVcIiwgd2luZG93LmVtLmVyc3RlbGxlTmV1ZXNQcm9qZWt0KTtcclxuXHJcblx0JCgnI1Byb2pla3RMaXN0ZVBhZ2VGb290ZXInKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnI09lZmZuZUthcnRlUHJvamVrdExpc3RlJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZVByb2pla3RMaXN0ZcOWZmZuZUthcnRlQ2xpY2soKTtcclxuICAgICAgICB9KTtcclxuXHJcblx0JCgnI01lbnVQcm9qZWt0TGlzdGUnKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfZWluZmFjaGVyX21vZHVzJywgd2luZG93LmVtLmhhbmRsZVByb2pla3RMaXN0ZU1lbnVFaW5mYWNoZXJNb2R1c0NsaWNrKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfZmVsZGVyX3ZlcndhbHRlbicsIHdpbmRvdy5lbS5oYW5kbGVQcm9qZWt0TGlzdGVNZW51RmVsZGVyVmVyd2FsdGVuQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9wcm9qZWt0ZV9leHBvcnRpZXJlbicsIHdpbmRvdy5lbS5oYW5kbGVIUHJvamVrdExpc3RlTWVudVByb2pla3RlRXhwb3J0aWVyZW5DbGljaylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2VpbnN0ZWxsdW5nZW4nLCB3aW5kb3cuZW0uaGFuZGxlUHJvamVrdExpc3RlTWVudUVpbnN0ZWxsdW5nZW5DbGljaylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X25ldV9hbm1lbGRlbicsIHdpbmRvdy5lbS5tZWxkZU5ldUFuKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfYXJ0ZW5ncnVwcGVuX2ltcG9ydGllcmVuJywgd2luZG93LmVtLsO2ZmZuZUFydGVuZ3J1cHBlbkltcG9ydGllcmVuKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfYXJ0ZW5faW1wb3J0aWVyZW4nLCB3aW5kb3cuZW0uw7ZmZm5lQXJ0ZW5JbXBvcnRpZXJlbilcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2FkbWluJywgd2luZG93LmVtLsO2ZmZuZUFkbWluKTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVQcm9qZWt0TGlzdGVTd2lwZWxlZnQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLlByb2pla3RJZCA9ICQodGhpcykuYXR0cignUHJvamVrdElkJyk7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJoUmF1bUxpc3RlLmh0bWxcIik7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlUHJvamVrdExpc3RlUHJvamVrdENsaWNrID0gZnVuY3Rpb24odGhhdCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuUHJvamVrdElkID0gJCh0aGF0KS5hdHRyKCdQcm9qZWt0SWQnKTtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhQcm9qZWt0RWRpdC5odG1sXCIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVByb2pla3RMaXN0ZVN3aXBlcmlnaHQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJCZW9iTGlzdGUuaHRtbFwiKTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVQcm9qZWt0TGlzdGXDlmZmbmVLYXJ0ZUNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS56dXJ1ZWNrID0gXCJoUHJvamVrdExpc3RlXCI7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJLYXJ0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVByb2pla3RMaXN0ZU1lbnVFaW5mYWNoZXJNb2R1c0NsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiQmVvYkxpc3RlLmh0bWxcIik7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlUHJvamVrdExpc3RlTWVudUZlbGRlclZlcndhbHRlbkNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS56dXJ1ZWNrID0gXCJoUHJvamVrdExpc3RlLmh0bWxcIjtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkZlbGRMaXN0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxuLy8gd2VubiBpbiBoUHJvamVrdExpc3RlLmh0bWwgLm1lbnVfcHJvamVrdGVfZXhwb3J0aWVyZW4gZ2VrbGlja3Qgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSFByb2pla3RMaXN0ZU1lbnVQcm9qZWt0ZUV4cG9ydGllcmVuQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93Lm9wZW4oJ19saXN0L0V4cG9ydFByb2pla3QvRXhwb3J0UHJvamVrdD9zdGFydGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiLHt9LHt9LHt9LHt9LHt9XSZlbmRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5FbWFpbCArICdcIl0mZGVzY2VuZGluZz10cnVlJmluY2x1ZGVfZG9jcz10cnVlJyk7XHJcblx0JChcIiNNZW51UHJvamVrdExpc3RlXCIpXHJcbiAgICAgICAgLy8gdsO2bGxpZyB1bmxvZ2lzY2g6IGRhcyBiZXJlaXRzIG9mZmVuZSBwb3B1cCBtdXNzIHp1ZXJzdCBpbml0aWFsaXNpZXJ0IHdlcmRlbi4uLlxyXG4gICAgICAgIC5wb3B1cCgpXHJcbiAgICAgICAgLy8gLi4uYmV2b3IgZXMgZ2VzY2hsb3NzZW4gd2VyZGVuIG11c3MsIHdlaWwgZXMgc29uc3Qgb2ZmZW4gYmxlaWJ0XHJcbiAgICAgICAgLnBvcHVwKFwiY2xvc2VcIik7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlUHJvamVrdExpc3RlTWVudUVpbnN0ZWxsdW5nZW5DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuenVydWVjayA9IFwiaFByb2pla3RMaXN0ZS5odG1sXCI7XHJcblx0d2luZG93LmVtLsO2ZmZuZU1laW5lRWluc3RlbGx1bmdlbigpO1xyXG59O1xyXG5cclxuLy8gd2VubiBoUmF1bUVkaXQgZXJzY2hlaW50XHJcbndpbmRvdy5lbS5oYW5kbGVSYXVtRWRpdFBhZ2VzaG93ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIFNvbGx0ZSBrZWluZSBpZCB2b3JsaWVnZW4sIHp1IGhQcm9qZWt0TGlzdGUuaHRtbCB3ZWNoc2VsblxyXG5cdC8vIGRhcyBrb21tdCBpbSBOb3JtYWxmYWxsIG51ciB2b3IsIHdlbm4gZGVyIENhY2hlIGRlcyBCcm93c2VycyBnZWxlZXJ0IHd1cmRlXHJcblx0Ly8gb2RlciBpbiBkZXIgWndpc2NoZW56ZWl0IGF1ZiBlaW5lbSBhbmRlcmVuIEJyb3dzZXIgZGllc2VyIERhdGVuc2F0eiBnZWzDtnNjaHQgd3VyZGVcclxuXHRpZiAobG9jYWxTdG9yYWdlLmxlbmd0aCA9PT0gMCB8fCAhbG9jYWxTdG9yYWdlLkVtYWlsKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKCk7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImluZGV4Lmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fSBlbHNlIGlmICgoIWxvY2FsU3RvcmFnZS5TdGF0dXMgfHwgbG9jYWxTdG9yYWdlLlN0YXR1cyA9PT0gXCJ1bmRlZmluZWRcIikgJiYgKCFsb2NhbFN0b3JhZ2UuUmF1bUlkIHx8IGxvY2FsU3RvcmFnZS5SYXVtSWQgPT09IFwidW5kZWZpbmVkXCIpKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKFwib2huZUNsZWFyXCIpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJoUHJvamVrdExpc3RlLmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdHdpbmRvdy5lbS5pbml0aWllcmVSYXVtRWRpdCgpO1xyXG59O1xyXG5cclxuLy8gd2VubiBoUmF1bUVkaXQgaW5pdGlpZXJ0IHdpcmRcclxud2luZG93LmVtLmhhbmRsZVJhdW1FZGl0UGFnZWluaXQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gV2lyZCBkaWVzZSBTZWl0ZSBkaXJla3QgYXVmZ2VydWZlbiB1bmQgZXMgZ2lidCBrZWluZW4gbG9jYWxTdG9yYWdlLFxyXG5cdC8vIG11c3MgYXVmIGluZGV4Lmh0bWwgdW1nZWxlaXRldCB3ZXJkZW5cclxuXHRpZiAobG9jYWxTdG9yYWdlLmxlbmd0aCA9PT0gMCB8fCAhbG9jYWxTdG9yYWdlLkVtYWlsKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKCk7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImluZGV4Lmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fSBlbHNlIGlmICgoIWxvY2FsU3RvcmFnZS5TdGF0dXMgfHwgbG9jYWxTdG9yYWdlLlN0YXR1cyA9PT0gXCJ1bmRlZmluZWRcIikgJiYgKCFsb2NhbFN0b3JhZ2UuUmF1bUlkIHx8IGxvY2FsU3RvcmFnZS5SYXVtSWQgPT09IFwidW5kZWZpbmVkXCIpKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKFwib2huZUNsZWFyXCIpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJoUHJvamVrdExpc3RlLmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHQkKFwiI1JhdW1FZGl0SGVhZGVyXCIpXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCJbbmFtZT0nT2VmZm5lUmF1bUxpc3RlUmF1bUVkaXQnXVwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlUmF1bUVkaXTDlmZmbmVSYXVtTGlzdGVDbGljaygpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLy8gTGluayB6dSBQcm9qZWt0IGluIE5hdmJhciB1bmQgVGl0ZWxsZWlzdGVcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiNQcm9qZWt0T2VmZm5lblJhdW1FZGl0XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVSYXVtRWRpdFByb2pla3TDlmZmbmVuQ2xpY2soKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC8vIExpbmsgenUgT3J0bGlzdGUgaW4gTmF2YmFyXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIjT3J0TGlzdGVPZWZmbmVuUmF1bUVkaXRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgJC5tb2JpbGUubmF2aWdhdGUoXCJoT3J0TGlzdGUuaHRtbFwiKTtcclxuICAgICAgICB9KTtcclxuXHJcblx0JChcIiNoUmF1bUVkaXRGb3JtXCIpXHJcbiAgICAgICAgLy8gRsO8ciBqZWRlcyBGZWxkIGJlaSDDhG5kZXJ1bmcgc3BlaWNoZXJuXHJcbiAgICAgICAgLm9uKFwiY2hhbmdlXCIsIFwiLnNwZWljaGVyblwiLCB3aW5kb3cuZW0uc3BlaWNoZXJlUmF1bSlcclxuICAgICAgICAvLyBFaW5nYWJlIGltIFphaGxlbmZlbGQgYWJmYW5nZW5cclxuICAgICAgICAub24oXCJibHVyXCIsICcuc3BlaWNoZXJuU2xpZGVyJywgd2luZG93LmVtLnNwZWljaGVyZVJhdW0pXHJcbiAgICAgICAgLy8gS2xpY2tlbiBhdWYgZGVuIFBmZWlsZW4gaW0gWmFobGVuZmVsZCBhYmZhbmdlblxyXG4gICAgICAgIC5vbihcIm1vdXNldXBcIiwgJy51aS1zbGlkZXItaW5wdXQnLCB3aW5kb3cuZW0uc3BlaWNoZXJlUmF1bSlcclxuICAgICAgICAvLyBFbmRlIGRlcyBTY2hpZWJlbnMgYWJmYW5nZW5cclxuICAgICAgICAub24oXCJzbGlkZXN0b3BcIiwgJy5zcGVpY2hlcm5TbGlkZXInLCB3aW5kb3cuZW0uc3BlaWNoZXJlUmF1bSk7XHJcblxyXG5cdCQoJyNoUmF1bUVkaXRGb290ZXInKVxyXG4gICAgICAgIC8vIENvZGUgZsO8ciBkZW4gUmF1bS1Mw7ZzY2hlbi1EaWFsb2dcclxuICAgICAgICAub24oJ2NsaWNrJywgJyNMb2VzY2hlUmF1bVJhdW1FZGl0JywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZVJhdW1FZGl0TMO2c2NoZVJhdW1DbGljaygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHQkKFwiI2hyZV9sw7ZzY2hlbl9tZWxkdW5nXCIpXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIjaHJlX2zDtnNjaGVuX21lbGR1bmdfamFfbG9lc2NoZW5cIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciAkaHJlX2zDtnNjaGVuX21lbGR1bmcgPSAkKFwiI2hyZV9sw7ZzY2hlbl9tZWxkdW5nXCIpWzBdO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0ubMO2c2NoZVJhdW0oalF1ZXJ5LmRhdGEoJGhyZV9sw7ZzY2hlbl9tZWxkdW5nLCAnQXJ0ZW4nKSwgalF1ZXJ5LmRhdGEoJGhyZV9sw7ZzY2hlbl9tZWxkdW5nLCAnWmVpdGVuJyksIGpRdWVyeS5kYXRhKCRocmVfbMO2c2NoZW5fbWVsZHVuZywgJ09ydGUnKSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgJChkb2N1bWVudClcclxuICAgICAgICAvLyBpbmFrdGl2ZSB0YWJzIGluYWt0aXZpZXJlblxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiLnRhYl9pbmFrdGl2XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHQkKFwiI2hSYXVtRWRpdFwiKVxyXG4gICAgICAgIC5vbihcInN3aXBlbGVmdFwiLCBcIiNoUmF1bUVkaXRDb250ZW50XCIsIHdpbmRvdy5lbS5oYW5kbGVSYXVtRWRpdENvbnRlbnRTd2lwcmVsZWZ0KVxyXG4gICAgICAgIC5vbihcInN3aXBlcmlnaHRcIiwgXCIjaFJhdW1FZGl0Q29udGVudFwiLCB3aW5kb3cuZW0uaGFuZGxlUmF1bUVkaXRDb250ZW50U3dpcGVyaWdodClcclxuICAgICAgICAvLyBQYWdpbmF0aW9uIFBmZWlsIHZvcmlnZXIgaW5pdGlhbGlzaWVyZW5cclxuICAgICAgICAub24oXCJ2Y2xpY2tcIiwgXCIudWktcGFnaW5hdGlvbi1wcmV2XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5uw6RjaHN0ZXJWb3JpZ2VyUmF1bShcInZvcmlnZXJcIik7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAvLyBQYWdpbmF0aW9uIFBmZWlsIG7DpGNoc3RlciBpbml0aWFsaXNpZXJlblxyXG4gICAgICAgIC5vbihcInZjbGlja1wiLCBcIi51aS1wYWdpbmF0aW9uLW5leHRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLm7DpGNoc3RlclZvcmlnZXJSYXVtKFwibsOkY2hzdGVyXCIpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLy8gUGFnaW5hdGlvbiBQZmVpbHRhc3RlbiBpbml0aWFsaXNpZXJlblxyXG4gICAgICAgIC5vbihcImtleXVwXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICd1c2Ugc3RyaWN0JztcclxuICAgICAgICAgICAgLy8gbnVyIHJlYWdpZXJlbiwgd2VubiBoUHJvamVrdEVkaXQgc2ljaHRiYXIgdW5kIEZva3VzIG5pY2h0IGluIGVpbmVtIEZlbGRcclxuICAgICAgICAgICAgaWYgKCEkKGV2ZW50LnRhcmdldCkuaXMoXCJpbnB1dCwgdGV4dGFyZWEsIHNlbGVjdCwgYnV0dG9uXCIpICYmICQoJyNoUmF1bUVkaXQnKS5pcygnOnZpc2libGUnKSkge1xyXG4gICAgICAgICAgICAgICAgLy8gTGVmdCBhcnJvd1xyXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09ICQubW9iaWxlLmtleUNvZGUuTEVGVCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5lbS5uw6RjaHN0ZXJWb3JpZ2VyUmF1bShcInZvcmlnZXJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIFJpZ2h0IGFycm93XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChldmVudC5rZXlDb2RlID09PSAkLm1vYmlsZS5rZXlDb2RlLlJJR0hUKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmVtLm7DpGNoc3RlclZvcmlnZXJSYXVtKFwibsOkY2hzdGVyXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAvLyDDhG5kZXJ1bmdlbiBpbSBGb3JtdWxhciBmw7xyIEFuaMOkbmdlIHNwZWljaGVyblxyXG4gICAgJChcIiNGb3JtQW5ow6RuZ2VoUkVcIilcclxuICAgICAgICAub24oXCJjaGFuZ2VcIiwgXCIuc3BlaWNoZXJuQW5oYW5nXCIsIHdpbmRvdy5lbS5oYW5kbGVSYXVtRWRpdFNwZWljaGVybkFuaGFuZ0NoYW5nZSlcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIltuYW1lPSdMw7ZzY2hlQW5oYW5nJ11cIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmzDtnNjaGVBbmhhbmcodGhpcywgd2luZG93LmVtLmhSYXVtLCBsb2NhbFN0b3JhZ2UuUmF1bUlkKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAkKFwiI2hSYXVtRWRpdEZvb3RlclwiKVxyXG4gICAgICAgIC8vIG5ldWVuIFJhdW0gZXJzdGVsbGVuXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIjTmV1ZXJSYXVtUmF1bUVkaXRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmVyc3RlbGxlTmV1ZW5SYXVtKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAvLyBzaWNodGJhcmUgRmVsZGVyIHfDpGhsZW5cclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiN3YWVobGVGZWxkZXJSYXVtRWRpdFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlUmF1bUVkaXRXw6RobGVGZWxkZXJDbGljaygpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIjS2FydGVPZWZmbmVuUmF1bUVkaXRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZVJhdW1FZGl0w5ZmZm5lS2FydGVDbGljaygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHQkKCcjTWVudVJhdW1FZGl0JylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2VpbmZhY2hlcl9tb2R1cycsIHdpbmRvdy5lbS5oYW5kbGVSYXVtRWRpdE1lbnVFaW5mYWNoZXJNb2R1c0NsaWNrKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfZmVsZGVyX3ZlcndhbHRlbicsIHdpbmRvdy5lbS5oYW5kbGVSYXVtRWRpdE1lbnVGZWxkZXJWZXJ3YWx0ZW5DbGljaylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X3JhZXVtZV9leHBvcnRpZXJlbicsIHdpbmRvdy5lbS5oYW5kbGVSYXVtRWRpdE1lbnVFeHBvcnRpZXJlbkNsaWNrKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfZWluc3RlbGx1bmdlbicsIHdpbmRvdy5lbS5oYW5kbGVSYXVtRWRpdE1lbnVFaW5zdGVsbHVuZ2VuQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9uZXVfYW5tZWxkZW4nLCB3aW5kb3cuZW0ubWVsZGVOZXVBbilcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2FydGVuZ3J1cHBlbl9pbXBvcnRpZXJlbicsIHdpbmRvdy5lbS7DtmZmbmVBcnRlbmdydXBwZW5JbXBvcnRpZXJlbilcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2FydGVuX2ltcG9ydGllcmVuJywgd2luZG93LmVtLsO2ZmZuZUFydGVuSW1wb3J0aWVyZW4pXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9hZG1pbicsIHdpbmRvdy5lbS7DtmZmbmVBZG1pbik7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlUmF1bUVkaXTDlmZmbmVSYXVtTGlzdGVDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUmF1bUVkaXQoKTtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhSYXVtTGlzdGUuaHRtbFwiKTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVSYXVtRWRpdFNwZWljaGVybkFuaGFuZ0NoYW5nZSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgX2F0dGFjaG1lbnRzID0gJChcIiNfYXR0YWNobWVudHNoUkVcIikudmFsKCk7XHJcblx0aWYgKF9hdHRhY2htZW50cyAmJiBfYXR0YWNobWVudHMubGVuZ3RoID4gMCkge1xyXG5cdFx0d2luZG93LmVtLnNwZWljaGVyZUFuaMOkbmdlKGxvY2FsU3RvcmFnZS5SYXVtSWQsIHdpbmRvdy5lbS5oUmF1bSwgXCJoUkVcIik7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVJhdW1FZGl0TMO2c2NoZVJhdW1DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBBbnphaGwgT3J0ZSBkZXMgUmF1bXMgesOkaGxlblxyXG5cdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHQkZGIudmlldygnZXZhYi9oT3J0SWRWb25SYXVtP3N0YXJ0a2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuUmF1bUlkICsgJ1wiXSZlbmRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5SYXVtSWQgKyAnXCIse30se31dJywge1xyXG5cdFx0c3VjY2VzczogZnVuY3Rpb24oT3J0ZSkge1xyXG5cdFx0XHR2YXIgYW56T3J0ZSA9IE9ydGUucm93cy5sZW5ndGg7XHJcblx0XHRcdC8vIEFuemFobCBaZWl0ZW4gZGVzIFJhdW1zIHrDpGhsZW5cclxuXHRcdFx0JGRiLnZpZXcoJ2V2YWIvaFplaXRJZFZvblJhdW0/c3RhcnRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5SYXVtSWQgKyAnXCJdJmVuZGtleT1bXCInICsgbG9jYWxTdG9yYWdlLlJhdW1JZCArICdcIix7fSx7fV0nLCB7XHJcblx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oWmVpdGVuKSB7XHJcblx0XHRcdFx0XHR2YXIgYW56WmVpdGVuID0gWmVpdGVuLnJvd3MubGVuZ3RoO1xyXG5cdFx0XHRcdFx0Ly8gQW56YWhsIEFydGVuIGRlcyBSYXVtcyB6w6RobGVuXHJcblx0XHRcdFx0XHQkZGIudmlldygnZXZhYi9oQXJ0SWRWb25SYXVtP3N0YXJ0a2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuUmF1bUlkICsgJ1wiXSZlbmRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5SYXVtSWQgKyAnXCIse30se31dJywge1xyXG5cdFx0XHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihBcnRlbikge1xyXG5cdFx0XHRcdFx0XHRcdHZhciBhbnpBcnRlbiA9IEFydGVuLnJvd3MubGVuZ3RoLFxyXG5cdFx0XHRcdFx0XHRcdFx0JGhyZV9sw7ZzY2hlbl9tZWxkdW5nID0gJChcIiNocmVfbMO2c2NoZW5fbWVsZHVuZ1wiKSxcclxuXHRcdFx0XHRcdFx0XHRcdG9ydGVfdGV4dCA9IChhbnpPcnRlID09PSAxID8gJyBPcnQsICcgOiAnIE9ydGUsICcpLFxyXG5cdFx0XHRcdFx0XHRcdFx0emVpdGVuX3RleHQgPSAoYW56WmVpdGVuID09PSAxID8gJyBaZWl0IHVuZCAnIDogJyBaZWl0ZW4gdW5kICcpLFxyXG5cdFx0XHRcdFx0XHRcdFx0YXJ0ZW5fdGV4dCA9IChhbnpBcnRlbiA9PT0gMSA/ICcgQXJ0JyA6ICcgQXJ0ZW4nKSxcclxuXHRcdFx0XHRcdFx0XHRcdG1lbGR1bmcgPSAnUmF1bSBpbmtsdXNpdmUgJyArIGFuek9ydGUgKyBvcnRlX3RleHQgKyBhbnpaZWl0ZW4gKyB6ZWl0ZW5fdGV4dCArIGFuekFydGVuICsgYXJ0ZW5fdGV4dCArICcgbMO2c2NoZW4/JztcclxuXHRcdFx0XHRcdFx0XHQkKFwiI2hyZV9sw7ZzY2hlbl9tZWxkdW5nX21lbGR1bmdcIikuaHRtbChtZWxkdW5nKTtcclxuXHRcdFx0XHRcdFx0XHQvLyBMaXN0ZW4gYW5ow6RuZ2VuLCBkYW1pdCBvaG5lIERCLUFiZnJhZ2UgZ2Vsw7ZzY2h0IHdlcmRlbiBrYW5uXHJcblx0XHRcdFx0XHRcdFx0JGhyZV9sw7ZzY2hlbl9tZWxkdW5nLmRhdGEoJ0FydGVuJywgQXJ0ZW4pO1xyXG5cdFx0XHRcdFx0XHRcdCRocmVfbMO2c2NoZW5fbWVsZHVuZy5kYXRhKCdaZWl0ZW4nLCBaZWl0ZW4pO1xyXG5cdFx0XHRcdFx0XHRcdCRocmVfbMO2c2NoZW5fbWVsZHVuZy5kYXRhKCdPcnRlJywgT3J0ZSk7XHJcblx0XHRcdFx0XHRcdFx0Ly8gcG9wdXAgw7ZmZm5lblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGhyZV9sw7ZzY2hlbl9tZWxkdW5nLnBvcHVwKFwib3BlblwiKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVSYXVtRWRpdFByb2pla3TDlmZmbmVuQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVJhdW1MaXN0ZShcIm1pdExhdExuZ0xpc3RlXCIpO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiaFByb2pla3RFZGl0Lmh0bWxcIik7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlUmF1bUVkaXRXw6RobGVGZWxkZXJDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuQXVmcnVmZW5kZVNlaXRlRlcgPSBcImhSYXVtRWRpdFwiO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiRmVsZGVyV2FlaGxlbi5odG1sXCIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVJhdW1FZGl0Q29udGVudFN3aXByZWxlZnQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKCEkKFwiKjpmb2N1c1wiKS5hdHRyKFwiYXJpYS12YWx1ZW5vd1wiKSkge1xyXG5cdFx0Ly8ga2VpbiBzbGlkZXJcclxuXHRcdHdpbmRvdy5lbS5uw6RjaHN0ZXJWb3JpZ2VyUmF1bShcIm7DpGNoc3RlclwiKTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlUmF1bUVkaXRDb250ZW50U3dpcGVyaWdodCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAoISQoXCIqOmZvY3VzXCIpLmF0dHIoXCJhcmlhLXZhbHVlbm93XCIpKSB7XHJcblx0XHQvLyBrZWluIHNsaWRlclxyXG5cdFx0d2luZG93LmVtLm7DpGNoc3RlclZvcmlnZXJSYXVtKFwidm9yaWdlclwiKTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlUmF1bUVkaXTDlmZmbmVLYXJ0ZUNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS56dXJ1ZWNrID0gXCJoUmF1bUVkaXRcIjtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkthcnRlLmh0bWxcIik7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlUmF1bUVkaXRNZW51RWluZmFjaGVyTW9kdXNDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUmF1bUVkaXQoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUmF1bUxpc3RlKCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVByb2pla3RFZGl0KCk7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJCZW9iTGlzdGUuaHRtbFwiKTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVSYXVtRWRpdE1lbnVGZWxkZXJWZXJ3YWx0ZW5DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuenVydWVjayA9IFwiaFJhdW1FZGl0Lmh0bWxcIjtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkZlbGRMaXN0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVJhdW1FZGl0TWVudUV4cG9ydGllcmVuQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93Lm9wZW4oJ19saXN0L0V4cG9ydFJhdW0vRXhwb3J0UmF1bT9zdGFydGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiXSZlbmRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5FbWFpbCArICdcIix7fSx7fV0maW5jbHVkZV9kb2NzPXRydWUnKTtcclxuXHQkKFwiI01lbnVSYXVtRWRpdFwiKVxyXG4gICAgICAgIC8vIHbDtmxsaWcgdW5sb2dpc2NoOiBkYXMgYmVyZWl0cyBvZmZlbmUgcG9wdXAgbXVzcyB6dWVyc3QgaW5pdGlhbGlzaWVydCB3ZXJkZW4uLi5cclxuICAgICAgICAucG9wdXAoKVxyXG4gICAgICAgIC8vIC4uLmJldm9yIGVzIGdlc2NobG9zc2VuIHdlcmRlbiBtdXNzLCB3ZWlsIGVzIHNvbnN0IG9mZmVuIGJsZWlidFxyXG4gICAgICAgIC5wb3B1cChcImNsb3NlXCIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVJhdW1FZGl0TWVudUVpbnN0ZWxsdW5nZW5DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuenVydWVjayA9IFwiaFJhdW1FZGl0Lmh0bWxcIjtcclxuXHR3aW5kb3cuZW0uw7ZmZm5lTWVpbmVFaW5zdGVsbHVuZ2VuKCk7XHJcbn07XHJcblxyXG53aW5kb3cuZW0ubMO2c2NoZVJhdW0gPSBmdW5jdGlvbihBcnRlbiwgWmVpdGVuLCBPcnRlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIG51ciBsw7ZzY2hlbiwgd28gRGF0ZW5zw6R0emUgdm9ya29tbWVuXHJcblx0aWYgKE9ydGUucm93cy5sZW5ndGggPiAwKSB7XHJcblx0XHR3aW5kb3cuZW0ubG9lc2NoZUlkSWRSZXZMaXN0ZShPcnRlKTtcclxuXHR9XHJcblx0aWYgKFplaXRlbi5yb3dzLmxlbmd0aCA+IDApIHtcclxuXHRcdHdpbmRvdy5lbS5sb2VzY2hlSWRJZFJldkxpc3RlKFplaXRlbik7XHJcblx0fVxyXG5cdGlmIChBcnRlbi5yb3dzLmxlbmd0aCA+IDApIHtcclxuXHRcdHdpbmRvdy5lbS5sb2VzY2hlSWRJZFJldkxpc3RlKEFydGVuKTtcclxuXHR9XHJcblx0aWYgKHdpbmRvdy5lbS5oUmF1bSkge1xyXG5cdFx0Ly8gT2JqZWt0IGJlbnV0emVuXHJcblx0XHR3aW5kb3cuZW0ubMO2c2NoZVJhdW1fMigpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBPYmpla3QgYXVzIERCIGhvbGVuXHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIub3BlbkRvYyhsb2NhbFN0b3JhZ2UuUmF1bUlkLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaFJhdW0gPSBkYXRhO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5sw7ZzY2hlUmF1bV8yKCk7XHJcblx0XHRcdH0sXHJcblx0XHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJGZWhsZXI6IFJhdW0gbmljaHQgZ2Vsw7ZzY2h0XCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0ubMO2c2NoZVJhdW1fMiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0JGRiLnJlbW92ZURvYyh3aW5kb3cuZW0uaFJhdW0sIHtcclxuXHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0Ly8gTGlzdGUgYW5wYXNzZW4uIFZvcnNpY2h0OiBCZWkgcmVmcmVzaCBrYW5uIHNpZSBmZWhsZW5cclxuXHRcdFx0aWYgKHdpbmRvdy5lbS5SYXVtTGlzdGUpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uUmF1bUxpc3RlLnJvd3MgPSBfLnJlamVjdCh3aW5kb3cuZW0uUmF1bUxpc3RlLnJvd3MsIGZ1bmN0aW9uKHJvdykge1xyXG5cdFx0XHRcdFx0cmV0dXJuIHJvdy5kb2MuX2lkID09PSBkYXRhLmlkO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdC8vIEtlaW5lIFJhdW1saXN0ZSBtZWhyLiBTdG9yYWdlIGzDtnNjaGVuXHJcblx0XHRcdFx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVJhdW1MaXN0ZShcIm1pdExhdExuZ0xpc3RlXCIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIFJhdW1MaXN0ZSB6dXLDvGNrc2V0emVuLCBkYW1pdCBzaWUgYmVpbSBuw6RjaHN0ZW4gQXVmcnVmIG5ldSBhdWZnZWJhdXQgd2lyZFxyXG5cdFx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUmF1bUVkaXQoXCJtaXRMYXRMbmdMaXN0ZVwiKTtcclxuXHRcdFx0JC5tb2JpbGUubmF2aWdhdGUoJ2hSYXVtTGlzdGUuaHRtbCcpO1xyXG5cdFx0fSxcclxuXHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRmVobGVyOiBSYXVtIG5pY2h0IGdlbMO2c2NodFwiKTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbndpbmRvdy5lbS52YWxpZGllcmVoUmF1bUVkaXQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKCEkKFwiI3JOYW1lXCIpLnZhbCgpKSB7XHJcblx0XHR3aW5kb3cuZW0ubWVsZGUoXCJCaXR0ZSBSYXVtbmFtZW4gZWluZ2ViZW5cIik7XHJcblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyBcclxuXHRcdFx0JCgnI3JOYW1lJykuZm9jdXMoKTsgXHJcblx0XHR9LCA1MCk7ICAvLyBuZWVkIHRvIHVzZSBhIHRpbWVyIHNvIHRoYXQgLmJsdXIoKSBjYW4gZmluaXNoIGJlZm9yZSB5b3UgZG8gLmZvY3VzKClcclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9XHJcblx0cmV0dXJuIHRydWU7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uc3BlaWNoZXJlUmF1bSA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgdGhhdCA9IHRoaXM7XHJcblx0Ly8gcHLDvGZlbiwgb2IgT2JqZWt0IFJhdW0gZXhpc3RpZXJ0XHJcblx0Ly8gZmVobHQgei5CLiBuYWNoIHJlZnJlc2hcclxuXHRpZiAod2luZG93LmVtLmhSYXVtKSB7XHJcblx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlUmF1bV8yKHRoYXQpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBrZWluIFJhdW0gPiBhdXMgREIgaG9sZW5cclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi5vcGVuRG9jKGxvY2FsU3RvcmFnZS5SYXVtSWQsIHtcclxuXHRcdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5oUmF1bSA9IGRhdGE7XHJcblx0XHRcdFx0d2luZG93LmVtLnNwZWljaGVyZVJhdW1fMih0aGF0KTtcclxuXHRcdFx0fSxcclxuXHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkZlaGxlcjogw4RuZGVydW5nIGluIFwiICsgdGhhdC5uYW1lICsgXCIgbmljaHQgZ2VzcGVpY2hlcnRcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcbn07XHJcblxyXG53aW5kb3cuZW0uc3BlaWNoZXJlUmF1bV8yID0gZnVuY3Rpb24odGhhdCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuICAgIHZhciBGZWxkbmFtZURiLFxyXG4gICAgICAgIEZlbGR3ZXJ0LFxyXG4gICAgICAgIGZlbGRpbmZvcztcclxuICAgIC8vIEZlbGRuYW1lIHVuZCAtd2VydCBlcm1pdHRlbG5cclxuICAgIGZlbGRpbmZvcyA9IHdpbmRvdy5lbS5ob2xlRmVsZEluZm9zVm9uRWxlbWVudCh0aGF0KTtcclxuICAgIEZlbGRuYW1lRGIgPSBmZWxkaW5mb3MuZmVsZG5hbWVfZGI7XHJcbiAgICBGZWxkd2VydCA9IGZlbGRpbmZvcy5mZWxkd2VydDtcclxuXHRpZiAod2luZG93LmVtLnZhbGlkaWVyZWhSYXVtRWRpdCgpKSB7XHJcblx0XHRpZiAoRmVsZG5hbWVEYiA9PT0gXCJyTmFtZVwiKSB7XHJcblx0XHRcdC8vIFJhdW1MaXN0ZSB6dXLDvGNrc2V0emVuLCBkYW1pdCBzaWUgYmVpbSBuw6RjaHN0ZW4gQXVmcnVmIG5ldSBhdWZnZWJhdXQgd2lyZFxyXG5cdFx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUmF1bUxpc3RlKFwibWl0TGF0TG5nTGlzdGVcIik7XHJcblx0XHR9XHJcblx0XHRpZiAoRmVsZHdlcnQpIHtcclxuXHRcdFx0aWYgKHdpbmRvdy5lbS5teVR5cGVPZihGZWxkd2VydCkgPT09IFwiZmxvYXRcIikge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5oUmF1bVtGZWxkbmFtZURiXSA9IHBhcnNlRmxvYXQoRmVsZHdlcnQpO1xyXG5cdFx0XHR9IGVsc2UgaWYgKHdpbmRvdy5lbS5teVR5cGVPZihGZWxkd2VydCkgPT09IFwiaW50ZWdlclwiKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLmhSYXVtW0ZlbGRuYW1lRGJdID0gcGFyc2VJbnQoRmVsZHdlcnQpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5oUmF1bVtGZWxkbmFtZURiXSA9IEZlbGR3ZXJ0O1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2UgaWYgKHdpbmRvdy5lbS5oUmF1bVtGZWxkbmFtZURiXSkge1xyXG5cdFx0XHRkZWxldGUgd2luZG93LmVtLmhSYXVtW0ZlbGRuYW1lRGJdO1xyXG5cdFx0fVxyXG5cdFx0Ly8gYWxsZXMgc3BlaWNoZXJuXHJcbiAgICAgICAgdmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLnNhdmVEb2Mod2luZG93LmVtLmhSYXVtLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaFJhdW0uX3JldiA9IGRhdGEucmV2O1xyXG5cdFx0XHRcdC8vIHdpbmRvdy5adWxldHp0R2VzcGVpY2hlcnRlUmF1bUlkIHdpcmQgYmVudXR6dCwgZGFtaXQgYXVjaCBuYWNoIGVpbmVtXHJcblx0XHRcdFx0Ly8gRGF0ZW5zYXR6d2VjaHNlbCBkaWUgTGlzdGVuIG5pY2h0IChpbW1lcikgYXVzIGRlciBEQiBnZWhvbHQgd2VyZGVuIG3DvHNzZW5cclxuXHRcdFx0XHQvLyBadWxldHp0IGdlc3BlaWNoZXJ0ZSBSYXVtSWQgTkFDSCBkZW0gc3BlaWNoZXJuIHNldHplblxyXG5cdFx0XHRcdC8vIHNpY2hlcnN0ZWxsZW4sIGRhc3MgYmlzIGRhaGluIG5pY2h0IHNjaG9uIGVpbmUgbsOkY2hzdGUgdmV3ZW5kZXQgd2lyZFxyXG5cdFx0XHRcdC8vIGRhcnVtIHp3aXNjaGVuc3BlaWNoZXJuXHJcblx0XHRcdFx0d2luZG93LmVtLlJhdW1JZFp3aXNjaGVuc3BlaWNoZXIgPSBsb2NhbFN0b3JhZ2UuUmF1bUlkO1xyXG5cdFx0XHRcdC8vc2V0VGltZW91dChcIndpbmRvdy5adWxldHp0R2VzcGVpY2hlcnRlUmF1bUlkID0gd2luZG93LmVtLlJhdW1JZFp3aXNjaGVuc3BlaWNoZXJcIiwgMTAwMCk7XHRBVVNHRVNDSEFMVEVULCBEQSBadWxldHp0R2VzcGVpY2hlcnRlUmF1bUlkIE5JUkdFTkRTIEdFQlJBVUNIVFxyXG5cdFx0XHRcdHNldFRpbWVvdXQoXCJkZWxldGUgd2luZG93LmVtLlJhdW1JZFp3aXNjaGVuc3BlaWNoZXJcIiwgMTUwMCk7XHJcblx0XHRcdFx0Ly8gbmljaHQgYWt0dWFsaXNpZXJ0ZSBoaWVyYXJjaGlzY2ggdGllZmVyZSBMaXN0ZW4gbMO2c2NoZW5cclxuXHRcdFx0XHRkZWxldGUgd2luZG93LmVtLk9ydGVWb25Qcm9qZWt0O1xyXG5cdFx0XHRcdGRlbGV0ZSB3aW5kb3cuZW0uWmVpdGVuVm9uUHJvamVrdDtcclxuXHRcdFx0XHRkZWxldGUgd2luZG93LmVtLlplaXRlblZvbk9ydDtcclxuXHRcdFx0XHRkZWxldGUgd2luZG93LmVtLkFydGVuVm9uUHJvamVrdDtcclxuXHRcdFx0XHRkZWxldGUgd2luZG93LmVtLkFydGVuVm9uT3J0O1xyXG5cdFx0XHRcdGRlbGV0ZSB3aW5kb3cuZW0uQXJ0ZW5Wb25aZWl0O1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlciBpbiBmdW5jdGlvbiBzcGVpY2hlcmVSYXVtXzIodGhhdCknKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gw5ZmZm5ldCBkZW4gdm9yaWdlbiBvZGVyIG7DpGNoc3RlbiBSYXVtXHJcbi8vIHZvcmlnZXIgZGVzIGVyc3RlbiA9PiBSYXVtTGlzdGVcclxuLy8gbsOkY2hzdGVyIGRlcyBsZXR6dGVuID0+IG1lbGRlblxyXG4vLyBlcndhcnRldCBkaWUgSUQgZGVzIGFrdHVlbGxlbiBEYXRlbnNhdHplcyB1bmQgb2IgbsOkY2hzdGVyIG9kZXIgdm9yaWdlciBnZXN1Y2h0IHdpcmRcclxud2luZG93LmVtLm7DpGNoc3RlclZvcmlnZXJSYXVtID0gZnVuY3Rpb24oTsOkY2hzdGVyT2RlclZvcmlnZXIpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gcHLDvGZlbiwgb2IgUmF1bUxpc3RlIHNjaG9uIGV4aXN0aWVydFxyXG5cdC8vIG51ciBhYmZyYWdlbiwgd2VubiBzaWUgbm9jaCBuaWNodCBleGlzdGllcnRcclxuXHRpZiAod2luZG93LmVtLlJhdW1MaXN0ZSkge1xyXG5cdFx0Ly8gZ2xvYmFsZSBWYXJpYWJsZSBSYXVtTGlzdGUgZXhpc3RpZXJ0IG5vY2hcclxuXHRcdHdpbmRvdy5lbS5uw6RjaHN0ZXJWb3JpZ2VyUmF1bV8yKE7DpGNoc3Rlck9kZXJWb3JpZ2VyKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8ga2VpbmUgUmF1bWxpc3RlIMO8YmVyZ2ViZW5cclxuXHRcdC8vIG5ldSBhdXMgREIgZXJzdGVsbGVuXHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIudmlldygnZXZhYi9oUmF1bUxpc3RlP3N0YXJ0a2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCIsIFwiJyArIGxvY2FsU3RvcmFnZS5Qcm9qZWt0SWQgKyAnXCJdJmVuZGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiLCBcIicgKyBsb2NhbFN0b3JhZ2UuUHJvamVrdElkICsgJ1wiICx7fV0maW5jbHVkZV9kb2NzPXRydWUnLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHQvLyBSYXVtTGlzdGUgYmVyZWl0c3RlbGxlblxyXG5cdFx0XHRcdHdpbmRvdy5lbS5SYXVtTGlzdGUgPSBkYXRhO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5uw6RjaHN0ZXJWb3JpZ2VyUmF1bV8yKE7DpGNoc3Rlck9kZXJWb3JpZ2VyKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLm7DpGNoc3RlclZvcmlnZXJSYXVtXzIgPSBmdW5jdGlvbihOw6RjaHN0ZXJPZGVyVm9yaWdlcikge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgaSxcclxuXHRcdFJhdW1JZEFrdHVlbGwsXHJcblx0XHRBbnpSYXVtO1xyXG5cdGZvciAoaT0wOyB3aW5kb3cuZW0uUmF1bUxpc3RlLnJvd3MubGVuZ3RoOyBpKyspIHtcclxuXHRcdFJhdW1JZEFrdHVlbGwgPSB3aW5kb3cuZW0uUmF1bUxpc3RlLnJvd3NbaV0uZG9jLl9pZDtcclxuXHRcdEFuelJhdW0gPSB3aW5kb3cuZW0uUmF1bUxpc3RlLnJvd3MubGVuZ3RoIC0xOyAgLy8gdm9yc2ljaHQ6IE9iamVrdGUgesOkaGxlbiBFbGVtZW50ZSBhYiAxLCBBcnJheXMgYWIgMCFcclxuXHRcdGlmIChSYXVtSWRBa3R1ZWxsID09PSBsb2NhbFN0b3JhZ2UuUmF1bUlkKSB7XHJcblx0XHRcdHN3aXRjaCAoTsOkY2hzdGVyT2RlclZvcmlnZXIpIHtcclxuXHRcdFx0Y2FzZSBcIm7DpGNoc3RlclwiOlxyXG5cdFx0XHRcdGlmIChpIDwgQW56UmF1bSkge1xyXG5cdFx0XHRcdFx0bG9jYWxTdG9yYWdlLlJhdW1JZCA9IHdpbmRvdy5lbS5SYXVtTGlzdGUucm93c1tpKzFdLmRvYy5faWQ7XHJcblx0XHRcdFx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUmF1bUVkaXQoXCJtaXRMYXRMbmdMaXN0ZVwiLCBcIm9obmVJZFwiKTtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5pbml0aWllcmVSYXVtRWRpdCgpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJEYXMgaXN0IGRlciBsZXR6dGUgUmF1bVwiKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgXCJ2b3JpZ2VyXCI6XHJcblx0XHRcdFx0aWYgKGkgPiAwKSB7XHJcblx0XHRcdFx0XHRsb2NhbFN0b3JhZ2UuUmF1bUlkID0gd2luZG93LmVtLlJhdW1MaXN0ZS5yb3dzW2ktMV0uZG9jLl9pZDtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VSYXVtRWRpdChcIm1pdExhdExuZ0xpc3RlXCIsIFwib2huZUlkXCIpO1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLmluaXRpaWVyZVJhdW1FZGl0KCk7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VSYXVtRWRpdCgpO1xyXG5cdFx0XHRcdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJoUmF1bUxpc3RlLmh0bWxcIik7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG59O1xyXG5cclxuLy8gd2VubiBoUmF1bUxpc3RlIGVyc2NoZWludFxyXG53aW5kb3cuZW0uaGFuZGxlSFJhdW1MaXN0ZVBhZ2VzaG93ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIFNvbGx0ZSBrZWluZSBpZCB2b3JsaWVnZW4sIHp1IGhQcm9qZWt0TGlzdGUuaHRtbCB3ZWNoc2VsblxyXG5cdC8vIGRhcyBrb21tdCBpbSBOb3JtYWxmYWxsIG51ciB2b3IsIHdlbm4gZGVyIENhY2hlIGRlcyBCcm93c2VycyBnZWxlZXJ0IHd1cmRlXHJcblx0Ly8gb2RlciBpbiBkZXIgWndpc2NoZW56ZWl0IGF1ZiBlaW5lbSBhbmRlcmVuIEJyb3dzZXIgZGllc2VyIERhdGVuc2F0eiBnZWzDtnNjaHQgd3VyZGVcclxuXHRpZiAobG9jYWxTdG9yYWdlLmxlbmd0aCA9PT0gMCB8fCAhbG9jYWxTdG9yYWdlLkVtYWlsKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKCk7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImluZGV4Lmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fSBlbHNlIGlmICghbG9jYWxTdG9yYWdlLlByb2pla3RJZCB8fCBsb2NhbFN0b3JhZ2UuUHJvamVrdElkID09PSBcInVuZGVmaW5lZFwiKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKFwib2huZUNsZWFyXCIpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJoUHJvamVrdExpc3RlLmh0bWxcIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdHdpbmRvdy5lbS5pbml0aWllcmVSYXVtTGlzdGUoKTtcclxufTtcclxuXHJcbi8vIHdlbm4gaFJhdW1MaXN0ZSBpbml0aWllcnQgd2lyZFxyXG53aW5kb3cuZW0uaGFuZGxlSFJhdW1MaXN0ZVBhZ2Vpbml0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIFdpcmQgZGllc2UgU2VpdGUgZGlyZWt0IGF1ZmdlcnVmZW4gdW5kIGVzIGdpYnQga2VpbmVuIGxvY2FsU3RvcmFnZSxcclxuXHQvLyBtdXNzIGF1ZiBpbmRleC5odG1sIHVtZ2VsZWl0ZXQgd2VyZGVuXHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH0gZWxzZSBpZiAoIWxvY2FsU3RvcmFnZS5Qcm9qZWt0SWQgfHwgbG9jYWxTdG9yYWdlLlByb2pla3RJZCA9PT0gXCJ1bmRlZmluZWRcIikge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbihcIm9obmVDbGVhclwiKTtcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiaFByb2pla3RMaXN0ZS5odG1sXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHJcblx0JChkb2N1bWVudClcclxuICAgICAgICAvLyBpbmFrdGl2ZSB0YWJzIGluYWt0aXZpZXJlblxyXG4gICAgICAgIC8vIEJFWlVHIEFVRiBET0NVTUVOVCwgV0VJTCBFUyBNSVQgQkVaVUcgQVVGIGlkIGRlcyBoZWFkZXIgTklDSFQgRlVOS1RJT05JRVJURSEhIT8/P1xyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiLnRhYl9pbmFrdGl2XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHQkKFwiI2hSYXVtTGlzdGVQYWdlSGVhZGVyXCIpXHJcbiAgICAgICAgLy8gTGluayB6dSBQcm9qZWt0IGluIE5hdmJhciB1bmQgVGl0ZWxsZWlzdGVcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIltuYW1lPSdQcm9qZWt0RWRpdE9lZmZuZW5SYXVtTGlzdGUnXVwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlUmF1bUxpc3Rlw5ZmZm5lUHJvamVrdEVkaXRDbGljaygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHQkKFwiI2hSYXVtTGlzdGVcIilcclxuICAgICAgICAvLyBuZXVlbiBSYXVtIGVyc3RlbGxlblxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiW25hbWU9J05ldWVyUmF1bVJhdW1MaXN0ZSddXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5lcnN0ZWxsZU5ldWVuUmF1bSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLm9uKFwic3dpcGVyaWdodFwiLCAnI2hSYXVtTGlzdGVQYWdlQ29udGVudCcsIHdpbmRvdy5lbS5oYW5kbGVSYXVtTGlzdGVDb250ZW50U3dpcGVyaWdodCk7XHJcblxyXG5cdCQoXCIjUmF1bWxpc3RlaFJMXCIpXHJcbiAgICAgICAgLm9uKFwic3dpcGVsZWZ0XCIsIFwiLlJhdW1cIiwgd2luZG93LmVtLmhhbmRsZVJhdW1MaXN0ZVN3aXBlbGVmdClcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIi5SYXVtXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVSYXVtTGlzdGVSYXVtQ2xpY2sodGhpcyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJzd2lwZWxlZnRcIiwgXCIuZXJzdGVcIiwgd2luZG93LmVtLmVyc3RlbGxlTmV1ZW5SYXVtKTtcclxuXHJcblx0JChcIiNoUmF1bUxpc3RlUGFnZUZvb3RlclwiKVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiI0thcnRlT2VmZm5lblJhdW1MaXN0ZVwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlUmF1bUxpc3Rlw5ZmZm5lS2FydGVDbGljaygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHQkKCcjTWVudVJhdW1MaXN0ZScpXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9laW5mYWNoZXJfbW9kdXMnLCB3aW5kb3cuZW0uaGFuZGxlSFJhdW1MaXN0ZU1lbnVFaW5mYWNoZXJNb2R1c0NsaWNrKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfZmVsZGVyX3ZlcndhbHRlbicsIHdpbmRvdy5lbS5oYW5kbGVSYXVtTGlzdGVNZW51RmVsZGVyVmVyd2FsdGVuQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9yYWV1bWVfZXhwb3J0aWVyZW4nLCB3aW5kb3cuZW0uaGFuZGxlSFJhdW1MaXN0ZU1lbnVFeHBvcnRpZXJlbkNsaWNrKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfZWluc3RlbGx1bmdlbicsIHdpbmRvdy5lbS5oYW5kbGVSYXVtTGlzdGVNZW51RWluc3RlbGx1bmdlbkNsaWNrKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfbmV1X2FubWVsZGVuJywgd2luZG93LmVtLm1lbGRlTmV1QW4pXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9hcnRlbmdydXBwZW5faW1wb3J0aWVyZW4nLCB3aW5kb3cuZW0uw7ZmZm5lQXJ0ZW5ncnVwcGVuSW1wb3J0aWVyZW4pXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9hcnRlbl9pbXBvcnRpZXJlbicsIHdpbmRvdy5lbS7DtmZmbmVBcnRlbkltcG9ydGllcmVuKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfYWRtaW4nLCB3aW5kb3cuZW0uw7ZmZm5lQWRtaW4pO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVJhdW1MaXN0ZcOWZmZuZVByb2pla3RFZGl0Q2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVJhdW1MaXN0ZSgpO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiaFByb2pla3RFZGl0Lmh0bWxcIik7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlUmF1bUxpc3RlU3dpcGVsZWZ0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS5SYXVtSWQgPSAkKHRoaXMpLmF0dHIoJ1JhdW1JZCcpO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiaE9ydExpc3RlLmh0bWxcIik7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlUmF1bUxpc3RlUmF1bUNsaWNrID0gZnVuY3Rpb24odGhhdCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuUmF1bUlkID0gJCh0aGF0KS5hdHRyKCdSYXVtSWQnKTtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhSYXVtRWRpdC5odG1sXCIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVJhdW1MaXN0ZUNvbnRlbnRTd2lwZXJpZ2h0ID0gZnVuY3Rpb24oKSB7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVJhdW1MaXN0ZSgpO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiaFByb2pla3RMaXN0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVJhdW1MaXN0ZcOWZmZuZUthcnRlQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLnp1cnVlY2sgPSBcImhSYXVtTGlzdGVcIjtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkthcnRlLmh0bWxcIik7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlSFJhdW1MaXN0ZU1lbnVFaW5mYWNoZXJNb2R1c0NsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VSYXVtTGlzdGUoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUHJvamVrdEVkaXQoKTtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkJlb2JMaXN0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVJhdW1MaXN0ZU1lbnVGZWxkZXJWZXJ3YWx0ZW5DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuenVydWVjayA9IFwiaFJhdW1MaXN0ZS5odG1sXCI7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJGZWxkTGlzdGUuaHRtbFwiKTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVSYXVtTGlzdGVNZW51RWluc3RlbGx1bmdlbkNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS56dXJ1ZWNrID0gXCJoUmF1bUxpc3RlLmh0bWxcIjtcclxuXHR3aW5kb3cuZW0uw7ZmZm5lTWVpbmVFaW5zdGVsbHVuZ2VuKCk7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlSFJhdW1MaXN0ZU1lbnVFeHBvcnRpZXJlbkNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHdpbmRvdy5vcGVuKCdfbGlzdC9FeHBvcnRSYXVtL0V4cG9ydFJhdW0/c3RhcnRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5FbWFpbCArICdcIl0mZW5ka2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCIse30se31dJmluY2x1ZGVfZG9jcz10cnVlJyk7XHJcblx0JChcIiNNZW51UmF1bUxpc3RlXCIpXHJcbiAgICAgICAgLy8gdsO2bGxpZyB1bmxvZ2lzY2g6IGRhcyBiZXJlaXRzIG9mZmVuZSBwb3B1cCBtdXNzIHp1ZXJzdCBpbml0aWFsaXNpZXJ0IHdlcmRlbi4uLlxyXG4gICAgICAgIC5wb3B1cCgpXHJcbiAgICAgICAgLy8gLi4uYmV2b3IgZXMgZ2VzY2hsb3NzZW4gd2VyZGVuIG11c3MsIHdlaWwgZXMgc29uc3Qgb2ZmZW4gYmxlaWJ0XHJcbiAgICAgICAgLnBvcHVwKFwiY2xvc2VcIik7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGhaZWl0RWRpdC5odG1sIGVyc2NoZWludFxyXG53aW5kb3cuZW0uaGFuZGxlSFplaXRFZGl0UGFnZXNob3cgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gU29sbHRlIGtlaW5lIGlkIHZvcmxpZWdlbiwgenUgaFByb2pla3RMaXN0ZS5odG1sIHdlY2hzZWxuXHJcblx0Ly8gZGFzIGtvbW10IGltIE5vcm1hbGZhbGwgbnVyIHZvciwgd2VubiBkZXIgQ2FjaGUgZGVzIEJyb3dzZXJzIGdlbGVlcnQgd3VyZGVcclxuXHQvLyBvZGVyIGluIGRlciBad2lzY2hlbnplaXQgYXVmIGVpbmVtIGFuZGVyZW4gQnJvd3NlciBkaWVzZXIgRGF0ZW5zYXR6IGdlbMO2c2NodCB3dXJkZVxyXG5cdGlmIChsb2NhbFN0b3JhZ2UubGVuZ3RoID09PSAwIHx8ICFsb2NhbFN0b3JhZ2UuRW1haWwpIHtcclxuXHRcdHdpbmRvdy5lbS5sZWVyZUFsbGVWYXJpYWJlbG4oKTtcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiaW5kZXguaHRtbFwiKTtcclxuXHR9IGVsc2UgaWYgKCghbG9jYWxTdG9yYWdlLlN0YXR1cyB8fCBsb2NhbFN0b3JhZ2UuU3RhdHVzID09PSBcInVuZGVmaW5lZFwiKSAmJiAoIWxvY2FsU3RvcmFnZS5aZWl0SWQgfHwgbG9jYWxTdG9yYWdlLlplaXRJZCA9PT0gXCJ1bmRlZmluZWRcIikpIHtcclxuXHRcdHdpbmRvdy5lbS5sZWVyZUFsbGVWYXJpYWJlbG4oXCJvaG5lQ2xlYXJcIik7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhQcm9qZWt0TGlzdGUuaHRtbFwiKTtcclxuXHR9XHJcblx0d2luZG93LmVtLmluaXRpaWVyZVplaXRFZGl0KCk7XHJcbn07XHJcblxyXG4vLyB3ZW5uIGhaZWl0RWRpdC5odG1sIGluaXRpaWVydCB3aXJkXHJcbndpbmRvdy5lbS5oYW5kbGVIWmVpdEVkaXRQYWdlaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBXaXJkIGRpZXNlIFNlaXRlIGRpcmVrdCBhdWZnZXJ1ZmVuIHVuZCBlcyBnaWJ0IGtlaW5lbiBsb2NhbFN0b3JhZ2UsXHJcblx0Ly8gbXVzcyBhdWYgaW5kZXguaHRtbCB1bWdlbGVpdGV0IHdlcmRlblxyXG5cdGlmIChsb2NhbFN0b3JhZ2UubGVuZ3RoID09PSAwIHx8ICFsb2NhbFN0b3JhZ2UuRW1haWwpIHtcclxuXHRcdHdpbmRvdy5lbS5sZWVyZUFsbGVWYXJpYWJlbG4oKTtcclxuXHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiaW5kZXguaHRtbFwiKTtcclxuXHR9IGVsc2UgaWYgKCghbG9jYWxTdG9yYWdlLlN0YXR1cyB8fCBsb2NhbFN0b3JhZ2UuU3RhdHVzID09PSBcInVuZGVmaW5lZFwiKSAmJiAoIWxvY2FsU3RvcmFnZS5aZWl0SWQgfHwgbG9jYWxTdG9yYWdlLlplaXRJZCA9PT0gXCJ1bmRlZmluZWRcIikpIHtcclxuXHRcdHdpbmRvdy5lbS5sZWVyZUFsbGVWYXJpYWJlbG4oXCJvaG5lQ2xlYXJcIik7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhQcm9qZWt0TGlzdGUuaHRtbFwiKTtcclxuXHR9XHJcblxyXG4gICAgJChkb2N1bWVudClcclxuICAgICAgICAvLyBpbmFrdGl2ZSB0YWJzIGluYWt0aXZpZXJlblxyXG4gICAgICAgIC8vIEJFWlVHIEFVRiBET0NVTUVOVCwgV0VJTCBFUyBNSVQgQkVaVUcgQVVGIGhaZWl0TGlzdGVQYWdlSGVhZGVyIE5JQ0hUIEZVTktUSU9OSUVSVEUhISE/Pz9cclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIi50YWJfaW5ha3RpdlwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB9KTtcclxuXHJcblx0JChcIiNaZWl0RWRpdFBhZ2VIZWFkZXJcIilcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIltuYW1lPSdPZWZmbmVaZWl0TGlzdGVaZWl0RWRpdCddXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VaZWl0RWRpdCgpO1xyXG4gICAgICAgICAgICAkLm1vYmlsZS5uYXZpZ2F0ZShcImhaZWl0TGlzdGUuaHRtbFwiKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiI09lZmZuZU9ydFplaXRFZGl0XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVaZWl0RWRpdMOWZmZuZU9ydENsaWNrKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiNPZWZmbmVBcnRMaXN0ZVplaXRFZGl0XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICQubW9iaWxlLm5hdmlnYXRlKFwiaEFydExpc3RlLmh0bWxcIik7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiNPZWZmbmVSYXVtWmVpdEVkaXRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZVplaXRFZGl0w5ZmZm5lUmF1bUNsaWNrKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiNPZWZmbmVQcm9qZWt0WmVpdEVkaXRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZVplaXRFZGl0w5ZmZm5lUHJvamVrdENsaWNrKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG5cdCQoXCIjaFplaXRFZGl0Rm9ybVwiKVxyXG4gICAgICAgIC8vIEbDvHIgamVkZXMgRmVsZCBiZWkgw4RuZGVydW5nIHNwZWljaGVyblxyXG4gICAgICAgIC5vbihcImNoYW5nZVwiLCBcIi5zcGVpY2hlcm5cIiwgd2luZG93LmVtLnNwZWljaGVyZUhaZWl0RWRpdClcclxuICAgICAgICAvLyBFaW5nYWJlIGltIFphaGxlbmZlbGQgYWJmYW5nZW5cclxuICAgICAgICAub24oXCJibHVyXCIsICcuc3BlaWNoZXJuU2xpZGVyJywgd2luZG93LmVtLnNwZWljaGVyZUhaZWl0RWRpdClcclxuICAgICAgICAvLyBLbGlja2VuIGF1ZiBkZW4gUGZlaWxlbiBpbSBaYWhsZW5mZWxkIGFiZmFuZ2VuXHJcbiAgICAgICAgLm9uKFwibW91c2V1cFwiLCAnLnVpLXNsaWRlci1pbnB1dCcsIHdpbmRvdy5lbS5zcGVpY2hlcmVIWmVpdEVkaXQpXHJcbiAgICAgICAgLy8gRW5kZSBkZXMgU2NoaWViZW5zIGFiZmFuZ2VuXHJcbiAgICAgICAgLm9uKFwic2xpZGVzdG9wXCIsICcuc3BlaWNoZXJuU2xpZGVyJywgd2luZG93LmVtLnNwZWljaGVyZUhaZWl0RWRpdCk7XHJcblxyXG5cdCQoXCIjRm9ybUFuaMOkbmdlaFpFXCIpXHJcbiAgICAgICAgLy8gw4RuZGVydW5nZW4gaW0gRm9ybXVsYXIgZsO8ciBBbmjDpG5nZSBzcGVpY2hlcm5cclxuICAgICAgICAub24oXCJjaGFuZ2VcIiwgXCIuc3BlaWNoZXJuQW5oYW5nXCIsIHdpbmRvdy5lbS5oYW5kbGVaZWl0RWRpdFNwZWljaGVybkFuaGFuZ0NoYW5nZSlcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIltuYW1lPSdMw7ZzY2hlQW5oYW5nJ11cIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmzDtnNjaGVBbmhhbmcodGhpcywgd2luZG93LmVtLmhaZWl0LCBsb2NhbFN0b3JhZ2UuWmVpdElkKTtcclxuICAgICAgICB9KTtcclxuXHJcblx0JChcIiNoWmVpdEVkaXRcIilcclxuICAgICAgICAub24oXCJzd2lwZWxlZnRcIiwgJyNaZWl0RWRpdFBhZ2VDb250ZW50Jywgd2luZG93LmVtLmhhbmRsZVplaXRFZGl0Q29udGVudFN3aXBlbGVmdClcclxuICAgICAgICAub24oXCJzd2lwZXJpZ2h0XCIsICcjWmVpdEVkaXRQYWdlQ29udGVudCcsIHdpbmRvdy5lbS5oYW5kbGVaZWl0RWRpdENvbnRlbnRTd2lwZXJpZ2h0KVxyXG4gICAgICAgIC8vIFBhZ2luYXRpb24gUGZlaWwgdm9yaWdlciBpbml0aWFsaXNpZXJlblxyXG4gICAgICAgIC5vbihcInZjbGlja1wiLCBcIi51aS1wYWdpbmF0aW9uLXByZXZcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLm7DpGNoc3RlVm9yaWdlWmVpdChcInZvcmlnZVwiKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC8vIFBhZ2luYXRpb24gUGZlaWwgbsOkY2hzdGVyIGluaXRpYWxpc2llcmVuXHJcbiAgICAgICAgLm9uKFwidmNsaWNrXCIsIFwiLnVpLXBhZ2luYXRpb24tbmV4dFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0ubsOkY2hzdGVWb3JpZ2VaZWl0KFwibsOkY2hzdGVcIik7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAvLyBQYWdpbmF0aW9uIFBmZWlsdGFzdGVuIGluaXRpYWxpc2llcmVuXHJcbiAgICAgICAgLm9uKFwia2V5dXBcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgLy8gbnVyIHJlYWdpZXJlbiwgd2VubiBoUHJvamVrdEVkaXQgc2ljaHRiYXIgdW5kIEZva3VzIG5pY2h0IGluIGVpbmVtIEZlbGRcclxuICAgICAgICAgICAgaWYgKCEkKGV2ZW50LnRhcmdldCkuaXMoXCJpbnB1dCwgdGV4dGFyZWEsIHNlbGVjdCwgYnV0dG9uXCIpICYmICQoJyNoWmVpdEVkaXQnKS5pcygnOnZpc2libGUnKSkge1xyXG4gICAgICAgICAgICAgICAgLy8gTGVmdCBhcnJvd1xyXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09ICQubW9iaWxlLmtleUNvZGUuTEVGVCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5lbS5uw6RjaHN0ZVZvcmlnZVplaXQoXCJ2b3JpZ2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIFJpZ2h0IGFycm93XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChldmVudC5rZXlDb2RlID09PSAkLm1vYmlsZS5rZXlDb2RlLlJJR0hUKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmVtLm7DpGNoc3RlVm9yaWdlWmVpdChcIm7DpGNoc3RlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAkKCcjWmVpdEVkaXRQYWdlRm9vdGVyJylcclxuICAgICAgICAvLyBOZXVlIFplaXQgZXJzdGVsbGVuXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcjTmV1ZVplaXRaZWl0RWRpdCcsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVaZWl0RWRpdE5ldUNsaWNrKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAvLyBzaWNodGJhcmUgRmVsZGVyIHfDpGhsZW5cclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiN3YWVobGVGZWxkZXJaZWl0RWRpdFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlWmVpdEVkaXRXw6RobGVGZWxkZXJDbGljaygpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLy8gQ29kZSBmw7xyIGRlbiBaZWl0LUzDtnNjaGVuLURpYWxvZ1xyXG4gICAgICAgIC5vbignY2xpY2snLCAnI0xvZXNjaGVaZWl0WmVpdEVkaXQnLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlWmVpdEVkaXRMw7ZzY2hlQ2xpY2soKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAkKFwiI2h6ZV9sw7ZzY2hlbl9tZWxkdW5nXCIpXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIjaHplX2zDtnNjaGVuX21lbGR1bmdfamFfbG9lc2NoZW5cIiwgd2luZG93LmVtLmhhbmRsZVplaXRFZGl0TMO2c2NoZW5NZWxkdW5nSmFDbGljayk7XHJcblxyXG5cdCQoJyNNZW51WmVpdEVkaXQnKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfZWluZmFjaGVyX21vZHVzJywgd2luZG93LmVtLmhhbmRsZVplaXRFZGl0TWVudUVpbmZhY2hlck1vZHVzQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9mZWxkZXJfdmVyd2FsdGVuJywgd2luZG93LmVtLmhhbmRsZVplaXRFZGl0TWVudUZlbGRlclZlcndhbHRlbkNsaWNrKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfemVpdGVuX2V4cG9ydGllcmVuJywgd2luZG93LmVtLmhhbmRsZVplaXRFZGl0TWVudUV4cG9ydGllcmVuQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9laW5zdGVsbHVuZ2VuJywgd2luZG93LmVtLmhhbmRsZVplaXRFZGl0TWVudUVpbnN0ZWxsdW5nZW5DbGljaylcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X25ldV9hbm1lbGRlbicsIHdpbmRvdy5lbS5tZWxkZU5ldUFuKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfYXJ0ZW5ncnVwcGVuX2ltcG9ydGllcmVuJywgd2luZG93LmVtLsO2ZmZuZUFydGVuZ3J1cHBlbkltcG9ydGllcmVuKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfYWRtaW4nLCB3aW5kb3cuZW0uw7ZmZm5lQWRtaW4pO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVplaXRFZGl0w5ZmZm5lT3J0Q2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVplaXRFZGl0KCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVplaXRMaXN0ZSgpO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiaE9ydEVkaXQuaHRtbFwiKTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVaZWl0RWRpdMOWZmZuZVJhdW1DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlWmVpdEVkaXQoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlWmVpdExpc3RlKCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZU9ydEVkaXQoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlT3J0TGlzdGUoKTtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhSYXVtRWRpdC5odG1sXCIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVplaXRFZGl0w5ZmZm5lUHJvamVrdENsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VaZWl0RWRpdCgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VaZWl0TGlzdGUoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlT3J0RWRpdCgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VPcnRMaXN0ZSgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VSYXVtRWRpdCgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VSYXVtTGlzdGUoKTtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhQcm9qZWt0RWRpdC5odG1sXCIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVplaXRFZGl0U3BlaWNoZXJuQW5oYW5nQ2hhbmdlID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBfYXR0YWNobWVudHMgPSAkKFwiI19hdHRhY2htZW50c2haRVwiKS52YWwoKTtcclxuXHRpZiAoX2F0dGFjaG1lbnRzICYmIF9hdHRhY2htZW50cy5sZW5ndGggPiAwKSB7XHJcblx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlQW5ow6RuZ2UobG9jYWxTdG9yYWdlLlplaXRJZCwgd2luZG93LmVtLmhaZWl0LCBcImhaRVwiKTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlWmVpdEVkaXROZXVDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBHbG9iYWxlIFZhcmlhYmxlbiBmw7xyIFplaXRMaXN0ZSB6dXLDvGNrc2V0emVuLCBkYW1pdCBkaWUgTGlzdGUgbmV1IGF1ZmdlYmF1dCB3aXJkXHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVplaXRMaXN0ZSgpO1xyXG5cdHdpbmRvdy5lbS5lcnN0ZWxsZU5ldWVaZWl0KCk7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlWmVpdEVkaXRXw6RobGVGZWxkZXJDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuQXVmcnVmZW5kZVNlaXRlRlcgPSBcImhaZWl0RWRpdFwiO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiRmVsZGVyV2FlaGxlbi5odG1sXCIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVplaXRFZGl0TMO2c2NoZUNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIEFuemFobCBaZWl0ZW4gdm9uIE9ydCB6w6RobGVuXHJcblx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdCRkYi52aWV3KCdldmFiL2hBcnRJZFZvblplaXQ/c3RhcnRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5aZWl0SWQgKyAnXCJdJmVuZGtleT1bXCInICsgbG9jYWxTdG9yYWdlLlplaXRJZCArICdcIix7fSx7fV0nLCB7XHJcblx0XHRzdWNjZXNzOiBmdW5jdGlvbihBcnRlbikge1xyXG5cdFx0XHR2YXIgYW56QXJ0ZW4gPSBBcnRlbi5yb3dzLmxlbmd0aCxcclxuXHRcdFx0XHQkaHplX2zDtnNjaGVuX21lbGR1bmcgPSAkKFwiI2h6ZV9sw7ZzY2hlbl9tZWxkdW5nXCIpLFxyXG5cdFx0XHRcdGFydGVuX3RleHQgPSAoYW56QXJ0ZW4gPT09IDEgPyAnIEFydCcgOiAnIEFydGVuJyksXHJcblx0XHRcdFx0bWVsZHVuZyA9ICdaZWl0IGlua2x1c2l2ZSAnICsgYW56QXJ0ZW4gKyBhcnRlbl90ZXh0ICsgJyBsw7ZzY2hlbj8nO1xyXG5cdFx0XHQkKFwiI2h6ZV9sw7ZzY2hlbl9tZWxkdW5nX21lbGR1bmdcIikuaHRtbChtZWxkdW5nKTtcclxuXHRcdFx0Ly8gTGlzdGVuIGFuaMOkbmdlbiwgZGFtaXQgb2huZSBEQi1BYmZyYWdlIGdlbMO2c2NodCB3ZXJkZW4ga2FublxyXG5cdFx0XHQkaHplX2zDtnNjaGVuX21lbGR1bmcuZGF0YSgnQXJ0ZW4nLCBBcnRlbik7XHJcblx0XHRcdC8vIHBvcHVwIMO2ZmZuZW5cclxuICAgICAgICAgICAgJGh6ZV9sw7ZzY2hlbl9tZWxkdW5nLnBvcHVwKFwib3BlblwiKTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVaZWl0RWRpdEzDtnNjaGVuTWVsZHVuZ0phQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyICRoemVfbMO2c2NoZW5fbWVsZHVuZyA9ICQoXCIjaHplX2zDtnNjaGVuX21lbGR1bmdcIilbMF07XHJcblx0d2luZG93LmVtLmzDtnNjaGVaZWl0KGpRdWVyeS5kYXRhKCRoemVfbMO2c2NoZW5fbWVsZHVuZywgJ0FydGVuJykpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVplaXRFZGl0Q29udGVudFN3aXBlbGVmdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAoISQoXCIqOmZvY3VzXCIpLmF0dHIoXCJhcmlhLXZhbHVlbm93XCIpKSB7XHJcblx0XHQvLyBrZWluIHNsaWRlclxyXG5cdFx0d2luZG93LmVtLm7DpGNoc3RlVm9yaWdlWmVpdChcIm7DpGNoc3RlXCIpO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVaZWl0RWRpdENvbnRlbnRTd2lwZXJpZ2h0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghJChcIio6Zm9jdXNcIikuYXR0cihcImFyaWEtdmFsdWVub3dcIikpIHtcclxuXHRcdC8vIGtlaW4gc2xpZGVyXHJcblx0XHR3aW5kb3cuZW0ubsOkY2hzdGVWb3JpZ2VaZWl0KFwidm9yaWdlXCIpO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVaZWl0RWRpdE1lbnVFaW5mYWNoZXJNb2R1c0NsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VaZWl0RWRpdCgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VaZWl0TGlzdGUoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlT3J0RWRpdCgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VPcnRMaXN0ZSgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VSYXVtRWRpdCgpO1xyXG5cdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VSYXVtTGlzdGUoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUHJvamVrdEVkaXQoKTtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkJlb2JMaXN0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVplaXRFZGl0TWVudUZlbGRlclZlcndhbHRlbkNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS56dXJ1ZWNrID0gXCJoWmVpdEVkaXQuaHRtbFwiO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiRmVsZExpc3RlLmh0bWxcIik7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlWmVpdEVkaXRNZW51RXhwb3J0aWVyZW5DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cub3BlbignX2xpc3QvRXhwb3J0WmVpdC9FeHBvcnRaZWl0P3N0YXJ0a2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCJdJmVuZGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiLHt9LHt9XSZpbmNsdWRlX2RvY3M9dHJ1ZScpO1xyXG5cdCQoXCIjTWVudVplaXRFZGl0XCIpXHJcbiAgICAgICAgLy8gdsO2bGxpZyB1bmxvZ2lzY2g6IGRhcyBiZXJlaXRzIG9mZmVuZSBwb3B1cCBtdXNzIHp1ZXJzdCBpbml0aWFsaXNpZXJ0IHdlcmRlbi4uLlxyXG4gICAgICAgIC5wb3B1cCgpXHJcbiAgICAgICAgLy8gLi4uYmV2b3IgZXMgZ2VzY2hsb3NzZW4gd2VyZGVuIG11c3MsIHdlaWwgZXMgc29uc3Qgb2ZmZW4gYmxlaWJ0XHJcbiAgICAgICAgLnBvcHVwKFwiY2xvc2VcIik7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlWmVpdEVkaXRNZW51RWluc3RlbGx1bmdlbkNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS56dXJ1ZWNrID0gXCJoWmVpdEVkaXQuaHRtbFwiO1xyXG5cdHdpbmRvdy5lbS7DtmZmbmVNZWluZUVpbnN0ZWxsdW5nZW4oKTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5sw7ZzY2hlWmVpdCA9IGZ1bmN0aW9uKEFydGVuKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIG51ciBsw7ZzY2hlbiwgd28gRGF0ZW5zw6R0emUgdm9ya29tbWVuXHJcblx0aWYgKEFydGVuLnJvd3MubGVuZ3RoID4gMCkge1xyXG5cdFx0d2luZG93LmVtLmxvZXNjaGVJZElkUmV2TGlzdGUoQXJ0ZW4pO1xyXG5cdH1cclxuXHQvLyBkYW5uIGRpZSBaZWl0XHJcblx0aWYgKHdpbmRvdy5lbS5oWmVpdCkge1xyXG5cdFx0Ly8gT2JqZWt0IG51dHplblxyXG5cdFx0d2luZG93LmVtLmzDtnNjaGVaZWl0XzIoKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gT2JqZWt0IGF1cyBEQiBob2xlblxyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLm9wZW5Eb2MobG9jYWxTdG9yYWdlLlplaXRJZCwge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLmhaZWl0ID0gZGF0YTtcclxuXHRcdFx0XHR3aW5kb3cuZW0ubMO2c2NoZVplaXRfMigpO1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRmVobGVyOiBaZWl0IG5pY2h0IGdlbMO2c2NodFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLmzDtnNjaGVaZWl0XzIgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdCRkYi5yZW1vdmVEb2Mod2luZG93LmVtLmhaZWl0LCB7XHJcblx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdC8vIExpc3RlIGFucGFzc2VuLiBWb3JzaWNodDogQmVpIHJlZnJlc2gga2FubiBzaWUgZmVobGVuXHJcblx0XHRcdGlmICh3aW5kb3cuZW0uWmVpdExpc3RlKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLlplaXRMaXN0ZS5yb3dzID0gXy5yZWplY3Qod2luZG93LmVtLlplaXRMaXN0ZS5yb3dzLCBmdW5jdGlvbihyb3cpIHtcclxuXHRcdFx0XHRcdHJldHVybiByb3cuZG9jLl9pZCA9PT0gZGF0YS5pZDtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvLyBLZWluZSBaZWl0TGlzdGUgbWVoci4gU3RvcmFnZSBsw7ZzY2hlblxyXG5cdFx0XHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VaZWl0TGlzdGUoKTtcclxuXHRcdFx0fVxyXG5cdFx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlWmVpdEVkaXQoKTtcclxuXHRcdFx0JC5tb2JpbGUubmF2aWdhdGUoJ2haZWl0TGlzdGUuaHRtbCcpO1xyXG5cdFx0fSxcclxuXHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRmVobGVyOiBaZWl0IG5pY2h0IGdlbMO2c2NodFwiKTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbndpbmRvdy5lbS52YWxpZGllcmVoWmVpdEVkaXQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKCEkKFwiW25hbWU9J3pEYXR1bSddXCIpLnZhbCgpKSB7XHJcblx0XHR3aW5kb3cuZW0ubWVsZGUoXCJCaXR0ZSBEYXR1bSBlcmZhc3NlblwiKTtcclxuXHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IFxyXG5cdFx0XHQkKFwiW25hbWU9J3pEYXR1bSddXCIpLmZvY3VzKCk7IFxyXG5cdFx0fSwgNTApOyAgLy8gbmVlZCB0byB1c2UgYSB0aW1lciBzbyB0aGF0IC5ibHVyKCkgY2FuIGZpbmlzaCBiZWZvcmUgeW91IGRvIC5mb2N1cygpXHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblx0fVxyXG5cdGlmICghJChcIltuYW1lPSd6VWhyemVpdCddXCIpLnZhbCgpKSB7XHJcblx0XHR3aW5kb3cuZW0ubWVsZGUoXCJCaXR0ZSBaZWl0IGVyZmFzc2VuXCIpO1xyXG5cdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHsgXHJcblx0XHRcdCQoXCJbbmFtZT0nelVocnplaXQnXVwiKS5mb2N1cygpOyBcclxuXHRcdH0sIDUwKTsgIC8vIG5lZWQgdG8gdXNlIGEgdGltZXIgc28gdGhhdCAuYmx1cigpIGNhbiBmaW5pc2ggYmVmb3JlIHlvdSBkbyAuZm9jdXMoKVxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH1cclxuXHRyZXR1cm4gdHJ1ZTtcclxufTtcclxuXHJcbi8vIHNwZWljaGVydCBuYWNoIGplZGVtIGNoYW5nZSBldmVudCBpbiBlaW5lbSBGZWxkIG1pdCBDbGFzcyBzcGVpY2hlcm5cclxuLy8gZGVuIFdlcnQgaW4gZGllIERCXHJcbi8vIGVyd2FydGV0IGRhcyBGZWxkIGFscyBPYmpla3Rcclxud2luZG93LmVtLnNwZWljaGVyZUhaZWl0RWRpdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgdGhhdCA9IHRoaXM7XHJcblx0Ly8gcHLDvGZlbiwgb2IgZGllIFplaXQgYWxzIE9iamVrdCB2b3JsaWVndFxyXG5cdGlmICh3aW5kb3cuZW0uaFplaXQpIHtcclxuXHRcdC8vIGRpZXNlcyB2ZXJ3ZW5kZW5cclxuXHRcdHdpbmRvdy5lbS5zcGVpY2hlcmVIWmVpdEVkaXRfMih0aGF0KTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gT2JqZWt0IGF1cyBEQiBob2xlblxyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLm9wZW5Eb2MobG9jYWxTdG9yYWdlLlplaXRJZCwge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLmhaZWl0ID0gZGF0YTtcclxuXHRcdFx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlSFplaXRFZGl0XzIodGhhdCk7XHJcblx0XHRcdH0sXHJcblx0XHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyIGluIGZ1bmN0aW9uIHNwZWljaGVyZUhaZWl0RWRpdCh0aGF0KScpO1xyXG5cdFx0XHRcdC8vd2luZG93LmVtLm1lbGRlKFwiRmVobGVyOiDDhG5kZXJ1bmcgaW4gXCIgKyBGZWxkbmFtZSArIFwiIG5pY2h0IGdlc3BlaWNoZXJ0XCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG59O1xyXG5cclxud2luZG93LmVtLnNwZWljaGVyZUhaZWl0RWRpdF8yID0gZnVuY3Rpb24odGhhdCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuICAgIHZhciBGZWxkbmFtZURiLFxyXG4gICAgICAgIEZlbGR3ZXJ0LFxyXG4gICAgICAgIGZlbGRpbmZvcztcclxuICAgIC8vIEZlbGRuYW1lIHVuZCAtd2VydCBlcm1pdHRlbG5cclxuICAgIGZlbGRpbmZvcyA9IHdpbmRvdy5lbS5ob2xlRmVsZEluZm9zVm9uRWxlbWVudCh0aGF0KTtcclxuICAgIEZlbGRuYW1lRGIgPSBmZWxkaW5mb3MuZmVsZG5hbWVfZGI7XHJcbiAgICBGZWxkd2VydCA9IGZlbGRpbmZvcy5mZWxkd2VydDtcclxuXHRpZiAod2luZG93LmVtLnZhbGlkaWVyZWhaZWl0RWRpdCgpKSB7XHJcblx0XHRpZiAoRmVsZG5hbWVEYiA9PT0gXCJ6RGF0dW1cIiB8fCBGZWxkbmFtZURiID09PSBcInpVaHJ6ZWl0XCIpIHtcclxuXHRcdFx0Ly8gVmFyaWFibGVuIGbDvHIgWmVpdExpc3RlIHp1csO8Y2tzZXR6ZW4sIGRhbWl0IGRpZSBMaXN0ZSBiZWltIG7DpGNoc3RlbiBBdWZydWYgbmV1IGF1ZmdlYmF1dCB3aXJkXHJcblx0XHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VaZWl0TGlzdGUoKTtcclxuXHRcdH1cclxuXHRcdC8vIFdlcnRlIGF1cyBkZW0gRm9ybXVsYXIgYWt0dWFsaXNpZXJlblxyXG5cdFx0aWYgKEZlbGR3ZXJ0KSB7XHJcblx0XHRcdGlmICh3aW5kb3cuZW0ubXlUeXBlT2YoRmVsZHdlcnQpID09PSBcImZsb2F0XCIpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaFplaXRbRmVsZG5hbWVEYl0gPSBwYXJzZUZsb2F0KEZlbGR3ZXJ0KTtcclxuXHRcdFx0fSBlbHNlIGlmICh3aW5kb3cuZW0ubXlUeXBlT2YoRmVsZHdlcnQpID09PSBcImludGVnZXJcIikge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5oWmVpdFtGZWxkbmFtZURiXSA9IHBhcnNlSW50KEZlbGR3ZXJ0KTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaFplaXRbRmVsZG5hbWVEYl0gPSBGZWxkd2VydDtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIGlmICh3aW5kb3cuZW0uaFplaXRbRmVsZG5hbWVEYl0pIHtcclxuXHRcdFx0ZGVsZXRlIHdpbmRvdy5lbS5oWmVpdFtGZWxkbmFtZURiXTtcclxuXHRcdH1cclxuXHRcdC8vIGFsbGVzIHNwZWljaGVyblxyXG4gICAgICAgIHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi5zYXZlRG9jKHdpbmRvdy5lbS5oWmVpdCwge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLmhaZWl0Ll9yZXYgPSBkYXRhLnJldjtcclxuXHRcdFx0XHQvLyB3aW5kb3cuWnVsZXR6dEdlc3BlaWNoZXJ0ZVplaXRJZCB3aXJkIGJlbnV0enQsIGRhbWl0IGF1Y2ggbmFjaCBlaW5lbVxyXG5cdFx0XHRcdC8vIERhdGVuc2F0endlY2hzZWwgZGllIExpc3RlbiBuaWNodCAoaW1tZXIpIGF1cyBkZXIgREIgZ2Vob2x0IHdlcmRlbiBtw7xzc2VuXHJcblx0XHRcdFx0Ly8gWnVsZXR6dCBnZXNwZWljaGVydGUgWmVpdElkIE5BQ0ggZGVtIHNwZWljaGVybiBzZXR6ZW5cclxuXHRcdFx0XHQvLyBzaWNoZXJzdGVsbGVuLCBkYXNzIGJpcyBkYWhpbiBuaWNodCBzY2hvbiBlaW5lIG7DpGNoc3RlIHZld2VuZGV0IHdpcmRcclxuXHRcdFx0XHQvLyBkYXJ1bSB6d2lzY2hlbnNwZWljaGVyblxyXG5cdFx0XHRcdHdpbmRvdy5lbS5aZWl0SWRad2lzY2hlbnNwZWljaGVyID0gbG9jYWxTdG9yYWdlLlplaXRJZDtcclxuXHRcdFx0XHQvL3NldFRpbWVvdXQoXCJ3aW5kb3cuWnVsZXR6dEdlc3BlaWNoZXJ0ZVplaXRJZCA9IHdpbmRvdy5lbS5aZWl0SWRad2lzY2hlbnNwZWljaGVyXCIsIDEwMDApO1x0QVVTR0VTQ0hBTFRFVCwgREEgWnVsZXR6dEdlc3BlaWNoZXJ0ZVplaXRJZCBOSVJHRU5EUyBCRU5VVFpUXHJcblx0XHRcdFx0c2V0VGltZW91dChcImRlbGV0ZSB3aW5kb3cuZW0uWmVpdElkWndpc2NoZW5zcGVpY2hlclwiLCAxNTAwKTtcclxuXHRcdFx0XHQvLyBuaWNodCBha3R1YWxpc2llcnRlIGhpZXJhcmNoaXNjaCB0aWVmZXJlIExpc3RlbiBsw7ZzY2hlblxyXG5cdFx0XHRcdGRlbGV0ZSB3aW5kb3cuZW0uQXJ0ZW5Wb25Qcm9qZWt0O1xyXG5cdFx0XHRcdGRlbGV0ZSB3aW5kb3cuZW0uQXJ0ZW5Wb25SYXVtO1xyXG5cdFx0XHRcdGRlbGV0ZSB3aW5kb3cuZW0uQXJ0ZW5Wb25PcnQ7XHJcblx0XHRcdH0sXHJcblx0XHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyIGluIGZ1bmN0aW9uIHNwZWljaGVyZUhaZWl0RWRpdF8yKHRoYXQpJyk7XHJcblx0XHRcdFx0Ly93aW5kb3cuZW0ubWVsZGUoXCJGZWhsZXI6IMOEbmRlcnVuZyBpbiBcIiArIEZlbGRuYW1lRGIgKyBcIiBuaWNodCBnZXNwZWljaGVydFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxuLy8gw5ZmZm5ldCBkaWUgdm9yaWdlIG9kZXIgbsOkY2hzdGUgWmVpdFxyXG4vLyB2b3JpZ2UgZGVyIGVyc3RlbiA9PiBaZWl0TGlzdGVcclxuLy8gbsOkY2hzdGUgZGVyIGxldHp0ZW4gPT4gbWVsZGVuXHJcbi8vIGVyd2FydGV0IGRpZSBJRCBkZXMgYWt0dWVsbGVuIERhdGVuc2F0emVzIHVuZCBvYiBuw6RjaHN0ZXIgb2RlciB2b3JpZ2VyIGdlc3VjaHQgd2lyZFxyXG53aW5kb3cuZW0ubsOkY2hzdGVWb3JpZ2VaZWl0ID0gZnVuY3Rpb24oTsOkY2hzdGVPZGVyVm9yaWdlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIHByw7xmZW4sIG9iIFplaXRMaXN0ZSBzY2hvbiBleGlzdGllcnRcclxuXHQvLyBudXIgYWJmcmFnZW4sIHdlbm4gc2llIG5vY2ggbmljaHQgZXhpc3RpZXJ0XHJcblx0aWYgKHdpbmRvdy5lbS5aZWl0TGlzdGUpIHtcclxuXHRcdHdpbmRvdy5lbS5uw6RjaHN0ZVZvcmlnZVplaXRfMihOw6RjaHN0ZU9kZXJWb3JpZ2UpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIudmlldygnZXZhYi9oWmVpdExpc3RlP3N0YXJ0a2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCIsIFwiJyArIGxvY2FsU3RvcmFnZS5PcnRJZCArICdcIl0mZW5ka2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCIsIFwiJyArIGxvY2FsU3RvcmFnZS5PcnRJZCArICdcIiAse31dJmluY2x1ZGVfZG9jcz10cnVlJywge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLlplaXRMaXN0ZSA9IGRhdGE7XHJcblx0XHRcdFx0d2luZG93LmVtLm7DpGNoc3RlVm9yaWdlWmVpdF8yKE7DpGNoc3RlT2RlclZvcmlnZSk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5uw6RjaHN0ZVZvcmlnZVplaXRfMiA9IGZ1bmN0aW9uKE7DpGNoc3RlT2RlclZvcmlnZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgaSxcclxuXHRcdFplaXRJZEFrdHVlbGwsXHJcblx0XHRBbnpaZWl0O1xyXG5cdGZvciAoaT0wOyB3aW5kb3cuZW0uWmVpdExpc3RlLnJvd3MubGVuZ3RoOyBpKyspIHtcclxuXHRcdFplaXRJZEFrdHVlbGwgPSB3aW5kb3cuZW0uWmVpdExpc3RlLnJvd3NbaV0uZG9jLl9pZDtcclxuXHRcdEFuelplaXQgPSB3aW5kb3cuZW0uWmVpdExpc3RlLnJvd3MubGVuZ3RoIC0xOyAgLy8gdm9yc2ljaHQ6IE9iamVrdGUgesOkaGxlbiBFbGVtZW50ZSBhYiAxLCBBcnJheXMgYWIgMCFcclxuXHRcdGlmIChaZWl0SWRBa3R1ZWxsID09PSBsb2NhbFN0b3JhZ2UuWmVpdElkKSB7XHJcblx0XHRcdHN3aXRjaCAoTsOkY2hzdGVPZGVyVm9yaWdlKSB7XHJcblx0XHRcdGNhc2UgXCJuw6RjaHN0ZVwiOlxyXG5cdFx0XHRcdGlmIChpIDwgQW56WmVpdCkge1xyXG5cdFx0XHRcdFx0bG9jYWxTdG9yYWdlLlplaXRJZCA9IHdpbmRvdy5lbS5aZWl0TGlzdGUucm93c1tpKzFdLmRvYy5faWQ7XHJcblx0XHRcdFx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlWmVpdEVkaXQoXCJvaG5lSWRcIik7XHJcblx0XHRcdFx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlWmVpdEVkaXQoKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRGFzIGlzdCBkaWUgbGV0enRlIFplaXRcIik7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlIFwidm9yaWdlXCI6XHJcblx0XHRcdFx0aWYgKGkgPiAwKSB7XHJcblx0XHRcdFx0XHRsb2NhbFN0b3JhZ2UuWmVpdElkID0gd2luZG93LmVtLlplaXRMaXN0ZS5yb3dzW2ktMV0uZG9jLl9pZDtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VaZWl0RWRpdChcIm9obmVJZFwiKTtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5pbml0aWllcmVaZWl0RWRpdCgpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlWmVpdEVkaXQoKTtcclxuXHRcdFx0XHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiaFplaXRMaXN0ZS5odG1sXCIpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVaZWl0TGlzdGVQYWdlc2hvdyA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBTb2xsdGUga2VpbmUgaWQgdm9ybGllZ2VuLCB6dSBoUHJvamVrdExpc3RlLmh0bWwgd2VjaHNlbG5cclxuXHQvLyBkYXMga29tbXQgaW0gTm9ybWFsZmFsbCBudXIgdm9yLCB3ZW5uIGRlciBDYWNoZSBkZXMgQnJvd3NlcnMgZ2VsZWVydCB3dXJkZVxyXG5cdC8vIG9kZXIgaW4gZGVyIFp3aXNjaGVuemVpdCBhdWYgZWluZW0gYW5kZXJlbiBCcm93c2VyIGRpZXNlciBEYXRlbnNhdHogZ2Vsw7ZzY2h0IHd1cmRlXHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH0gZWxzZSBpZiAoIWxvY2FsU3RvcmFnZS5PcnRJZCB8fCBsb2NhbFN0b3JhZ2UuT3J0SWQgPT09IFwidW5kZWZpbmVkXCIpIHtcclxuXHRcdHdpbmRvdy5lbS5sZWVyZUFsbGVWYXJpYWJlbG4oXCJvaG5lQ2xlYXJcIik7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhQcm9qZWt0TGlzdGUuaHRtbFwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0d2luZG93LmVtLmluaXRpaWVyZVplaXRMaXN0ZSgpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVplaXRMaXN0ZVBhZ2Vpbml0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIFdpcmQgZGllc2UgU2VpdGUgZGlyZWt0IGF1ZmdlcnVmZW4gdW5kIGVzIGdpYnQga2VpbmVuIGxvY2FsU3RvcmFnZSxcclxuXHQvLyBtdXNzIGF1ZiBpbmRleC5odG1sIHVtZ2VsZWl0ZXQgd2VyZGVuXHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH0gZWxzZSBpZiAoIWxvY2FsU3RvcmFnZS5PcnRJZCB8fCBsb2NhbFN0b3JhZ2UuT3J0SWQgPT09IFwidW5kZWZpbmVkXCIpIHtcclxuXHRcdHdpbmRvdy5lbS5sZWVyZUFsbGVWYXJpYWJlbG4oXCJvaG5lQ2xlYXJcIik7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhQcm9qZWt0TGlzdGUuaHRtbFwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG4gICAgJChkb2N1bWVudClcclxuICAgICAgICAvLyBpbmFrdGl2ZSB0YWJzIGluYWt0aXZpZXJlblxyXG4gICAgICAgIC8vIEJFWlVHIEFVRiBET0NVTUVOVCwgV0VJTCBFUyBNSVQgQkVaVUcgQVVGIGhaZWl0TGlzdGVQYWdlSGVhZGVyIE5JQ0hUIEZVTktUSU9OSUVSVEUhISE/Pz9cclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIi50YWJfaW5ha3RpdlwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB9KTtcclxuXHJcblx0JChcIiNoWmVpdExpc3RlUGFnZUhlYWRlclwiKVxyXG4gICAgICAgIC8vIExpbmsgenUgUmF1bSBpbiBOYXZiYXIgdW5kIFRpdGVsbGVpc3RlXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCJbbmFtZT0nT2VmZm5lT3J0WmVpdExpc3RlJ11cIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZVplaXRMaXN0ZcOWZmZuZU9ydENsaWNrKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIiNPZWZmbmVSYXVtWmVpdExpc3RlXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVaZWl0TGlzdGXDlmZmbmVSYXVtQ2xpY2soKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiI09lZmZuZVByb2pla3RaZWl0TGlzdGVcIiwgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZVplaXRMaXN0ZcOWZmZuZVByb2pla3RDbGljaygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHQkKFwiI2haZWl0TGlzdGVcIilcclxuICAgICAgICAvLyBOZXVlIFplaXQgZXJzdGVsbGVuLCBlcnN0ZSBaZWl0IHVuZCBmaXhlciBidXR0b25cclxuICAgICAgICAub24oXCJjbGlja1wiLCBcIi5OZXVlWmVpdFplaXRMaXN0ZVwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uZXJzdGVsbGVOZXVlWmVpdCgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLm9uKFwic3dpcGVyaWdodFwiLCB3aW5kb3cuZW0uaGFuZGxlWmVpdExpc3RlU3dpcGVyaWdodCk7XHJcblxyXG5cdCQoXCIjWmVpdGxpc3RlaFpMXCIpXHJcbiAgICAgICAgLm9uKFwic3dpcGVsZWZ0XCIsIFwiLlplaXRcIiwgd2luZG93LmVtLmhhbmRsZVplaXRMaXN0ZVN3aXBlbGVmdFplaXQpXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIuWmVpdFwiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlWmVpdExpc3RlWmVpdENsaWNrKHRoaXMpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLm9uKFwic3dpcGVsZWZ0XCIsIFwiLmVyc3RlXCIsIHdpbmRvdy5lbS5lcnN0ZWxsZU5ldWVaZWl0KTtcclxuXHJcblx0JCgnI01lbnVaZWl0TGlzdGUnKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfZWluZmFjaGVyX21vZHVzJywgd2luZG93LmVtLmhhbmRsZVplaXRMaXN0ZU1lbnVFaW5mYWNoZXJNb2R1c0NsaWNrKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnLm1lbnVfZmVsZGVyX3ZlcndhbHRlbicsIHdpbmRvdy5lbS5oYW5kbGVaZWl0TGlzdGVNZW51RmVsZGVyVmVyd2FsdGVuQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV96ZWl0ZW5fZXhwb3J0aWVyZW4nLCB3aW5kb3cuZW0uaGFuZGxlWmVpdExpc3RlTWVudVplaXRlbkV4cG9ydGllcmVuQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9laW5zdGVsbHVuZ2VuJywgd2luZG93LmVtLmhhbmRsZVplaXRMaXN0ZU1lbnVFaW5zdGVsbHVuZ2VuQ2xpY2spXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcubWVudV9uZXVfYW5tZWxkZW4nLCB3aW5kb3cuZW0ubWVsZGVOZXVBbilcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2FydGVuZ3J1cHBlbl9pbXBvcnRpZXJlbicsIHdpbmRvdy5lbS7DtmZmbmVBcnRlbmdydXBwZW5JbXBvcnRpZXJlbilcclxuICAgICAgICAub24oJ2NsaWNrJywgJy5tZW51X2FkbWluJywgd2luZG93LmVtLsO2ZmZuZUFkbWluKTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVaZWl0TGlzdGXDlmZmbmVPcnRDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlWmVpdExpc3RlKCk7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJoT3J0RWRpdC5odG1sXCIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVplaXRMaXN0ZcOWZmZuZVJhdW1DbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlWmVpdExpc3RlKCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZU9ydEVkaXQoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlT3J0TGlzdGUoKTtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhSYXVtRWRpdC5odG1sXCIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVplaXRMaXN0ZcOWZmZuZVByb2pla3RDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlWmVpdExpc3RlKCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZU9ydEVkaXQoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlT3J0TGlzdGUoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUmF1bUVkaXQoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUmF1bUxpc3RlKCk7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJoUHJvamVrdEVkaXQuaHRtbFwiKTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVaZWl0TGlzdGVTd2lwZWxlZnRaZWl0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS5aZWl0SWQgPSAkKHRoaXMpLmF0dHIoJ1plaXRJZCcpO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiaEFydExpc3RlLmh0bWxcIik7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlWmVpdExpc3RlWmVpdENsaWNrID0gZnVuY3Rpb24odGhhdCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuWmVpdElkID0gJCh0aGF0KS5hdHRyKCdaZWl0SWQnKTtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcImhaZWl0RWRpdC5odG1sXCIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVplaXRMaXN0ZVN3aXBlcmlnaHQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJoT3J0TGlzdGUuaHRtbFwiKTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVaZWl0TGlzdGVNZW51RWluZmFjaGVyTW9kdXNDbGljayA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlWmVpdExpc3RlKCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZU9ydEVkaXQoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlT3J0TGlzdGUoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUmF1bUVkaXQoKTtcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlUmF1bUxpc3RlKCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZVByb2pla3RFZGl0KCk7XHJcblx0d2luZG93LmVtLmxlZXJlU3RvcmFnZU9ydExpc3RlKCk7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJCZW9iTGlzdGUuaHRtbFwiKTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVaZWl0TGlzdGVNZW51RmVsZGVyVmVyd2FsdGVuQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLnp1cnVlY2sgPSBcImhaZWl0TGlzdGUuaHRtbFwiO1xyXG5cdCQubW9iaWxlLm5hdmlnYXRlKFwiRmVsZExpc3RlLmh0bWxcIik7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlWmVpdExpc3RlTWVudVplaXRlbkV4cG9ydGllcmVuQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93Lm9wZW4oJ19saXN0L0V4cG9ydFplaXQvRXhwb3J0WmVpdD9zdGFydGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiXSZlbmRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5FbWFpbCArICdcIix7fSx7fV0maW5jbHVkZV9kb2NzPXRydWUnKTtcclxuXHQkKFwiI01lbnVaZWl0TGlzdGVcIilcclxuICAgICAgICAvLyB2w7ZsbGlnIHVubG9naXNjaDogZGFzIGJlcmVpdHMgb2ZmZW5lIHBvcHVwIG11c3MgenVlcnN0IGluaXRpYWxpc2llcnQgd2VyZGVuLi4uXHJcbiAgICAgICAgLnBvcHVwKClcclxuICAgICAgICAvLyAuLi5iZXZvciBlcyBnZXNjaGxvc3NlbiB3ZXJkZW4gbXVzcywgd2VpbCBlcyBzb25zdCBvZmZlbiBibGVpYnRcclxuICAgICAgICAucG9wdXAoXCJjbG9zZVwiKTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVaZWl0TGlzdGVNZW51RWluc3RlbGx1bmdlbkNsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS56dXJ1ZWNrID0gXCJoWmVpdExpc3RlLmh0bWxcIjtcclxuXHR3aW5kb3cuZW0uw7ZmZm5lTWVpbmVFaW5zdGVsbHVuZ2VuKCk7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlSW5kZXhQYWdlc2hvdyA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBXZW5uIG3DtmdsaWNoIGxvY2FsU3RvcmFnZS5FbWFpbCBmw7xyIGRpZSBBbm1lbGR1bmcgdmVyd2VuZGVuXHJcblx0Ly8gYXVzc2VyIFVzZXIgaGF0IHZpYSBNZW7DvCBiZXd1c3N0IG5ldSBhbm1lbGRlbiB3b2xsZW5cclxuXHQvLyBsb2NhbFN0b3JhZ2UgbXVzcyBiZWkgTmV1YW5tZWxkdW5nIGdlbGVlcnQgd2VyZGVuLCBzb25zdCB3ZXJkZW4gZGllIEJlb2JhY2h0dW5nZW4gZGVzIGFsdGVuIFVzZXJzIGdlemVpZ3RcclxuXHRpZiAobG9jYWxTdG9yYWdlLmxlbmd0aCA+IDApIHtcclxuXHRcdGlmIChsb2NhbFN0b3JhZ2UuRW1haWwpIHtcclxuXHRcdFx0aWYgKGxvY2FsU3RvcmFnZS5Vc2VyU3RhdHVzICE9PSBcIm5ldVwiKSB7XHJcblx0XHRcdFx0aWYgKGxvY2FsU3RvcmFnZS5FbWFpbCAmJiBsb2NhbFN0b3JhZ2UuQXV0b3IpIHtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS7DtmZmbmVadWxldHp0QmVudXR6dGVTZWl0ZSgpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQvLyBVc2VyZGF0ZW4gYmVyZWl0c3RlbGxlbiB1bmQgZGFuYWNoIGRpZSB6dWxldHp0IGJlbnV0enRlIFNlaXRlIMO2ZmZuZW5cclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5zdGVsbGVVc2VyRGF0ZW5CZXJlaXQoKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0Ly8gV2VubiBsb2NhbFN0b3JhZ2UuVXNlclN0YXR1cyBuZXUgaXN0LCBtw7xzc2VuIGFsbGUgVmFyaWFiZWxuIGVudGZlcm50IHdlcmRlbiwgaW5rbC4gVXNlcm5hbWVcclxuXHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKCk7XHJcblx0XHRcclxuXHRpZiAoIShcImF1dG9mb2N1c1wiIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKSkpIHtcclxuXHRcdCQoXCIjRW1haWxcIikuZm9jdXMoKTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlSW5kZXhQYWdlaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuICAgICQoXCIjaW5kZXhGb3JtXCIpXHJcbiAgICAgICAgLy8gUmVha3Rpb24gYXVmIEVudGVyLVRhc3RlXHJcbiAgICAgICAgLm9uKFwia2V5ZG93blwiLCBcIiNQYXNzd29ydFwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDEzKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuZW0ubWVsZGVVc2VyQW4oKTtcclxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcblx0JChcIiNpbmRleEZvb3RlclwiKVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiI2luZGV4X3N1Ym1pdF9idXR0b25cIiwgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5tZWxkZVVzZXJBbigpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLm9uKFwiY2xpY2tcIiwgXCIjaW5kZXhfc2lnbnVwX2J1dHRvblwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgICAgICAgICB2YXIgZW1haWwgPSAkKFwiI0VtYWlsXCIpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgcGFzc3dvcnQgPSAkKFwiI1Bhc3N3b3J0XCIpLnZhbCgpO1xyXG4gICAgICAgICAgICBpZiAoZW1haWwpIHtcclxuICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnByb3ZfZW1haWwgPSBlbWFpbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocGFzc3dvcnQpIHtcclxuICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnByb3ZfcGFzc3dvcnQgPSBwYXNzd29ydDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAkLm1vYmlsZS5uYXZpZ2F0ZShcIlNpZ251cC5odG1sXCIpO1xyXG4gICAgICAgIH0pXHJcbn07XHJcblxyXG53aW5kb3cuZW0udmFsaWRpZXJlVXNlckluZGV4ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBFbWFpbCA9ICQoJ2lucHV0W25hbWU9RW1haWxdJykudmFsKCksXHJcblx0XHRQYXNzd29ydCA9ICQoJ2lucHV0W25hbWU9UGFzc3dvcnRdJykudmFsKCk7XHJcblx0aWYgKCFFbWFpbCkge1xyXG5cdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7IFxyXG5cdFx0XHQkKCcjRW1haWwnKS5mb2N1cygpOyBcclxuXHRcdH0sIDUwKTsgIC8vIG5lZWQgdG8gdXNlIGEgdGltZXIgc28gdGhhdCAuYmx1cigpIGNhbiBmaW5pc2ggYmVmb3JlIHlvdSBkbyAuZm9jdXMoKVxyXG5cdFx0d2luZG93LmVtLm1lbGRlKFwiQml0dGUgQmVudXR6ZXJuYW1lbiBlaW5nZWJlblwiKTtcclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9IGVsc2UgaWYgKCFQYXNzd29ydCkge1xyXG5cdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7IFxyXG5cdFx0XHQkKCcjUGFzc3dvcnQnKS5mb2N1cygpOyBcclxuXHRcdH0sIDUwKTsgIC8vIG5lZWQgdG8gdXNlIGEgdGltZXIgc28gdGhhdCAuYmx1cigpIGNhbiBmaW5pc2ggYmVmb3JlIHlvdSBkbyAuZm9jdXMoKVxyXG5cdFx0d2luZG93LmVtLm1lbGRlKFwiQml0dGUgUGFzc3dvcnQgZWluZ2ViZW5cIik7XHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblx0fVxyXG5cdHJldHVybiB0cnVlO1xyXG59O1xyXG5cclxud2luZG93LmVtLm1lbGRlVXNlckFuID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBFbWFpbCA9ICQoJ2lucHV0W25hbWU9RW1haWxdJykudmFsKCksXHJcblx0XHRQYXNzd29ydCA9ICQoJ2lucHV0W25hbWU9UGFzc3dvcnRdJykudmFsKCk7XHJcblx0Ly8gc2ljaGVyc3RlbGxlbiwgZGFzcyBkaWUgbG9jYWxTdG9yYWdlIGxlZXIgaXN0XHJcblx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdGlmICh3aW5kb3cuZW0udmFsaWRpZXJlVXNlckluZGV4KSB7XHJcblx0XHQkLmNvdWNoLmxvZ2luKHtcclxuXHRcdFx0bmFtZSA6IEVtYWlsLFxyXG5cdFx0XHRwYXNzd29yZCA6IFBhc3N3b3J0LFxyXG5cdFx0XHRzdWNjZXNzIDogZnVuY3Rpb24gKHIpIHtcclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UuRW1haWwgPSBFbWFpbDtcclxuXHRcdFx0XHRpZiAoci5yb2xlcy5pbmRleE9mKFwiX2FkbWluXCIpICE9PSAtMSkge1xyXG5cdFx0XHRcdFx0Ly8gZGFzIGlzdCBlaW4gYWRtaW5cclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKFwiaGFsbG8gYWRtaW5cIik7XHJcblx0XHRcdFx0XHRsb2NhbFN0b3JhZ2UuYWRtaW4gPSB0cnVlO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLmFkbWluO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR3aW5kb3cuZW0uYmxlbmRlTWVudXMoKTtcclxuXHRcdFx0XHQvLyBVc2VyZGF0ZW4gYmVyZWl0c3RlbGxlbiB1bmQgYW4gZGllIHp1bGV0enQgYmVudXR6dGUgU2VpdGUgd2VpdGVybGVpdGVuXHJcblx0XHRcdFx0d2luZG93LmVtLnN0ZWxsZVVzZXJEYXRlbkJlcmVpdCgpO1xyXG5cdFx0XHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuVXNlclN0YXR1cztcclxuXHRcdFx0fSxcclxuXHRcdFx0ZXJyb3I6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJBbm1lbGR1bmcgZ2VzY2hlaXRlcnQuPGJyPlNpZSBtw7xzc2VuIGV2LiBlaW4gS29udG8gZXJzdGVsbGVuP1wiKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLmJsZW5kZU1lbnVzID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmIChsb2NhbFN0b3JhZ2UuYWRtaW4pIHtcclxuXHRcdCQoXCIucG9wdXBcIilcclxuICAgICAgICAgICAgLmZpbmQoXCIuYWRtaW5cIilcclxuICAgICAgICAgICAgLnNob3coKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0JChcIi5wb3B1cFwiKVxyXG4gICAgICAgICAgICAuZmluZChcIi5hZG1pblwiKVxyXG4gICAgICAgICAgICAuaGlkZSgpO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVLYXJ0ZVBhZ2VzaG93ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIEthcnRlbiBtw7xzc2VuIGluIHBhZ2VzaG93IGVyc3RlbGx0IHdlcmRlbiwgd2VpbCBzaWUgc29uc3QgaW4gQ2hyb21lIG5pY2h0IGVyc2NoZWluZW5cclxuXHR2YXIgdmlld25hbWU7XHJcblx0Ly8gSW4gZGllc2VtIEFycmF5IHdlcmRlbiBhbGxlIE1hcmtlciBnZXNwZWljaGVydCwgZGFtaXQgc2llIGdlbMO2c2NodCB3ZXJkZW4ga8O2bm5lblxyXG5cdC8vIHdpcmQgYmVudXR6dCB2b246IGhPcnRFZGl0Lmh0bWwsIEJlb2JFZGl0Lmh0bWxcclxuXHR3aW5kb3cuZW0ubWFya2Vyc0FycmF5ID0gW107XHJcblx0d2luZG93LmVtLkluZm9XaW5kb3dBcnJheSA9IFtdO1xyXG5cclxuXHQvLyBzaWNoZXJzdGVsbGVuLCBkYXNzIGxvY2FsU3RvcmFnZS56dXJ1ZWNrIGV4aXN0aWVydCAoZ2lidCBzb25zdCBzcMOkdGVyIEZlaGxlcilcclxuXHRpZiAoIWxvY2FsU3RvcmFnZS56dXJ1ZWNrKSB7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkJlb2JMaXN0ZS5odG1sXCIpO1xyXG5cdH1cclxuXHJcblx0Ly8gSmUgbmFjaGRlbSwgd2VsY2hlIFNlaXRlIGRpZSBLYXJ0ZSBhdWZydWZ0LCBtdXNzIHVudGVyc2NoaWVkbGljaCB2b3JnZWdhbmdlbiB3ZXJkZW5cclxuXHRzd2l0Y2gobG9jYWxTdG9yYWdlLnp1cnVlY2spIHtcclxuXHRcdGNhc2UgXCJoUHJvamVrdExpc3RlXCI6XHJcblx0XHRcdHZpZXduYW1lID0gJ2V2YWIvaFByb2pla3RsaXN0ZU9ydGVGdWVyS2FydGU/a2V5PVwiJyArIGxvY2FsU3RvcmFnZS5FbWFpbCArICdcIiZpbmNsdWRlX2RvY3M9dHJ1ZSc7XHJcblx0XHRcdHdpbmRvdy5lbS5LZWluT3J0TWVsZHVuZyA9IFwiRXMgZ2lidCBrZWluZSBPcnRlIG1pdCBLb29yZGluYXRlblwiO1xyXG5cdFx0XHR3aW5kb3cuZW0uZXJzdGVsbGVLYXJ0ZUgodmlld25hbWUpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgXCJoUHJvamVrdEVkaXRcIjpcdC8vIGdsZWljaCB3aWUgaFJhdW1MaXN0ZVxyXG5cdFx0Y2FzZSBcImhSYXVtTGlzdGVcIjpcclxuXHRcdFx0dmlld25hbWUgPSAnZXZhYi9oUHJvamVrdE9ydGVGdWVyS2FydGU/c3RhcnRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5FbWFpbCArICdcIiwgXCInICsgbG9jYWxTdG9yYWdlLlByb2pla3RJZCArICdcIl0mZW5ka2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCIsIFwiJyArIGxvY2FsU3RvcmFnZS5Qcm9qZWt0SWQgKyAnXCIgLHt9XSZpbmNsdWRlX2RvY3M9dHJ1ZSc7XHJcblx0XHRcdHdpbmRvdy5lbS5LZWluT3J0TWVsZHVuZyA9IFwiRXMgZ2lidCBrZWluZSBPcnRlIG1pdCBLb29yZGluYXRlblwiO1xyXG5cdFx0XHR3aW5kb3cuZW0uZXJzdGVsbGVLYXJ0ZUgodmlld25hbWUpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgXCJoUmF1bUVkaXRcIjpcdC8vIGdsZWljaCB3aWUgaE9ydExpc3RlXHJcblx0XHRjYXNlIFwiaE9ydExpc3RlXCI6XHJcblx0XHRcdHZpZXduYW1lID0gJ2V2YWIvaFJhdW1PcnRlRnVlckthcnRlP3N0YXJ0a2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCIsIFwiJyArIGxvY2FsU3RvcmFnZS5SYXVtSWQgKyAnXCJdJmVuZGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiLCBcIicgKyBsb2NhbFN0b3JhZ2UuUmF1bUlkICsgJ1wiICx7fV0maW5jbHVkZV9kb2NzPXRydWUnO1xyXG5cdFx0XHR3aW5kb3cuZW0uS2Vpbk9ydE1lbGR1bmcgPSBcIkVzIGdpYnQga2VpbmUgT3J0ZSBtaXQgS29vcmRpbmF0ZW5cIjtcclxuXHRcdFx0d2luZG93LmVtLmVyc3RlbGxlS2FydGVIKHZpZXduYW1lKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlIFwiaE9ydEVkaXRcIjpcclxuXHRcdFx0bG9jYWxTdG9yYWdlLk9ydE9kZXJCZW9iID0gXCJPcnRcIjtcclxuXHRcdFx0d2luZG93LmVtLmVyc3RlbGxlS2FydGVoT3J0RWRpdCgpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgXCJCZW9iTGlzdGVcIjpcclxuXHRcdFx0d2luZG93LmVtLmVyc3RlbGxlS2FydGVCZW9iTGlzdGUoKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlIFwiQmVvYkVkaXRcIjpcclxuXHRcdFx0d2luZG93LmVtLmVyc3RlbGxlS2FydGVCZW9iRWRpdCgpO1xyXG5cdFx0XHRicmVhaztcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlS2FydGVQYWdlaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQkKFwiI0thcnRlSGVhZGVyXCIpXHJcbiAgICAgICAgLy8genVyw7xjay1CdXR0b24gc3RldWVyblxyXG4gICAgICAgIC5vbignY2xpY2snLCAnI1p1cnVlY2tLYXJ0ZScsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlS2FydGVadXLDvGNrQ2xpY2soKTtcclxuICAgICAgICB9KTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVLYXJ0ZVBhZ2VoaWRlID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIGxlZXJlbiwgZGFtaXQgYmVpIGVybmV1dGVuIMOWZmZuZW4gZGllIEthcnRlIG5pY2h0IHp3ZWltYWwgYXVmZ2ViYXV0IHdpcmRcclxuXHQkKFwiI01hcENhbnZhc1wiKS5odG1sKFwiXCIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZUthcnRlWnVyw7xja0NsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciB6dXJ1ZWNrO1xyXG5cdGlmIChsb2NhbFN0b3JhZ2UuenVydWVjaykge1xyXG5cdFx0enVydWVjayA9IGxvY2FsU3RvcmFnZS56dXJ1ZWNrICsgXCIuaHRtbFwiO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR6dXJ1ZWNrID0gXCJCZW9iTGlzdGUuaHRtbFwiO1xyXG5cdH1cclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZSh6dXJ1ZWNrKTtcclxuXHRkZWxldGUgbG9jYWxTdG9yYWdlLnp1cnVlY2s7XHJcbn07XHJcblxyXG4vLyBlcnN0ZWxsdCBLYXJ0ZW4gZsO8ciBoUHJvamVrdExpc3RlIGJpcyBoT3J0TGlzdGVcclxuLy8gaW0gZXJzdGVuIFRlaWwgd2lyZCBkaWUgTGlzdGUgYWxsZXIgT3J0ZSBlcnN0ZWxsdCB1bmQgYW4gZGVuIHp3ZWl0ZW4gVGVpbCDDvGJlcmdlYmVuXHJcbndpbmRvdy5lbS5lcnN0ZWxsZUthcnRlSCA9IGZ1bmN0aW9uKHZpZXduYW1lKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cclxuXHQvLyBTZWl0ZW5ow7ZoZSBrb3JyaWdpZXJlbiwgd2VpbCBzb25zdCBHb29nbGVNYXAgd2Vpc3MgYmxlaWJ0XHJcblx0dmFyIGNvbnRlbnRIZWlnaHQgPSAkKHdpbmRvdykuaGVpZ2h0KCkgLSA0NCxcclxuXHRcdGhPcnRMYXRMbmdMaXN0ZTtcclxuXHJcblx0JChcIiNNYXBDYW52YXNcIikuY3NzKFwiaGVpZ2h0XCIsIGNvbnRlbnRIZWlnaHQgKyBcInB4XCIpO1xyXG5cdC8vIHp1c3TDpG5kaWdlIGhPcnRMYXRMbmdMaXN0ZSBlcm1pdHRlbG5cclxuXHRzd2l0Y2ggKGxvY2FsU3RvcmFnZS56dXJ1ZWNrKSB7XHJcblx0XHRjYXNlIFwiaFByb2pla3RMaXN0ZVwiOlxyXG5cdFx0aE9ydExhdExuZ0xpc3RlID0gXCJoT3J0ZUxhdExuZ1Byb2pla3RsaXN0ZVwiO1xyXG5cdFx0YnJlYWs7XHJcblx0Y2FzZSBcImhQcm9qZWt0RWRpdFwiOlxyXG5cdGNhc2UgXCJoUmF1bUxpc3RlXCI6XHJcblx0XHRoT3J0TGF0TG5nTGlzdGUgPSBcImhPcnRlTGF0TG5nUHJvamVrdFwiO1xyXG5cdFx0YnJlYWs7XHJcblx0Y2FzZSBcImhSYXVtRWRpdFwiOlxyXG5cdGNhc2UgXCJoT3J0TGlzdGVcIjpcclxuXHRcdGhPcnRMYXRMbmdMaXN0ZSA9IFwiaE9ydGVMYXRMbmdSYXVtXCI7XHJcblx0XHRicmVhaztcclxuXHR9XHJcblxyXG5cdC8vIExpc3RlIGRlciBPcnRlIGhvbGVuLiBQcsO8ZmVuLCBvYiBzaWUgbm9jaCBhbHMgVmFyaWFibGUgdm9ybGllZ3RcclxuXHRpZiAod2luZG93LmVtW2hPcnRMYXRMbmdMaXN0ZV0pIHtcclxuXHRcdHdpbmRvdy5lbS5lcnN0ZWxsZUthcnRlSF8yKHdpbmRvdy5lbVtoT3J0TGF0TG5nTGlzdGVdKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLnZpZXcodmlld25hbWUsIHtcclxuXHRcdFx0c3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW1baE9ydExhdExuZ0xpc3RlXSA9IGRhdGE7XHJcblx0XHRcdFx0d2luZG93LmVtLmVyc3RlbGxlS2FydGVIXzIoZGF0YSk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIGFsbGUgYmVuw7Z0aWd0ZW4gUHJvamVrdGUgaG9sZW5cclxud2luZG93LmVtLmVyc3RlbGxlS2FydGVIXzIgPSBmdW5jdGlvbihoT3J0ZUxhdExuZykge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAoIXdpbmRvdy5lbS5oUHJvamVrdCAmJiAhd2luZG93LmVtLmhQcm9qZWt0TGlzdGUpIHtcclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi52aWV3KFwiZXZhYi9oUHJvakxpc3RlP2luY2x1ZGVfZG9jcz10cnVlXCIsIHtcclxuXHRcdFx0c3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uaFByb2pla3RMaXN0ZSA9IGRhdGE7XHJcblx0XHRcdFx0d2luZG93LmVtLmVyc3RlbGxlS2FydGVIXzMoaE9ydGVMYXRMbmcsIGRhdGEpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0d2luZG93LmVtLmVyc3RlbGxlS2FydGVIXzMoaE9ydGVMYXRMbmcsIHdpbmRvdy5lbS5oUHJvamVrdExpc3RlKTtcclxuXHR9XHJcbn07XHJcblxyXG4vLyBhbGxlIGJlbsO2dGlndGVuIFLDpHVtZSBob2xlblxyXG53aW5kb3cuZW0uZXJzdGVsbGVLYXJ0ZUhfMyA9IGZ1bmN0aW9uKGhPcnRlTGF0TG5nLCBoUHJvamVrdExpc3RlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghd2luZG93LmVtLmhSYXVtICYmICF3aW5kb3cuZW0uaFJhdW1MaXN0ZSkge1xyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLnZpZXcoXCJldmFiL2hSYXVtTGlzdGU/aW5jbHVkZV9kb2NzPXRydWVcIiwge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xyXG5cdFx0XHRcdC8vIHdpbmRvdy5lbS5oUmF1bUxpc3RlIG5pY2h0IGFrdHVhbGlzaWVyZW5cclxuXHRcdFx0XHR3aW5kb3cuZW0uZXJzdGVsbGVLYXJ0ZUhfNChoT3J0ZUxhdExuZywgaFByb2pla3RMaXN0ZSwgZGF0YSk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR3aW5kb3cuZW0uZXJzdGVsbGVLYXJ0ZUhfNChoT3J0ZUxhdExuZywgaFByb2pla3RMaXN0ZSwgd2luZG93LmVtLmhSYXVtTGlzdGUpO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5lcnN0ZWxsZUthcnRlSF80ID0gZnVuY3Rpb24oaE9ydGVMYXRMbmcsIGhQcm9qZWt0TGlzdGUsIGhSYXVtTGlzdGUpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGFuek9ydCA9IDAsXHJcblx0XHRPcnQsXHJcblx0XHRsYXQsXHJcblx0XHRsbmcsXHJcblx0XHRsYXRsbmdfbWFwY2VudGVyLFxyXG5cdFx0b3B0aW9ucyxcclxuXHRcdG1hcCxcclxuXHRcdHByb2pla3Rfcm93LFxyXG5cdFx0cE5hbWUsXHJcblx0XHRyYXVtX3JvdyxcclxuXHRcdHJOYW1lLFxyXG5cdFx0Ym91bmRzLFxyXG5cdFx0bWFya2VycyxcclxuXHRcdGhPcnRJZCxcclxuXHRcdGxhdGxuZ19vcnQsXHJcblx0XHRtYXJrZXIsXHJcblx0XHRjb250ZW50U3RyaW5nLFxyXG5cdFx0bWNPcHRpb25zLFxyXG5cdFx0bWFya2VyQ2x1c3RlcjtcclxuXHJcblx0Ly8gT3J0ZSB6w6RobGVuXHJcblx0aWYgKGhPcnRlTGF0TG5nLnJvd3MpIHtcclxuXHRcdGFuek9ydCA9IGhPcnRlTGF0TG5nLnJvd3MubGVuZ3RoO1xyXG5cdH1cclxuXHJcblx0aWYgKGFuek9ydCA9PT0gMCkge1xyXG5cdFx0Ly8gS2VpbmUgT3J0ZTogSGlud2Vpc1xyXG5cdFx0d2luZG93LmVtLm1lbGRlKHdpbmRvdy5lbS5LZWluT3J0TWVsZHVuZyk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIE9ydGUgdm9yaGFuZGVuOiBLYXJ0ZSBhdWZiYXVlblxyXG5cdFx0Ly8gbWFsIGF1ZiBaw7xyaWNoIHplbnRyaWVyZW4sIGZhbGxzIGluIGRlbiBoT3J0ZUxhdExuZy5yb3dzIGtlaW5lIEtvb3JkaW5hdGVuIGtvbW1lblxyXG5cdFx0Ly8gYXVmIGRpZSBkaWUgS2FydGUgYXVzZ2VyaWNodGV0IHdlcmRlbiBrYW5uXHJcblx0XHRsYXQgPSA0Ny4zODMzMzM7XHJcblx0XHRsbmcgPSA4LjUzMzMzMztcclxuXHRcdGxhdGxuZ19tYXBjZW50ZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxhdCwgbG5nKTtcclxuXHRcdG9wdGlvbnMgPSB7XHJcblx0XHRcdHpvb206IDE1LFxyXG5cdFx0XHRjZW50ZXI6IGxhdGxuZ19tYXBjZW50ZXIsXHJcblx0XHRcdHN0cmVldFZpZXdDb250cm9sOiBmYWxzZSxcclxuXHRcdFx0bWFwVHlwZUlkOiBnb29nbGUubWFwcy5NYXBUeXBlSWQuSFlCUklEXHJcblx0XHR9O1xyXG5cdFx0bWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIk1hcENhbnZhc1wiKSxvcHRpb25zKTtcclxuXHRcdC8vZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcihtYXAsJ3Jlc2l6ZScpO1xyXG5cdFx0Ym91bmRzID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZ0JvdW5kcygpO1xyXG5cdFx0Ly8gZsO8ciBhbGxlIE9ydGUgTWFya2VyIGVyc3RlbGxlblxyXG5cdFx0bWFya2VycyA9IFtdO1xyXG5cclxuXHRcdF8uZWFjaChoT3J0ZUxhdExuZy5yb3dzLCBmdW5jdGlvbihyb3cpIHtcclxuXHRcdFx0T3J0ID0gcm93LmRvYztcclxuXHRcdFx0aE9ydElkID0gT3J0Ll9pZDtcclxuXHJcblx0XHRcdC8vIEluZm9zIGbDvHIgSW5mb3dpbmRvdyBob2xlblxyXG5cdFx0XHRwTmFtZSA9IFwiXCI7XHJcblx0XHRcdHJOYW1lID0gXCJcIjtcclxuXHRcdFx0aWYgKHdpbmRvdy5lbS5oUHJvamVrdCAmJiB3aW5kb3cuZW0uaFByb2pla3QucE5hbWUpIHtcclxuXHRcdFx0XHRwTmFtZSA9IHdpbmRvdy5lbS5oUHJvamVrdC5wTmFtZTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvLyBwTmFtZSBhdXMgaFByb2pla3RMaXN0ZSBob2xlblxyXG5cdFx0XHRcdHByb2pla3Rfcm93ID0gXy5maW5kKGhQcm9qZWt0TGlzdGUucm93cywgZnVuY3Rpb24ocm93KSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gcm93LmRvYy5faWQgPT09IE9ydC5oUHJvamVrdElkO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdHBOYW1lID0gcHJvamVrdF9yb3cuZG9jLnBOYW1lO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICh3aW5kb3cuZW0uaFJhdW0gJiYgd2luZG93LmVtLmhSYXVtLnJOYW1lKSB7XHJcblx0XHRcdFx0ck5hbWUgPSB3aW5kb3cuZW0uaFJhdW0uck5hbWU7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly8gck5hbWUgYXVzIGhSYXVtTGlzdGUgaG9sZW5cclxuXHRcdFx0XHRyYXVtX3JvdyA9IF8uZmluZChoUmF1bUxpc3RlLnJvd3MsIGZ1bmN0aW9uKHJvdykge1xyXG5cdFx0XHRcdFx0cmV0dXJuIHJvdy5kb2MuX2lkID09PSBPcnQuaFJhdW1JZDtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRyTmFtZSA9IHJhdW1fcm93LmRvYy5yTmFtZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRsYXRsbmdfb3J0ID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhPcnQub0xhdGl0dWRlRGVjRGVnLCBPcnQub0xvbmdpdHVkZURlY0RlZyk7XHJcblx0XHRcdGlmIChhbnpPcnQgPT09IDEpIHtcclxuXHRcdFx0XHQvLyBtYXAuZml0Ym91bmRzIHNldHp0IHp1IGhvaGVuIHpvb20sIHdlbm4gbnVyIGVpbmUgQmVvYmFjaHR1bmcgZXJmYXNzdCB3dXJkZSA+IHZlcmhpbmRlcm5cclxuXHRcdFx0XHRsYXRsbmdfbWFwY2VudGVyID0gbGF0bG5nX29ydDtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvLyBLYXJ0ZW5hdXNzY2huaXR0IHVtIGRpZXNlIEtvb3JkaW5hdGUgZXJ3ZWl0ZXJuXHJcblx0XHRcdFx0Ym91bmRzLmV4dGVuZChsYXRsbmdfb3J0KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRtYXJrZXIgPSBuZXcgTWFya2VyV2l0aExhYmVsKHsgXHJcblx0XHRcdFx0bWFwOiBtYXAsXHJcblx0XHRcdFx0cG9zaXRpb246IGxhdGxuZ19vcnQsXHJcblx0XHRcdFx0Ly8gdGl0bGUgbXVzcyBTdHJpbmcgc2VpblxyXG5cdFx0XHRcdHRpdGxlOiBPcnQub05hbWUudG9TdHJpbmcoKSB8fCBcIlwiLFxyXG5cdFx0XHRcdGxhYmVsQ29udGVudDogT3J0Lm9OYW1lLFxyXG5cdFx0XHRcdGxhYmVsQW5jaG9yOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoNzUsIC01KSxcclxuXHRcdFx0XHRsYWJlbENsYXNzOiBcIk1hcExhYmVsXCIgLy8gdGhlIENTUyBjbGFzcyBmb3IgdGhlIGxhYmVsXHJcblx0XHRcdH0pO1xyXG5cdFx0XHRtYXJrZXJzLnB1c2gobWFya2VyKTtcclxuXHRcdFx0Y29udGVudFN0cmluZyA9ICc8dGFibGUgY2xhc3M9XCJrYXJ0ZW5sZWdlbmRlX3RhYmVsbGVcIj4nO1xyXG5cdFx0XHRjb250ZW50U3RyaW5nICs9ICc8dHI+PHRkPlByb2pla3Q6PC90ZD48dGQ+JyArIHBOYW1lICsgJzwvdGQ+PC90cj4nO1xyXG5cdFx0XHRjb250ZW50U3RyaW5nICs9ICc8dHI+PHRkPlJhdW06PC90ZD48dGQ+JyArIHJOYW1lICsgJzwvdGQ+PC90cj4nO1xyXG5cdFx0XHRjb250ZW50U3RyaW5nICs9ICc8dHI+PHRkPk9ydDo8L3RkPjx0ZD4nICsgT3J0Lm9OYW1lICsgJzwvdGQ+PC90cj4nO1xyXG5cdFx0XHRjb250ZW50U3RyaW5nICs9ICc8dHI+PHRkPktvb3JkaW5hdGVuOjwvdGQ+PHRkPicgKyBPcnQub1hLb29yZCArIFwiL1wiICsgT3J0Lm9ZS29vcmQgKyAnPC90ZD48L3RyPic7XHJcblx0XHRcdGNvbnRlbnRTdHJpbmcgKz0gXCI8dHI+PHRkPjxhIGhyZWY9JyMnIG9uY2xpY2s9J3dpbmRvdy5lbS7DtmZmbmVPcnQoJ1wiICsgaE9ydElkICsgXCInKSc+YmVhcmJlaXRlbjxcXC9hPjwvdGQ+PHRkPjwvdGQ+PC90cj5cIjtcclxuXHRcdFx0Y29udGVudFN0cmluZyArPSAnPC90YWJsZT4nO1xyXG5cdFx0XHR3aW5kb3cuZW0ubWFrZU1hcExpc3RlbmVyKG1hcCwgbWFya2VyLCBjb250ZW50U3RyaW5nKTtcclxuXHRcdH0pO1xyXG5cdFx0bWNPcHRpb25zID0ge21heFpvb206IDE3fTtcclxuXHRcdG1hcmtlckNsdXN0ZXIgPSBuZXcgTWFya2VyQ2x1c3RlcmVyKG1hcCwgbWFya2VycywgbWNPcHRpb25zKTtcclxuXHRcdGlmIChhbnpPcnQgPT09IDEpIHtcclxuXHRcdFx0Ly8gbWFwLmZpdGJvdW5kcyBzZXR6dCB6dSBob2hlbiB6b29tLCB3ZW5uIG51ciBlaW5lIEJlb2JhY2h0dW5nIGVyZmFzc3Qgd3VyZGUgPiB2ZXJoaW5kZXJuXHJcblx0XHRcdG1hcC5zZXRDZW50ZXIobGF0bG5nX21hcGNlbnRlcik7XHJcblx0XHRcdG1hcC5zZXRab29tKDE4KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIEthcnRlIGF1ZiBBdXNzY2huaXR0IGFucGFzc2VuXHJcblx0XHRcdG1hcC5maXRCb3VuZHMoYm91bmRzKTtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0ubWFrZU1hcExpc3RlbmVyID0gZnVuY3Rpb24obWFwLCBtYXJrZXIsIGNvbnRlbnRTdHJpbmcpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGluZm93aW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdygpO1xyXG5cdGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG5cdFx0aW5mb3dpbmRvdy5zZXRDb250ZW50KGNvbnRlbnRTdHJpbmcpO1xyXG5cdFx0aW5mb3dpbmRvdy5vcGVuKG1hcCwgbWFya2VyKTtcclxuXHR9KTtcclxufTtcclxuXHJcbi8vIHdlbm4gbsO2dGlnIE9ydCBob2xlblxyXG53aW5kb3cuZW0uZXJzdGVsbGVLYXJ0ZWhPcnRFZGl0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghd2luZG93LmVtLmhPcnQpIHtcclxuXHRcdGlmIChsb2NhbFN0b3JhZ2UuT3J0SWQpIHtcclxuXHRcdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0XHQkZGIub3BlbkRvYyhsb2NhbFN0b3JhZ2UuT3J0SWQsIHtcclxuXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkb2MpIHtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5oT3J0ID0gZG9jO1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLmVyc3RlbGxlS2FydGVoT3J0RWRpdF8yKGRvYyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkZlaGxlcjogS2VpbiBPcnQgdmVyZsO8Z2JhclwiKTtcclxuICAgICAgICAgICAgLy8gcmV0dXJuIGlzdCBoaWVyIG5pY2h0IG7DtnRpZ1xyXG5cdFx0fVxyXG5cdH0gZWxzZSB7XHJcblx0XHR3aW5kb3cuZW0uZXJzdGVsbGVLYXJ0ZWhPcnRFZGl0XzIod2luZG93LmVtLmhPcnQpO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIGFsbGUgYmVuw7Z0aWd0ZW4gUHJvamVrdGUgaG9sZW5cclxud2luZG93LmVtLmVyc3RlbGxlS2FydGVoT3J0RWRpdF8yID0gZnVuY3Rpb24ob3J0KSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICghd2luZG93LmVtLmhQcm9qZWt0ICYmICF3aW5kb3cuZW0uaFByb2pla3RMaXN0ZSkge1xyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLnZpZXcoXCJldmFiL2hQcm9qTGlzdGU/aW5jbHVkZV9kb2NzPXRydWVcIiwge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5oUHJvamVrdExpc3RlID0gZGF0YTtcclxuXHRcdFx0XHR3aW5kb3cuZW0uZXJzdGVsbGVLYXJ0ZWhPcnRFZGl0XzMob3J0LCBkYXRhKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fSBlbHNlIHtcclxuXHRcdHdpbmRvdy5lbS5lcnN0ZWxsZUthcnRlaE9ydEVkaXRfMyhvcnQsIHdpbmRvdy5lbS5oUHJvamVrdExpc3RlKTtcclxuXHR9XHJcbn07XHJcblxyXG4vLyBhbGxlIGJlbsO2dGlndGVuIFLDpHVtZSBob2xlblxyXG53aW5kb3cuZW0uZXJzdGVsbGVLYXJ0ZWhPcnRFZGl0XzMgPSBmdW5jdGlvbihvcnQsIGhQcm9qZWt0TGlzdGUpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKCF3aW5kb3cuZW0uaFJhdW0gJiYgIXdpbmRvdy5lbS5oUmF1bUxpc3RlKSB7XHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIudmlldyhcImV2YWIvaFJhdW1MaXN0ZT9pbmNsdWRlX2RvY3M9dHJ1ZVwiLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XHJcblx0XHRcdFx0Ly8gd2luZG93LmVtLmhSYXVtTGlzdGUgbmljaHQgYWt0dWFsaXNpZXJlblxyXG5cdFx0XHRcdHdpbmRvdy5lbS5lcnN0ZWxsZUthcnRlaE9ydEVkaXRfNChvcnQsIGhQcm9qZWt0TGlzdGUsIGRhdGEpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0d2luZG93LmVtLmVyc3RlbGxlS2FydGVoT3J0RWRpdF80KG9ydCwgaFByb2pla3RMaXN0ZSwgd2luZG93LmVtLmhSYXVtTGlzdGUpO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIHdpcmQgYmVudXR6dCBpbiBoT3J0RWRpdC5odG1sXHJcbndpbmRvdy5lbS5lcnN0ZWxsZUthcnRlaE9ydEVkaXRfNCA9IGZ1bmN0aW9uKG9ydCwgaFByb2pla3RMaXN0ZSwgaFJhdW1MaXN0ZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgbWFwLFxyXG5cdFx0dmVyb3J0ZWQsXHJcblx0XHRsYXQsXHJcblx0XHRsbmcsXHJcblx0XHRab29tTGV2ZWwsXHJcblx0XHRsYXRsbmdfbWFwY2VudGVyLFxyXG5cdFx0b3B0aW9ucyxcclxuXHRcdC8vIHRpdGxlIG11c3MgU3RyaW5nIHNlaW5cclxuXHRcdHRpdGxlID0gXCJcIixcclxuXHRcdHByb2pla3Rfcm93LFxyXG5cdFx0cE5hbWUgPSBcIlwiLFxyXG5cdFx0cmF1bV9yb3csXHJcblx0XHRyTmFtZSA9IFwiXCIsXHJcblx0XHRvTmFtZSA9IFwiXCIsXHJcblx0XHRtYXJrZXIsXHJcblx0XHRjb250ZW50U3RyaW5nLFxyXG5cdFx0aW5mb3dpbmRvdyxcclxuXHRcdC8vIFNlaXRlbmjDtmhlIGtvcnJpZ2llcmVuLCB3ZWlsIHNvbnN0IEdvb2dsZU1hcCB3ZWlzcyBibGVpYnRcclxuXHRcdGNvbnRlbnRIZWlnaHQgPSAkKHdpbmRvdykuaGVpZ2h0KCkgLSA0NDtcclxuXHQvLyBGZWhsZXJtZWxkdW5nIHZlcmhpbmRlcm4sIGZhbGxzIGtlaW4gd2luZG93LmVtLmhPcnQgZXhpc3RpZXJ0XHJcblx0aWYgKHdpbmRvdy5lbS5oT3J0KSB7XHJcblx0XHRpZiAod2luZG93LmVtLmhPcnQub05hbWUpIHtcclxuXHRcdFx0dGl0bGUgPSB3aW5kb3cuZW0uaE9ydC5vTmFtZS50b1N0cmluZygpO1xyXG5cdFx0XHRvTmFtZSA9IHdpbmRvdy5lbS5oT3J0Lm9OYW1lO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRpZiAod2luZG93LmVtLmhQcm9qZWt0ICYmIHdpbmRvdy5lbS5oUHJvamVrdC5wTmFtZSkge1xyXG5cdFx0cE5hbWUgPSB3aW5kb3cuZW0uaFByb2pla3QucE5hbWU7XHJcblx0fSBlbHNlIGlmIChsb2NhbFN0b3JhZ2UuUHJvamVrdElkKSB7XHJcblx0XHQvLyBwTmFtZSBhdXMgaFByb2pla3RMaXN0ZSBob2xlblxyXG5cdFx0cHJvamVrdF9yb3cgPSBfLmZpbmQoaFByb2pla3RMaXN0ZS5yb3dzLCBmdW5jdGlvbihyb3cpIHtcclxuXHRcdFx0cmV0dXJuIHJvdy5kb2MuX2lkID09PSBsb2NhbFN0b3JhZ2UuUHJvamVrdElkO1xyXG5cdFx0fSk7XHJcblx0XHRwTmFtZSA9IHByb2pla3Rfcm93LmRvYy5wTmFtZTtcclxuXHR9XHJcblx0aWYgKHdpbmRvdy5lbS5oUmF1bSAmJiB3aW5kb3cuZW0uaFJhdW0uck5hbWUpIHtcclxuXHRcdHJOYW1lID0gd2luZG93LmVtLmhSYXVtLnJOYW1lO1xyXG5cdH0gZWxzZSBpZiAobG9jYWxTdG9yYWdlLlJhdW1JZCkge1xyXG5cdFx0Ly8gck5hbWUgYXVzIGhSYXVtTGlzdGUgaG9sZW5cclxuXHRcdHJhdW1fcm93ID0gXy5maW5kKGhSYXVtTGlzdGUucm93cywgZnVuY3Rpb24ocm93KSB7XHJcblx0XHRcdHJldHVybiByb3cuZG9jLl9pZCA9PT0gbG9jYWxTdG9yYWdlLlJhdW1JZDtcclxuXHRcdH0pO1xyXG5cdFx0ck5hbWUgPSByYXVtX3Jvdy5kb2Muck5hbWU7XHJcblx0fVxyXG5cdCQoXCIjTWFwQ2FudmFzXCIpLmNzcyhcImhlaWdodFwiLCBjb250ZW50SGVpZ2h0ICsgXCJweFwiKTtcclxuXHRpZiAobG9jYWxTdG9yYWdlLm9MYXRpdHVkZURlY0RlZyAmJiBsb2NhbFN0b3JhZ2Uub0xvbmdpdHVkZURlY0RlZykge1xyXG5cdFx0bGF0ID0gbG9jYWxTdG9yYWdlLm9MYXRpdHVkZURlY0RlZztcclxuXHRcdGxuZyA9IGxvY2FsU3RvcmFnZS5vTG9uZ2l0dWRlRGVjRGVnO1xyXG5cdFx0Wm9vbUxldmVsID0gMTU7XHJcblx0XHR2ZXJvcnRlZCA9IHRydWU7XHJcblx0fSBlbHNlIHtcclxuXHRcdGxhdCA9IDQ3LjM2MDU2NjtcclxuXHRcdGxuZyA9IDguNTQyODI5O1xyXG5cdFx0Wm9vbUxldmVsID0gMTI7XHJcblx0XHR2ZXJvcnRlZCA9IGZhbHNlO1xyXG5cdH1cclxuXHRsYXRsbmdfbWFwY2VudGVyID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsYXQsIGxuZyk7XHJcblx0b3B0aW9ucyA9IHtcclxuXHRcdHpvb206IFpvb21MZXZlbCxcclxuXHRcdGNlbnRlcjogbGF0bG5nX21hcGNlbnRlcixcclxuXHRcdHN0cmVldFZpZXdDb250cm9sOiBmYWxzZSxcclxuXHRcdG1hcFR5cGVJZDogZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLkhZQlJJRFxyXG5cdH07XHJcblx0bWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIk1hcENhbnZhc1wiKSxvcHRpb25zKTtcclxuXHRpZiAodmVyb3J0ZWQgPT09IHRydWUpIHtcclxuXHRcdG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xyXG5cdFx0XHRwb3NpdGlvbjogbGF0bG5nX21hcGNlbnRlciwgXHJcblx0XHRcdG1hcDogbWFwLFxyXG5cdFx0XHR0aXRsZTogdGl0bGUsXHJcblx0XHRcdGRyYWdnYWJsZTogdHJ1ZVxyXG5cdFx0fSk7XHJcblx0XHQvLyBNYXJrZXIgaW4gQXJyYXkgc3BlaWNoZXJuLCBkYW1pdCBlciBnZWzDtnNjaHQgd2VyZGVuIGthbm5cclxuXHRcdHdpbmRvdy5lbS5tYXJrZXJzQXJyYXkucHVzaChtYXJrZXIpO1xyXG5cdFx0Y29udGVudFN0cmluZyA9ICc8dGFibGUgY2xhc3M9XCJrYXJ0ZW5sZWdlbmRlX3RhYmVsbGVcIj4nO1xyXG5cdFx0Y29udGVudFN0cmluZyArPSAnPHRyPjx0ZD5Qcm9qZWt0OjwvdGQ+PHRkPicgKyBwTmFtZSArICc8L3RkPjwvdHI+JztcclxuXHRcdGNvbnRlbnRTdHJpbmcgKz0gJzx0cj48dGQ+UmF1bTo8L3RkPjx0ZD4nICsgck5hbWUgKyAnPC90ZD48L3RyPic7XHJcblx0XHRjb250ZW50U3RyaW5nICs9ICc8dHI+PHRkPk9ydDo8L3RkPjx0ZD4nICsgb05hbWUgKyAnPC90ZD48L3RyPic7XHJcblx0XHRjb250ZW50U3RyaW5nICs9ICc8dHI+PHRkPktvb3JkaW5hdGVuOjwvdGQ+PHRkPicgKyBsb2NhbFN0b3JhZ2Uub1hLb29yZCArIFwiL1wiICsgbG9jYWxTdG9yYWdlLm9ZS29vcmQgKyAnPC90ZD48L3RyPic7XHJcblx0XHRjb250ZW50U3RyaW5nICs9ICc8L3RhYmxlPic7XHJcblx0XHRpbmZvd2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coe1xyXG5cdFx0XHRjb250ZW50OiBjb250ZW50U3RyaW5nXHJcblx0XHR9KTtcclxuXHRcdHdpbmRvdy5lbS5JbmZvV2luZG93QXJyYXkucHVzaChpbmZvd2luZG93KTtcclxuXHRcdGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRpbmZvd2luZG93Lm9wZW4obWFwLG1hcmtlcik7XHJcblx0XHR9KTtcclxuXHRcdGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgXCJkcmFnZW5kXCIsIGZ1bmN0aW9uIChldmVudCkge1xyXG5cdFx0XHR3aW5kb3cuZW0uU2V0TG9jYXRpb25oT3J0RWRpdChldmVudC5sYXRMbmcsIG1hcCwgbWFya2VyKTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHRnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAsICdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xyXG5cdFx0d2luZG93LmVtLnBsYWNlTWFya2VyaE9ydEVkaXQoZXZlbnQubGF0TG5nLCBtYXAsIG1hcmtlcik7XHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyB3aXJkIGJlbnV0enQgaW4gQmVvYkxpc3RlLmh0bWxcclxud2luZG93LmVtLmVyc3RlbGxlS2FydGVCZW9iTGlzdGUgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gU2VpdGVuaMO2aGUga29ycmlnaWVyZW4sIHdlaWwgc29uc3QgR29vZ2xlTWFwIHdlaXNzIGJsZWlidFxyXG5cdHZhciBjb250ZW50SGVpZ2h0ID0gJCh3aW5kb3cpLmhlaWdodCgpIC0gNDQ7XHJcblx0JChcIiNNYXBDYW52YXNcIikuY3NzKFwiaGVpZ2h0XCIsIGNvbnRlbnRIZWlnaHQgKyBcInB4XCIpO1xyXG5cdC8vIEJlb2JhY2h0dW5nZW4gaG9sZW4uIFByw7xmZW4sIG9iIGRpZSBMaXN0ZSBub2NoIGRhIGlzdFxyXG5cdGlmICh3aW5kb3cuZW0uQmVvYkxpc3RlTGF0TG5nKSB7XHJcblx0XHR3aW5kb3cuZW0uZXJzdGVsbGVLYXJ0ZUJlb2JMaXN0ZV8yKCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi52aWV3KCdldmFiL0Jlb2JMaXN0ZUxhdExuZz9rZXk9XCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiJmluY2x1ZGVfZG9jcz10cnVlJywge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5CZW9iTGlzdGVMYXRMbmcgPSBkYXRhO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5lcnN0ZWxsZUthcnRlQmVvYkxpc3RlXzIoKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLmVyc3RlbGxlS2FydGVCZW9iTGlzdGVfMiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgYW56QmVvYiA9IHdpbmRvdy5lbS5CZW9iTGlzdGVMYXRMbmcucm93cy5sZW5ndGgsXHJcblx0XHRiZW9iLFxyXG5cdFx0aW1hZ2UsXHJcblx0XHRsYXQsXHJcblx0XHRsbmcsXHJcblx0XHRsYXRsbmdfbWFwY2VudGVyLFxyXG5cdFx0bGF0bG5nX2Jlb2IsXHJcblx0XHRvcHRpb25zLFxyXG5cdFx0bWFwLFxyXG5cdFx0Ym91bmRzLFxyXG5cdFx0bWFya2VyLFxyXG5cdFx0bWFya2VycyxcclxuXHRcdGNvbnRlbnRTdHJpbmcsXHJcblx0XHRtY09wdGlvbnMsXHJcblx0XHRtYXJrZXJDbHVzdGVyLFxyXG5cdFx0YXJ0Z3J1cHBlbm5hbWU7XHJcblx0aWYgKGFuekJlb2IgPT09IDApIHtcclxuXHRcdC8vIEtlaW5lIEJlb2JhY2h0dW5nZW46IEhpbndlaXMgdW5kIHp1csO8Y2tcclxuXHRcdHdpbmRvdy5lbS5tZWxkZShcIkVzIHd1cmRlbiBub2NoIGtlaW5lIEJlb2JhY2h0dW5nZW4gbWl0IEtvb3JkaW5hdGVuIGVyZmFzc3RcIik7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkJlb2JMaXN0ZS5odG1sXCIpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBCZW9iYWNodHVuZ2VuIHZvcmhhbmRlbjogS2FydGUgYXVmYmF1ZW5cclxuXHRcdGxhdCA9IDQ3LjM4MzMzMztcclxuXHRcdGxuZyA9IDguNTMzMzMzO1xyXG5cdFx0bGF0bG5nX21hcGNlbnRlciA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobGF0LCBsbmcpO1xyXG5cdFx0b3B0aW9ucyA9IHtcclxuXHRcdFx0em9vbTogMTUsXHJcblx0XHRcdGNlbnRlcjogbGF0bG5nX21hcGNlbnRlcixcclxuXHRcdFx0c3RyZWV0Vmlld0NvbnRyb2w6IGZhbHNlLFxyXG5cdFx0XHRtYXBUeXBlSWQ6IGdvb2dsZS5tYXBzLk1hcFR5cGVJZC5IWUJSSURcclxuXHRcdH07XHJcblx0XHRtYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiTWFwQ2FudmFzXCIpLG9wdGlvbnMpO1xyXG5cdFx0Ly9nb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKG1hcCwncmVzaXplJyk7XHJcblx0XHRib3VuZHMgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nQm91bmRzKCk7XHJcblx0XHQvLyBmw7xyIGFsbGUgQmVvYmFjaHR1bmdlbiBNYXJrZXIgZXJzdGVsbGVuXHJcblx0XHRtYXJrZXJzID0gW107XHJcblx0XHRfLmVhY2god2luZG93LmVtLkJlb2JMaXN0ZUxhdExuZy5yb3dzLCBmdW5jdGlvbihyb3cpIHtcclxuXHRcdFx0YmVvYiA9IHJvdy5kb2M7XHJcblx0XHRcdGFydGdydXBwZW5uYW1lID0gZW5jb2RlVVJJQ29tcG9uZW50KGJlb2IuYUFydEdydXBwZS5yZXBsYWNlKCfDvCcsICd1ZScpLnJlcGxhY2UoJ8OkJywgJ2FlJykucmVwbGFjZSgnw7YnLCAnb2UnKSkgKyBcIi5wbmdcIjtcclxuXHRcdFx0aWYgKGJlb2IuYUFydEdydXBwZSA9PT0gXCJEaXZlcnNlSW5zZWt0ZW5cIikge1xyXG5cdFx0XHRcdGFydGdydXBwZW5uYW1lID0gXCJ1bmJlbmFubnQucG5nXCI7XHJcblx0XHRcdH1cclxuXHRcdFx0aW1hZ2UgPSBcIkFydGdydXBwZW5iaWxkZXIvXCIgKyBhcnRncnVwcGVubmFtZTtcclxuXHRcdFx0bGF0bG5nX2Jlb2IgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGJlb2Iub0xhdGl0dWRlRGVjRGVnLCBiZW9iLm9Mb25naXR1ZGVEZWNEZWcpO1xyXG5cdFx0XHRpZiAoYW56QmVvYiA9PT0gMSkge1xyXG5cdFx0XHRcdC8vIG1hcC5maXRib3VuZHMgc2V0enQgenUgaG9oZW4gem9vbSwgd2VubiBudXIgZWluZSBCZW9iYWNodHVuZyBlcmZhc3N0IHd1cmRlID4gdmVyaGluZGVyblxyXG5cdFx0XHRcdGxhdGxuZ19tYXBjZW50ZXIgPSBsYXRsbmdfYmVvYjtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvLyBLYXJ0ZW5hdXNzY2huaXR0IHVtIGRpZXNlIEtvb3JkaW5hdGUgZXJ3ZWl0ZXJuXHJcblx0XHRcdFx0Ym91bmRzLmV4dGVuZChsYXRsbmdfYmVvYik7XHJcblx0XHRcdH1cclxuXHRcdFx0bWFya2VyID0gbmV3IE1hcmtlcldpdGhMYWJlbCh7IFxyXG5cdFx0XHRcdG1hcDogbWFwLFxyXG5cdFx0XHRcdHBvc2l0aW9uOiBsYXRsbmdfYmVvYixcclxuXHRcdFx0XHQvLyB0aXRsZSBtdXNzIFN0cmluZyBzZWluXHJcblx0XHRcdFx0dGl0bGU6IGJlb2IuYUFydE5hbWUudG9TdHJpbmcoKSB8fCBcIlwiLFxyXG5cdFx0XHRcdC8vaWNvbjogaW1hZ2UsXHJcblx0XHRcdFx0bGFiZWxDb250ZW50OiBiZW9iLmFBcnROYW1lLFxyXG5cdFx0XHRcdGxhYmVsQW5jaG9yOiBuZXcgZ29vZ2xlLm1hcHMuUG9pbnQoNzUsIC01KSxcclxuXHRcdFx0XHRsYWJlbENsYXNzOiBcIk1hcExhYmVsXCIgLy8gdGhlIENTUyBjbGFzcyBmb3IgdGhlIGxhYmVsXHJcblx0XHRcdH0pO1xyXG5cdFx0XHRtYXJrZXJzLnB1c2gobWFya2VyKTtcclxuXHRcdFx0Y29udGVudFN0cmluZyA9ICc8aDQgY2xhc3M9XCJtYXBfaW5mb3dpbmRvd190aXRsZVwiPicgKyBiZW9iLmFBcnROYW1lICsgJzwvaDQ+JztcclxuXHRcdFx0Y29udGVudFN0cmluZyArPSAnPHRhYmxlIGNsYXNzPVwia2FydGVubGVnZW5kZV90YWJlbGxlXCI+JztcclxuXHRcdFx0Y29udGVudFN0cmluZyArPSAnPHRyPjx0ZD5BcnQtR3J1cHBlOjwvdGQ+PHRkPicgKyBiZW9iLmFBcnRHcnVwcGUgKyAnPC90ZD48L3RyPic7XHJcblx0XHRcdGlmIChiZW9iLmFBdXRvcikge1xyXG5cdFx0XHRcdGNvbnRlbnRTdHJpbmcgKz0gJzx0cj48dGQ+QXV0b3I6PC90ZD48dGQ+JyArIGJlb2IuYUF1dG9yICsgJzwvdGQ+PC90cj4nO1xyXG5cdFx0XHR9XHJcblx0XHRcdGNvbnRlbnRTdHJpbmcgKz0gJzx0cj48dGQ+RGF0dW06PC90ZD48dGQ+JyArIGJlb2IuekRhdHVtICsgJzwvdGQ+PC90cj4nO1xyXG5cdFx0XHRjb250ZW50U3RyaW5nICs9ICc8dHI+PHRkPlplaXQ6PC90ZD48dGQ+JyArIGJlb2IuelVocnplaXQgKyAnPC90ZD48L3RyPic7XHJcblx0XHRcdGNvbnRlbnRTdHJpbmcgKz0gJzx0cj48dGQ+S29vcmRpbmF0ZW46PC90ZD48dGQ+JyArIGJlb2Iub1hLb29yZCArIFwiL1wiICsgYmVvYi5vWUtvb3JkICsgJzwvdGQ+PC90cj4nO1xyXG5cdFx0XHRjb250ZW50U3RyaW5nICs9ICc8L3RhYmxlPic7XHJcblx0XHRcdHdpbmRvdy5lbS5tYWtlTWFwTGlzdGVuZXIobWFwLCBtYXJrZXIsIGNvbnRlbnRTdHJpbmcpO1xyXG5cdFx0fSk7XHJcblx0XHRtY09wdGlvbnMgPSB7bWF4Wm9vbTogMTd9O1xyXG5cdFx0bWFya2VyQ2x1c3RlciA9IG5ldyBNYXJrZXJDbHVzdGVyZXIobWFwLCBtYXJrZXJzLCBtY09wdGlvbnMpO1xyXG5cdFx0aWYgKGFuekJlb2IgPT09IDEpIHtcclxuXHRcdFx0Ly8gbWFwLmZpdGJvdW5kcyBzZXR6dCB6dSBob2hlbiB6b29tLCB3ZW5uIG51ciBlaW5lIEJlb2JhY2h0dW5nIGVyZmFzc3Qgd3VyZGUgPiB2ZXJoaW5kZXJuXHJcblx0XHRcdG1hcC5zZXRDZW50ZXIobGF0bG5nX21hcGNlbnRlcik7XHJcblx0XHRcdG1hcC5zZXRab29tKDE4KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIEthcnRlIGF1ZiBBdXNzY2huaXR0IGFucGFzc2VuXHJcblx0XHRcdG1hcC5maXRCb3VuZHMoYm91bmRzKTtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG4vLyBzaWNoZXJzdGVsbGVuLCBkYXNzIHdpbmRvdy5lbS5CZW9iYWNodHVuZyBleGlzdGllcnRcclxud2luZG93LmVtLmVyc3RlbGxlS2FydGVCZW9iRWRpdCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAoIXdpbmRvdy5lbS5CZW9iYWNodHVuZykge1xyXG5cdFx0aWYgKGxvY2FsU3RvcmFnZS5CZW9iSWQpIHtcclxuXHRcdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0XHQkZGIub3BlbkRvYyhsb2NhbFN0b3JhZ2UuQmVvYklkLCB7XHJcblx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oZG9jKSB7XHJcblx0XHRcdFx0XHR3aW5kb3cuZW0uQmVvYmFjaHR1bmcgPSBkb2M7XHJcblx0XHRcdFx0XHR3aW5kb3cuZW0uZXJzdGVsbGVLYXJ0ZUJlb2JFZGl0XzIoZG9jKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRmVobGVyOiBLZWluZSBCZW9iYWNodHVuZyB2ZXJmw7xnYmFyXCIpO1xyXG4gICAgICAgICAgICAvLyByZXR1cm4gaXN0IGhpZXIgbmljaHQgbsO2dGlnXHJcblx0XHR9XHJcblx0fSBlbHNlIHtcclxuXHRcdHdpbmRvdy5lbS5lcnN0ZWxsZUthcnRlQmVvYkVkaXRfMih3aW5kb3cuZW0uQmVvYmFjaHR1bmcpO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5lcnN0ZWxsZUthcnRlQmVvYkVkaXRfMiA9IGZ1bmN0aW9uKGJlb2IpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIG1hcCxcclxuXHRcdHZlcm9ydGVkLFxyXG5cdFx0bGF0LFxyXG5cdFx0bG5nLFxyXG5cdFx0Wm9vbUxldmVsLFxyXG5cdFx0bGF0bG5nX21hcGNlbnRlcixcclxuXHRcdG9wdGlvbnMsXHJcblx0XHRtYXBjYW52YXMsXHJcblx0XHRpbWFnZSxcclxuXHRcdG1hcmtlcixcclxuXHRcdGNvbnRlbnRTdHJpbmcsXHJcblx0XHRpbmZvd2luZG93LFxyXG5cdFx0Ly8gU2VpdGVuaMO2aGUga29ycmlnaWVyZW4sIHdlaWwgc29uc3QgR29vZ2xlTWFwIHdlaXNzIGJsZWlidFxyXG5cdFx0Y29udGVudEhlaWdodCA9ICQod2luZG93KS5oZWlnaHQoKSAtIDQ0LFxyXG5cdFx0YXJ0Z3J1cHBlbm5hbWU7XHJcblx0JChcIiNNYXBDYW52YXNcIikuY3NzKFwiaGVpZ2h0XCIsIGNvbnRlbnRIZWlnaHQgKyBcInB4XCIpO1xyXG5cdGlmIChsb2NhbFN0b3JhZ2Uub0xhdGl0dWRlRGVjRGVnICYmIGxvY2FsU3RvcmFnZS5vTG9uZ2l0dWRlRGVjRGVnKSB7XHJcblx0XHRsYXQgPSBsb2NhbFN0b3JhZ2Uub0xhdGl0dWRlRGVjRGVnO1xyXG5cdFx0bG5nID0gbG9jYWxTdG9yYWdlLm9Mb25naXR1ZGVEZWNEZWc7XHJcblx0XHRab29tTGV2ZWwgPSAxNTtcclxuXHRcdHZlcm9ydGVkID0gdHJ1ZTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0bGF0ID0gNDcuMzYwNTY2O1xyXG5cdFx0bG5nID0gOC41NDI4Mjk7XHJcblx0XHRab29tTGV2ZWwgPSAxMjtcclxuXHRcdHZlcm9ydGVkID0gZmFsc2U7XHJcblx0fVxyXG5cdGxhdGxuZ19tYXBjZW50ZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxhdCwgbG5nKTtcclxuXHRvcHRpb25zID0ge1xyXG5cdFx0em9vbTogWm9vbUxldmVsLFxyXG5cdFx0Y2VudGVyOiBsYXRsbmdfbWFwY2VudGVyLFxyXG5cdFx0c3RyZWV0Vmlld0NvbnRyb2w6IGZhbHNlLFxyXG5cdFx0bWFwVHlwZUlkOiBnb29nbGUubWFwcy5NYXBUeXBlSWQuSFlCUklEXHJcblx0fTtcclxuXHRtYXBjYW52YXMgPSAkKCcjTWFwQ2FudmFzJyk7XHJcblx0bWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChtYXBjYW52YXNbMF0sb3B0aW9ucyk7XHJcblx0Ly9nb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKG1hcCwncmVzaXplJyk7XHJcblx0YXJ0Z3J1cHBlbm5hbWUgPSBlbmNvZGVVUklDb21wb25lbnQobG9jYWxTdG9yYWdlLmFBcnRHcnVwcGUucmVwbGFjZSgnw7wnLCAndWUnKS5yZXBsYWNlKCfDpCcsICdhZScpLnJlcGxhY2UoJ8O2JywgJ29lJykpICsgXCIucG5nXCI7XHJcblx0aWYgKGxvY2FsU3RvcmFnZS5hQXJ0R3J1cHBlID09PSBcIkRpdmVyc2VJbnNla3RlblwiKSB7XHJcblx0XHRhcnRncnVwcGVubmFtZSA9IFwidW5iZW5hbm50LnBuZ1wiO1xyXG5cdH1cclxuXHRpbWFnZSA9IFwiQXJ0Z3J1cHBlbmJpbGRlci9cIiArIGFydGdydXBwZW5uYW1lO1xyXG5cdGlmICh2ZXJvcnRlZCA9PT0gdHJ1ZSkge1xyXG5cdFx0bWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XHJcblx0XHRcdHBvc2l0aW9uOiBsYXRsbmdfbWFwY2VudGVyLCBcclxuXHRcdFx0bWFwOiBtYXAsXHJcblx0XHRcdC8vIHRpdGxlIG11c3MgU3RyaW5nIHNlaW5cclxuXHRcdFx0dGl0bGU6IGxvY2FsU3RvcmFnZS5hQXJ0TmFtZS50b1N0cmluZygpIHx8IFwiXCIsXHJcblx0XHRcdC8vaWNvbjogaW1hZ2UsXHJcblx0XHRcdGRyYWdnYWJsZTogdHJ1ZVxyXG5cdFx0fSk7XHJcblx0XHQvLyBNYXJrZXIgaW4gQXJyYXkgc3BlaWNoZXJuLCBkYW1pdCBlciBnZWzDtnNjaHQgd2VyZGVuIGthbm5cclxuXHRcdHdpbmRvdy5lbS5tYXJrZXJzQXJyYXkucHVzaChtYXJrZXIpOyBcclxuXHRcdGNvbnRlbnRTdHJpbmcgPSAnPGg0IGNsYXNzPVwibWFwX2luZm93aW5kb3dfdGl0bGVcIj4nICsgbG9jYWxTdG9yYWdlLmFBcnROYW1lICsgJzwvaDQ+JztcclxuXHRcdGNvbnRlbnRTdHJpbmcgKz0gJzx0YWJsZSBjbGFzcz1cImthcnRlbmxlZ2VuZGVfdGFiZWxsZVwiPic7XHJcblx0XHRjb250ZW50U3RyaW5nICs9ICc8dHI+PHRkPkFydC1HcnVwcGU6PC90ZD48dGQ+JyArIGxvY2FsU3RvcmFnZS5hQXJ0R3J1cHBlICsgJzwvdGQ+PC90cj4nO1xyXG5cdFx0aWYgKGJlb2IuYUF1dG9yKSB7XHJcblx0XHRcdGNvbnRlbnRTdHJpbmcgKz0gJzx0cj48dGQ+QXV0b3I6PC90ZD48dGQ+JyArIGJlb2IuYUF1dG9yICsgJzwvdGQ+PC90cj4nO1xyXG5cdFx0fVxyXG5cdFx0Y29udGVudFN0cmluZyArPSAnPHRyPjx0ZD5EYXR1bTo8L3RkPjx0ZD4nICsgYmVvYi56RGF0dW0gKyAnPC90ZD48L3RyPic7XHJcblx0XHRjb250ZW50U3RyaW5nICs9ICc8dHI+PHRkPlplaXQ6PC90ZD48dGQ+JyArIGJlb2IuelVocnplaXQgKyAnPC90ZD48L3RyPic7XHJcblx0XHRjb250ZW50U3RyaW5nICs9ICc8dHI+PHRkPktvb3JkaW5hdGVuOjwvdGQ+PHRkPicgKyBsb2NhbFN0b3JhZ2Uub1hLb29yZCArIFwiL1wiICsgbG9jYWxTdG9yYWdlLm9ZS29vcmQgKyAnPC90ZD48L3RyPic7XHJcblx0XHRjb250ZW50U3RyaW5nICs9ICc8L3RhYmxlPic7XHJcblx0XHRpbmZvd2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coe1xyXG5cdFx0XHRjb250ZW50OiBjb250ZW50U3RyaW5nXHJcblx0XHR9KTtcclxuXHRcdHdpbmRvdy5lbS5JbmZvV2luZG93QXJyYXkucHVzaChpbmZvd2luZG93KTtcclxuXHRcdGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRpbmZvd2luZG93Lm9wZW4obWFwLG1hcmtlcik7XHJcblx0XHR9KTtcclxuXHRcdGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgXCJkcmFnZW5kXCIsIGZ1bmN0aW9uIChldmVudCkge1xyXG5cdFx0XHR3aW5kb3cuZW0uU2V0TG9jYXRpb25CZW9iRWRpdChldmVudC5sYXRMbmcsIG1hcCwgbWFya2VyKTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHRnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAsICdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xyXG5cdFx0d2luZG93LmVtLnBsYWNlTWFya2VyQmVvYkVkaXQoZXZlbnQubGF0TG5nLCBtYXAsIG1hcmtlciwgaW1hZ2UpO1xyXG5cdH0pO1xyXG59O1xyXG5cclxuLy8gd2lyZCBiZW51dHp0IGluIGhPcnRFZGl0Lmh0bWxcclxud2luZG93LmVtLnBsYWNlTWFya2VyaE9ydEVkaXQgPSBmdW5jdGlvbihsb2NhdGlvbiwgbWFwLCBtYXJrZXIpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8genVlcnN0IGJpc2hlcmlnZSBNYXJrZXIgbMO2c2NoZW5cclxuXHQvL3dpbmRvdy5lbS5jbGVhck1hcmtlcnMoKTtcclxuXHRtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcclxuXHRcdHBvc2l0aW9uOiBsb2NhdGlvbiwgXHJcblx0XHRtYXA6IG1hcCxcclxuXHRcdC8vIHRpdGxlIG11c3MgU3RyaW5nIHNlaW5cclxuXHRcdHRpdGxlOiB3aW5kb3cuZW0uaE9ydC5vTmFtZS50b1N0cmluZygpIHx8IFwiXCIsXHJcblx0XHRkcmFnZ2FibGU6IHRydWVcclxuXHR9KTtcclxuXHQvLyBNYXJrZXIgaW4gQXJyYXkgc3BlaWNoZXJuLCBkYW1pdCBlciBnZWzDtnNjaHQgd2VyZGVuIGthbm5cclxuXHQvLyB6dWVyc3QgYmlzaGVyaWdlIGzDtnNjaGVuLCBzb25zdCBnaWJ0IGVzIHBybyBLbGljayBlaW5lbiBNYXJrZXIuLi5cclxuXHR3aW5kb3cuZW0uY2xlYXJNYXJrZXJzKCk7XHJcblx0d2luZG93LmVtLm1hcmtlcnNBcnJheS5wdXNoKG1hcmtlcik7XHJcblx0Z29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCBcImRyYWdlbmRcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XHJcblx0XHR3aW5kb3cuZW0uU2V0TG9jYXRpb25oT3J0RWRpdChldmVudC5sYXRMbmcsIG1hcCwgbWFya2VyKTtcclxuXHR9KTtcclxuXHR3aW5kb3cuZW0uU2V0TG9jYXRpb25oT3J0RWRpdChsb2NhdGlvbiwgbWFwLCBtYXJrZXIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLnBsYWNlTWFya2VyQmVvYkVkaXQgPSBmdW5jdGlvbihsb2NhdGlvbiwgbWFwLCBtYXJrZXIsIGltYWdlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIHp1ZXJzdCBiaXNoZXJpZ2VuIE1hcmtlciBsw7ZzY2hlblxyXG5cdC8vd2luZG93LmVtLmNsZWFyTWFya2VycygpO1xyXG5cdG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xyXG5cdFx0cG9zaXRpb246IGxvY2F0aW9uLCBcclxuXHRcdG1hcDogbWFwLFxyXG5cdFx0Ly8gdGl0bGUgbXVzcyBTdHJpbmcgc2VpblxyXG5cdFx0dGl0bGU6IGxvY2FsU3RvcmFnZS5hQXJ0TmFtZS50b1N0cmluZygpIHx8IFwiXCIsXHJcblx0XHQvL2ljb246IGltYWdlLFxyXG5cdFx0ZHJhZ2dhYmxlOiB0cnVlXHJcblx0fSk7XHJcblx0Ly8gTWFya2VyIGluIEFycmF5IHNwZWljaGVybiwgZGFtaXQgZXIgZ2Vsw7ZzY2h0IHdlcmRlbiBrYW5uXHJcblx0Ly8genVlcnN0IGJpc2hlcmlnZSBsw7ZzY2hlbiwgc29uc3QgZ2lidCBlcyBwcm8gS2xpY2sgZWluZW4gTWFya2VyLi4uXHJcblx0d2luZG93LmVtLmNsZWFyTWFya2VycygpO1xyXG5cdHdpbmRvdy5lbS5tYXJrZXJzQXJyYXkucHVzaChtYXJrZXIpO1xyXG5cdGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgXCJkcmFnZW5kXCIsIGZ1bmN0aW9uIChldmVudCkge1xyXG5cdFx0d2luZG93LmVtLlNldExvY2F0aW9uQmVvYkVkaXQoZXZlbnQubGF0TG5nLCBtYXAsIG1hcmtlcik7XHJcblx0fSk7XHJcblx0d2luZG93LmVtLlNldExvY2F0aW9uQmVvYkVkaXQobG9jYXRpb24sIG1hcCwgbWFya2VyKTtcclxufTtcclxuXHJcbi8vIEdvb2dsZU1hcDogYWxsZSBNYXJrZXIgbMO2c2NoZW5cclxuLy8gYmVudXR6dCB3byBpbiBHb29nbGVNYXBzIE1hcmtlciBnZXNldHp0IHVuZCB2ZXJzY2hvYmVuIHdlcmRlblxyXG53aW5kb3cuZW0uY2xlYXJNYXJrZXJzID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdF8uZWFjaCh3aW5kb3cuZW0ubWFya2Vyc0FycmF5LCBmdW5jdGlvbihtYXJrZXIpIHtcclxuXHRcdG1hcmtlci5zZXRNYXAobnVsbCk7XHJcblx0fSk7XHJcblx0d2luZG93LmVtLm1hcmtlcnNBcnJheSA9IFtdO1xyXG59O1xyXG5cclxuLy8gd2lyZCBiZW51dHp0IGluIGhPcnRFZGl0Lmh0bWxcclxud2luZG93LmVtLlNldExvY2F0aW9uaE9ydEVkaXQgPSBmdW5jdGlvbihMYXRMbmcsIG1hcCwgbWFya2VyKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBsYXQgPSBMYXRMbmcubGF0KCksXHJcblx0XHRsbmcgPSBMYXRMbmcubG5nKCksXHJcblx0XHRjb250ZW50U3RyaW5nLFxyXG5cdFx0aW5mb3dpbmRvdyxcclxuICAgICAgICBEZEluQ2hYID0gcmVxdWlyZSgnLi91dGlsL2RkSW5DaFgnKSxcclxuICAgICAgICBEZEluQ2hZID0gcmVxdWlyZSgnLi91dGlsL2RkSW5DaFknKTtcclxuXHRsb2NhbFN0b3JhZ2Uub0xhdGl0dWRlRGVjRGVnID0gbGF0O1xyXG5cdGxvY2FsU3RvcmFnZS5vTG9uZ2l0dWRlRGVjRGVnID0gbG5nO1xyXG5cdGxvY2FsU3RvcmFnZS5vWEtvb3JkID0gRGRJbkNoWChsYXQsIGxuZyk7XHJcblx0bG9jYWxTdG9yYWdlLm9ZS29vcmQgPSBEZEluQ2hZKGxhdCwgbG5nKTtcclxuXHRsb2NhbFN0b3JhZ2Uub0xhZ2VnZW5hdWlna2VpdCA9IFwiQXVmIEx1ZnRiaWxkIG1hcmtpZXJ0XCI7XHJcblx0d2luZG93LmVtLmNsZWFySW5mb1dpbmRvd3MoKTtcclxuXHRjb250ZW50U3RyaW5nID0gJzx0YWJsZSBjbGFzcz1cImthcnRlbmxlZ2VuZGVfdGFiZWxsZVwiPic7XHJcblx0Y29udGVudFN0cmluZyArPSAnPHRyPjx0ZD5Qcm9qZWt0OjwvdGQ+PHRkPicgKyB3aW5kb3cuZW0uaE9ydC5wTmFtZSArICc8L3RkPjwvdHI+JztcclxuXHRjb250ZW50U3RyaW5nICs9ICc8dHI+PHRkPlJhdW06PC90ZD48dGQ+JyArIHdpbmRvdy5lbS5oT3J0LnJOYW1lICsgJzwvdGQ+PC90cj4nO1xyXG5cdGNvbnRlbnRTdHJpbmcgKz0gJzx0cj48dGQ+T3J0OjwvdGQ+PHRkPicgKyB3aW5kb3cuZW0uaE9ydC5vTmFtZSArICc8L3RkPjwvdHI+JztcclxuXHRjb250ZW50U3RyaW5nICs9ICc8dHI+PHRkPktvb3JkaW5hdGVuOjwvdGQ+PHRkPicgKyBsb2NhbFN0b3JhZ2Uub1hLb29yZCArIFwiL1wiICsgbG9jYWxTdG9yYWdlLm9ZS29vcmQgKyAnPC90ZD48L3RyPic7XHJcblx0Y29udGVudFN0cmluZyArPSAnPC90YWJsZT4nO1xyXG5cdGluZm93aW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdyh7XHJcblx0XHRjb250ZW50OiBjb250ZW50U3RyaW5nXHJcblx0fSk7XHJcblx0d2luZG93LmVtLkluZm9XaW5kb3dBcnJheS5wdXNoKGluZm93aW5kb3cpO1xyXG5cdGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG5cdGluZm93aW5kb3cub3BlbihtYXAsbWFya2VyKTtcclxuXHR9KTtcclxuXHR3aW5kb3cuZW0uc3BlaWNoZXJlS29vcmRpbmF0ZW4obG9jYWxTdG9yYWdlLk9ydElkLCBcImhPcnRcIik7XHJcbn07XHJcblxyXG4vLyB3aXJkIGJlbnV0enQgaW4gQmVvYkVkaXQuaHRtbFxyXG53aW5kb3cuZW0uU2V0TG9jYXRpb25CZW9iRWRpdCA9IGZ1bmN0aW9uKExhdExuZywgbWFwLCBtYXJrZXIpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGxhdCA9IExhdExuZy5sYXQoKSxcclxuXHRcdGxuZyA9IExhdExuZy5sbmcoKSxcclxuXHRcdGNvbnRlbnRTdHJpbmcsXHJcblx0XHRpbmZvd2luZG93LFxyXG4gICAgICAgIERkSW5DaFggPSByZXF1aXJlKCcuL3V0aWwvZGRJbkNoWCcpLFxyXG4gICAgICAgIERkSW5DaFkgPSByZXF1aXJlKCcuL3V0aWwvZGRJbkNoWScpO1xyXG5cdGxvY2FsU3RvcmFnZS5vTGF0aXR1ZGVEZWNEZWcgPSBsYXQ7XHJcblx0bG9jYWxTdG9yYWdlLm9Mb25naXR1ZGVEZWNEZWcgPSBsbmc7XHJcblx0bG9jYWxTdG9yYWdlLm9YS29vcmQgPSBEZEluQ2hYKGxhdCwgbG5nKTtcclxuXHRsb2NhbFN0b3JhZ2Uub1lLb29yZCA9IERkSW5DaFkobGF0LCBsbmcpO1xyXG5cdGxvY2FsU3RvcmFnZS5vTGFnZWdlbmF1aWdrZWl0ID0gXCJBdWYgTHVmdGJpbGQgbWFya2llcnRcIjtcclxuXHR3aW5kb3cuZW0uY2xlYXJJbmZvV2luZG93cygpO1xyXG5cdGNvbnRlbnRTdHJpbmcgPSAnPGg0IGNsYXNzPVwibWFwX2luZm93aW5kb3dfdGl0bGVcIj4nICsgbG9jYWxTdG9yYWdlLmFBcnROYW1lICsgJzwvaDQ+JztcclxuXHRjb250ZW50U3RyaW5nICs9ICc8dGFibGUgY2xhc3M9XCJrYXJ0ZW5sZWdlbmRlX3RhYmVsbGVcIj4nO1xyXG5cdGNvbnRlbnRTdHJpbmcgKz0gJzx0cj48dGQ+QXJ0LUdydXBwZTo8L3RkPjx0ZD4nICsgbG9jYWxTdG9yYWdlLmFBcnRHcnVwcGUgKyAnPC90ZD48L3RyPic7XHJcblx0aWYgKHdpbmRvdy5lbS5CZW9iYWNodHVuZy5hQXV0b3IpIHtcclxuXHRcdGNvbnRlbnRTdHJpbmcgKz0gJzx0cj48dGQ+QXV0b3I6PC90ZD48dGQ+JyArIHdpbmRvdy5lbS5CZW9iYWNodHVuZy5hQXV0b3IgKyAnPC90ZD48L3RyPic7XHJcblx0fVxyXG5cdGlmICh3aW5kb3cuZW0uQmVvYmFjaHR1bmcuekRhdHVtKSB7XHJcblx0XHRjb250ZW50U3RyaW5nICs9ICc8dHI+PHRkPkRhdHVtOjwvdGQ+PHRkPicgKyB3aW5kb3cuZW0uQmVvYmFjaHR1bmcuekRhdHVtICsgJzwvdGQ+PC90cj4nO1xyXG5cdH1cclxuXHRpZiAod2luZG93LmVtLkJlb2JhY2h0dW5nLnpVaHJ6ZWl0KSB7XHJcblx0XHRjb250ZW50U3RyaW5nICs9ICc8dHI+PHRkPlplaXQ6PC90ZD48dGQ+JyArIHdpbmRvdy5lbS5CZW9iYWNodHVuZy56VWhyemVpdCArICc8L3RkPjwvdHI+JztcclxuXHR9XHJcblx0Y29udGVudFN0cmluZyArPSAnPHRyPjx0ZD5Lb29yZGluYXRlbjo8L3RkPjx0ZD4nICsgbG9jYWxTdG9yYWdlLm9YS29vcmQgKyBcIi9cIiArIGxvY2FsU3RvcmFnZS5vWUtvb3JkICsgJzwvdGQ+PC90cj4nO1xyXG5cdGNvbnRlbnRTdHJpbmcgKz0gJzwvdGFibGU+JztcclxuXHRpbmZvd2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coe1xyXG5cdFx0Y29udGVudDogY29udGVudFN0cmluZ1xyXG5cdH0pO1xyXG5cdHdpbmRvdy5lbS5JbmZvV2luZG93QXJyYXkucHVzaChpbmZvd2luZG93KTtcclxuXHRnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuXHRcdGluZm93aW5kb3cub3BlbihtYXAsbWFya2VyKTtcclxuXHR9KTtcclxuXHR3aW5kb3cuZW0uc3BlaWNoZXJlS29vcmRpbmF0ZW4obG9jYWxTdG9yYWdlLkJlb2JJZCwgXCJCZW9iYWNodHVuZ1wiKTtcclxufTtcclxuXHJcbi8vIEdvb2dsZU1hcDogYWxsZSBJbmZvV2luZG93cyBsw7ZzY2hlblxyXG4vLyBiZW51dHp0IHdvIGluIEdvb2dsZU1hcHMgSW5mb3dpbmRvd3MgbmV1IGdlc2V0enQgd2VyZGVuIG3DvHNzZW4sIHdlaWwgZGllIERhdGVuIHZlcsOkbmRlcnQgd3VyZGVuXHJcbndpbmRvdy5lbS5jbGVhckluZm9XaW5kb3dzID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdF8uZWFjaCh3aW5kb3cuZW0uSW5mb1dpbmRvd0FycmF5LCBmdW5jdGlvbihpbmZvd2luZG93KSB7XHJcblx0XHRpbmZvd2luZG93LnNldE1hcChudWxsKTtcclxuXHR9KTtcclxuXHR3aW5kb3cuZW0uSW5mb1dpbmRvd0FycmF5ID0gW107XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlU2lnbnVwUGFnZXNob3cgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gc2ljaGVyc3RlbGxlbiwgZGFzcyBuaWNodHMgdm9tIGxldHp0ZW4gVXNlciDDvGJyaWcgYmxlaWJ0XHJcblx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdC8vIERhdGVudmVyd2VuZHVuZyBtYW5hZ2VuOiBXZW5uIGRlciBVc2VyIG5pY2h0cyBhbmdpYnQsIGphQWJlciBzZXR6ZW5cclxuXHRsb2NhbFN0b3JhZ2UuRGF0ZW52ZXJ3ZW5kdW5nID0gXCJKYUFiZXJcIjtcclxuXHQvLyB3ZW5uIGRlciBCZW51dHplciB2b20gTG9naW4gaGVyIGtvbW10IHVuZCBiZXJlaXRzIEJlbnV0emVybmFtZSB1bmQgUGFzc3dvcnQgZXJmYXNzdCBoYXQ6IMO8YmVybmVobWVuXHJcblx0aWYgKHNlc3Npb25TdG9yYWdlLnByb3ZfZW1haWwpIHtcclxuXHRcdCQoXCIjc3VfRW1haWxcIikudmFsKHNlc3Npb25TdG9yYWdlLnByb3ZfZW1haWwpO1xyXG5cdFx0ZGVsZXRlIHNlc3Npb25TdG9yYWdlLnByb3ZfZW1haWw7XHJcblx0XHRpZiAoc2Vzc2lvblN0b3JhZ2UucHJvdl9wYXNzd29ydCkge1xyXG5cdFx0XHQkKFwiI3N1X1Bhc3N3b3J0XCIpLnZhbChzZXNzaW9uU3RvcmFnZS5wcm92X3Bhc3N3b3J0KTtcclxuXHRcdFx0ZGVsZXRlIHNlc3Npb25TdG9yYWdlLnByb3ZfcGFzc3dvcnQ7XHJcblx0XHRcdCQoXCIjc3VfUGFzc3dvcnQyXCIpLmZvY3VzKCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQkKFwiI3N1X1Bhc3N3b3J0XCIpLmZvY3VzKCk7XHJcblx0XHR9XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVNpZ251cFBhZ2Vpbml0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG4gICAgJChcIiNTaWdudXBGb3JtXCIpXHJcbiAgICAgICAgLm9uKFwiY2hhbmdlXCIsIFwiW25hbWU9J0RhdGVudmVyd2VuZHVuZyddXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLkRhdGVudmVyd2VuZHVuZyA9ICQodGhpcykuYXR0cihcImlkXCIpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHQkKFwiI1NpZ251cEZvb3RlclwiKVxyXG4gICAgICAgIC5vbihcImNsaWNrXCIsIFwiI1N1Ym1pdEJ1dHRvblwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZVNpZ251cFN1Ym1pdEJ1dHRvbkNsaWNrKCk7XHJcbiAgICAgICAgfSk7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlU2lnbnVwU3VibWl0QnV0dG9uQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKHdpbmRvdy5lbS52YWxpZGllcmVVc2VyU2lnbnVwKCkpIHtcclxuXHRcdHdpbmRvdy5lbS5lcnN0ZWxsZUtvbnRvKCk7XHJcblx0fVxyXG59O1xyXG5cclxuLy8ga29udHJvbGxpZXJyZW4sIG9iIGRpZSBlcmZvcmRlcmxpY2hlbiBGZWxkZXIgZXR3YXMgZW50aGFsdGVuXHJcbi8vIHdlbm4gamEgd2lyZCB0cnVlIHJldG91cm5pZXJ0LCBzb25zdCBmYWxzZVxyXG53aW5kb3cuZW0udmFsaWRpZXJlVXNlclNpZ251cCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgRW1haWwgPSAkKFwiI3N1X0VtYWlsXCIpLnZhbCgpLFxyXG5cdFx0UGFzc3dvcnQgPSAkKFwiI3N1X1Bhc3N3b3J0XCIpLnZhbCgpLFxyXG5cdFx0c3VfUGFzc3dvcnQyID0gJChcIiNzdV9QYXNzd29ydDJcIikudmFsKCksXHJcblx0XHRBdXRvciA9ICQoXCIjQXV0b3JcIikudmFsKCk7XHJcblx0aWYgKCFFbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLm1lbGRlKFwiQml0dGUgRW1haWwgZWluZ2ViZW5cIik7XHJcblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQkKFwiI3N1X0VtYWlsXCIpLmZvY3VzKCk7XHJcblx0XHR9LCA1MCk7ICAvLyBuZWVkIHRvIHVzZSBhIHRpbWVyIHNvIHRoYXQgLmJsdXIoKSBjYW4gZmluaXNoIGJlZm9yZSB5b3UgZG8gLmZvY3VzKClcclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9IGVsc2UgaWYgKCF3aW5kb3cuZW0udmFsaWRhdGVFbWFpbChFbWFpbCkpIHtcclxuXHRcdHdpbmRvdy5lbS5tZWxkZShcIkJpdHRlIGfDvGx0aWdlIEVtYWlsLUFkcmVzc2UgZWluZ2ViZW5cIik7XHJcblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQkKFwiI3N1X0VtYWlsXCIpLmZvY3VzKCk7XHJcblx0XHR9LCA1MCk7ICAvLyBuZWVkIHRvIHVzZSBhIHRpbWVyIHNvIHRoYXQgLmJsdXIoKSBjYW4gZmluaXNoIGJlZm9yZSB5b3UgZG8gLmZvY3VzKClcclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9IGVsc2UgaWYgKCFQYXNzd29ydCkge1xyXG5cdFx0d2luZG93LmVtLm1lbGRlKFwiQml0dGUgUGFzc3dvcnQgZWluZ2ViZW5cIik7XHJcblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQkKFwiI3N1X1Bhc3N3b3J0XCIpLmZvY3VzKCk7XHJcblx0XHR9LCA1MCk7ICAvLyBuZWVkIHRvIHVzZSBhIHRpbWVyIHNvIHRoYXQgLmJsdXIoKSBjYW4gZmluaXNoIGJlZm9yZSB5b3UgZG8gLmZvY3VzKClcclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9IGVsc2UgaWYgKCFzdV9QYXNzd29ydDIpIHtcclxuXHRcdHdpbmRvdy5lbS5tZWxkZShcIkJpdHRlIFBhc3N3b3J0IGJlc3TDpHRpZ2VuXCIpO1xyXG5cdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdFx0JChcIiNzdV9QYXNzd29ydDJcIikuZm9jdXMoKTtcclxuXHRcdH0sIDUwKTsgIC8vIG5lZWQgdG8gdXNlIGEgdGltZXIgc28gdGhhdCAuYmx1cigpIGNhbiBmaW5pc2ggYmVmb3JlIHlvdSBkbyAuZm9jdXMoKVxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH0gZWxzZSBpZiAoUGFzc3dvcnQgIT09IHN1X1Bhc3N3b3J0Mikge1xyXG5cdFx0d2luZG93LmVtLm1lbGRlKFwiUGFzc3dvcnQgaXN0IGZhbHNjaCBiZXN0w6R0aWd0XCIpO1xyXG5cdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuXHRcdFx0JChcIiNzdV9QYXNzd29ydDJcIikuZm9jdXMoKTtcclxuXHRcdH0sIDUwKTsgIC8vIG5lZWQgdG8gdXNlIGEgdGltZXIgc28gdGhhdCAuYmx1cigpIGNhbiBmaW5pc2ggYmVmb3JlIHlvdSBkbyAuZm9jdXMoKVxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH0gZWxzZSBpZiAoIUF1dG9yKSB7XHJcblx0XHR3aW5kb3cuZW0ubWVsZGUoXCJCaXR0ZSBBdXRvciBlaW5nZWJlblwiKTtcclxuXHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblx0XHRcdCQoXCIjQXV0b3JcIikuZm9jdXMoKTtcclxuXHRcdH0sIDUwKTsgIC8vIG5lZWQgdG8gdXNlIGEgdGltZXIgc28gdGhhdCAuYmx1cigpIGNhbiBmaW5pc2ggYmVmb3JlIHlvdSBkbyAuZm9jdXMoKVxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH1cclxuXHRyZXR1cm4gdHJ1ZTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5lcnN0ZWxsZUtvbnRvID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIFVzZXIgaW4gX3VzZXIgZWludHJhZ2VuXHJcblx0JC5jb3VjaC5zaWdudXAoe1xyXG5cdFx0XHRuYW1lOiAkKCcjc3VfRW1haWwnKS52YWwoKSxcclxuXHRcdFx0RGF0ZW52ZXJ3ZW5kdW5nOiBsb2NhbFN0b3JhZ2UuRGF0ZW52ZXJ3ZW5kdW5nIHx8IFwiSmFBYmVyXCJcclxuXHRcdH0sICQoJyNzdV9QYXNzd29ydCcpLnZhbCgpLCB7XHJcblx0XHRzdWNjZXNzIDogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRsb2NhbFN0b3JhZ2UuRW1haWwgPSAkKCcjc3VfRW1haWwnKS52YWwoKTtcclxuXHRcdFx0bG9jYWxTdG9yYWdlLkF1dG9yID0gJChcIiNBdXRvclwiKS52YWwoKTtcclxuXHRcdFx0d2luZG93LmVtLnNwZWljaGVyZUF1dG9yQWxzU3RhbmRhcmR3ZXJ0KCk7XHJcblx0XHR9LFxyXG5cdFx0ZXJyb3IgOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkZlaGxlcjogRGFzIEtvbnRvIHd1cmRlIG5pY2h0IGVyc3RlbGx0XCIpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZVVzZXJFZGl0UGFnZXNob3cgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdH1cclxuXHR3aW5kb3cuZW0uaW5pdGlpZXJlVXNlckVkaXQoKTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVVc2VyRWRpdFBhZ2Vpbml0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIFdpcmQgZGllc2UgU2VpdGUgZGlyZWt0IGF1ZmdlcnVmZW4gdW5kIGVzIGdpYnQga2VpbmVuIGxvY2FsU3RvcmFnZSxcclxuXHQvLyBtdXNzIGF1ZiBpbmRleC5odG1sIHVtZ2VsZWl0ZXQgd2VyZGVuXHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdH1cclxuXHJcblx0JChcIiNVc2VyRWRpdEhlYWRlclwiKVxyXG4gICAgICAgIC8vIHp1csO8Y2stQnV0dG9uIHN0ZXVlcm5cclxuICAgICAgICAub24oJ2NsaWNrJywgJyN6dXLDvGNrVXNlckVkaXQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZVVzZXJFZGl0WnVyw7xja0NsaWNrKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgJChcIiNVc2VyRWRpdEZvcm1cIilcclxuICAgICAgICAvLyBqZWRlcyBGZWxkIGJlaSDDhG5kZXJ1bmcgc3BlaWNoZXJuXHJcbiAgICAgICAgLm9uKFwiY2hhbmdlXCIsIFwiLkZlbGRcIiwgd2luZG93LmVtLmhhbmRsZVVzZXJFZGl0RmVsZENoYW5nZSlcclxuICAgICAgICAub24oXCJjaGFuZ2VcIiwgXCJbbmFtZT0nRGF0ZW52ZXJ3ZW5kdW5nJ11cIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UuRGF0ZW52ZXJ3ZW5kdW5nID0gJCh0aGlzKS5hdHRyKFwiaWRcIik7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAvLyBBdXRvciBiZWkgw4RuZGVydW5nIHNwZWljaGVyblxyXG4gICAgICAgIC5vbihcImNoYW5nZVwiLCBcIiNBdXRvclwiLCB3aW5kb3cuZW0uaGFuZGxlVXNlckVkaXRBdXRvckNoYW5nZSk7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlVXNlckVkaXRadXLDvGNrQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gc2ljaGVyc3RlbGxlbiwgZGFzcyBlciBpbW1lciBlaW4genVyw7xjayBrZW5udFxyXG5cdGlmICghbG9jYWxTdG9yYWdlLnp1cnVlY2spIHtcclxuXHRcdGxvY2FsU3RvcmFnZS56dXJ1ZWNrID0gXCJCZW9iTGlzdGUuaHRtbFwiO1xyXG5cdH1cclxuICAgIGlmIChsb2NhbFN0b3JhZ2UuaEFydFNpY2h0ID09PSBcImxpc3RlXCIgJiYgbG9jYWxTdG9yYWdlLnp1cnVlY2sgPT09IFwiaEFydEVkaXQuaHRtbFwiKSB7XHJcbiAgICAgICAgJC5tb2JpbGUubmF2aWdhdGUoXCJoQXJ0RWRpdExpc3RlLmh0bWxcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgICQubW9iaWxlLm5hdmlnYXRlKGxvY2FsU3RvcmFnZS56dXJ1ZWNrKTtcclxuICAgIH1cclxuXHRkZWxldGUgbG9jYWxTdG9yYWdlLnp1cnVlY2s7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlVXNlckVkaXRGZWxkQ2hhbmdlID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBGZWxkbmFtZSA9IHRoaXMubmFtZSxcclxuXHRcdC8vIG7DtnRpZywgZGFtaXQgQXJyYXlzIHJpY2h0aWcga29tbWVuXHJcblx0XHRGZWxkanNvbiA9ICQoXCJbbmFtZT0nXCIgKyBGZWxkbmFtZSArIFwiJ11cIikuc2VyaWFsaXplT2JqZWN0KCksXHJcblx0XHRGZWxkd2VydCA9IEZlbGRqc29uW0ZlbGRuYW1lXTtcclxuXHRpZiAod2luZG93LmVtLnZhbGlkaWVyZVVzZXJVc2VyRWRpdCgpKSB7XHJcblx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlVXNlcihGZWxkbmFtZSwgRmVsZHdlcnQpO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVVc2VyRWRpdEF1dG9yQ2hhbmdlID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG4gICAgdmFyICRBdXRvciA9ICQoXCIjQXV0b3JcIiksXHJcbiAgICAgICAgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0JGRiLm9wZW5Eb2MoXCJmMTljZDQ5YmQ3YjdhMTUwYzg5NTA0MWE1ZDAyYWNiMFwiLCB7XHJcblx0XHRzdWNjZXNzOiBmdW5jdGlvbiAoZG9jKSB7XHJcblx0XHRcdGlmICgkQXV0b3IudmFsKCkpIHtcclxuXHRcdFx0XHQvLyBXZW5uIEF1dG9yIGVyZmFzc3QgaXN0LCBzcGVpY2hlcm5cclxuXHRcdFx0XHQvLyBGYWxscyBTdGFuZGFyZHdlcnQgbm9jaCBuaWNodCBleGlzdGllcnQsIFxyXG5cdFx0XHRcdC8vIHVzcyB6dWVyc3QgZGFzIE9iamVrdCBnZXNjaGFmZmVuIHdlcmRlblxyXG5cdFx0XHRcdGlmICghZG9jLlN0YW5kYXJkd2VydCkge1xyXG5cdFx0XHRcdFx0ZG9jLlN0YW5kYXJkd2VydCA9IHt9O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRkb2MuU3RhbmRhcmR3ZXJ0W2xvY2FsU3RvcmFnZS5FbWFpbF0gPSAkQXV0b3IudmFsKCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly8gV2VubiBrZWluIEF1dG9yIGVyZmFzc3QgaXN0LCBlaW5lbiBhbGxmw6RsbGlnZW4gbMO2c2NoZW5cclxuXHRcdFx0XHRpZiAoZG9jLlN0YW5kYXJkd2VydCkge1xyXG5cdFx0XHRcdFx0ZGVsZXRlIGRvYy5TdGFuZGFyZHdlcnRbbG9jYWxTdG9yYWdlLkVtYWlsXTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0JGRiLnNhdmVEb2MoZG9jLCB7XHJcblx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdFx0Ly8gRmVsZGxpc3RlIHNvbGwgbmV1IGF1ZmdlYmF1dCB3ZXJkZW5cclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VGZWxkTGlzdGUoKTtcclxuXHRcdFx0XHRcdGxvY2FsU3RvcmFnZS5BdXRvciA9ICRBdXRvci52YWwoKTtcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdGVycm9yOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJGZWhsZXI6IMOEbmRlcnVuZyBhbSBBdXRvciBuaWNodCBnZXNwZWljaGVydFwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSxcclxuXHRcdGVycm9yOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkZlaGxlcjogw4RuZGVydW5nIGFtIEF1dG9yIG5pY2h0IGdlc3BlaWNoZXJ0XCIpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxuLy8ga29udHJvbGxpZXJyZW4sIG9iIGRpZSBlcmZvcmRlcmxpY2hlbiBGZWxkZXIgZXR3YXMgZW50aGFsdGVuXHJcbi8vIHdlbm4gamEgd2lyZCB0cnVlIHJldG91cm5pZXJ0LCBzb25zdCBmYWxzZVxyXG53aW5kb3cuZW0udmFsaWRpZXJlVXNlclVzZXJFZGl0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG4gICAgdmFyICRBdXRvciA9ICQoXCIjQXV0b3JcIik7XHJcblx0aWYgKCEkQXV0b3IudmFsKCkpIHtcclxuXHRcdHdpbmRvdy5lbS5tZWxkZShcIkJpdHRlIEF1dG9yIGVpbmdlYmVuXCIpO1xyXG5cdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJEF1dG9yLmZvY3VzKCk7XHJcblx0XHR9LCA1MCk7ICAvLyBuZWVkIHRvIHVzZSBhIHRpbWVyIHNvIHRoYXQgLmJsdXIoKSBjYW4gZmluaXNoIGJlZm9yZSB5b3UgZG8gLmZvY3VzKClcclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9XHJcblx0cmV0dXJuIHRydWU7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uc3BlaWNoZXJlVXNlciA9IGZ1bmN0aW9uKEZlbGRuYW1lLCBGZWxkd2VydCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAobG9jYWxTdG9yYWdlLkRhdGVudmVyd2VuZHVuZykge1xyXG5cdFx0JC5jb3VjaC51c2VyRGIoZnVuY3Rpb24oZGIpIHtcclxuXHRcdFx0ZGIub3BlbkRvYyhcIm9yZy5jb3VjaGRiLnVzZXI6XCIgKyBsb2NhbFN0b3JhZ2UuRW1haWwsIHtcclxuXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiAoZG9jKSB7XHJcblx0XHRcdFx0XHRcdGlmIChGZWxkd2VydCkge1xyXG5cdFx0XHRcdFx0XHRcdGRvY1tGZWxkbmFtZV0gPSBGZWxkd2VydDtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIGlmIChkb2NbRmVsZG5hbWVdKSB7XHJcblx0XHRcdFx0XHRcdFx0ZGVsZXRlIGRvY1tGZWxkbmFtZV07XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGRiLnNhdmVEb2MoZG9jLCB7XHJcblx0XHRcdFx0XHRcdGVycm9yOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlciBpbiBmdW5jdGlvbiB3aW5kb3cuZW0uc3BlaWNoZXJlVXNlcjogRGF0ZW52ZXJ3ZW5kdW5nIG5pY2h0IGdlc3BlaWNoZXJ0XCIpOycpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdGVycm9yOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyIGluIGZ1bmN0aW9uIHdpbmRvdy5lbS5zcGVpY2hlcmVVc2VyOiBEYXRlbnZlcndlbmR1bmcgbmljaHQgZ2VzcGVpY2hlcnRcIik7Jyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBlcyBnaWJ0IG5vY2gga2VpbmUgVXNlci1Eb2NcclxuXHRcdC8vIHZpZWxsZWljaHQgaGF0dGUgZGVyIFVzZXIgZWluIEtvbnRvIGJlaSBBcnRlbkRiIGVyc3RlbGx0IHVuZCBpc3QgZGFzIGVyc3RlIG1hbCBpbiBFdmFiXHJcblx0XHRjb25zb2xlLmxvZyhcIkZlaGxlcjogRGF0ZW52ZXJ3ZW5kdW5nIG5pY2h0IGdlc3BlaWNoZXJ0XCIpO1xyXG5cdH1cclxufTtcclxuXHJcbi8vIHdpcmQgaW4gaEFydEVkaXQuaHRtbCB2ZXJ3ZW5kZXRcclxud2luZG93LmVtLnp1QXJ0Z3J1cHBlbmxpc3RlID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIEdsb2JhbGUgVmFyaWFibGVuIGbDvHIgaEFydExpc3RlIHp1csO8Y2tzZXR6ZW4sIGRhbWl0IGRpZSBMaXN0ZSBiZWltIG7DpGNoc3RlbiBBdWZydWYgbmV1IGF1ZmdlYmF1dCB3aXJkXHJcblx0Ly93aW5kb3cuZW0ubGVlcmVTdG9yYWdlaEFydExpc3RlKCk7XHJcblx0bG9jYWxTdG9yYWdlLlZvbiA9IFwiaEFydEVkaXRcIjtcclxuXHRpZiAod2luZG93LmVtLmdydXBwZV9tZXJrZW4pIHtcclxuXHRcdC8vIEFydGdydXBwZW5saXN0ZSBhdXNsYXNzZW5cclxuXHRcdC8vIGxvY2FsU3RvcmFnZS5hQXJ0R3J1cHBlIGlzdCBzY2hvbiBnZXNldHp0XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkFydGVubGlzdGUuaHRtbFwiKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJBcnRncnVwcGVubGlzdGUuaHRtbFwiKTtcclxuXHR9XHJcbn07XHJcblxyXG4vLyB3aXJkIGluIGhBcnRFZGl0Lmh0bWwgdmVyd2VuZGV0XHJcbndpbmRvdy5lbS56dUFydGxpc3RlID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGxvY2FsU3RvcmFnZS5Wb24gPSBcImhBcnRFZGl0XCI7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJBcnRlbmxpc3RlLmh0bWxcIik7XHJcbn07XHJcblxyXG4vLyBTcGVpY2hlcnQgYWxsZSBEYXRlblxyXG4vLyB3aXJkIGluIGhBcnRFZGl0Lmh0bWwgdmVyd2VuZGV0XHJcbndpbmRvdy5lbS5zcGVpY2hlcmVIQXJ0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciB0aGF0ID0gdGhpcyxcclxuXHRcdGhhcnRpZDtcclxuXHQvLyBBY2h0dW5nOiBpbiBoQXJ0RWRpdExpc3RlIGthbm4gZXMgc2VpbiwgZGFzcyB3aW5kb3cuZW0uaEFydCBlcnN0IGdlcmFkZSBha3R1YWxpc2llcnQgd2lyZCB1bmQgbW9tZW50YW4gbmljaHQgYWt0dWVsbCBpc3QhXHJcblx0Ly8gTMO2c3VuZzogaGFydGlkIGF1cyBow7ZoZXIgbGllZ2VuZGVyIHRyIGhvbGVuIHVuZCB2ZXJnbGVpY2hlbiwgb2Igd2luZG93LmVtLmhBcnQgZGllc2VsYmUgaWQgaGF0XHJcblx0aWYgKCQoXCJib2R5XCIpLnBhZ2Vjb250YWluZXIoXCJnZXRBY3RpdmVQYWdlXCIpLmF0dHIoXCJpZFwiKSA9PT0gXCJoQXJ0RWRpdExpc3RlXCIpIHtcclxuXHRcdGhhcnRpZCA9ICQodGhhdCkuY2xvc2VzdCgndHInKS5hdHRyKFwiaGFydGlkXCIpO1xyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5oQXJ0SWQgPSBoYXJ0aWQ7XHJcblx0fVxyXG5cdC8vIHByw7xmZW4sIG9iIGhBcnQgYWxzIE9iamVrdCB2b3JsaWVndFxyXG5cdGlmICgod2luZG93LmVtLmhBcnQgJiYgIWhhcnRpZCkgfHwgKHdpbmRvdy5lbS5oQXJ0ICYmIGhhcnRpZCA9PT0gd2luZG93LmVtLmhBcnQuX2lkKSkge1xyXG5cdFx0Ly8gZGllc2VzIHZlcndlbmRlblxyXG5cdFx0d2luZG93LmVtLnNwZWljaGVyZUhBcnRfMih0aGF0KTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gT2JqZWt0IGF1ZCBEQiBob2xlblxyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLm9wZW5Eb2MobG9jYWxTdG9yYWdlLmhBcnRJZCwge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLmhBcnQgPSBkYXRhO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5zcGVpY2hlcmVIQXJ0XzIodGhhdCk7XHJcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UuYUFydElkID0gd2luZG93LmVtLmhBcnQuYUFydElkO1xyXG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLmFBcnROYW1lID0gd2luZG93LmVtLmhBcnQuYUFydE5hbWU7XHJcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UuYUFydEdydXBwZSA9IHdpbmRvdy5lbS5oQXJ0LmFBcnRHcnVwcGU7XHJcblx0XHRcdH0sXHJcblx0XHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZygnRmVobGVyIGluIGZ1bmN0aW9uIHNwZWljaGVyZUhBcnQnKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLnNwZWljaGVyZUhBcnRfMiA9IGZ1bmN0aW9uKHRoYXQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIEZlbGRuYW1lRGIsXHJcblx0XHRGZWxkd2VydCxcclxuICAgICAgICBmZWxkaW5mb3M7XHJcblx0Ly8gRmVsZG5hbWUgdW5kIC13ZXJ0IGVybWl0dGVsblxyXG5cdGZlbGRpbmZvcyA9IHdpbmRvdy5lbS5ob2xlRmVsZEluZm9zVm9uRWxlbWVudCh0aGF0KTtcclxuICAgIEZlbGRuYW1lRGIgPSBmZWxkaW5mb3MuZmVsZG5hbWVfZGI7XHJcbiAgICBGZWxkd2VydCA9IGZlbGRpbmZvcy5mZWxkd2VydDtcclxuXHQvLyB3aW5kb3cuZW0uaEFydCBha3R1YWxpc2llcmVuXHJcblx0aWYgKEZlbGR3ZXJ0KSB7XHJcblx0XHRpZiAod2luZG93LmVtLm15VHlwZU9mKEZlbGR3ZXJ0KSA9PT0gXCJmbG9hdFwiKSB7XHJcblx0XHRcdHdpbmRvdy5lbS5oQXJ0W0ZlbGRuYW1lRGJdID0gcGFyc2VGbG9hdChGZWxkd2VydCk7XHJcblx0XHR9IGVsc2UgaWYgKHdpbmRvdy5lbS5teVR5cGVPZihGZWxkd2VydCkgPT09IFwiaW50ZWdlclwiKSB7XHJcblx0XHRcdHdpbmRvdy5lbS5oQXJ0W0ZlbGRuYW1lRGJdID0gcGFyc2VJbnQoRmVsZHdlcnQpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0d2luZG93LmVtLmhBcnRbRmVsZG5hbWVEYl0gPSBGZWxkd2VydDtcclxuXHRcdH1cclxuXHR9IGVsc2UgaWYgKHdpbmRvdy5lbS5oQXJ0W0ZlbGRuYW1lRGJdKSB7XHJcblx0XHRkZWxldGUgd2luZG93LmVtLmhBcnRbRmVsZG5hbWVEYl07XHJcblx0fVxyXG5cdC8vIFdlcnRlIGFrdHVhbGlzaWVyZW4sIGRpZSBuaWNodCBkdXJjaCAuc3BlaWNoZXJuIGVyZmFzc3Qgd2VyZGVuXHJcblx0d2luZG93LmVtLmhBcnQuYUFydElkID0gbG9jYWxTdG9yYWdlLmFBcnRJZDtcclxuXHR3aW5kb3cuZW0uaEFydC5hQXJ0TmFtZSA9IGxvY2FsU3RvcmFnZS5hQXJ0TmFtZTtcclxuXHR3aW5kb3cuZW0uaEFydC5hQXJ0R3J1cHBlID0gbG9jYWxTdG9yYWdlLmFBcnRHcnVwcGU7XHJcblx0Ly8gRGF0ZW5iYW5rIGFrdHVhbGlzaWVyZW5cclxuICAgIHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHQkZGIuc2F2ZURvYyh3aW5kb3cuZW0uaEFydCwge1xyXG5cdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHR3aW5kb3cuZW0uaEFydC5fcmV2ID0gZGF0YS5yZXY7XHJcblx0XHRcdGxvY2FsU3RvcmFnZS5oQXJ0SWQgPSBkYXRhLmlkO1xyXG5cdFx0fSxcclxuXHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlciBpbiBmdW5jdGlvbiBzcGVpY2hlcmVIQXJ0XzInKTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5ob2xlRmVsZEluZm9zVm9uRWxlbWVudCA9IGZ1bmN0aW9uKHRoYXQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcbiAgICB2YXIgZmVsZGluZm9zID0ge30sXHJcbiAgICAgICAgZmVsZGpzb247XHJcbiAgICAvLyBGZWxkbmFtZSB1bmQgLXdlcnQgZXJtaXR0ZWxuXHJcbiAgICBpZiAod2luZG93LmVtLm15VHlwZU9mKCQodGhhdCkuYXR0cihcImFyaWEtdmFsdWVub3dcIikpICE9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgLy8gc2xpZGVyXHJcbiAgICAgICAgZmVsZGluZm9zLmZlbGRuYW1lX2RvbSA9IGZlbGRpbmZvcy5mZWxkbmFtZV9kYiA9ICQodGhhdCkuYXR0cihcImFyaWEtbGFiZWxsZWRieVwiKS5zbGljZSgwLCAoJCh0aGF0KS5hdHRyKFwiYXJpYS1sYWJlbGxlZGJ5XCIpLmxlbmd0aCAtNikpO1xyXG4gICAgICAgIGZlbGRpbmZvcy5mZWxkd2VydCA9ICQodGhhdCkuYXR0cihcImFyaWEtdmFsdWVub3dcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIGFsbGUgYW5kZXJlbiBGZWxkdHlwZW5cclxuICAgICAgICBpZiAodGhhdC50eXBlID09PSBcInJhZGlvXCIpIHtcclxuICAgICAgICAgICAgLy8gaW4gaEFydEVkaXRMaXN0ZSB6ZWlnZW4gcmFkaW9zIGlocmUgV2VydGUgbnVyIGFuLCB3ZW5uIGRpZSByYWRpb3MgZGVzc2VsYmVuIEZlbGRzIHVudGVyc2NoaWVkbGljaGUgTmFtZW4gaGFiZW5cclxuICAgICAgICAgICAgLy8gZGFydW0gd2lyZCBfIHVuZCBlaW5lIGlkIGhpbnRhbmdlc3RlbGx0XHJcbiAgICAgICAgICAgIGZlbGRpbmZvcy5mZWxkbmFtZV9kb20gPSB0aGF0Lm5hbWU7XHJcbiAgICAgICAgICAgIGZlbGRpbmZvcy5mZWxkbmFtZV9kYiA9IHRoYXQubmFtZS5zdWJzdHJpbmcoMCwgdGhhdC5uYW1lLmxhc3RJbmRleE9mKFwiX1wiKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZmVsZGluZm9zLmZlbGRuYW1lX2RiID0gZmVsZGluZm9zLmZlbGRuYW1lX2RvbSA9IHRoYXQubmFtZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gbsO2dGlnLCBkYW1pdCBBcnJheXMgcmljaHRpZyBrb21tZW5cclxuICAgICAgICAvL2lmICgkKFwiYm9keVwiKS5wYWdlY29udGFpbmVyKFwiZ2V0QWN0aXZlUGFnZVwiKS5hdHRyKFwiaWRcIikgPT09IFwiaEFydEVkaXRMaXN0ZVwiKSB7IC8vIEZ1bmt0aW9uaWVydCBuaWNodCwgd2VpbCB6LkIuIGVpbiBzZWxlY3QgZWluIGVpZ2VuZXMgRmVuc3RlciDDtmZmbmV0IVxyXG4gICAgICAgIGlmIChsb2NhbFN0b3JhZ2UuaEFydElkICYmIGxvY2FsU3RvcmFnZS5oQXJ0U2ljaHQgPT09IFwibGlzdGVcIikge1xyXG4gICAgICAgICAgICAvLyBoaWVyIGdpYnQgZXMgcHJvIFRhYmVsbGVuemVpbGUgZWluIEZlbGQgbWl0IGRpZXNlbSBOYW1lbiFcclxuICAgICAgICAgICAgaWYgKFtcImNoZWNrYm94XCJdLmluZGV4T2YodGhhdC50eXBlKSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBmZWxkanNvbiA9ICQodGhhdCkucGFyZW50cyhcImZpZWxkc2V0XCIpLnNlcmlhbGl6ZU9iamVjdCgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZmVsZGpzb24gPSAkKHRoYXQpLnNlcmlhbGl6ZU9iamVjdCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZmVsZGpzb24gPSAkKFwiW25hbWU9J1wiICsgZmVsZGluZm9zLmZlbGRuYW1lX2RvbSArIFwiJ11cIikuc2VyaWFsaXplT2JqZWN0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZlbGRpbmZvcy5mZWxkd2VydCA9IGZlbGRqc29uW2ZlbGRpbmZvcy5mZWxkbmFtZV9kb21dO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZlbGRpbmZvcztcclxufTtcclxuXHJcbi8vIMOWZmZuZXQgZGllIHZvcmlnZSBvZGVyIG7DpGNoc3RlIEFydFxyXG4vLyB2b3JpZ2UgZGVyIGVyc3RlbiA9PiBBcnRMaXN0ZVxyXG4vLyBuw6RjaHN0ZSBkZXIgbGV0enRlbiA9PiBtZWxkZW5cclxuLy8gZXJ3YXJ0ZXQgZGllIElEIGRlcyBha3R1ZWxsZW4gRGF0ZW5zYXR6ZXMgdW5kIG9iIG7DpGNoc3RlciBvZGVyIHZvcmlnZXIgZ2VzdWNodCB3aXJkXHJcbi8vIHdpcmQgaW4gaEFydEVkaXQuaHRtbCB2ZXJ3ZW5kZXRcclxud2luZG93LmVtLm7DpGNoc3RlVm9yaWdlQXJ0ID0gZnVuY3Rpb24oTsOkY2hzdGVPZGVyVm9yaWdlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIHByw7xmZW4sIG9iIGhBcnRMaXN0ZSBzY2hvbiBleGlzdGllcnRcclxuXHQvLyBudXIgYWJmcmFnZW4sIHdlbm4gc2llIG5vY2ggbmljaHQgZXhpc3RpZXJ0XHJcblx0aWYgKHdpbmRvdy5lbS5oQXJ0TGlzdGUpIHtcclxuXHRcdC8vIGhBcnRMaXN0ZSBsaWVndCBhbHMgVmFyaWFibGUgdm9yXHJcblx0XHR3aW5kb3cuZW0ubsOkY2hzdGVWb3JpZ2VBcnRfMihOw6RjaHN0ZU9kZXJWb3JpZ2UpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBrZWluZSBPcnRsaXN0ZSB2b3JoYW5kZW4sIG5ldSBhdXMgREIgZXJzdGVsbGVuXHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIudmlldygnZXZhYi9oQXJ0TGlzdGU/c3RhcnRrZXk9W1wiJyArIGxvY2FsU3RvcmFnZS5FbWFpbCArICdcIiwgXCInICsgbG9jYWxTdG9yYWdlLlplaXRJZCArICdcIl0mZW5ka2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCIsIFwiJyArIGxvY2FsU3RvcmFnZS5aZWl0SWQgKyAnXCIgLHt9XSZpbmNsdWRlX2RvY3M9dHJ1ZScsIHtcclxuXHRcdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdC8vIExpc3RlIGJlcmVpdHN0ZWxsZW4sIHVtIERhdGVuYmFua3p1Z3JpZmZlIHp1IHJlZHV6aWVyZW5cclxuXHRcdFx0XHR3aW5kb3cuZW0uaEFydExpc3RlID0gZGF0YTtcclxuXHRcdFx0XHR3aW5kb3cuZW0ubsOkY2hzdGVWb3JpZ2VBcnRfMihOw6RjaHN0ZU9kZXJWb3JpZ2UpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0ubsOkY2hzdGVWb3JpZ2VBcnRfMiA9IGZ1bmN0aW9uKE7DpGNoc3RlT2RlclZvcmlnZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgaSxcclxuXHRcdEFydElkQWt0dWVsbCxcclxuXHRcdEFuekFydDtcclxuXHRmb3IgKGk9MDsgd2luZG93LmVtLmhBcnRMaXN0ZS5yb3dzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRBcnRJZEFrdHVlbGwgPSB3aW5kb3cuZW0uaEFydExpc3RlLnJvd3NbaV0uZG9jLl9pZDtcclxuXHRcdEFuekFydCA9IHdpbmRvdy5lbS5oQXJ0TGlzdGUucm93cy5sZW5ndGggLTE7ICAvLyB2b3JzaWNodDogT2JqZWt0ZSB6w6RobGVuIEVsZW1lbnRlIGFiIDEsIEFycmF5cyBhYiAwIVxyXG5cdFx0aWYgKEFydElkQWt0dWVsbCA9PT0gbG9jYWxTdG9yYWdlLmhBcnRJZCkge1xyXG5cdFx0XHRzd2l0Y2ggKE7DpGNoc3RlT2RlclZvcmlnZSkge1xyXG5cdFx0XHRjYXNlIFwibsOkY2hzdGVcIjpcclxuXHRcdFx0XHRpZiAoaSA8IEFuekFydCkge1xyXG5cdFx0XHRcdFx0bG9jYWxTdG9yYWdlLmhBcnRJZCA9IHdpbmRvdy5lbS5oQXJ0TGlzdGUucm93c1tpKzFdLmRvYy5faWQ7XHJcblx0XHRcdFx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlaEFydEVkaXQoXCJvaG5lSWRcIik7XHJcblx0XHRcdFx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlaEFydEVkaXQoKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRGFzIGlzdCBkaWUgbGV0enRlIEFydFwiKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgXCJ2b3JpZ2VcIjpcclxuXHRcdFx0XHRpZiAoaSA+IDApIHtcclxuXHRcdFx0XHRcdGxvY2FsU3RvcmFnZS5oQXJ0SWQgPSB3aW5kb3cuZW0uaEFydExpc3RlLnJvd3NbaS0xXS5kb2MuX2lkO1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLmxlZXJlU3RvcmFnZWhBcnRFZGl0KFwib2huZUlkXCIpO1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLmluaXRpaWVyZWhBcnRFZGl0KCk7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VoQXJ0RWRpdCgpO1xyXG5cdFx0XHRcdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJoQXJ0TGlzdGUuaHRtbFwiKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG4vLyB3aXJkIGluIGhBcnRFZGl0Lmh0bWwgYmVudXR6dFxyXG4vLyBsw7ZzY2h0IGVpbmUgQmVvYmFjaHR1bmdcclxud2luZG93LmVtLmzDtnNjaGVIQXJ0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICh3aW5kb3cuZW0uaEFydCkge1xyXG5cdFx0Ly8gdm9yaGFuZGVuZXMgT2JqZWt0IG51dHplblxyXG5cdFx0d2luZG93LmVtLmzDtnNjaGVIQXJ0XzIoKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gT2JqZWt0IGF1cyBEQiBob2xlblxyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLm9wZW5Eb2MobG9jYWxTdG9yYWdlLmhBcnRJZCwge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLmhBcnQgPSBkYXRhO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5sw7ZzY2hlSEFydF8yKCk7XHJcblx0XHRcdH0sXHJcblx0XHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJGZWhsZXI6IEFydCBuaWNodCBnZWzDtnNjaHRcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5sw7ZzY2hlSEFydF8yID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHQkZGIucmVtb3ZlRG9jKHdpbmRvdy5lbS5oQXJ0LCB7XHJcblx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdC8vIExpc3RlIGFucGFzc2VuLiBWb3JzaWNodDogQmVpIHJlZnJlc2gga2FubiBzaWUgZmVobGVuXHJcblx0XHRcdGlmICh3aW5kb3cuZW0uaEFydExpc3RlKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLmhBcnRMaXN0ZS5yb3dzID0gXy5yZWplY3Qod2luZG93LmVtLmhBcnRMaXN0ZS5yb3dzLCBmdW5jdGlvbihyb3cpIHtcclxuXHRcdFx0XHRcdHJldHVybiByb3cuZG9jLl9pZCA9PT0gZGF0YS5pZDtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvLyBLZWluZSBCZW9ibGlzdGUgbWVoci4gU3RvcmFnZSBsw7ZzY2hlblxyXG5cdFx0XHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VoQXJ0TGlzdGUoKTtcclxuXHRcdFx0fVxyXG5cdFx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlaEFydEVkaXQoKTtcclxuXHRcdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJoQXJ0TGlzdGUuaHRtbFwiKTtcclxuXHRcdH0sXHJcblx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkZlaGxlcjogQXJ0IG5pY2h0IGdlbMO2c2NodFwiKTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbi8vIHByw7xmdCBuZXVlIG9kZXIgdW1iZW5hbm50ZSBGZWxkbmFtZW5cclxuLy8gcHLDvGZ0LCBvYiBkZXIgbmV1ZSBGZWxkbmFtZSBzY2hvbiBleGlzdGllcnRcclxuLy8gd2VubiBqYTogbWVsZGVuLCB6dXLDvGNrc3RlbGxlblxyXG4vLyB3ZW5uIG5laW46IHNwZWljaGVyblxyXG4vLyB3aXJkIGluIEZlbGRFZGl0Lmh0bWwgdmVyd2VuZGV0XHJcbndpbmRvdy5lbS5wcsO8ZmVGZWxkTmFtZW4gPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdCRkYi52aWV3KCdldmFiL0ZlbGROYW1lbj9rZXk9XCInICsgbG9jYWxTdG9yYWdlLkZlbGRXZXJ0ICsgJ1wiJmluY2x1ZGVfZG9jcz10cnVlJywge1xyXG5cdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHR2YXIgdGVtcEZlbGQsXHJcblx0XHRcdFx0QW56RWlnZW5lT2Rlck9mZml6aWVsbGVGZWxkZXJNaXRTZWxiZW1OYW1lbiA9IDA7XHJcblx0XHRcdC8vIGR1cmNoIGFsbGUgRmVsZGVyIG1pdCBkZW1zZWxiZW4gQXJ0bmFtZW4gbGF1ZmVuXHJcblx0XHRcdC8vIHByw7xmZW4sIG9iIHNpZSBlaWdlbmUgb2RlciBvZmZpZWxsZSBzaW5kXHJcblx0XHRcdGlmIChkYXRhLnJvd3MpIHtcclxuXHRcdFx0XHRfLmVhY2goZGF0YS5yb3dzLCBmdW5jdGlvbihyb3cpIHtcclxuXHRcdFx0XHRcdGlmIChyb3cuZG9jKSB7XHJcblx0XHRcdFx0XHRcdHRlbXBGZWxkID0gcm93LmRvYztcclxuXHRcdFx0XHRcdFx0Ly8gaXN0IGVzIGVpbiBlaWdlbmVzIG9kZXIgZWluIG9mZml6aWVsbGVzP1xyXG5cdFx0XHRcdFx0XHRpZiAodGVtcEZlbGQuVXNlciA9PT0gbG9jYWxTdG9yYWdlLkVtYWlsIHx8IHRlbXBGZWxkLlVzZXIgPT09IFwiWmVudHJlbkJkS3RcIikge1xyXG5cdFx0XHRcdFx0XHRcdC8vIGphID4gZGllc2VyIE5hbWUgaXN0IG5pY2h0IHp1bMOkc3NpZ1xyXG5cdFx0XHRcdFx0XHRcdEFuekVpZ2VuZU9kZXJPZmZpemllbGxlRmVsZGVyTWl0U2VsYmVtTmFtZW4gKys7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoQW56RWlnZW5lT2Rlck9mZml6aWVsbGVGZWxkZXJNaXRTZWxiZW1OYW1lbiA9PT0gMCkge1xyXG5cdFx0XHRcdC8vIEZlbGRuYW1lIGlzdCBuZXUsIHNvbWl0IHp1bMOkc3NpZyA+IHNwZWljaGVyblxyXG5cdFx0XHRcdC8vIHVuZCBhbHRlbiBGZWxkTmFtZW4gYXVzIGRlciBMaXN0ZSBkZXIgYW56dXplaWdlbmRlbiBGZWxkZXIgZW50ZmVybmVuXHJcbiAgICAgICAgICAgICAgICAkKFwiI1NpY2h0YmFySW1Nb2R1c0hpZXJhcmNoaXNjaFwiKVxyXG5cdFx0XHRcdCAgICAudmFsKFwiamFcIilcclxuXHRcdFx0XHQgICAgLnBhcmVudCgpLmFkZENsYXNzKFwidWktZmxpcHN3aXRjaC1hY3RpdmVcIik7XHJcblx0XHRcdFx0d2luZG93LmVtLnNwZWljaGVyZUZlbGRlaWdlbnNjaGFmdGVuKCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly8gRmVsZG5hbWUga29tbXQgYmVpIGRpZXNlbSBVc2VyIHNjaG9uIHZvclxyXG5cdFx0XHRcdC8vIFdlcnQgaW0gRmVsZCB6dXLDvGNrc2V0emVuXHJcblx0XHRcdFx0aWYgKGxvY2FsU3RvcmFnZS5BbHRlckZlbGRXZXJ0ICYmIGxvY2FsU3RvcmFnZS5BbHRlckZlbGRXZXJ0ICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRcdCQoXCIjRmVsZE5hbWVcIikudmFsKGxvY2FsU3RvcmFnZS5BbHRlckZlbGRXZXJ0KTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0JChcIiNGZWxkTmFtZVwiKS52YWwoXCJcIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IFxyXG5cdFx0XHRcdFx0JCgnI0ZlbGROYW1lJykuZm9jdXMoKTsgXHJcblx0XHRcdFx0fSwgNTApOyAgLy8gbmVlZCB0byB1c2UgYSB0aW1lciBzbyB0aGF0IC5ibHVyKCkgY2FuIGZpbmlzaCBiZWZvcmUgeW91IGRvIC5mb2N1cygpXHJcblx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRmVsZG5hbWUgXCIgKyBsb2NhbFN0b3JhZ2UuRmVsZFdlcnQgKyBcIiBleGlzdGllcnQgc2Nob248YnI+V8OkaGxlbiBTaWUgZWluZW4gYW5kZXJlblwiKTtcclxuXHRcdFx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLkZlbGROYW1lO1xyXG5cdFx0XHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuRmVsZFdlcnQ7XHJcblx0XHRcdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5BbHRlckZlbGRXZXJ0O1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQvLyBXZXJ0IGltIEZlbGQgenVyw7xja3NldHplblxyXG5cdFx0XHRpZiAobG9jYWxTdG9yYWdlLkFsdGVyRmVsZFdlcnQpIHtcclxuXHRcdFx0XHQkKFwiI0ZlbGROYW1lXCIpLnZhbChsb2NhbFN0b3JhZ2UuQWx0ZXJGZWxkV2VydCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0JChcIiNGZWxkTmFtZVwiKS52YWwoXCJcIik7XHJcblx0XHRcdH1cclxuXHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRmVobGVyOiDDhG5kZXJ1bmcgaW4gXCIgKyBsb2NhbFN0b3JhZ2UuRmVsZE5hbWUgKyBcIiBuaWNodCBnZXNwZWljaGVydFwiKTtcclxuXHRcdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5GZWxkTmFtZTtcclxuXHRcdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5GZWxkV2VydDtcclxuXHRcdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5BbHRlckZlbGRXZXJ0O1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxuLy8gbMO2c2NodCBGZWxkZXJcclxuLy8gd2lyZCBpbiBGZWxkRWRpdC5odG1sIHZlcndlbmRldFxyXG53aW5kb3cuZW0ubMO2c2NoZUZlbGQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKHdpbmRvdy5lbS5GZWxkKSB7XHJcblx0XHQvLyBPYmpla3QgbnV0emVuXHJcblx0XHR3aW5kb3cuZW0ubMO2c2NoZUZlbGRfMigpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBGZWxkIGF1cyBEQiBob2xlblxyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLm9wZW5Eb2Mod2luZG93LmVtLkZlbGQuX2lkLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uRmVsZCA9IGRhdGE7XHJcblx0XHRcdFx0d2luZG93LmVtLmzDtnNjaGVGZWxkXzIoKTtcclxuXHRcdFx0fSxcclxuXHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkZlaGxlcjogbmljaHQgZ2Vsw7ZzY2h0XCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0ubMO2c2NoZUZlbGRfMiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0JGRiLnJlbW92ZURvYyh3aW5kb3cuZW0uRmVsZCwge1xyXG5cdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHQvLyBMaXN0ZSBhbnBhc3Nlbi4gVm9yc2ljaHQ6IEJlaSByZWZyZXNoIGthbm4gc2llIGZlaGxlblxyXG5cdFx0XHRpZiAod2luZG93LmVtLkZlbGRsaXN0ZSkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5GZWxkbGlzdGUucm93cyA9IF8ucmVqZWN0KHdpbmRvdy5lbS5GZWxkbGlzdGUucm93cywgZnVuY3Rpb24ocm93KSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gcm93LmRvYy5faWQgPT09IGRhdGEuaWQ7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly8gS2VpbmUgRmVsZGxpc3RlIG1laHIuIFN0b3JhZ2UgbMO2c2NoZW5cclxuXHRcdFx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlRmVsZExpc3RlKCk7XHJcblx0XHRcdH1cclxuXHRcdFx0d2luZG93LmVtLmxlZXJlU3RvcmFnZUZlbGRFZGl0KCk7XHJcblx0XHRcdCQubW9iaWxlLm5hdmlnYXRlKFwiRmVsZExpc3RlLmh0bWxcIik7XHJcblx0XHR9LFxyXG5cdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJGZWhsZXI6IG5pY2h0IGdlbMO2c2NodFwiKTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbi8vIMOWZmZuZXQgZGFzIG7DpGNoc3RlIEZlbGRcclxuLy8gbsOkY2hzdGVzIGRlcyBsZXR6dGVuID0+IG1lbGRlblxyXG4vLyBlcndhcnRldCBkaWUgSUQgZGVzIGFrdHVlbGxlbiBEYXRlbnNhdHplc1xyXG4vLyB3aXJkIGluIEZlbGRFZGl0Lmh0bWwgdmVyd2VuZGV0XHJcbndpbmRvdy5lbS5nZWhlWnVtTsOkY2hzdGVuRmVsZCA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAod2luZG93LmVtLkZlbGRsaXN0ZSkge1xyXG5cdFx0Ly8gRmVsZGxpc3RlIGF1cyBnbG9iYWxlciBWYXJpYWJsZSB2ZXJ3ZW5kZW4gLSBtdXNzIG5pY2h0IGdlcGFyc3Qgd2VyZGVuXHJcblx0XHR3aW5kb3cuZW0uZ2VoZVp1bU7DpGNoc3RlbkZlbGRfMigpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIudmlldygnZXZhYi9GZWxkTGlzdGU/aW5jbHVkZV9kb2NzPXRydWUnLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uRmVsZGxpc3RlID0gZGF0YTtcclxuXHRcdFx0XHR3aW5kb3cuZW0uZ2VoZVp1bU7DpGNoc3RlbkZlbGRfMigpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0uZ2VoZVp1bU7DpGNoc3RlbkZlbGRfMiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgaSxcclxuXHRcdHksXHJcblx0XHRGZWxkSWRBa3R1ZWxsLFxyXG5cdFx0QW56RmVsZGVyID0gd2luZG93LmVtLkZlbGRsaXN0ZS5yb3dzLmxlbmd0aCAtMSxcclxuXHRcdEFrdEZlbGRfaSxcclxuXHRcdEFrdEZlbGRfeTtcclxuXHRmb3IgKGk9MDsgd2luZG93LmVtLkZlbGRsaXN0ZS5yb3dzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHQvLyBhbGxlIEZlbGRlciBkdXJjaGxhdWZlbiwgYWt0dWVsbGVzIGVpZ2VuZXMgb2RlciBvZmZpemllbGxlcyBzdWNoZW5cclxuXHRcdEFrdEZlbGRfaSA9IHdpbmRvdy5lbS5GZWxkbGlzdGUucm93c1tpXS5kb2M7XHJcblx0XHQvLyB2b3JzaWNodDogT2JqZWt0ZSB6w6RobGVuIEVsZW1lbnRlIGFiIDEsIEFycmF5cyBhYiAwIVxyXG5cdFx0aWYgKEFrdEZlbGRfaS5Vc2VyID09PSBsb2NhbFN0b3JhZ2UuRW1haWwgfHwgQWt0RmVsZF9pLlVzZXIgPT09IFwiWmVudHJlbkJkS3RcIikge1xyXG5cdFx0XHQvLyBOdXIgZWlnZW5lIHVuZCBvZmZpemllbGxlIEZlbGRlciBiZXLDvGNrc2ljaHRpZ2VuXHJcblx0XHRcdEZlbGRJZEFrdHVlbGwgPSB3aW5kb3cuZW0uRmVsZGxpc3RlLnJvd3NbaV0uZG9jLl9pZDtcclxuXHRcdFx0aWYgKEZlbGRJZEFrdHVlbGwgPT09IGxvY2FsU3RvcmFnZS5GZWxkSWQpIHtcclxuXHRcdFx0XHQvLyBkYXMgaXN0IGRhcyBha3R1ZWxsZSBGZWxkXHJcblx0XHRcdFx0Ly8gdm9uIGhpZXIgYXVzIHZvcnfDpHJ0cyBkYXMgbsOkY2hzdGUgZWlnZW5lIG9kZXIgb2ZmaXppZWxsZSBzdWNoZW5cclxuXHRcdFx0XHRpZiAoaSA8IEFuekZlbGRlcikge1xyXG5cdFx0XHRcdFx0Ly8gZGFzIGFrdHVlbGxlIEZlbGQgaXN0IG5pY2h0IGRhcyBsZXR6dGVcclxuXHRcdFx0XHRcdGZvciAoeSA9IGkrMTsgeSA8PSBBbnpGZWxkZXI7IHkrKykge1xyXG5cdFx0XHRcdFx0XHQvLyBhbGxlIHZlcmJsZWliZW5kZW4gRmVsZGVyIGR1cmNobGF1ZmVuLCBlaWdlbmVzIHN1Y2hlblxyXG5cdFx0XHRcdFx0XHRBa3RGZWxkX3kgPSB3aW5kb3cuZW0uRmVsZGxpc3RlLnJvd3NbeV0uZG9jO1xyXG5cdFx0XHRcdFx0XHQvLyBOdXIgZWlnZW5lIEZlbGRlciB1bmQgb2ZmaXppZWxsZSBiZXLDvGNrc2ljaHRpZ2VuXHJcblx0XHRcdFx0XHRcdGlmIChBa3RGZWxkX3kuVXNlciA9PT0gbG9jYWxTdG9yYWdlLkVtYWlsIHx8IEFrdEZlbGRfeS5Vc2VyID09PSBcIlplbnRyZW5CZEt0XCIpIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBkYXMgaXN0IGRhcyBuw6RjaHN0ZSBlaWdlbmUgRmVsZCA+IMO2ZmZuZW5cclxuXHRcdFx0XHRcdFx0XHRsb2NhbFN0b3JhZ2UuRmVsZElkID0gd2luZG93LmVtLkZlbGRsaXN0ZS5yb3dzW2krMV0uZG9jLl9pZDtcclxuXHRcdFx0XHRcdFx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlRmVsZEVkaXQoXCJvaG5lSWRcIik7XHJcblx0XHRcdFx0XHRcdFx0d2luZG93LmVtLmluaXRpaWVyZUZlbGRFZGl0KCk7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdGlmICh5ID09PSBBbnpGZWxkZXIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIGFtIGxldHp0ZW4gRmVsZCBhbmdlbGFuZ3QgdW5kIGVzIGlzdCBrZWluIGVpZ2VuZXNcclxuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkRhcyBpc3QgZGFzIGxldHp0ZSBGZWxkXCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQvLyBkYXMgYWt0dWVsbGUgRmVsZCBpc3QgZGFzIGxldHp0ZVxyXG5cdFx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRGFzIGlzdCBkYXMgbGV0enRlIEZlbGRcIik7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG59O1xyXG5cclxuLy8gw5ZmZm5ldCBkYXMgdm9yaWdlIEZlbGRcclxuLy8gdm9yaWdlcyBkZXMgZXJzdGVuID0+IEZlbGRMaXN0ZVxyXG4vLyBlcndhcnRldCBkaWUgSUQgZGVzIGFrdHVlbGxlbiBEYXRlbnNhdHplc1xyXG4vLyB3aXJkIGluIEZlbGRFZGl0Lmh0bWwgdmVyd2VuZGV0XHJcbndpbmRvdy5lbS5nZWhlWnVtVm9yaWdlbkZlbGQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKHdpbmRvdy5lbS5GZWxkbGlzdGUpIHtcclxuXHRcdC8vIEZlbGRsaXN0ZSBhdXMgZ2xvYmFsZXIgVmFyaWFibGUgdmVyd2VuZGVuIC0gbXVzcyBuaWNodCBnZXBhcnN0IHdlcmRlblxyXG5cdFx0d2luZG93LmVtLmdlaGVadW1Wb3JpZ2VuRmVsZF8yKCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi52aWV3KCdldmFiL0ZlbGRMaXN0ZT9pbmNsdWRlX2RvY3M9dHJ1ZScsIHtcclxuXHRcdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5GZWxkbGlzdGUgPSBkYXRhO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5nZWhlWnVtVm9yaWdlbkZlbGRfMigpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0uZ2VoZVp1bVZvcmlnZW5GZWxkXzIgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIGksXHJcblx0XHR5LFxyXG5cdFx0RmVsZElkQWt0dWVsbCxcclxuXHRcdEZlbGRJZFZvcmlnZXMsXHJcblx0XHRBa3RGZWxkX2ksXHJcblx0XHRBa3RGZWxkX3k7XHJcblx0Zm9yIChpPTA7IHdpbmRvdy5lbS5GZWxkbGlzdGUucm93cy5sZW5ndGg7IGkrKykge1xyXG5cdFx0Ly8gYWxsZSBGZWxkZXIgZHVyY2hsYXVmZW4sIGFrdHVlbGxlcyBlaWdlbmVzIG9kZXIgb2ZmaXppZWxsZXMgc3VjaGVuXHJcblx0XHRBa3RGZWxkX2kgPSB3aW5kb3cuZW0uRmVsZGxpc3RlLnJvd3NbaV0uZG9jO1xyXG5cdFx0Ly8gdm9yc2ljaHQ6IE9iamVrdGUgesOkaGxlbiBFbGVtZW50ZSBhYiAxLCBBcnJheXMgYWIgMCFcclxuXHRcdGlmIChBa3RGZWxkX2kuVXNlciA9PT0gbG9jYWxTdG9yYWdlLkVtYWlsIHx8IEFrdEZlbGRfaS5Vc2VyID09PSBcIlplbnRyZW5CZEt0XCIpIHtcclxuXHRcdFx0Ly8gTnVyIGVpZ2VuZSB1bmQgb2ZmaXppZWxsZSBGZWxkZXIgYmVyw7xja3NpY2h0aWdlblxyXG5cdFx0XHRGZWxkSWRBa3R1ZWxsID0gd2luZG93LmVtLkZlbGRsaXN0ZS5yb3dzW2ldLmRvYy5faWQ7XHJcblx0XHRcdGlmIChGZWxkSWRBa3R1ZWxsID09PSBsb2NhbFN0b3JhZ2UuRmVsZElkKSB7XHJcblx0XHRcdFx0Ly8gZGFzIGlzdCBkYXMgYWt0dWVsbGUgRmVsZFxyXG5cdFx0XHRcdC8vIHZvbiBoaWVyIGF1cyByw7xja3fDpHJ0cyBkYXMgbsOkY2hzdGUgZWlnZW5lIG9kZXIgb2ZmaXppZWxsZSBzdWNoZW5cclxuXHRcdFx0XHRpZiAoaSA+IDApIHtcclxuXHRcdFx0XHRcdC8vIGRhcyBha3R1ZWxsZSBGZWxkIGlzdCBuaWNodCBkYXMgZXJzdGUgXHJcblx0XHRcdFx0XHRmb3IgKHkgPSBpLTE7IHkgPj0gMDsgeS0tKSB7XHJcblx0XHRcdFx0XHRcdC8vIGFsbGUgdm9yaGVyZ2VoZW5kZW4gRmVsZGVyIGR1cmNobGF1ZmVuLCBlaWdlbmVzIHN1Y2hlblxyXG5cdFx0XHRcdFx0XHRBa3RGZWxkX3kgPSB3aW5kb3cuZW0uRmVsZGxpc3RlLnJvd3NbeV0uZG9jO1xyXG5cdFx0XHRcdFx0XHQvLyBOdXIgZWlnZW5lIEZlbGRlciB1bmQgb2ZmaXppZWxsZSBiZXLDvGNrc2ljaHRpZ2VuXHJcblx0XHRcdFx0XHRcdGlmIChBa3RGZWxkX3kuVXNlciA9PT0gbG9jYWxTdG9yYWdlLkVtYWlsIHx8IEFrdEZlbGRfeS5Vc2VyID09PSBcIlplbnRyZW5CZEt0XCIpIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBkYXMgaXN0IGRhcyBuw6RjaHN0dm9yaGVyaWdlIGVpZ2VuZSBGZWxkID4gw7ZmZm5lblxyXG5cdFx0XHRcdFx0XHRcdEZlbGRJZFZvcmlnZXMgPSB3aW5kb3cuZW0uRmVsZGxpc3RlLnJvd3NbaS0xXS5kb2MuX2lkO1xyXG5cdFx0XHRcdFx0XHRcdGxvY2FsU3RvcmFnZS5GZWxkSWQgPSBGZWxkSWRWb3JpZ2VzO1xyXG5cdFx0XHRcdFx0XHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VGZWxkRWRpdChcIm9obmVJZFwiKTtcclxuXHRcdFx0XHRcdFx0XHR3aW5kb3cuZW0uaW5pdGlpZXJlRmVsZEVkaXQoKTtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0aWYgKHkgPT09IDEpIHtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIGFtIGVyc3RlbiBGZWxkIGFuZ2VsYW5ndCB1bmQgZXMgaXN0IGtlaW4gZWlnZW5lc1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gd2lyIGdlaGVuIHp1ciBGZWxkbGlzdGVcclxuXHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5lbS5nZWhlWnVydWVja0ZFKCk7XHJcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdC8vIGRhcyBha3R1ZWxsZSBGZWxkIGlzdCBkYXMgZXJzdGVcclxuXHRcdFx0XHRcdC8vIHdpciBnZWhlbiB6dXIgRmVsZGxpc3RlXHJcblx0XHRcdFx0XHR3aW5kb3cuZW0uZ2VoZVp1cnVlY2tGRSgpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxufTtcclxuXHJcbi8vIGVtcGbDpG5ndCBkZW4gRmVsZG5hbWVuIGRlcyBnZXfDpGhsdGVuIFZvcmfDpG5nZXJzXHJcbi8vIGVybWl0dGVsdCBkZXNzZW4gUmVpaGVuZm9sZ2VcclxuLy8gc3VjaHQgZGFzIG7DpGNoc3RlIGVpZ2VuZSBGZWxkIHVuZCBzZXR6dCBhbHMgUmVpaGVuZm9sZ2UgZGVuIE1pdHRlbHdlcnQgZGVyIHp3ZWkgUmVpaGVuZm9sZ2VuXHJcbi8vIFdlbm4ga2VpbiB3ZWl0ZXJlcyBlaWdlbmVzIEZlbGQga29tbXQsIHdpcmQgYWxzIFJlaWhlbmZvbGdlIGRlciBuw6RjaHN0ZSB1bSBtaW5kZXN0ZW5zIDEgaMO2aGVyZSBnYW56emFobGlnZSBXZXJ0IGdlc2V0enRcclxuLy8gd2lyZCBpbiBGZWxkRWRpdC5odG1sIHZlcndlbmRldFxyXG53aW5kb3cuZW0uc2V0emVSZWloZW5mb2xnZU1pdFZvcmfDpG5nZXIgPSBmdW5jdGlvbihGZWxkTmFtZVZvcmfDpG5nZXIpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyIHZpZXduYW1lID0gJ2V2YWIvRmVsZExpc3RlRmVsZE5hbWU/a2V5PVwiJyArIEZlbGROYW1lVm9yZ8OkbmdlciArICdcIiZpbmNsdWRlX2RvY3M9dHJ1ZScsXHJcbiAgICAgICAgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0JGRiLnZpZXcodmlld25hbWUsIHtcclxuXHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0dmFyIFJlaWhlbmZvbGdlVm9yZ2FlbmdlciA9IGRhdGEucm93c1swXS5kb2MuUmVpaGVuZm9sZ2U7XHJcblx0XHRcdCQoXCIjUmVpaGVuZm9sZ2VcIikudmFsKE1hdGguZmxvb3IoUmVpaGVuZm9sZ2VWb3JnYWVuZ2VyICsgMSkpO1xyXG5cdFx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlRmVsZGVpZ2Vuc2NoYWZ0ZW4oKTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbi8vIHNwZWljaGVydCwgZGFzcyBlaW4gV2VydCBhbHMgU3RhbmRhcmR3ZXJ0IHZlcndlbmRldCB3ZXJkZW4gc29sbFxyXG4vLyB3aXJkIGluIEZlbGRFZGl0Lmh0bWwgdmVyd2VuZGV0XHJcbndpbmRvdy5lbS5zcGVpY2hlcmVTdGFuZGFyZHdlcnQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gUHLDvGZlbiwgb2IgRmVsZCBhbHMgT2JqZWt0IHZvcmxpZWd0XHJcblx0aWYgKHdpbmRvdy5lbS5GZWxkKSB7XHJcblx0XHQvLyBkaWVzZXMgdmVyd2VuZGVuXHJcblx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlU3RhbmRhcmR3ZXJ0XzIoKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gYXVzIERCIGhvbGVuXHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIub3BlbkRvYyhsb2NhbFN0b3JhZ2UuRmVsZElkLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRvYykge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5GZWxkID0gZG9jO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5zcGVpY2hlcmVTdGFuZGFyZHdlcnRfMigpO1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRmVobGVyOiBGZWxkIG5pY2h0IGdlc3BlaWNoZXJ0XCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG59O1xyXG5cclxud2luZG93LmVtLnNwZWljaGVyZVN0YW5kYXJkd2VydF8yID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBGZWxkd2VydCA9ICQoXCIjU3RhbmRhcmR3ZXJ0XCIpLnZhbCgpO1xyXG5cdC8vIFN0YW5kYXJkd2VydCBtYW5hZ2VuXHJcblx0Ly8gU3RhbmRhcmR3ZXJ0IGlzdCBPYmpla3QsIGluIGRlbSBkaWUgV2VydGUgZsO8ciBqZWRlbiBVc2VyIGdlc3BlaWNoZXJ0IHdlcmRlblxyXG5cdC8vIGRhcnVtIG1hbnVlbGwgZsO8ciBkaWVzZW4gVXNlciB1cGRhdGVuXHJcblx0aWYgKHdpbmRvdy5lbS5GZWxkLlN0YW5kYXJkd2VydCkge1xyXG5cdFx0Ly8gU3RhbmRhcmR3ZXJ0IGV4aXN0aWVydGVcclxuXHRcdGlmIChGZWxkd2VydCkge1xyXG5cdFx0XHQvLyBuZXVlbiBTdGFuZGFyZHdlcnQgc2V0emVuXHJcblx0XHRcdHdpbmRvdy5lbS5GZWxkLlN0YW5kYXJkd2VydFtsb2NhbFN0b3JhZ2UuRW1haWxdID0gRmVsZHdlcnQ7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQvLyBTdGFuZGFyZHdlcnQgaXN0IGxlZXJcclxuXHRcdFx0aWYgKHdpbmRvdy5lbS5GZWxkLlN0YW5kYXJkd2VydFtsb2NhbFN0b3JhZ2UuRW1haWxdKSB7XHJcblx0XHRcdFx0Ly8gYmlzaGVyaWdlbiBTdGFuZGFyZHdlcnQgbMO2c2NoZW5cclxuXHRcdFx0XHRkZWxldGUgd2luZG93LmVtLkZlbGQuU3RhbmRhcmR3ZXJ0W2xvY2FsU3RvcmFnZS5FbWFpbF07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9IGVsc2Uge1xyXG5cdFx0Ly8gQmlzaGVyIGdhYiBlcyBub2NoIGtlaW5lbiBTdGFuZGFyZHdlcnRcclxuXHRcdGlmIChGZWxkd2VydCkge1xyXG5cdFx0XHQvLyBPYmpla3QgZsO8ciBTdGFuZGFyZHdlcnQgc2NoYWZmZW4gdW5kIG5ldWVuIFdlcnQgc2V0emVuXHJcblx0XHRcdHdpbmRvdy5lbS5GZWxkLlN0YW5kYXJkd2VydCA9IHt9O1xyXG5cdFx0XHR3aW5kb3cuZW0uRmVsZC5TdGFuZGFyZHdlcnRbbG9jYWxTdG9yYWdlLkVtYWlsXSA9IEZlbGR3ZXJ0O1xyXG5cdFx0fVxyXG5cdH1cclxuICAgIHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHQkZGIuc2F2ZURvYyh3aW5kb3cuZW0uRmVsZCwge1xyXG5cdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHR3aW5kb3cuZW0uRmVsZC5fcmV2ID0gZGF0YS5yZXY7XHJcblx0XHRcdGxvY2FsU3RvcmFnZS5GZWxkSWQgPSBkYXRhLmlkO1xyXG5cdFx0XHQvLyBGZWxkbGlzdGVuIGxlZXJlbiwgZGFtaXQgU3RhbmRhcmR3ZXJ0IHNvZm9ydCB2ZXJ3ZW5kZXQgd2VyZGVuIGthbm4hXHJcblx0XHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VGZWxkTGlzdGUoKTtcclxuXHRcdH0sXHJcblx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkZlaGxlcjogRmVsZCBuaWNodCBnZXNwZWljaGVydFwiKTtcclxuXHRcdH1cclxuXHR9KTtcclxufTtcclxuXHJcbi8vIHNwZWljaGVydCBGZWxkZWlnZW5zY2hhZnRlblxyXG4vLyB3aXJkIGluIEZlbGRFZGl0Lmh0bWwgdmVyd2VuZGV0XHJcbndpbmRvdy5lbS5zcGVpY2hlcmVGZWxkZWlnZW5zY2hhZnRlbiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBwcsO8ZmVuLCBvYiBkYXMgRmVsZCBhbHMgT2JqZWt0IHZvcmxpZWd0XHJcblx0aWYgKHdpbmRvdy5lbS5GZWxkKSB7XHJcblx0XHQvLyBiZXN0ZWhlbmRlcyBPYmpla3QgdmVyd2VuZGVuXHJcblx0XHR3aW5kb3cuZW0uc3BlaWNoZXJlRmVsZGVpZ2Vuc2NoYWZ0ZW5fMigpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHQvLyBPYmpla3QgYXVzIGRlciBEQiBob2xlblxyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLm9wZW5Eb2MobG9jYWxTdG9yYWdlLkZlbGRJZCwge1xyXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLkZlbGQgPSBkYXRhO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5zcGVpY2hlcmVGZWxkZWlnZW5zY2hhZnRlbl8yKCk7XHJcblx0XHRcdH0sXHJcblx0XHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJGZWhsZXI6IERpZSBsZXR6dGUgw4RuZGVydW5nIHd1cmRlIG5pY2h0IGdlc3BlaWNoZXJ0XCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0uc3BlaWNoZXJlRmVsZGVpZ2Vuc2NoYWZ0ZW5fMiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgRm9ybXVsYXJmZWxkZXIgPSAkKFwiI0ZlbGRFZGl0Rm9ybVwiKS5zZXJpYWxpemVPYmplY3ROdWxsKCk7XHJcblx0Ly8gRmVsZGVyIG1pdCBBcnJheXM6IEtvbW1hZ2V0cmVubnRlIFdlcnRlIGluIEFycmF5cyB2ZXJ3YW5kZWxuXHJcblx0aWYgKEZvcm11bGFyZmVsZGVyLk9wdGlvbmVuKSB7XHJcblx0XHRGb3JtdWxhcmZlbGRlci5PcHRpb25lbiA9IEZvcm11bGFyZmVsZGVyLk9wdGlvbmVuLnNwbGl0KFwiLFwiKTtcclxuXHR9XHJcblx0Ly8gV2VubiBCZXNjaHJpZnR1bmcgZmVobHQgdW5kIE5hbWUgZXhpc3RpZXJ0OiBCZXNjaHJpZnR1bmcgPSBOYW1lXHJcblx0aWYgKCFGb3JtdWxhcmZlbGRlci5GZWxkQmVzY2hyaWZ0dW5nICYmIEZvcm11bGFyZmVsZGVyLkhpZXJhcmNoaWVzdHVmZSAmJiBGb3JtdWxhcmZlbGRlci5GZWxkTmFtZSkge1xyXG5cdFx0Rm9ybXVsYXJmZWxkZXIuRmVsZEJlc2NocmlmdHVuZyA9IEZvcm11bGFyZmVsZGVyLkZlbGROYW1lO1xyXG5cdFx0Ly8gRmVsZGxpc3RlIHNvbGwgbmV1IGF1ZmdlYmF1dCB3ZXJkZW5cclxuXHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VGZWxkTGlzdGUoKTtcclxuXHR9XHJcblx0Ly8gRXMgYnJhdWNodCBlaW5lIFJlaWhlbmZvbGdlXHJcblx0aWYgKCFGb3JtdWxhcmZlbGRlci5SZWloZW5mb2xnZSAmJiBGb3JtdWxhcmZlbGRlci5IaWVyYXJjaGllc3R1ZmUgJiYgRm9ybXVsYXJmZWxkZXIuRmVsZE5hbWUpIHtcclxuXHRcdEZvcm11bGFyZmVsZGVyLlJlaWhlbmZvbGdlID0gMTtcclxuXHRcdC8vIEZlbGRsaXN0ZSBzb2xsIG5ldSBhdWZnZWJhdXQgd2VyZGVuXHJcblx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlRmVsZExpc3RlKCk7XHJcblx0fVxyXG5cdC8vIFdlbm4gRmVsZHR5cCB2b24gdGV4dGlucHV0IHdlZyBnZcOkbmRlcnQgd3VyZGUsIHNvbGx0ZSBJbnB1dFR5cCBlbnRmZXJudCB3ZXJkZW5cclxuXHRpZiAoRm9ybXVsYXJmZWxkZXIuRm9ybXVsYXJlbGVtZW50ICE9PSBcInRleHRpbnB1dFwiICYmIEZvcm11bGFyZmVsZGVyLklucHV0VHlwKSB7XHJcblx0XHRkZWxldGUgRm9ybXVsYXJmZWxkZXIuSW5wdXRUeXA7XHJcblx0XHQkKFwiI1wiICsgd2luZG93LmVtLkZlbGQuSW5wdXRUeXApLnByb3AoXCJjaGVja2VkXCIsZmFsc2UpLmNoZWNrYm94cmFkaW8oXCJyZWZyZXNoXCIpO1xyXG5cdH1cclxuXHQvLyBXZW5uIEZlbGR0eXAgdGV4dGlucHV0IGdlc2V0enQgd3VyZGUsIG11c3MgZWluIElucHV0VHlwIGV4aXN0aWVyZW4uIFdlbm4gZXIgbmljaHQgZ2VzZXR6dCB3dXJkZSwgdGV4dCBzZXR6ZW5cclxuXHRpZiAoRm9ybXVsYXJmZWxkZXIuRm9ybXVsYXJlbGVtZW50ID09PSBcInRleHRpbnB1dFwiICYmICFGb3JtdWxhcmZlbGRlci5JbnB1dFR5cCkge1xyXG5cdFx0Rm9ybXVsYXJmZWxkZXIuSW5wdXRUeXAgPSBcInRleHRcIjtcclxuXHRcdCQoXCIjXCIgKyB3aW5kb3cuZW0uRmVsZC5JbnB1dFR5cCkucHJvcChcImNoZWNrZWRcIix0cnVlKS5jaGVja2JveHJhZGlvKFwicmVmcmVzaFwiKTtcclxuXHR9XHJcblx0Ly8gRm9ybXVsYXJmZWxkZXIgaW4gRG9rdW1lbnQgc2NocmVpYmVuXHJcblx0Ly8gc2V0enQgVm9yaGFuZGVuc2VpbiB2b24gRmVsZG5hbWVuIHZvcmF1cyFcclxuXHRfLmVhY2goRm9ybXVsYXJmZWxkZXIsIGZ1bmN0aW9uKGZlbGR3ZXJ0LCBmZWxkbmFtZSkge1xyXG5cdFx0aWYgKGZlbGR3ZXJ0KSB7XHJcblx0XHRcdGlmIChmZWxkbmFtZSA9PT0gXCJSZWloZW5mb2xnZVwiIHx8IGZlbGRuYW1lID09PSBcIlNsaWRlck1pbmltdW1cIiB8fCBmZWxkbmFtZSA9PT0gXCJTbGlkZXJNYXhpbXVtXCIpIHtcclxuXHRcdFx0XHQvLyBaYWhsIHdpcmQgc29uc3QgaW4gVGV4dCB2ZXJ3YW5kZWx0IHVuZCBmYWxzY2ggc29ydGllcnRcclxuXHRcdFx0XHR3aW5kb3cuZW0uRmVsZFtmZWxkbmFtZV0gPSBwYXJzZUludChmZWxkd2VydCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0d2luZG93LmVtLkZlbGRbZmVsZG5hbWVdID0gZmVsZHdlcnQ7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIGxlZXJlIEZlbGRlciBlbnRmZXJuZW4sIGRhbWl0IHdlcmRlbiBhdWNoIHNvZWJlbiBnZWzDtnNjaHRlIEZlbGRlciBlbnRmZXJudFxyXG5cdFx0XHRkZWxldGUgd2luZG93LmVtLkZlbGRbZmVsZG5hbWVdO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG4gICAgdmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdCRkYi5zYXZlRG9jKHdpbmRvdy5lbS5GZWxkLCB7XHJcblx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdC8vIHJldiBha3R1YWxpc2llcmVuXHJcblx0XHRcdHdpbmRvdy5lbS5GZWxkLl9yZXYgPSBkYXRhLnJldjtcclxuXHRcdFx0bG9jYWxTdG9yYWdlLkZlbGRJZCA9IGRhdGEuaWQ7XHJcblx0XHRcdC8vIEZlbGRsaXN0ZSBzb2xsIG5ldSBhdWZiYXVlblxyXG5cdFx0XHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlRmVsZExpc3RlKCk7XHJcblx0XHR9LFxyXG5cdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJGZWhsZXI6IERpZSBsZXR6dGUgw4RuZGVydW5nIHd1cmRlIG5pY2h0IGdlc3BlaWNoZXJ0XCIpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuRmVsZE5hbWU7XHJcblx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5GZWxkV2VydDtcclxuXHRkZWxldGUgbG9jYWxTdG9yYWdlLkFsdGVyRmVsZFdlcnQ7XHJcbn07XHJcblxyXG4vLyB3aXJkIGluIEJlb2JMaXN0ZS5odG1sIHZlcndlbmRldFxyXG4vLyBlaWdlbmUgRnVua3Rpb24sIHdlaWwgYXVjaCBkaWUgQmVvYmxpc3RlIGRhcmF1ZiB2ZXJ3ZWlzdCwgd2VubiBub2NoIGtlaW5lIEFydCBlcmZhc3N0IHd1cmRlXHJcbndpbmRvdy5lbS5lcnN0ZWxsZU5ldWVCZW9iXzFfQXJ0Z3J1cHBlbmxpc3RlID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIEdsb2JhbGUgVmFyaWFibGVuIGbDvHIgQmVvYkxpc3RlIHp1csO8Y2tzZXR6ZW4sIGRhbWl0IGRpZSBMaXN0ZSBuZXUgYXVmZ2ViYXV0IHdpcmRcclxuXHR3aW5kb3cuZW0ubGVlcmVTdG9yYWdlQmVvYkxpc3RlKCk7XHJcblx0bG9jYWxTdG9yYWdlLlN0YXR1cyA9IFwibmV1XCI7XHJcblx0bG9jYWxTdG9yYWdlLlZvbiA9IFwiQmVvYkxpc3RlXCI7XHJcblx0ZGVsZXRlIGxvY2FsU3RvcmFnZS5hQXJ0R3J1cHBlO1x0Ly8gdmVyaGluZGVybiwgZGFzcyBlaW5lIEFydGdydXBwZSDDvGJlcmdlYmVuIHdpcmRcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkFydGdydXBwZW5saXN0ZS5odG1sXCIpO1xyXG59O1xyXG5cclxuXHJcbi8vIHdpcmQgaW4gQmVvYkVkaXQuaHRtbCBiZW51dHp0XHJcbi8vIMOWZmZuZXQgZGllIHZvcmlnZSBvZGVyIG7DpGNoc3RlIEJlb2JhY2h0dW5nXHJcbi8vIHZvcmlnZSBkZXIgZXJzdGVuID0+IEJlb2JMaXN0ZVxyXG4vLyBuw6RjaHN0ZSBkZXIgbGV0enRlbiA9PiBtZWxkZW5cclxuLy8gZXJ3YXJ0ZXQgb2IgbsOkY2hzdGVyIG9kZXIgdm9yaWdlciBnZXN1Y2h0IHdpcmRcclxud2luZG93LmVtLm7DpGNoc3RlVm9yaWdlQmVvYiA9IGZ1bmN0aW9uKE7DpGNoc3RlT2RlclZvcmlnZSkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBwcsO8ZmVuLCBvYiBCZW9iTGlzdGUgc2Nob24gZXhpc3RpZXJ0XHJcblx0Ly8gbnVyIGFiZnJhZ2VuLCB3ZW5uIHNpZSBub2NoIG5pY2h0IGV4aXN0aWVydFxyXG5cdGlmICh3aW5kb3cuZW0uQmVvYkxpc3RlKSB7XHJcblx0XHQvLyBnbG9iYWxlIFZhcmlhYmxlIEJlb2JMaXN0ZSBleGlzdGllcnQgbm9jaFxyXG5cdFx0d2luZG93LmVtLm7DpGNoc3RlVm9yaWdlQmVvYl8yKE7DpGNoc3RlT2RlclZvcmlnZSk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIGtlaW5lIFByb2pla3RsaXN0ZSDDvGJlcmdlYmVuXHJcblx0XHQvLyBuZXUgYXVzIERCIGVyc3RlbGxlblxyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLnZpZXcoJ2V2YWIvQmVvYkxpc3RlP3N0YXJ0a2V5PVtcIicgKyBsb2NhbFN0b3JhZ2UuRW1haWwgKyAnXCIse31dJmVuZGtleT1bXCInICsgbG9jYWxTdG9yYWdlLkVtYWlsICsgJ1wiXSZkZXNjZW5kaW5nPXRydWUmaW5jbHVkZV9kb2NzPXRydWUnLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHQvLyBHbG9iYWxlIFZhcmlhYmxlIGVyc3RlbGxlbiwgZGFtaXQgQWJmcmFnZSBhYiBkZW0gendlaXRlbiBNYWwgbmljaHQgbWVociBuw7Z0aWcgaXN0XHJcblx0XHRcdFx0Ly8gYmVpIG5ldWVuL0zDtnNjaGVuIHZvbiBCZW9iYWNodHVuZ2VuIHdpcmQgQmVvYkxpc3RlIHdpZWRlciBhdWYgdW5kZWZpbmVkIGdlc2V0enRcclxuXHRcdFx0XHR3aW5kb3cuZW0uQmVvYkxpc3RlID0gZGF0YTtcclxuXHRcdFx0XHR3aW5kb3cuZW0ubsOkY2hzdGVWb3JpZ2VCZW9iXzIoTsOkY2hzdGVPZGVyVm9yaWdlKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG59O1xyXG5cclxud2luZG93LmVtLm7DpGNoc3RlVm9yaWdlQmVvYl8yID0gZnVuY3Rpb24oTsOkY2hzdGVPZGVyVm9yaWdlKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciBpLFxyXG5cdFx0QmVvYklkQWt0dWVsbCxcclxuXHRcdEFuekJlb2I7XHJcblx0Zm9yIChpPTA7IHdpbmRvdy5lbS5CZW9iTGlzdGUucm93cy5sZW5ndGg7IGkrKykge1xyXG5cdFx0QmVvYklkQWt0dWVsbCA9IHdpbmRvdy5lbS5CZW9iTGlzdGUucm93c1tpXS5kb2MuX2lkO1xyXG5cdFx0QW56QmVvYiA9IHdpbmRvdy5lbS5CZW9iTGlzdGUucm93cy5sZW5ndGggLTE7XHRcdC8vIHZvcnNpY2h0OiBPYmpla3RlIHrDpGhsZW4gRWxlbWVudGUgYWIgMSwgQXJyYXlzIGFiIDAhXHJcblx0XHRpZiAoQmVvYklkQWt0dWVsbCA9PT0gbG9jYWxTdG9yYWdlLkJlb2JJZCkge1xyXG5cdFx0XHRzd2l0Y2ggKE7DpGNoc3RlT2RlclZvcmlnZSkge1xyXG5cdFx0XHRjYXNlIFwibsOkY2hzdGVcIjpcclxuXHRcdFx0XHRpZiAoaSA8IEFuekJlb2IpIHtcclxuXHRcdFx0XHRcdGxvY2FsU3RvcmFnZS5CZW9iSWQgPSB3aW5kb3cuZW0uQmVvYkxpc3RlLnJvd3NbaSsxXS5kb2MuX2lkO1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLmxlZXJlU3RvcmFnZUJlb2JFZGl0KFwib2huZUlkXCIpO1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLmluaXRpaWVyZUJlb2JFZGl0KCk7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkRhcyBpc3QgZGllIGxldHp0ZSBCZW9iYWNodHVuZ1wiKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgXCJ2b3JpZ2VcIjpcclxuXHRcdFx0XHRpZiAoaSA+IDApIHtcclxuXHRcdFx0XHRcdGxvY2FsU3RvcmFnZS5CZW9iSWQgPSB3aW5kb3cuZW0uQmVvYkxpc3RlLnJvd3NbaS0xXS5kb2MuX2lkO1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLmxlZXJlU3RvcmFnZUJlb2JFZGl0KFwib2huZUlkXCIpO1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLmluaXRpaWVyZUJlb2JFZGl0KCk7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VCZW9iRWRpdCgpO1xyXG5cdFx0XHRcdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJCZW9iTGlzdGUuaHRtbFwiKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG4vLyB3aXJkIGluIEJlb2JFZGl0Lmh0bWwgYmVudXR6dFxyXG4vLyBsw7ZzY2h0IGVpbmUgQmVvYmFjaHR1bmdcclxud2luZG93LmVtLmzDtnNjaGVCZW9iID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICh3aW5kb3cuZW0uQmVvYmFjaHR1bmcpIHtcclxuXHRcdC8vIHZvcmhhbmRlbmVzIE9iamVrdCBudXR6ZW5cclxuXHRcdHdpbmRvdy5lbS5sw7ZzY2hlQmVvYl8yKCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIE9iamVrdCBhdXMgREIgaG9sZW5cclxuXHRcdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRcdCRkYi5vcGVuRG9jKGxvY2FsU3RvcmFnZS5CZW9iSWQsIHtcclxuXHRcdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5CZW9iYWNodHVuZyA9IGRhdGE7XHJcblx0XHRcdFx0d2luZG93LmVtLmzDtnNjaGVCZW9iXzIoKTtcclxuXHRcdFx0fSxcclxuXHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkZlaGxlcjogQmVvYmFjaHR1bmcgbmljaHQgZ2Vsw7ZzY2h0XCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG53aW5kb3cuZW0ubMO2c2NoZUJlb2JfMiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0JGRiLnJlbW92ZURvYyh3aW5kb3cuZW0uQmVvYmFjaHR1bmcsIHtcclxuXHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0Ly8gTGlzdGUgYW5wYXNzZW4uIFZvcnNpY2h0OiBCZWkgcmVmcmVzaCBrYW5uIHNpZSBmZWhsZW5cclxuXHRcdFx0aWYgKHdpbmRvdy5lbS5CZW9iTGlzdGUpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uQmVvYkxpc3RlLnJvd3MgPSBfLnJlamVjdCh3aW5kb3cuZW0uQmVvYkxpc3RlLnJvd3MsIGZ1bmN0aW9uKHJvdykge1xyXG5cdFx0XHRcdFx0cmV0dXJuIHJvdy5kb2MuX2lkID09PSBkYXRhLmlkO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdC8vIEtlaW5lIEJlb2JMaXN0ZSBtZWhyLiBTdG9yYWdlIGzDtnNjaGVuXHJcblx0XHRcdFx0d2luZG93LmVtLmxlZXJlU3RvcmFnZUJlb2JMaXN0ZSgpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHdpbmRvdy5lbS5sZWVyZVN0b3JhZ2VCZW9iRWRpdCgpO1xyXG5cdFx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkJlb2JMaXN0ZS5odG1sXCIpO1xyXG5cdFx0fSxcclxuXHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRmVobGVyOiBCZW9iYWNodHVuZyBuaWNodCBnZWzDtnNjaHRcIik7XHJcblx0XHR9XHJcblx0fSk7XHJcbn07XHJcblxyXG4vLyBTcGVpY2hlcnQgYWxsZSBEYXRlbiBpbiBCZW9iRWRpdC5odG1sXHJcbndpbmRvdy5lbS5zcGVpY2hlcmVCZW9iID0gZnVuY3Rpb24odGhhdCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBldmVudGhhbmRsZXIgw7xiZXJnZWJlbiB0aGlzIG5pY2h0IGluIGRlciBLbGFtbWVyXHJcblx0dmFyIF90aGlzID0gdGhhdCB8fCB0aGlzO1xyXG5cdC8vIHByw7xmZW4sIG9iIEJlb2IgYWxzIE9iamVrdCB2b3JsaWVndFxyXG5cdGlmICh3aW5kb3cuZW0uQmVvYmFjaHR1bmcpIHtcclxuXHRcdC8vIGphOiBkaWVzZXMgT2JqZWt0IHZlcndlbmRlblxyXG5cdFx0d2luZG93LmVtLnNwZWljaGVyZUJlb2JfMihfdGhpcyk7XHJcblx0fSBlbHNlIHtcclxuXHRcdC8vIG5laW46IEJlb2IgYXVzIERCIGhvbGVuXHJcblx0XHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0XHQkZGIub3BlbkRvYyhsb2NhbFN0b3JhZ2UuQmVvYklkLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0uQmVvYmFjaHR1bmcgPSBkYXRhO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5zcGVpY2hlcmVCZW9iXzIoX3RoaXMpO1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coJ0ZlaGxlciBpbiBmdW5jdGlvbiBzcGVpY2hlcmVCZW9iXzIoX3RoaXMpJyk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxufTtcclxuXHJcbndpbmRvdy5lbS5zcGVpY2hlcmVCZW9iXzIgPSBmdW5jdGlvbih0aGF0KSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG4gICAgdmFyIEZlbGRuYW1lRGIsXHJcbiAgICAgICAgRmVsZHdlcnQsXHJcbiAgICAgICAgZmVsZGluZm9zO1xyXG4gICAgLy8gRmVsZG5hbWUgdW5kIC13ZXJ0IGVybWl0dGVsblxyXG4gICAgZmVsZGluZm9zID0gd2luZG93LmVtLmhvbGVGZWxkSW5mb3NWb25FbGVtZW50KHRoYXQpO1xyXG4gICAgRmVsZG5hbWVEYiA9IGZlbGRpbmZvcy5mZWxkbmFtZV9kYjtcclxuICAgIEZlbGR3ZXJ0ID0gZmVsZGluZm9zLmZlbGR3ZXJ0O1xyXG5cdC8vIFdlcnRlIGF1cyBkZW0gRm9ybXVsYXIgYWt0dWFsaXNpZXJlblxyXG5cdGlmIChGZWxkd2VydCkge1xyXG5cdFx0aWYgKHdpbmRvdy5lbS5teVR5cGVPZihGZWxkd2VydCkgPT09IFwiZmxvYXRcIikge1xyXG5cdFx0XHR3aW5kb3cuZW0uQmVvYmFjaHR1bmdbRmVsZG5hbWVEYl0gPSBwYXJzZUZsb2F0KEZlbGR3ZXJ0KTtcclxuXHRcdH0gZWxzZSBpZiAod2luZG93LmVtLm15VHlwZU9mKEZlbGR3ZXJ0KSA9PT0gXCJpbnRlZ2VyXCIpIHtcclxuXHRcdFx0d2luZG93LmVtLkJlb2JhY2h0dW5nW0ZlbGRuYW1lRGJdID0gcGFyc2VJbnQoRmVsZHdlcnQpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0d2luZG93LmVtLkJlb2JhY2h0dW5nW0ZlbGRuYW1lRGJdID0gRmVsZHdlcnQ7XHJcblx0XHR9XHJcblx0fSBlbHNlIGlmICh3aW5kb3cuZW0uQmVvYmFjaHR1bmdbRmVsZG5hbWVEYl0pIHtcclxuXHRcdGRlbGV0ZSB3aW5kb3cuZW0uQmVvYmFjaHR1bmdbRmVsZG5hbWVEYl1cclxuXHR9XHJcblx0d2luZG93LmVtLkJlb2JhY2h0dW5nLmFBcnRHcnVwcGUgPSBsb2NhbFN0b3JhZ2UuYUFydEdydXBwZTtcclxuXHR3aW5kb3cuZW0uQmVvYmFjaHR1bmcuYUFydE5hbWUgPSBsb2NhbFN0b3JhZ2UuYUFydE5hbWU7XHJcblx0d2luZG93LmVtLkJlb2JhY2h0dW5nLmFBcnRJZCA9IGxvY2FsU3RvcmFnZS5hQXJ0SWQ7XHJcblx0Ly8gYWxsZXMgc3BlaWNoZXJuXHJcbiAgICB2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0JGRiLnNhdmVEb2Mod2luZG93LmVtLkJlb2JhY2h0dW5nLCB7XHJcblx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdHdpbmRvdy5lbS5CZW9iYWNodHVuZy5fcmV2ID0gZGF0YS5yZXY7XHJcblx0XHR9LFxyXG5cdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRjb25zb2xlLmxvZygnRmVobGVyIGluIGZ1bmN0aW9uIHNwZWljaGVyZUJlb2JfMih0aGF0KScpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxud2luZG93LmVtLm1lbGRlTmV1QW4gPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLlVzZXJTdGF0dXMgPSBcIm5ldVwiO1xyXG5cdCQubW9iaWxlLmNoYW5nZVBhZ2UoXCJpbmRleC5odG1sXCIpO1xyXG5cdC8vIEZlbGRlciB6dXLDvGNrc2V0emVuLCBzb25zdCBpc3QgaGllciBub2NoIGRpZSBhbHRlIEFubWVsZHVuZyBkcmluXHJcblx0JChcIiNFbWFpbFwiKS52YWwoXCJcIik7XHJcblx0JChcIiNQYXNzd29ydFwiKS52YWwoXCJcIik7XHJcbn07XHJcblxyXG5cclxuXHJcblxyXG5cclxud2luZG93LmVtLmhhbmRsZUFydGVuSW1wb3J0aWVyZW5QYWdlc2hvdyA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRpZiAobG9jYWxTdG9yYWdlLmxlbmd0aCA9PT0gMCB8fCAhbG9jYWxTdG9yYWdlLkVtYWlsKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKCk7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImluZGV4Lmh0bWxcIik7XHJcblx0fVxyXG5cdHdpbmRvdy5lbS5pbml0aWllcmVBcnRlbkltcG9ydGllcmVuKCk7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlQXJ0ZW5JbXBvcnRpZXJlblBhZ2Vpbml0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIFdpcmQgZGllc2UgU2VpdGUgZGlyZWt0IGF1ZmdlcnVmZW4gdW5kIGVzIGdpYnQga2VpbmVuIGxvY2FsU3RvcmFnZSxcclxuXHQvLyBtdXNzIGF1ZiBpbmRleC5odG1sIHVtZ2VsZWl0ZXQgd2VyZGVuXHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdH1cclxuXHJcblx0JChcIiNBcnRlbkltcG9ydGllcmVuSGVhZGVyXCIpXHJcbiAgICAgICAgLy8genVyw7xjay1CdXR0b24gc3RldWVyblxyXG4gICAgICAgIC5vbignY2xpY2snLCAnI3p1csO8Y2tBcnRlbkltcG9ydGllcmVuJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5lbS5oYW5kbGVBcnRlbkltcG9ydGllcmVuWnVyw7xja0NsaWNrKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgJChcIiNBcnRlbkltcG9ydGllcmVuQ29udGVudFwiKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnI2FpX2FydGVuX29obmVfYXJ0Z3J1cHBlX2VudGZlcm5lbicsIHdpbmRvdy5lbS5lbnRmZXJuZUFydGVuT2huZUFydGdydXBwZSlcclxuICAgICAgICAub24oJ2NsaWNrJywgJyNhaV9nZW1laW5zYW1fYW56YXJ0ZW5fYWt0dWFsaXNpZXJlbicsIHdpbmRvdy5lbS5ha3R1YWxpc2llcmVBbnphaGxBcnRlblZvbkFydGVuKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnI2FpX2ZlaGxlbl9pbl9ldmFiX2ltcG9ydGllcmVuJywgd2luZG93LmVtLmltcG9ydGllcmVGZWhsZW5kZUFydGVuKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnI2FpX2ZlaGxlbl9pbl9hcnRlbmRiX2V4cG9ydGllcmVuJywgd2luZG93LmVtLmV4cG9ydGllcmVCZW9iVm9uSW5BcnRlbmRiRmVobGVuZGVuQXJ0ZW4pO1xyXG59O1xyXG5cclxud2luZG93LmVtLmltcG9ydGllcmVGZWhsZW5kZUFydGVuID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICh3aW5kb3cuZW0uYXJ0ZW5fZmVobGVuX2luX2V2YWIubGVuZ3RoID09PSAwKSB7XHJcblx0XHR3aW5kb3cuZW0ubWVsZGUoXCJBa3Rpb24gYWJnZWJyb2NoZW46IEVzIGdpYnQgaW4gYXJ0ZWlnZW5zY2hhZnRlbi5jaCBrZWluZSBBcnRlbiwgZGllIGluIGFydGJlb2JhY2h0dW5nZW4uY2ggZmVobGVuXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHR2YXIgJGRiID0gJC5jb3VjaC5kYihcImV2YWJcIik7XHJcblx0Xy5lYWNoKHdpbmRvdy5lbS5hcnRlbl9mZWhsZW5faW5fZXZhYiwgZnVuY3Rpb24oYXJ0KSB7XHJcblx0XHQkZGIuc2F2ZURvYyhhcnQsIHtcclxuXHRcdFx0c3VjY2VzczogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0Ly93aW5kb3cuZW0uaW5pdGlpZXJlQXJ0ZW5JbXBvcnRpZXJlbigpO1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRmVobGVyOiBBcnQgXCIgKyBhcnQuQXJ0bmFtZSArIFwiIG5pY2h0IGltcG9ydGllcnRcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0pO1xyXG59O1xyXG5cclxud2luZG93LmVtLmFrdHVhbGlzaWVyZUFuemFobEFydGVuVm9uQXJ0ZW4gPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0d2luZG93LmVtLm1lbGRlKFwiRGllc2UgRnVua3Rpb24gaXN0IG5vY2ggbmljaHQgaW1wbGVtZW50aWVydFwiKTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5leHBvcnRpZXJlQmVvYlZvbkluQXJ0ZW5kYkZlaGxlbmRlbkFydGVuID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHdpbmRvdy5lbS5tZWxkZShcIkRpZXNlIEZ1bmt0aW9uIGlzdCBub2NoIG5pY2h0IGltcGxlbWVudGllcnRcIik7XHJcbn07XHJcblxyXG4vLyBQUk9WSVNPUklTQ0gsIE5BQ0ggQkVOVVRaVU5HIEVOVEZFUk5FTlxyXG53aW5kb3cuZW0uZW50ZmVybmVBcnRlbk9obmVBcnRncnVwcGUgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdCRkYi52aWV3KCdldmFiL0FydGVuT2huZUFydGdydXBwZT9pbmNsdWRlX2RvY3M9dHJ1ZScsIHtcclxuXHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0aWYgKGRhdGEucm93cy5sZW5ndGggPT09IDApIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJFcyBnaWJ0IGtlaW5lIEFydGVuIG9obmUgQXJ0Z3J1cHBlXCIpO1xyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgYXJ0ZW5fb2huZV9hcnRncnVwcGUgPSBfLm1hcChkYXRhLnJvd3MsIGZ1bmN0aW9uKG9iamVrdCkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIG9iamVrdC5kb2M7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdF8uZWFjaChhcnRlbl9vaG5lX2FydGdydXBwZSwgZnVuY3Rpb24oYXJ0KSB7XHJcblx0XHRcdFx0JGRiLnJlbW92ZURvYyhhcnQsIHtcclxuXHRcdFx0XHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coXCJGZWhsZXI6IFwiICsgYXJ0LkFydG5hbWUgKyBcIiBuaWNodCBnZWzDtnNjaHRcIik7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZUFydGVuSW1wb3J0aWVyZW5adXLDvGNrQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gc2ljaGVyc3RlbGxlbiwgZGFzcyBlciBpbW1lciBlaW4genVyw7xjayBrZW5udFxyXG5cdGlmICghbG9jYWxTdG9yYWdlLnp1cnVlY2spIHtcclxuXHRcdGxvY2FsU3RvcmFnZS56dXJ1ZWNrID0gXCJCZW9iTGlzdGVcIjtcclxuXHR9XHJcblx0JC5tb2JpbGUubmF2aWdhdGUobG9jYWxTdG9yYWdlLnp1cnVlY2sgKyBcIi5odG1sXCIpO1xyXG5cdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuenVydWVjaztcclxufTtcclxuXHJcbndpbmRvdy5lbS5pbml0aWllcmVBcnRlbkltcG9ydGllcmVuID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIGFrdHVlbGxlIGF1cyBldm0gaG9sZW5cclxuXHQkLmFqYXgoe1xyXG5cdFx0dHlwZTogXCJHRVRcIixcclxuXHRcdHVybDogXCJodHRwOi8vYXJ0ZWlnZW5zY2hhZnRlbi5jaC9fbGlzdC9leHBvcnRfZXZtX2FydGVuL2V2YWJfYXJ0ZW4/aW5jbHVkZV9kb2NzPXRydWVcIixcclxuXHRcdGNvbnRlbnRUeXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG5cdH0pXHJcblx0LmRvbmUoZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0ZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XHJcblx0XHR3aW5kb3cuZW0uYXJ0ZW5fYXJ0ZW5kYiA9IGRhdGEuZG9jcztcclxuXHRcdHZhciBhcnRlbl9hcnRlbmRiX3JlZHV6aWVydCA9IHdpbmRvdy5lbS5yZWR1emllcmVBcnRlbmZlbGRlckF1ZkFydGdydXBwZVVuZE5hbWUod2luZG93LmVtLmFydGVuX2FydGVuZGIpO1xyXG5cdFx0Ly8gVGFiZWxsZSBhdWZiYXVlblxyXG5cdFx0JChcIiNhaV9hcnRlbmRiXCIpLmh0bWwod2luZG93LmVtLmVyc3RlbGxlVGFiZWxsZShhcnRlbl9hcnRlbmRiX3JlZHV6aWVydCwgXCJyZWZsb3dcIiwgXCJhaV9hcnRlbmRiX3RhYmVsbGVcIikpO1xyXG5cdFx0Ly8gaW5pdGlhbGlzaWVyZW5cclxuXHRcdCQoXCIjYWlfYXJ0ZW5kYl90YWJlbGxlXCIpLnRhYmxlKCk7XHJcblx0XHQvLyBBbnphaGwgYW56ZWlnZW5cclxuXHRcdCQoXCIjYWlfYXJ0ZW5kYl90aXRlbFwiKS5odG1sKFwiRXJzdGUgNTAgdm9uIFwiICsgd2luZG93LmVtLmFydGVuX2FydGVuZGIubGVuZ3RoICsgXCIgQXJ0ZW4gYXVzIGFydGVpZ2Vuc2NoYWZ0ZW4uY2g6XCIpO1xyXG5cclxuXHRcdC8vIGVpZ2VuZSBBcnRlbiBob2xlblxyXG5cdFx0Y29uc29sZS5sb2coXCJob2xlIEFydGVuIGF1cyBldmFiXCIpO1xyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLnZpZXcoJ2V2YWIvQXJ0bGlzdGU/aW5jbHVkZV9kb2NzPXRydWUnLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHQvLyBBcnRlbiBpbiBldmFiIGVybWl0dGVsblxyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFwidmVyYXJiZWl0ZSBBcnRlbiBhdXMgZXZhYlwiKTtcclxuXHRcdFx0XHR3aW5kb3cuZW0uYXJ0ZW5fZXZhYiA9IF8ubWFwKGRhdGEucm93cywgZnVuY3Rpb24ob2JqZWt0KSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gb2JqZWt0LmRvYztcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHR2YXIgYXJ0ZW5fZXZhYl9yZWR1emllcnQgPSB3aW5kb3cuZW0ucmVkdXppZXJlQXJ0ZW5mZWxkZXJBdWZBcnRncnVwcGVVbmROYW1lKHdpbmRvdy5lbS5hcnRlbl9ldmFiKTtcclxuXHRcdFx0XHQvLyBUYWJlbGxlIGF1ZmJhdWVuXHJcblx0XHRcdFx0JChcIiNhaV9ldmFiXCIpLmh0bWwod2luZG93LmVtLmVyc3RlbGxlVGFiZWxsZShhcnRlbl9ldmFiX3JlZHV6aWVydCwgXCJyZWZsb3dcIiwgXCJhaV9ldmFiX3RhYmVsbGVcIikpO1xyXG5cdFx0XHRcdC8vIGluaXRpYWxpc2llcmVuXHJcblx0XHRcdFx0JChcIiNhaV9ldmFiX3RhYmVsbGVcIikudGFibGUoKTtcclxuXHRcdFx0XHQvLyBBbnphaGwgYW56ZWlnZW5cclxuXHRcdFx0XHQkKFwiI2FpX2V2YWJfdGl0ZWxcIikuaHRtbChcIkVyc3RlIDUwIHZvbiBcIiArIHdpbmRvdy5lbS5hcnRlbl9ldmFiLmxlbmd0aCArIFwiIEFydGVuIGF1cyBhcnRiZW9iYWNodHVuZ2VuLmNoOlwiKTtcclxuXHJcblx0XHRcdFx0Ly8gZ2VtZWluc2FtZSBBcnRlbiBtaXQgdW50ZXJzY2hpZWRsaWNoZW0gTmFtZW4gb2RlciBBcnRncnVwcGUgZXJtaXR0ZWxuXHJcblx0XHRcdFx0Y29uc29sZS5sb2coXCJzdWNoZSBBcnRlbiBtaXQgVW50ZXJzY2hpZWRlblwiKTtcclxuXHRcdFx0XHR3aW5kb3cuZW0uYXJ0ZW5fZ2VtZWluc2FtX3VudGVyc2NoaWVkbGljaCA9IF8uZmlsdGVyKHdpbmRvdy5lbS5hcnRlbl9hcnRlbmRiLCBmdW5jdGlvbihhcnRfYXJ0ZW5kYikge1xyXG5cdFx0XHRcdFx0Zm9yICh2YXIgaSBpbiB3aW5kb3cuZW0uYXJ0ZW5fZXZhYikge1xyXG5cdFx0XHRcdFx0XHR2YXIgYXJ0X2V2YWIgPSB3aW5kb3cuZW0uYXJ0ZW5fZXZhYltpXTtcclxuXHRcdFx0XHRcdFx0aWYgKGFydF9ldmFiLl9pZCA9PT0gYXJ0X2FydGVuZGIuX2lkICYmIChhcnRfZXZhYi5BcnRHcnVwcGUgIT09IGFydF9hcnRlbmRiLkFydEdydXBwZSB8fCBhcnRfZXZhYi5BcnRuYW1lICE9PSBhcnRfYXJ0ZW5kYi5BcnRuYW1lKSkge1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0aWYgKHdpbmRvdy5lbS5hcnRlbl9nZW1laW5zYW1fdW50ZXJzY2hpZWRsaWNoLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHRcdHZhciBhcnRlbl9nZW1laW5zYW1fdW50ZXJzY2hpZWRsaWNoX3JlZHV6aWVydCA9IHdpbmRvdy5lbS5yZWR1emllcmVBcnRlbmZlbGRlckF1ZkFydGdydXBwZVVuZE5hbWUod2luZG93LmVtLmFydGVuX2dlbWVpbnNhbV91bnRlcnNjaGllZGxpY2gpO1xyXG5cdFx0XHRcdFx0Ly8gVGFiZWxsZSBhdWZiYXVlblxyXG5cdFx0XHRcdFx0JChcIiNhaV9hcnRlbl9nZW1laW5zYW1fdW50ZXJzY2hpZWRsaWNoXCIpLmh0bWwod2luZG93LmVtLmVyc3RlbGxlVGFiZWxsZShhcnRlbl9nZW1laW5zYW1fdW50ZXJzY2hpZWRsaWNoX3JlZHV6aWVydCwgXCJyZWZsb3dcIiwgXCJhaV9hcnRlbl9nZW1laW5zYW1fdW50ZXJzY2hpZWRsaWNoX3RhYmVsbGVcIikpO1xyXG5cdFx0XHRcdFx0Ly8gaW5pdGlhbGlzaWVyZW5cclxuXHRcdFx0XHRcdCQoXCIjYWlfYXJ0ZW5fZ2VtZWluc2FtX3VudGVyc2NoaWVkbGljaF90YWJlbGxlXCIpLnRhYmxlKCk7XHJcblx0XHRcdFx0XHQvLyBTY2hhbHRmbMOkY2hlIGVpbnNjaGFsdGVuXHJcblx0XHRcdFx0XHQkKFwiI2FpX2FydGVuX2dlbWVpbnNhbV91bnRlcnNjaGllZGxpY2hfYWt0dWFsaXNpZXJlblwiKS5idXR0b24oXCJlbmFibGVcIik7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdC8vIHAgbWl0bGllZmVybiwgZGFtaXQgZGVyIFRleHQgZ2xlaWNoIGVpbmdlcsO8Y2t0IHdpcmQsIHdpZSBkZXIgVGl0ZWwgZGFyw7xiZXJcclxuXHRcdFx0XHRcdCQoXCIjYWlfYXJ0ZW5fZ2VtZWluc2FtX3VudGVyc2NoaWVkbGljaFwiKS5odG1sKFwiPHA+RXJmb2xnOjxicj5BbGxlIGdlbWVpbnNhbWVuIEFydGVuIGhhYmVuIGRlbnNlbGJlbiBOYW1lbiB1bmQgZGllc2VsYmUgQXJ0Z3J1cHBlITwvcD5cIik7XHJcblx0XHRcdFx0XHQkKFwiI2FpX2FydGVuX2dlbWVpbnNhbV91bnRlcnNjaGllZGxpY2hfYWt0dWFsaXNpZXJlblwiKS5idXR0b24oXCJkaXNhYmxlXCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQvLyBBbnphaGwgYW56ZWlnZW5cclxuXHRcdFx0XHQkKFwiI2FpX2FydGVuX2dlbWVpbnNhbV91bnRlcnNjaGllZGxpY2hfdGl0ZWxcIikuaHRtbChcIkVyc3RlIDUwIHZvbiBcIiArIHdpbmRvdy5lbS5hcnRlbl9nZW1laW5zYW1fdW50ZXJzY2hpZWRsaWNoLmxlbmd0aCArIFwiIGdlbWVpbnNhbWVuIEFydGVuPGJyPm1pdCB1bnRlcnNjaGllZGxpY2hlciBBcnRncnVwcGUgb2RlciBBcnRuYW1lOlwiKTtcclxuXHJcblx0XHRcdFx0Ly8gQXJ0ZW4gYXVzIGFydGVuZGIsIGRpZSBpbiBldmFiIGZlaGxlblxyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFwic3VjaGUgQXJ0ZW4sIGRpZSBpbiBldmFiIGZlaGxlblwiKTtcclxuXHRcdFx0XHR3aW5kb3cuZW0uYXJ0ZW5fZmVobGVuX2luX2V2YWIgPSBfLnJlamVjdCh3aW5kb3cuZW0uYXJ0ZW5fYXJ0ZW5kYiwgZnVuY3Rpb24oYXJ0X2FydGVuZGIpIHtcclxuXHRcdFx0XHRcdGZvciAodmFyIGkgaW4gd2luZG93LmVtLmFydGVuX2V2YWIpIHtcclxuXHRcdFx0XHRcdFx0aWYgKHdpbmRvdy5lbS5hcnRlbl9ldmFiW2ldLl9pZCA9PT0gYXJ0X2FydGVuZGIuX2lkKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRpZiAod2luZG93LmVtLmFydGVuX2ZlaGxlbl9pbl9ldmFiLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHRcdHZhciBhcnRlbl9mZWhsZW5faW5fZXZhYl9yZWR1emllcnQgPSB3aW5kb3cuZW0ucmVkdXppZXJlQXJ0ZW5mZWxkZXJBdWZBcnRncnVwcGVVbmROYW1lKHdpbmRvdy5lbS5hcnRlbl9mZWhsZW5faW5fZXZhYik7XHJcblx0XHRcdFx0XHQvLyBUYWJlbGxlIGF1ZmJhdWVuXHJcblx0XHRcdFx0XHQkKFwiI2FpX2ZlaGxlbl9pbl9ldmFiXCIpLmh0bWwod2luZG93LmVtLmVyc3RlbGxlVGFiZWxsZShhcnRlbl9mZWhsZW5faW5fZXZhYl9yZWR1emllcnQsIFwicmVmbG93XCIsIFwiYWlfZmVobGVuX2luX2V2YWJfdGFiZWxsZVwiKSk7XHJcblx0XHRcdFx0XHQvLyBpbml0aWFsaXNpZXJlblxyXG5cdFx0XHRcdFx0JChcIiNhaV9mZWhsZW5faW5fZXZhYl90YWJlbGxlXCIpLnRhYmxlKCk7XHJcblx0XHRcdFx0XHQvLyBTY2hhbHRmbMOkY2hlIGVpbnNjaGFsdGVuXHJcblx0XHRcdFx0XHQkKFwiI2FpX2ZlaGxlbl9pbl9ldmFiX2ltcG9ydGllcmVuXCIpLmJ1dHRvbihcImVuYWJsZVwiKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0Ly8gcCBtaXRsaWVmZXJuLCBkYW1pdCBkZXIgVGV4dCBnbGVpY2ggZWluZ2Vyw7xja3Qgd2lyZCwgd2llIGRlciBUaXRlbCBkYXLDvGJlclxyXG5cdFx0XHRcdFx0JChcIiNhaV9mZWhsZW5faW5fZXZhYlwiKS5odG1sKFwiPHA+RXJmb2xnOjxicj5hcnRiZW9iYWNodHVuZ2VuLmNoIGVudGjDpGx0IHNjaG9uIGFsbGUgQXJ0ZW4gYXVzIGFydGVpZ2Vuc2NoYWZ0ZW4uY2ghPC9wPlwiKTtcclxuXHRcdFx0XHRcdCQoXCIjYWlfZmVobGVuX2luX2V2YWJfaW1wb3J0aWVyZW5cIikuYnV0dG9uKFwiZGlzYWJsZVwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Ly8gQW56YWhsIGFuemVpZ2VuXHJcblx0XHRcdFx0JChcIiNhaV9mZWhsZW5faW5fZXZhYl90aXRlbFwiKS5odG1sKFwiRXJzdGUgNTAgdm9uIFwiICsgd2luZG93LmVtLmFydGVuX2ZlaGxlbl9pbl9ldmFiLmxlbmd0aCArIFwiIEFydGVuIGF1cyBhcnRlaWdlbnNjaGFmdGVuLmNoLCBkaWUgaW4gYXJ0YmVvYmFjaHR1bmdlbi5jaCBmZWhsZW46XCIpO1xyXG5cclxuXHRcdFx0XHQvLyBBcnRlbiBhdXMgZXZhYiwgZGllIGluIGFydGVuZGIgZmVobGVuXHJcblx0XHRcdFx0Y29uc29sZS5sb2coXCJzdWNoZSBBcnRlbiwgZGllIGluIGFydGVuZGIgZmVobGVuXCIpO1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5hcnRlbl9mZWhsZW5faW5fYXJ0ZW5kYiA9IF8ucmVqZWN0KHdpbmRvdy5lbS5hcnRlbl9ldmFiLCBmdW5jdGlvbihhcnRfZXZhYikge1xyXG5cdFx0XHRcdFx0Ly8gZWlnZW5lIHVuZCB1bmJla2FubnRlIEFydGVuIGlnbm9yaWVyZW5cclxuXHRcdFx0XHRcdGlmIChhcnRfZXZhYi5BcnRuYW1lLnN1YnN0cmluZygwLCA2KSA9PT0gXCJFaWdlbmVcIiB8fCBhcnRfZXZhYi5BcnRuYW1lLnN1YnN0cmluZygwLCA5KSA9PT0gXCJVbmJla2FubnRcIikge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGZvciAodmFyIGkgaW4gd2luZG93LmVtLmFydGVuX2FydGVuZGIpIHtcclxuXHRcdFx0XHRcdFx0aWYgKHdpbmRvdy5lbS5hcnRlbl9hcnRlbmRiW2ldLl9pZCA9PT0gYXJ0X2V2YWIuX2lkKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRpZiAod2luZG93LmVtLmFydGVuX2ZlaGxlbl9pbl9hcnRlbmRiLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHRcdHZhciBhcnRlbl9mZWhsZW5faW5fYXJ0ZW5kYl9yZWR1emllcnQgPSB3aW5kb3cuZW0ucmVkdXppZXJlQXJ0ZW5mZWxkZXJBdWZBcnRncnVwcGVVbmROYW1lKHdpbmRvdy5lbS5hcnRlbl9mZWhsZW5faW5fYXJ0ZW5kYik7XHJcblx0XHRcdFx0XHQvLyBUYWJlbGxlIGF1ZmJhdWVuXHJcblx0XHRcdFx0XHQkKFwiI2FpX2ZlaGxlbl9pbl9hcnRlbmRiXCIpLmh0bWwod2luZG93LmVtLmVyc3RlbGxlVGFiZWxsZShhcnRlbl9mZWhsZW5faW5fYXJ0ZW5kYl9yZWR1emllcnQsIFwicmVmbG93XCIsIFwiYWlfZmVobGVuX2luX2FydGVuZGJfdGFiZWxsZVwiKSk7XHJcblx0XHRcdFx0XHQvLyBpbml0aWFsaXNpZXJlblxyXG5cdFx0XHRcdFx0JChcIiNhaV9mZWhsZW5faW5fYXJ0ZW5kYl90YWJlbGxlXCIpLnRhYmxlKCk7XHJcblx0XHRcdFx0XHQvLyBTY2hhbHRmbMOkY2hlIGVpbnNjaGFsdGVuXHJcblx0XHRcdFx0XHQkKFwiI2FpX2ZlaGxlbl9pbl9hcnRlbmRiX2V4cG9ydGllcmVuXCIpLmJ1dHRvbihcImVuYWJsZVwiKTtcclxuXHRcdFx0XHRcdCQoXCIjYWlfZmVobGVuX2luX2FydGVuZGJfZXhwb3J0aWVyZW5faGlud2Vpc1wiKS5zaG93KCk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdC8vIHAgbWl0bGllZmVybiwgZGFtaXQgZGVyIFRleHQgZ2xlaWNoIGVpbmdlcsO8Y2t0IHdpcmQsIHdpZSBkZXIgVGl0ZWwgZGFyw7xiZXJcclxuXHRcdFx0XHRcdCQoXCIjYWlfZmVobGVuX2luX2FydGVuZGJcIikuaHRtbChcIjxwPkVyZm9sZzo8YnI+YXJ0YmVvYmFjaHR1bmdlbi5jaCBlbnRow6RsdCBrZWluZSBBcnRlbiwgZGllIGluIGFydGVpZ2Vuc2NoYWZ0ZW4uY2ggbmljaHQgdm9ya29tbWVuITwvcD5cIik7XHJcblx0XHRcdFx0XHQkKFwiI2FpX2ZlaGxlbl9pbl9hcnRlbmRiX2V4cG9ydGllcmVuXCIpLmJ1dHRvbihcImRpc2FibGVcIik7XHJcblx0XHRcdFx0XHQkKFwiI2FpX2ZlaGxlbl9pbl9hcnRlbmRiX2V4cG9ydGllcmVuX2hpbndlaXNcIikuaGlkZSgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQvLyBBbnphaGwgYW56ZWlnZW5cclxuXHRcdFx0XHQkKFwiI2FpX2ZlaGxlbl9pbl9hcnRlbmRiX3RpdGVsXCIpLmh0bWwoXCJFcnN0ZSA1MCB2b24gXCIgKyB3aW5kb3cuZW0uYXJ0ZW5fZmVobGVuX2luX2FydGVuZGIubGVuZ3RoICsgXCIgQXJ0ZW4gYXVzIGFydGJlb2JhY2h0dW5nZW4uY2gsIGRpZSBpbiBhcnRlaWdlbnNjaGFmdGVuLmNoIGZlaGxlbjpcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0pXHJcblx0LmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRjb25zb2xlLmxvZyhcIkZlaGxlcjoga2VpbmUgQXJ0ZW4gZXJoYWx0ZW5cIik7XHJcblx0fSk7XHJcbn07XHJcblxyXG53aW5kb3cuZW0ucmVkdXppZXJlQXJ0ZW5mZWxkZXJBdWZBcnRncnVwcGVVbmROYW1lID0gZnVuY3Rpb24oYXJ0ZW4pIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gZGEgZXMgc292aWVsZSBBcnRlbiBnaWJ0LCBudXIgZGllIGVyc3RlbiA1MCB2ZXJhcmJlaXRlbiB1bmQgYW56ZWlnZW5cclxuXHR2YXIgZXJzdGVfZsO8bmZ6aWdfYXJ0ZW4gPSBfLmZpcnN0KGFydGVuLCA1MCk7XHJcblx0cmV0dXJuIF8ubWFwKGVyc3RlX2bDvG5memlnX2FydGVuLCBmdW5jdGlvbihhcnQpIHtcclxuXHRcdHZhciBhcnRfcmV0dXJuID0ge307XHJcblx0XHRhcnRfcmV0dXJuLkFydGdydXBwZSA9IGFydC5BcnRHcnVwcGU7XHJcblx0XHRhcnRfcmV0dXJuLkFydG5hbWUgPSBhcnQuQXJ0bmFtZTtcclxuXHRcdHJldHVybiBhcnRfcmV0dXJuO1xyXG5cdH0pO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZUFydGVuZ3J1cHBlbkltcG9ydGllcmVuUGFnZXNob3cgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdH1cclxuXHR3aW5kb3cuZW0uaW5pdGlpZXJlQXJ0ZW5ncnVwcGVuSW1wb3J0aWVyZW4oKTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5oYW5kbGVBcnRlbmdydXBwZW5JbXBvcnRpZXJlblBhZ2Vpbml0ID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIFdpcmQgZGllc2UgU2VpdGUgZGlyZWt0IGF1ZmdlcnVmZW4gdW5kIGVzIGdpYnQga2VpbmVuIGxvY2FsU3RvcmFnZSxcclxuXHQvLyBtdXNzIGF1ZiBpbmRleC5odG1sIHVtZ2VsZWl0ZXQgd2VyZGVuXHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdH1cclxuXHJcblx0JChcIiNBcnRlbmdydXBwZW5JbXBvcnRpZXJlbkhlYWRlclwiKVxyXG4gICAgICAgIC8vIHp1csO8Y2stQnV0dG9uIHN0ZXVlcm5cclxuICAgICAgICAub24oJ2NsaWNrJywgJyN6dXLDvGNrQXJ0ZW5ncnVwcGVuSW1wb3J0aWVyZW4nLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgd2luZG93LmVtLmhhbmRsZUFydGVuZ3J1cHBlbkltcG9ydGllcmVuWnVyw7xja0NsaWNrKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG5cdCQoZG9jdW1lbnQpXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcjYWdpX2dlbWVpbnNhbV9hbnphcnRlbl9ha3R1YWxpc2llcmVuJywgd2luZG93LmVtLmFrdHVhbGlzaWVyZUFuemFobEFydGVuVm9uQXJ0ZW5ncnVwcGVuKTtcclxuXHJcbiAgICAkKFwiI0FydGVuZ3J1cHBlbkltcG9ydGllcmVuQ29udGVudFwiKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnI2FnaV9mZWhsZW5faW5fZXZhYl9pbXBvcnRpZXJlbicsIHdpbmRvdy5lbS5pbXBvcnRpZXJlRmVobGVuZGVBcnRlbmdydXBwZW4pXHJcbiAgICAgICAgLm9uKCdjbGljaycsICcjYWdpX2ZlaGxlbl9pbl9hcnRlbmRiX2V4cG9ydGllcmVuJywgd2luZG93LmVtLmV4cG9ydGllcmVCZW9iVm9uSW5BcnRlbmRiRmVobGVuZGVuQXJ0ZW5ncnVwcGVuKTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5leHBvcnRpZXJlQmVvYlZvbkluQXJ0ZW5kYkZlaGxlbmRlbkFydGVuZ3J1cHBlbiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRjb25zb2xlLmxvZyhcIndpbmRvdy5lbS5leHBvcnRpZXJlQmVvYlZvbkluQXJ0ZW5kYkZlaGxlbmRlbkFydGVuZ3J1cHBlblwiKTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5pbXBvcnRpZXJlRmVobGVuZGVBcnRlbmdydXBwZW4gPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKHdpbmRvdy5lbS5hcnRncnVwcGVuX2ZlaGxlbl9pbl9ldmFiLmxlbmd0aCA9PT0gMCkge1xyXG5cdFx0d2luZG93LmVtLm1lbGRlKFwiQWt0aW9uIGFiZ2Vicm9jaGVuOiBFcyBnaWJ0IGluIGFydGVpZ2Vuc2NoYWZ0ZW4uY2gga2VpbmUgQXJ0ZW5ncnVwcGVuLCBkaWUgaW4gYXJ0YmVvYmFjaHR1bmdlbi5jaCBmZWhsZW5cIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRfLmVhY2god2luZG93LmVtLmFydGdydXBwZW5fZmVobGVuX2luX2V2YWIsIGZ1bmN0aW9uKGFydGdydXBwZSkge1xyXG5cdFx0JGRiLnNhdmVEb2MoYXJ0Z3J1cHBlLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHdpbmRvdy5lbS5pbml0aWllcmVBcnRlbmdydXBwZW5JbXBvcnRpZXJlbigpO1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRmVobGVyOiBBcnRncnVwcGUgXCIgKyBhcnRncnVwcGVfYXJ0ZW5kYi5BcnRHcnVwcGUgKyBcIiBuaWNodCBha3R1YWxpc2llcnRcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0pO1xyXG59O1xyXG5cclxud2luZG93LmVtLmFrdHVhbGlzaWVyZUFuemFobEFydGVuVm9uQXJ0ZW5ncnVwcGVuID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdGlmICh3aW5kb3cuZW0uYXJ0Z3J1cHBlbl9nZW1laW5zYW1fYW56YXJ0ZW4ubGVuZ3RoID09PSAwKSB7XHJcblx0XHR3aW5kb3cuZW0ubWVsZGUoXCJBa3Rpb24gYWJnZWJyb2NoZW46IEVzIGdpYnQga2VpbmUgZ2VtZWluc2FtZW4gQXJ0ZW5ncnVwcGVuIG1pdCB1bnRlcnNjaGllZGxpY2hlciBBbnphaGwgQXJ0ZW5cIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHRfLmVhY2god2luZG93LmVtLmFydGdydXBwZW5fZ2VtZWluc2FtX2FuemFydGVuLCBmdW5jdGlvbihhcnRncnVwcGVfYXJ0ZW5kYikge1xyXG5cdFx0JGRiLm9wZW5Eb2MoYXJ0Z3J1cHBlX2FydGVuZGIuX2lkLCB7XHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGFydGdydXBwZV9ldmFiKSB7XHJcblx0XHRcdFx0YXJ0Z3J1cHBlX2V2YWIuQW56QXJ0ZW4gPSBhcnRncnVwcGVfYXJ0ZW5kYi5BbnpBcnRlbjtcclxuXHRcdFx0XHQkZGIuc2F2ZURvYyhhcnRncnVwcGVfZXZhYiwge1xyXG5cdFx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdHdpbmRvdy5lbS5pbml0aWllcmVBcnRlbmdydXBwZW5JbXBvcnRpZXJlbigpO1xyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRmVobGVyOiBBcnRncnVwcGUgXCIgKyBhcnRncnVwcGVfYXJ0ZW5kYi5BcnRHcnVwcGUgKyBcIiBuaWNodCBha3R1YWxpc2llcnRcIik7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0sXHJcblx0XHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJGZWhsZXI6IEFydGdydXBwZSBcIiArIGFydGdydXBwZV9hcnRlbmRiLkFydEdydXBwZSArIFwiIG5pY2h0IGFrdHVhbGlzaWVydFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRcdFx0XHJcblx0fSk7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uaGFuZGxlQXJ0ZW5ncnVwcGVuSW1wb3J0aWVyZW5adXLDvGNrQ2xpY2sgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gc2ljaGVyc3RlbGxlbiwgZGFzcyBlciBpbW1lciBlaW4genVyw7xjayBrZW5udFxyXG5cdGlmICghbG9jYWxTdG9yYWdlLnp1cnVlY2spIHtcclxuXHRcdGxvY2FsU3RvcmFnZS56dXJ1ZWNrID0gXCJCZW9iTGlzdGVcIjtcclxuXHR9XHJcblx0JC5tb2JpbGUubmF2aWdhdGUobG9jYWxTdG9yYWdlLnp1cnVlY2sgKyBcIi5odG1sXCIpO1xyXG5cdGRlbGV0ZSBsb2NhbFN0b3JhZ2UuenVydWVjaztcclxufTtcclxuXHJcbndpbmRvdy5lbS7DtmZmbmVBcnRlbmdydXBwZW5JbXBvcnRpZXJlbiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRsb2NhbFN0b3JhZ2UuenVydWVjayA9ICQoXCJib2R5XCIpLnBhZ2Vjb250YWluZXIoXCJnZXRBY3RpdmVQYWdlXCIpLmF0dHIoXCJpZFwiKTtcclxuXHQkLm1vYmlsZS5uYXZpZ2F0ZShcIkFydGVuZ3J1cHBlbkltcG9ydGllcmVuLmh0bWxcIik7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uw7ZmZm5lQWRtaW4gPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLnp1cnVlY2sgPSAkKFwiYm9keVwiKS5wYWdlY29udGFpbmVyKFwiZ2V0QWN0aXZlUGFnZVwiKS5hdHRyKFwiaWRcIik7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJhZG1pbi5odG1sXCIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZUFkbWluUGFnZXNob3cgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0aWYgKGxvY2FsU3RvcmFnZS5sZW5ndGggPT09IDAgfHwgIWxvY2FsU3RvcmFnZS5FbWFpbCkge1xyXG5cdFx0d2luZG93LmVtLmxlZXJlQWxsZVZhcmlhYmVsbigpO1xyXG5cdFx0JC5tb2JpbGUubmF2aWdhdGUoXCJpbmRleC5odG1sXCIpO1xyXG5cdH1cclxuXHQvL3dpbmRvdy5lbS5pbml0aWllcmVBZG1pbigpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZUFkbWluUGFnZWluaXQgPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0Ly8gV2lyZCBkaWVzZSBTZWl0ZSBkaXJla3QgYXVmZ2VydWZlbiB1bmQgZXMgZ2lidCBrZWluZW4gbG9jYWxTdG9yYWdlLFxyXG5cdC8vIG11c3MgYXVmIGluZGV4Lmh0bWwgdW1nZWxlaXRldCB3ZXJkZW5cclxuXHRpZiAobG9jYWxTdG9yYWdlLmxlbmd0aCA9PT0gMCB8fCAhbG9jYWxTdG9yYWdlLkVtYWlsKSB7XHJcblx0XHR3aW5kb3cuZW0ubGVlcmVBbGxlVmFyaWFiZWxuKCk7XHJcblx0XHQkLm1vYmlsZS5uYXZpZ2F0ZShcImluZGV4Lmh0bWxcIik7XHJcblx0fVxyXG5cclxuXHQkKFwiI0FkbWluSGVhZGVyXCIpXHJcbiAgICAgICAgLy8genVyw7xjay1CdXR0b24gc3RldWVyblxyXG4gICAgICAgIC5vbignY2xpY2snLCAnI3p1csO8Y2tBZG1pbicsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB3aW5kb3cuZW0uaGFuZGxlQWRtaW5adXLDvGNrQ2xpY2soKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAkKFwiI0FkbWluQ29udGVudFwiKVxyXG4gICAgICAgIC5vbignY2xpY2snLCAnI2FkbWluX2Jlb2JfZWluZXNfdXNlcnNfZW50ZmVybmVuJywgd2luZG93LmVtLmVudGZlcm5lRG9rdW1lbnRlRWluZXNVc2VycylcclxuICAgICAgICAub24oJ2NsaWNrJywgJyNhZG1pbl91c2VyX2VudGZlcm5lbicsIHdpbmRvdy5lbS5lbnRmZXJuZVVzZXIpO1xyXG59O1xyXG5cclxud2luZG93LmVtLmhhbmRsZUFkbWluWnVyw7xja0NsaWNrID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdC8vIHNpY2hlcnN0ZWxsZW4sIGRhc3MgZXIgaW1tZXIgZWluIHp1csO8Y2sga2VubnRcclxuXHRpZiAoIWxvY2FsU3RvcmFnZS56dXJ1ZWNrKSB7XHJcblx0XHRsb2NhbFN0b3JhZ2UuenVydWVjayA9IFwiQmVvYkxpc3RlXCI7XHJcblx0fVxyXG5cdCQubW9iaWxlLm5hdmlnYXRlKGxvY2FsU3RvcmFnZS56dXJ1ZWNrICsgXCIuaHRtbFwiKTtcclxuXHRkZWxldGUgbG9jYWxTdG9yYWdlLnp1cnVlY2s7XHJcbn07XHJcblxyXG53aW5kb3cuZW0uZW50ZmVybmVEb2t1bWVudGVFaW5lc1VzZXJzID0gZnVuY3Rpb24oKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cdHZhciB1c2VyID0gJChcIiNhZG1pbl9iZW9iX2VpbmVzX3VzZXJzX2VudGZlcm5lbl91c2VyXCIpLnZhbCgpO1xyXG5cdGlmICghdXNlcikge1xyXG5cdFx0d2luZG93LmVtLm1lbGRlKFwiQml0dGUgVXNlciBlaW5nZWJlblwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdCRkYi52aWV3KCdldmFiL1VzZXJEb2NzP2tleT1cIicgKyB1c2VyICsgJ1wiJmRlc2NlbmRpbmc9dHJ1ZSZpbmNsdWRlX2RvY3M9dHJ1ZSZyZWR1Y2U9ZmFsc2UnLCB7XHJcblx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdHZhciBkb2t1bWVudGVuID0gZGF0YS5yb3dzLFxyXG5cdFx0XHRcdGZlaGxlciA9IDAsXHJcblx0XHRcdFx0Z2Vsw7ZzY2h0ID0gMDtcclxuXHRcdFx0JChcIiNhZG1pbl91c2VyX2VudGZlcm5lbl9yw7xja21lbGR1bmdcIikuaHRtbChcIkRva3VtZW50ZTogR2Vsw7ZzY2h0OiBcIiArIGdlbMO2c2NodCArIFwiLCBGZWhsZXI6IFwiICsgZmVobGVyICsgXCIgdm9uIFwiICsgZG9rdW1lbnRlbi5sZW5ndGgpO1xyXG5cdFx0XHRfLmVhY2goZG9rdW1lbnRlbiwgZnVuY3Rpb24gKGRvYykge1xyXG5cdFx0XHRcdCRkYi5yZW1vdmVEb2MoZG9jLmRvYywge1xyXG5cdFx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdGdlbMO2c2NodCArKztcclxuXHRcdFx0XHRcdFx0JChcIiNhZG1pbl91c2VyX2VudGZlcm5lbl9yw7xja21lbGR1bmdcIikuaHRtbChcIkRva3VtZW50ZTogR2Vsw7ZzY2h0OiBcIiArIGdlbMO2c2NodCArIFwiLCBGZWhsZXI6IFwiICsgZmVobGVyICsgXCIgdm9uIFwiICsgZG9rdW1lbnRlbi5sZW5ndGgpO1xyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdFx0ZmVobGVyICsrO1xyXG5cdFx0XHRcdFx0XHQkKFwiI2FkbWluX3VzZXJfZW50ZmVybmVuX3LDvGNrbWVsZHVuZ1wiKS5odG1sKFwiRG9rdW1lbnRlOiBHZWzDtnNjaHQ6IFwiICsgZ2Vsw7ZzY2h0ICsgXCIsIEZlaGxlcjogXCIgKyBmZWhsZXIgKyBcIiB2b24gXCIgKyBkb2t1bWVudGVuLmxlbmd0aCk7XHJcblxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIEJlenVnIHp1IFVzZXJuIGF1cyBGZWxkZXJuIGVudGZlcm5lbiAodXNlcm5hbWUgaW4gQXJyYXlzKVxyXG5cdFx0XHQkZGIudmlldygnZXZhYi9Vc2VyRmVsZGVyTWl0RGF0ZW4/a2V5PVwiJyArIHVzZXIgKyAnXCImZGVzY2VuZGluZz10cnVlJmluY2x1ZGVfZG9jcz10cnVlJnJlZHVjZT1mYWxzZScsIHtcclxuXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdFx0XHR2YXIgZmVsZGVyID0gZGF0YS5yb3dzLFxyXG5cdFx0XHRcdFx0XHRmZWhsZXIgPSAwLFxyXG5cdFx0XHRcdFx0XHRnZWzDtnNjaHQgPSAwO1xyXG5cclxuXHRcdFx0XHRcdCQoXCIjYWRtaW5fdXNlcl9lbnRmZXJuZW5fcsO8Y2ttZWxkdW5nMlwiKS5odG1sKFwiRWluc3RlbGx1bmdlbiBpbiBGZWxkZXJuOiBHZWzDtnNjaHQ6IFwiICsgZ2Vsw7ZzY2h0ICsgXCIsIEZlaGxlcjogXCIgKyBmZWhsZXIgKyBcIiB2b24gXCIgKyBmZWxkZXIubGVuZ3RoKTtcclxuXHJcblx0XHRcdFx0XHRfLmVhY2goZmVsZGVyLCBmdW5jdGlvbihmZWxkKSB7XHJcblx0XHRcdFx0XHRcdGZlbGQgPSBmZWxkLmRvYztcclxuXHJcblx0XHRcdFx0XHRcdC8vIFVzZXIgYXVzIFNpY2h0YmFySW1Nb2R1c0VpbmZhY2ggZW50ZmVybmVuXHJcblx0XHRcdFx0XHRcdGlmIChmZWxkLlNpY2h0YmFySW1Nb2R1c0VpbmZhY2ggJiYgZmVsZC5TaWNodGJhckltTW9kdXNFaW5mYWNoLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZlbGQuU2ljaHRiYXJJbU1vZHVzRWluZmFjaCA9IF8ud2l0aG91dChmZWxkLlNpY2h0YmFySW1Nb2R1c0VpbmZhY2gsIHVzZXIpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0XHQvLyBVc2VyIGF1cyBTaWNodGJhckltTW9kdXNIaWVyYXJjaGlzY2ggZW50ZmVybmVuXHJcblx0XHRcdFx0XHRcdGlmIChmZWxkLlNpY2h0YmFySW1Nb2R1c0hpZXJhcmNoaXNjaCAmJiBmZWxkLlNpY2h0YmFySW1Nb2R1c0hpZXJhcmNoaXNjaC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmZWxkLlNpY2h0YmFySW1Nb2R1c0hpZXJhcmNoaXNjaCA9IF8ud2l0aG91dChmZWxkLlNpY2h0YmFySW1Nb2R1c0hpZXJhcmNoaXNjaCwgdXNlcik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVzZXIgYXVzIFNpY2h0YmFySW5IQXJ0RWRpdExpc3RlIGVudGZlcm5lblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmVsZC5TaWNodGJhckluSEFydEVkaXRMaXN0ZSAmJiBmZWxkLlNpY2h0YmFySW5IQXJ0RWRpdExpc3RlLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZlbGQuU2ljaHRiYXJJbkhBcnRFZGl0TGlzdGUgPSBfLndpdGhvdXQoZmVsZC5TaWNodGJhckluSEFydEVkaXRMaXN0ZSwgdXNlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcblx0XHRcdFx0XHRcdC8vIFVzZXIgYXVzIFN0YW5kYXJkd2VydCBlbnRmZXJuZW5cclxuXHRcdFx0XHRcdFx0aWYgKGZlbGQuU3RhbmRhcmR3ZXJ0ICYmIGZlbGQuU3RhbmRhcmR3ZXJ0W3VzZXJdKSB7XHJcblx0XHRcdFx0XHRcdFx0ZGVsZXRlIGZlbGQuU3RhbmRhcmR3ZXJ0W3VzZXJdO1xyXG5cdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0XHQkZGIuc2F2ZURvYyhmZWxkLCB7XHJcblx0XHRcdFx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRnZWzDtnNjaHQgKys7XHJcblx0XHRcdFx0XHRcdFx0XHQkKFwiI2FkbWluX3VzZXJfZW50ZmVybmVuX3LDvGNrbWVsZHVuZzJcIikuaHRtbChcIkVpbnN0ZWxsdW5nZW4gaW4gRmVsZGVybjogR2Vsw7ZzY2h0OiBcIiArIGdlbMO2c2NodCArIFwiLCBGZWhsZXI6IFwiICsgZmVobGVyICsgXCIgdm9uIFwiICsgZmVsZGVyLmxlbmd0aCk7XHJcblx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRmZWhsZXIgKys7XHJcblx0XHRcdFx0XHRcdFx0XHQkKFwiI2FkbWluX3VzZXJfZW50ZmVybmVuX3LDvGNrbWVsZHVuZzJcIikuaHRtbChcIkVpbnN0ZWxsdW5nZW4gaW4gRmVsZGVybjogR2Vsw7ZzY2h0OiBcIiArIGdlbMO2c2NodCArIFwiLCBGZWhsZXI6IFwiICsgZmVobGVyICsgXCIgdm9uIFwiICsgZmVsZGVyLmxlbmd0aCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRGllIEZlbGRlciBrb25udGVuIG5pY2h0IGFiZ2VydWZlbiB3ZXJkZW5cIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHR9LFxyXG5cdFx0ZXJyb3I6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJEaWUgRG9rdW1lbnRlIGRlcyBCZW51dHplcnMga29ubnRlbiBuaWNodCBhYmdlcnVmZW4gd2VyZGVuXCIpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxud2luZG93LmVtLmVudGZlcm5lVXNlciA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgdXNlciA9ICQoXCIjYWRtaW5fdXNlcl9lbnRmZXJuZW5fdXNlclwiKS52YWwoKTtcclxuXHRpZiAoIXVzZXIpIHtcclxuXHRcdHdpbmRvdy5lbS5tZWxkZShcIkJpdHRlIFVzZXIgZWluZ2ViZW5cIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdC8vIEtvbnRyb2xsaWVyZW4sIG9iIGRlciBVc2VyIG5vY2ggRG9rdW1lbnRlIGhhdFxyXG5cdHZhciAkZGIgPSAkLmNvdWNoLmRiKFwiZXZhYlwiKTtcclxuXHQkZGIudmlldygnZXZhYi9Vc2VyRG9jcz9rZXk9XCInICsgdXNlciArICdcIiZkZXNjZW5kaW5nPXRydWUmaW5jbHVkZV9kb2NzPXRydWUmcmVkdWNlPWZhbHNlJywge1xyXG5cdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRpZiAoZGF0YS5yb3dzLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJEaWVzZXIgVXNlciBoYXQgbm9jaCBEb2t1bWVudGUuIEJpdHRlIGRpZXNlIHp1ZXJzdCBlbnRmZXJuZW5cIik7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIGtvbnRyb2xsaWVyZW4sIG9iIGRlciBVc2VyIG5vY2ggRmVsZGVpbnN0ZWxsdW5nZW4gaGF0XHJcblx0XHRcdCRkYi52aWV3KCdldmFiL1VzZXJGZWxkZXJNaXREYXRlbj9rZXk9XCInICsgdXNlciArICdcIiZkZXNjZW5kaW5nPXRydWUmaW5jbHVkZV9kb2NzPXRydWUmcmVkdWNlPWZhbHNlJywge1xyXG5cdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRcdGlmIChkYXRhLnJvd3MubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJEaWVzZXIgVXNlciBoYXQgbm9jaCBFaW5zdGVsbHVuZ2VuIGluIEZlbGRlcm4uIEJpdHRlIGRpZXNlIHp1ZXJzdCBlbnRmZXJuZW5cIik7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdC8vIGRlciBCZW51dHplciBoYXQga2VpbmUgRGF0ZW4gbWVoci4gQmVudXR6ZXIgZW50ZmVybmVuXHJcblx0XHRcdFx0XHQkLmNvdWNoLnVzZXJEYihmdW5jdGlvbihkYikge1xyXG5cdFx0XHRcdFx0XHRkYi5vcGVuRG9jKFwib3JnLmNvdWNoZGIudXNlcjpcIiArIHVzZXIsIHtcclxuXHRcdFx0XHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiAoZG9jKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRkYi5yZW1vdmVEb2MoZG9jLCB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHdpbmRvdy5lbS5tZWxkZShcIkJlbnV0emVyIFwiICsgdXNlciArIFwiIHd1cmRlIGVudGZlcm50XCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRmVobGVyOiBCZW51dHplciBcIiArIHVzZXIgKyBcIiB3dXJkZSBuaWNodCBlbnRmZXJudFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHRlcnJvcjogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0d2luZG93LmVtLm1lbGRlKCdGZWhsZXI6IFVzZXIgd3VyZGUgbmljaHQgZ2VmdW5kZW4nKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHR3aW5kb3cuZW0ubWVsZGUoXCJEaWUgRmVsZGVyIGtvbm50ZW4gbmljaHQgYWJnZXJ1ZmVuIHdlcmRlblwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSxcclxuXHRcdGVycm9yOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0d2luZG93LmVtLm1lbGRlKFwiRmVobGVyOiBFcyBrb25udGUgbmljaHQga29udHJvbGxpZXJ0IHdlcmRlbiwgb2IgZGVyIEJlbnV0emVyIG5vY2ggQmVvYmFjaHR1bmdlbiBoYXRcIik7XHJcblx0XHR9XHJcblx0fSk7XHRcclxufTtcclxuXHJcbndpbmRvdy5lbS5pbml0aWllcmVBcnRlbmdydXBwZW5JbXBvcnRpZXJlbiA9IGZ1bmN0aW9uKCkge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHQvLyBha3R1ZWxsZSBhdXMgZXZtIGhvbGVuXHJcblx0JC5hamF4KHtcclxuXHRcdHR5cGU6IFwiR0VUXCIsXHJcblx0XHR1cmw6IFwiaHR0cDovL2FydGVpZ2Vuc2NoYWZ0ZW4uY2gvX2xpc3QvZXhwb3J0X2V2bV9hcnRncnVwcGVuL2FydGdydXBwZW4/Z3JvdXBfbGV2ZWw9MVwiLFxyXG5cdFx0Y29udGVudFR5cGU6IFwiYXBwbGljYXRpb24vanNvblwiXHJcblx0fSlcclxuXHQuZG9uZShmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRkYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcclxuXHRcdHdpbmRvdy5lbS5hcnRncnVwcGVuX2FydGVuZGIgPSBkYXRhLmRvY3M7XHJcblx0XHR2YXIgYXJ0Z3J1cHBlbl9hcnRlbmRiX3JlZHV6aWVydCA9IHdpbmRvdy5lbS5yZWR1emllcmVBcnRncnVwcGVuZmVsZGVyQXVmQXJ0Z3J1cHBlVW5kQW56YWhsKHdpbmRvdy5lbS5hcnRncnVwcGVuX2FydGVuZGIpO1xyXG5cdFx0Ly8gVGFiZWxsZSBhdWZiYXVlblxyXG5cdFx0JChcIiNhZ2lfYXJ0ZW5kYlwiKS5odG1sKHdpbmRvdy5lbS5lcnN0ZWxsZVRhYmVsbGUoYXJ0Z3J1cHBlbl9hcnRlbmRiX3JlZHV6aWVydCwgXCJyZWZsb3dcIiwgXCJhZ2lfYXJ0ZW5kYl90YWJlbGxlXCIpKTtcclxuXHRcdC8vIGluaXRpYWxpc2llcmVuXHJcblx0XHQkKFwiI2FnaV9hcnRlbmRiX3RhYmVsbGVcIikudGFibGUoKTtcclxuXHRcdC8vIEFuemFobCBhbnplaWdlblxyXG5cdFx0JChcIiNhZ2lfYXJ0ZW5kYl90aXRlbFwiKS5odG1sKFwiSW4gYXJ0ZWlnZW5zY2hhZnRlbi5jaDxicj52b3JoYW5kZW5lIEFydGVuZ3J1cHBlbiAoXCIgKyBhcnRncnVwcGVuX2FydGVuZGJfcmVkdXppZXJ0Lmxlbmd0aCArIFwiKTpcIik7XHJcblx0XHQvLyBlaWdlbmUgQXJ0Z3J1cHBlbiBob2xlblxyXG5cdFx0dmFyICRkYiA9ICQuY291Y2guZGIoXCJldmFiXCIpO1xyXG5cdFx0JGRiLnZpZXcoJ2V2YWIvQXJ0Z3J1cHBlbj9pbmNsdWRlX2RvY3M9dHJ1ZScsIHtcclxuXHRcdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdC8vIEFydGdydXBwZW4gaW4gZXZhYiBlcm1pdHRlbG5cclxuXHRcdFx0XHR3aW5kb3cuZW0uYXJ0Z3J1cHBlbl9ldmFiID0gXy5tYXAoZGF0YS5yb3dzLCBmdW5jdGlvbihvYmpla3QpIHtcclxuXHRcdFx0XHRcdHJldHVybiBvYmpla3QuZG9jO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdHZhciBhcnRncnVwcGVuX2V2YWJfcmVkdXppZXJ0ID0gd2luZG93LmVtLnJlZHV6aWVyZUFydGdydXBwZW5mZWxkZXJBdWZBcnRncnVwcGVVbmRBbnphaGwod2luZG93LmVtLmFydGdydXBwZW5fZXZhYik7XHJcblx0XHRcdFx0Ly8gVGFiZWxsZSBhdWZiYXVlblxyXG5cdFx0XHRcdCQoXCIjYWdpX2V2YWJcIikuaHRtbCh3aW5kb3cuZW0uZXJzdGVsbGVUYWJlbGxlKGFydGdydXBwZW5fZXZhYl9yZWR1emllcnQsIFwicmVmbG93XCIsIFwiYWdpX2V2YWJfdGFiZWxsZVwiKSk7XHJcblx0XHRcdFx0Ly8gaW5pdGlhbGlzaWVyZW5cclxuXHRcdFx0XHQkKFwiI2FnaV9ldmFiX3RhYmVsbGVcIikudGFibGUoKTtcclxuXHRcdFx0XHQvLyBBbnphaGwgYW56ZWlnZW5cclxuXHRcdFx0XHQkKFwiI2FnaV9ldmFiX3RpdGVsXCIpLmh0bWwoXCJJbiBhcnRiZW9iYWNodHVuZ2VuLmNoPGJyPnZvcmhhbmRlbmUgQXJ0ZW5ncnVwcGVuIChcIiArIGFydGdydXBwZW5fZXZhYl9yZWR1emllcnQubGVuZ3RoICsgXCIpOlwiKTtcclxuXHJcblx0XHRcdFx0Ly8gZ2VtZWluc2FtZSBBcnRncnVwcGVuIGVybWl0dGVsblxyXG5cdFx0XHRcdHdpbmRvdy5lbS5hcnRncnVwcGVuX2dlbWVpbnNhbSA9IF8uZmlsdGVyKHdpbmRvdy5lbS5hcnRncnVwcGVuX2V2YWIsIGZ1bmN0aW9uKGFydGdydXBwZV9ldmFiKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gXy5maWx0ZXIod2luZG93LmVtLmFydGdydXBwZW5fYXJ0ZW5kYiwgXy5tYXRjaGVzKGFydGdydXBwZV9ldmFiKSk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0aWYgKHdpbmRvdy5lbS5hcnRncnVwcGVuX2dlbWVpbnNhbS5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0XHR2YXIgYXJ0Z3J1cHBlbl9nZW1laW5zYW1fcmVkdXppZXJ0ID0gd2luZG93LmVtLnJlZHV6aWVyZUFydGdydXBwZW5mZWxkZXJBdWZBcnRncnVwcGVVbmRBbnphaGwod2luZG93LmVtLmFydGdydXBwZW5fZ2VtZWluc2FtKTtcclxuXHRcdFx0XHRcdC8vIFRhYmVsbGUgYXVmYmF1ZW5cclxuXHRcdFx0XHRcdCQoXCIjYWdpX2dlbWVpbnNhbVwiKS5odG1sKHdpbmRvdy5lbS5lcnN0ZWxsZVRhYmVsbGUoYXJ0Z3J1cHBlbl9nZW1laW5zYW1fcmVkdXppZXJ0LCBcInJlZmxvd1wiLCBcImFnaV9nZW1laW5zYW1fdGFiZWxsZVwiKSk7XHJcblx0XHRcdFx0XHQvLyBpbml0aWFsaXNpZXJlblxyXG5cdFx0XHRcdFx0JChcIiNhZ2lfZ2VtZWluc2FtX3RhYmVsbGVcIikudGFibGUoKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0JChcIiNhZ2lfZ2VtZWluc2FtXCIpLmh0bWwoXCI8cD5Pb3BzOiBFcyBnaWJ0IGtlaW5lIGdlbWVpbnNhbWVuIEFydGdydXBwZW4hPC9wPlwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Ly8gQW56YWhsIGFuemVpZ2VuXHJcblx0XHRcdFx0JChcIiNhZ2lfZ2VtZWluc2FtX3RpdGVsXCIpLmh0bWwoXCJHZW1laW5zYW1lPGJyPkFydGVuZ3J1cHBlbiAoXCIgKyB3aW5kb3cuZW0uYXJ0Z3J1cHBlbl9nZW1laW5zYW0ubGVuZ3RoICsgXCIpOlwiKTtcclxuXHJcblx0XHRcdFx0Ly8gZ2VtZWluc2FtZSBBcnRlbmdydXBwZW4gbWl0IHVudGVyc2NoaWVkbGljaGVyIEFuemFobCBBcnRlbiBlcm1pdHRlbG5cclxuXHRcdFx0XHR3aW5kb3cuZW0uYXJ0Z3J1cHBlbl9nZW1laW5zYW1fYW56YXJ0ZW4gPSBfLmZpbHRlcih3aW5kb3cuZW0uYXJ0Z3J1cHBlbl9hcnRlbmRiLCBmdW5jdGlvbihhcnRncnVwcGVfYXJ0ZW5kYikge1xyXG5cdFx0XHRcdFx0Zm9yICh2YXIgaSBpbiB3aW5kb3cuZW0uYXJ0Z3J1cHBlbl9ldmFiKSB7XHJcblx0XHRcdFx0XHRcdGlmICh3aW5kb3cuZW0uYXJ0Z3J1cHBlbl9ldmFiW2ldLkFydEdydXBwZSA9PT0gYXJ0Z3J1cHBlX2FydGVuZGIuQXJ0R3J1cHBlICYmIHdpbmRvdy5lbS5hcnRncnVwcGVuX2V2YWJbaV0uQW56QXJ0ZW4gIT09IGFydGdydXBwZV9hcnRlbmRiLkFuekFydGVuKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHR2YXIgYXJ0Z3J1cHBlbl9nZW1laW5zYW1fYW56YXJ0ZW5fcmVkdXppZXJ0ID0gXy5tYXAod2luZG93LmVtLmFydGdydXBwZW5fZ2VtZWluc2FtX2FuemFydGVuLCBmdW5jdGlvbihhcnRncnVwcGUpIHtcclxuXHRcdFx0XHRcdHZhciBhcnRncnVwcGVfcmV0dXJuID0ge307XHJcblx0XHRcdFx0XHRhcnRncnVwcGVfcmV0dXJuLkFydGdydXBwZSA9IGFydGdydXBwZS5BcnRHcnVwcGU7XHJcblx0XHRcdFx0XHRyZXR1cm4gYXJ0Z3J1cHBlX3JldHVybjtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRpZiAod2luZG93LmVtLmFydGdydXBwZW5fZ2VtZWluc2FtX2FuemFydGVuLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHRcdC8vIFRhYmVsbGUgYXVmYmF1ZW5cclxuXHRcdFx0XHRcdCQoXCIjYWdpX2dlbWVpbnNhbV9hbnphcnRlblwiKS5odG1sKHdpbmRvdy5lbS5lcnN0ZWxsZVRhYmVsbGUoYXJ0Z3J1cHBlbl9nZW1laW5zYW1fYW56YXJ0ZW5fcmVkdXppZXJ0LCBcInJlZmxvd1wiLCBcImFnaV9nZW1laW5zYW1fYW56YXJ0ZW5fdGFiZWxsZVwiKSk7XHJcblx0XHRcdFx0XHQvLyBpbml0aWFsaXNpZXJlblxyXG5cdFx0XHRcdFx0JChcIiNhZ2lfZ2VtZWluc2FtX2FuemFydGVuX3RhYmVsbGVcIikudGFibGUoKTtcclxuXHRcdFx0XHRcdC8vIFNjaGFsdGZsw6RjaGUgZWluc2NoYWx0ZW5cclxuXHRcdFx0XHRcdCQoXCIjYWdpX2dlbWVpbnNhbV9hbnphcnRlbl9ha3R1YWxpc2llcmVuXCIpLmJ1dHRvbihcImVuYWJsZVwiKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0Ly8gcCBtaXRsaWVmZXJuLCBkYW1pdCBkZXIgVGV4dCBnbGVpY2ggZWluZ2Vyw7xja3Qgd2lyZCwgd2llIGRlciBUaXRlbCBkYXLDvGJlclxyXG5cdFx0XHRcdFx0JChcIiNhZ2lfZ2VtZWluc2FtX2FuemFydGVuXCIpLmh0bWwoXCI8cD5FcmZvbGc6PGJyPkFsbGUgZ2VtZWluc2FtZW4gQXJ0ZW5ncnVwcGVuIHdlaXNlbiBkaWVzZWxiZSBBbnphaGwgQXJ0ZW4gYXVzITwvcD5cIik7XHJcblx0XHRcdFx0XHQkKFwiI2FnaV9nZW1laW5zYW1fYW56YXJ0ZW5fYWt0dWFsaXNpZXJlblwiKS5idXR0b24oXCJkaXNhYmxlXCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQvLyBBbnphaGwgYW56ZWlnZW5cclxuXHRcdFx0XHQkKFwiI2FnaV9nZW1laW5zYW1fYW56YXJ0ZW5fdGl0ZWxcIikuaHRtbChcIkdlbWVpbnNhbWUgQXJ0ZW5ncnVwcGVuPGJyPm1pdCB1bnRlcnNjaGllZGxpY2hlciBBbnouIEFydGVuIChcIiArIHdpbmRvdy5lbS5hcnRncnVwcGVuX2dlbWVpbnNhbV9hbnphcnRlbi5sZW5ndGggKyBcIik6XCIpO1xyXG5cclxuXHRcdFx0XHQvLyBBcnRlbmdydXBwZW4gYXVzIGFydGVuZGIsIGRpZSBpbiBldmFiIGZlaGxlblxyXG5cdFx0XHRcdHdpbmRvdy5lbS5hcnRncnVwcGVuX2ZlaGxlbl9pbl9ldmFiID0gXy5yZWplY3Qod2luZG93LmVtLmFydGdydXBwZW5fYXJ0ZW5kYiwgZnVuY3Rpb24oYXJ0Z3J1cHBlX2FydGVuZGIpIHtcclxuXHRcdFx0XHRcdGZvciAodmFyIGkgaW4gd2luZG93LmVtLmFydGdydXBwZW5fZXZhYikge1xyXG5cdFx0XHRcdFx0XHRpZiAod2luZG93LmVtLmFydGdydXBwZW5fZXZhYltpXS5BcnRHcnVwcGUgPT09IGFydGdydXBwZV9hcnRlbmRiLkFydEdydXBwZSkge1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0aWYgKHdpbmRvdy5lbS5hcnRncnVwcGVuX2ZlaGxlbl9pbl9ldmFiLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHRcdHZhciBhcnRncnVwcGVuX2ZlaGxlbl9pbl9ldmFiX3JlZHV6aWVydCA9IHdpbmRvdy5lbS5yZWR1emllcmVBcnRncnVwcGVuZmVsZGVyQXVmQXJ0Z3J1cHBlVW5kQW56YWhsKHdpbmRvdy5lbS5hcnRncnVwcGVuX2ZlaGxlbl9pbl9ldmFiKTtcclxuXHRcdFx0XHRcdC8vIFRhYmVsbGUgYXVmYmF1ZW5cclxuXHRcdFx0XHRcdCQoXCIjYWdpX2ZlaGxlbl9pbl9ldmFiXCIpLmh0bWwod2luZG93LmVtLmVyc3RlbGxlVGFiZWxsZShhcnRncnVwcGVuX2ZlaGxlbl9pbl9ldmFiX3JlZHV6aWVydCwgXCJyZWZsb3dcIiwgXCJhZ2lfZmVobGVuX2luX2V2YWJfdGFiZWxsZVwiKSk7XHJcblx0XHRcdFx0XHQvLyBpbml0aWFsaXNpZXJlblxyXG5cdFx0XHRcdFx0JChcIiNhZ2lfZmVobGVuX2luX2V2YWJfdGFiZWxsZVwiKS50YWJsZSgpO1xyXG5cdFx0XHRcdFx0Ly8gU2NoYWx0ZmzDpGNoZSBlaW5zY2hhbHRlblxyXG5cdFx0XHRcdFx0JChcIiNhZ2lfZmVobGVuX2luX2V2YWJfaW1wb3J0aWVyZW5cIikuYnV0dG9uKFwiZW5hYmxlXCIpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQvLyBwIG1pdGxpZWZlcm4sIGRhbWl0IGRlciBUZXh0IGdsZWljaCBlaW5nZXLDvGNrdCB3aXJkLCB3aWUgZGVyIFRpdGVsIGRhcsO8YmVyXHJcblx0XHRcdFx0XHQkKFwiI2FnaV9mZWhsZW5faW5fZXZhYlwiKS5odG1sKFwiPHA+RXJmb2xnOjxicj5hcnRiZW9iYWNodHVuZ2VuLmNoIGVudGjDpGx0IHNjaG9uIGFsbGUgQXJ0Z3J1cHBlbiBhdXMgYXJ0ZWlnZW5zY2hhZnRlbi5jaCE8L3A+XCIpO1xyXG5cdFx0XHRcdFx0JChcIiNhZ2lfZmVobGVuX2luX2V2YWJfaW1wb3J0aWVyZW5cIikuYnV0dG9uKFwiZGlzYWJsZVwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Ly8gQW56YWhsIGFuemVpZ2VuXHJcblx0XHRcdFx0JChcIiNhZ2lfZmVobGVuX2luX2V2YWJfdGl0ZWxcIikuaHRtbChcIkFydGVuZ3J1cHBlbiBhdXMgYXJ0ZWlnZW5zY2hhZnRlbi5jaCw8YnI+ZGllIGluIGFydGJlb2JhY2h0dW5nZW4uY2ggZmVobGVuIChcIiArIHdpbmRvdy5lbS5hcnRncnVwcGVuX2ZlaGxlbl9pbl9ldmFiLmxlbmd0aCArIFwiKTpcIik7XHJcblxyXG5cdFx0XHRcdC8vIEFydGVuZ3J1cHBlbiBhdXMgZXZhYiwgZGllIGluIGFydGVuZGIgZmVobGVuXHJcblx0XHRcdFx0d2luZG93LmVtLmFydGdydXBwZW5fZmVobGVuX2luX2FydGVuZGIgPSBfLnJlamVjdCh3aW5kb3cuZW0uYXJ0Z3J1cHBlbl9ldmFiLCBmdW5jdGlvbihhcnRncnVwcGVfZXZhYikge1xyXG5cdFx0XHRcdFx0Zm9yICh2YXIgaSBpbiB3aW5kb3cuZW0uYXJ0Z3J1cHBlbl9hcnRlbmRiKSB7XHJcblx0XHRcdFx0XHRcdGlmICh3aW5kb3cuZW0uYXJ0Z3J1cHBlbl9hcnRlbmRiW2ldLkFydEdydXBwZSA9PT0gYXJ0Z3J1cHBlX2V2YWIuQXJ0R3J1cHBlKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRpZiAod2luZG93LmVtLmFydGdydXBwZW5fZmVobGVuX2luX2FydGVuZGIubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0dmFyIGFydGdydXBwZW5fZmVobGVuX2luX2FydGVuZGJfcmVkdXppZXJ0ID0gd2luZG93LmVtLnJlZHV6aWVyZUFydGdydXBwZW5mZWxkZXJBdWZBcnRncnVwcGVVbmRBbnphaGwod2luZG93LmVtLmFydGdydXBwZW5fZmVobGVuX2luX2FydGVuZGIpO1xyXG5cdFx0XHRcdFx0Ly8gVGFiZWxsZSBhdWZiYXVlblxyXG5cdFx0XHRcdFx0JChcIiNhZ2lfZmVobGVuX2luX2FydGVuZGJcIikuaHRtbCh3aW5kb3cuZW0uZXJzdGVsbGVUYWJlbGxlKGFydGdydXBwZW5fZmVobGVuX2luX2FydGVuZGJfcmVkdXppZXJ0LCBcInJlZmxvd1wiLCBcImFnaV9mZWhsZW5faW5fYXJ0ZW5kYl90YWJlbGxlXCIpKTtcclxuXHRcdFx0XHRcdC8vIGluaXRpYWxpc2llcmVuXHJcblx0XHRcdFx0XHQkKFwiI2FnaV9mZWhsZW5faW5fYXJ0ZW5kYl90YWJlbGxlXCIpLnRhYmxlKCk7XHJcblx0XHRcdFx0XHQvLyBTY2hhbHRmbMOkY2hlIGVpbnNjaGFsdGVuXHJcblx0XHRcdFx0XHQkKFwiI2FnaV9mZWhsZW5faW5fYXJ0ZW5kYl9leHBvcnRpZXJlblwiKS5idXR0b24oXCJlbmFibGVcIik7XHJcblx0XHRcdFx0XHQkKFwiI2FnaV9mZWhsZW5faW5fYXJ0ZW5kYl9leHBvcnRpZXJlbl9oaW53ZWlzXCIpLnNob3coKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0Ly8gcCBtaXRsaWVmZXJuLCBkYW1pdCBkZXIgVGV4dCBnbGVpY2ggZWluZ2Vyw7xja3Qgd2lyZCwgd2llIGRlciBUaXRlbCBkYXLDvGJlclxyXG5cdFx0XHRcdFx0JChcIiNhZ2lfZmVobGVuX2luX2FydGVuZGJcIikuaHRtbChcIjxwPkVyZm9sZzo8YnI+YXJ0YmVvYmFjaHR1bmdlbi5jaCBlbnRow6RsdCBrZWluZSBBcnRncnVwcGVuLCBkaWUgaW4gYXJ0ZWlnZW5zY2hhZnRlbi5jaCBuaWNodCB2b3Jrb21tZW4hPC9wPlwiKTtcclxuXHRcdFx0XHRcdCQoXCIjYWdpX2ZlaGxlbl9pbl9hcnRlbmRiX2V4cG9ydGllcmVuXCIpLmJ1dHRvbihcImRpc2FibGVcIik7XHJcblx0XHRcdFx0XHQkKFwiI2FnaV9mZWhsZW5faW5fYXJ0ZW5kYl9leHBvcnRpZXJlbl9oaW53ZWlzXCIpLmhpZGUoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Ly8gQW56YWhsIGFuemVpZ2VuXHJcblx0XHRcdFx0JChcIiNhZ2lfZmVobGVuX2luX2FydGVuZGJfdGl0ZWxcIikuaHRtbChcIkFydGVuZ3J1cHBlbiBhdXMgYXJ0YmVvYmFjaHR1bmdlbi5jaCw8YnI+ZGllIGluIGFydGVpZ2Vuc2NoYWZ0ZW4uY2ggZmVobGVuIChcIiArIHdpbmRvdy5lbS5hcnRncnVwcGVuX2ZlaGxlbl9pbl9hcnRlbmRiLmxlbmd0aCArIFwiKTpcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0pXHJcblx0LmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRjb25zb2xlLmxvZyhcIkZlaGxlcjoga2VpbmUgQXJ0Z3J1cHBlbiBlcmhhbHRlblwiKTtcclxuXHR9KTtcclxufTtcclxuXHJcbndpbmRvdy5lbS5yZWR1emllcmVBcnRncnVwcGVuZmVsZGVyQXVmQXJ0Z3J1cHBlVW5kQW56YWhsID0gZnVuY3Rpb24oYXJ0Z3J1cHBlbikge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHRyZXR1cm4gXy5tYXAoYXJ0Z3J1cHBlbiwgZnVuY3Rpb24oYXJ0Z3J1cHBlKSB7XHJcblx0XHR2YXIgYXJ0Z3J1cHBlX3JldHVybiA9IHt9O1xyXG5cdFx0YXJ0Z3J1cHBlX3JldHVybi5BcnRncnVwcGUgPSBhcnRncnVwcGUuQXJ0R3J1cHBlO1xyXG5cdFx0YXJ0Z3J1cHBlX3JldHVybltcIkFuei4gQXJ0ZW5cIl0gPSBhcnRncnVwcGUuQW56QXJ0ZW47XHJcblx0XHRyZXR1cm4gYXJ0Z3J1cHBlX3JldHVybjtcclxuXHR9KVxyXG59O1xyXG5cclxuLy8gYmF1dCBUYWJlbGxlbiBhdWZcclxuLy8gb2JqZWt0ZTogQXJyYXkgdm9uIE9iamVrdGVuLCB3ZWxjaGUgZGllIGRhcnp1c3RlbGxlbmRlbiBGZWxkZXIgZW50aGFsdGVuXHJcbi8vIGRhdGFtb2RlOiBnZW3DpHNzIGpxbSwgc3RhbmRhcmQgPSByZWZsb3dcclxuLy8gdGFibGVfaWQ6IGRpZSBJRCB3aXJkIGJlbsO2dGlndCwgZGFtaXQgZGllIFRhYmVsbGUgbmFjaCBpaHJlciBFcnN0ZWxsdW5nIGluaXRpaWVydCB3ZXJkZW4ga2FublxyXG4vLyBjbGFzczogS2xhc3NlLCB3ZWxjaGUgZGllIERhcnN0ZWxsdW5nIGJlc3RpbW10LiBTdGFuZGFyZCBpc3Q6IHRhYmVsbGVfZ2VzdHJlaWZ0XHJcbndpbmRvdy5lbS5lcnN0ZWxsZVRhYmVsbGUgPSBmdW5jdGlvbihvYmpla3RlLCBkYXRhbW9kZSwgdGFibGVfaWQsIGNzc19jbGFzcykge1xyXG5cdCd1c2Ugc3RyaWN0JztcclxuXHR2YXIgaHRtbCxcclxuXHRcdGRhdGFtb2RlID0gZGF0YW1vZGUgfHwgXCJyZWZsb3dcIixcclxuXHRcdGNzc19jbGFzcyA9IGNzc19jbGFzcyB8fCBcInRhYmVsbGVfZ2VzdHJlaWZ0XCI7XHJcblx0Ly8gaHRtbCBmw7xyIFRhYmVsbGVuLWRpdlxyXG5cdGh0bWwgPSAnPHRhYmxlIGRhdGEtcm9sZT1cInRhYmxlXCInO1xyXG5cdGlmICh0YWJsZV9pZCkge1xyXG5cdFx0aHRtbCArPSAnIGlkPVwiJyArIHRhYmxlX2lkICsgJ1wiJztcclxuXHR9XHJcblx0aHRtbCArPSAnIGRhdGEtbW9kZT1cIicgKyBkYXRhbW9kZSArICdcIiBjbGFzcz1cInVpLXJlc3BvbnNpdmUgJyArIGNzc19jbGFzcyArICdcIj4nO1xyXG5cdC8vIGh0bWwgZsO8ciBkaWUgZXJzdGUgWmVpbGUgYmVnaW5uZW5cclxuXHRodG1sICs9ICc8dGhlYWQ+PHRyPic7XHJcblx0Ly8gaHRtbCBmw7xyIGRpZSBTcGFsdGVuLCBCaWVzcGllbDogPHRoPkFydGdydXBwZTwvdGg+PHRoPkFuemFobCBBcnRlbjwvdGg+XHJcblx0Xy5lYWNoKF8uZmlyc3Qob2JqZWt0ZSksIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcclxuXHRcdGh0bWwgKz0gJzx0aD4nICsga2V5ICsgJzwvdGg+JztcclxuXHR9KTtcclxuXHQvLyBodG1sIGbDvHIgZGllIGVyc3RlIFplaWxlIGFic2NobGllc3NlblxyXG5cdGh0bWwgKz0gJzwvdHI+PC90aGVhZD4nO1xyXG5cdC8vIFRhYmVsbGVuYm9keSBiZWdpbm5lblxyXG5cdGh0bWwgKz0gJzx0Ym9keT4nO1xyXG5cdC8vIGplZGUgWmVpbGUgXHJcblx0Xy5lYWNoKG9iamVrdGUsIGZ1bmN0aW9uKG9iamVrdCkge1xyXG5cdFx0aHRtbCArPSAnPHRyPic7XHJcblx0XHQvLyBhbGxlIFNwYWx0ZW5cclxuXHRcdF8uZWFjaChvYmpla3QsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcblx0XHRcdGh0bWwgKz0gJzx0ZD4nICsgdmFsdWUgKyAnPC90ZD4nO1xyXG5cdFx0fSk7XHJcblx0XHRodG1sICs9ICc8L3RyPic7XHJcblx0fSk7XHJcblx0Ly8gVGFiZWxsZW4tYm9keSB1bmQgZGl2IGFic2NobGllc3NlblxyXG5cdGh0bWwgKz0gJzwvdGJvZHk+PC90YWJsZT4nO1xyXG5cdHJldHVybiBodG1sO1xyXG59O1xyXG5cclxud2luZG93LmVtLsO2ZmZuZUFydGVuSW1wb3J0aWVyZW4gPSBmdW5jdGlvbigpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblx0bG9jYWxTdG9yYWdlLnp1cnVlY2sgPSAkKFwiYm9keVwiKS5wYWdlY29udGFpbmVyKFwiZ2V0QWN0aXZlUGFnZVwiKS5hdHRyKFwiaWRcIik7XHJcblx0JC5tb2JpbGUubmF2aWdhdGUoXCJBcnRlbkltcG9ydGllcmVuLmh0bWxcIik7XHJcbn07XHJcblxyXG4vKiFcclxuKiBqUXVlcnkgTW9iaWxlIEZyYW1ld29yayA6IGRyYWcgcGFnaW5hdGlvbiBwbHVnaW5cclxuKiBDb3B5cmlnaHQgKGMpIEZpbGFtZW50IEdyb3VwLCBJbmNcclxuKiBBdXRob3JlZCBieSBTY290dCBKZWhsLCBzY290dEBmaWxhbWVudGdyb3VwLmNvbVxyXG4qIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBvciBHUEwgVmVyc2lvbiAyIGxpY2Vuc2VzLlxyXG4qL1xyXG4oZnVuY3Rpb24oJCwgdW5kZWZpbmVkKSB7XHJcblxyXG5cdC8vIGF1dG8taW5pdCBvbiBwYWdlY3JlYXRlXHJcblx0JChkb2N1bWVudCkuYmluZChcInBhZ2VjcmVhdGVcIiwgZnVuY3Rpb24oZSkge1xyXG5cdFx0JChcIjpqcW1EYXRhKHJvbGU9J3BhZ2luYXRpb24nKVwiLCBlLnRhcmdldCkucGFnaW5hdGlvbigpO1xyXG5cdH0pO1xyXG5cclxuXHR2YXIgcGFnZVRpdGxlID0gXCJcIjtcclxuXHJcblx0Ly8gY3JlYXRlIHdpZGdldFxyXG5cdCQud2lkZ2V0KFwibW9iaWxlLnBhZ2luYXRpb25cIiwgJC5tb2JpbGUud2lkZ2V0LCB7XHJcblx0XHRfY3JlYXRlOiBmdW5jdGlvbigpIHtcclxuXHRcdFx0dmFyICRlbFx0XHRcdD0gdGhpcy5lbGVtZW50LFxyXG5cdFx0XHRcdCRwYWdlXHRcdD0gJGVsLmNsb3Nlc3QoXCIudWktcGFnZVwiKSxcclxuXHRcdFx0XHQkbGlua3NcdFx0PSAkZWwuZmluZChcImFcIiksXHJcblx0XHRcdFx0JG9yaWdpblx0XHQ9ICQubW9iaWxlLnBhZ2VDb250YWluZXIsXHJcblx0XHRcdFx0Y2xhc3NOU1x0XHQ9IFwidWktcGFnaW5hdGlvblwiLFxyXG5cdFx0XHRcdHByZXZMSUNsYXNzXHQ9IGNsYXNzTlMgKyBcIi1wcmV2XCIsXHJcblx0XHRcdFx0bmV4dExJQ2xhc3NcdD0gY2xhc3NOUyArIFwiLW5leHRcIixcclxuXHRcdFx0XHRwcmV2UENsYXNzXHQ9IFwidWktcGFnZS1wcmV2XCIsXHJcblx0XHRcdFx0bmV4dFBDbGFzc1x0PSBcInVpLXBhZ2UtbmV4dFwiLFxyXG5cdFx0XHRcdHNuYXBDbGFzc1x0PSBjbGFzc05TICsgXCItc25hcHBpbmdcIixcclxuXHRcdFx0XHRkcmFnQ2xhc3NcdD0gY2xhc3NOUyArIFwiLWRyYWdnaW5nXCIsXHJcblx0XHRcdFx0ZHJhZ0NsYXNzT25cdD0gZmFsc2UsXHJcblx0XHRcdFx0JG5leHRQYWdlLFxyXG5cdFx0XHRcdCRwcmV2UGFnZTtcclxuXHJcblx0XHRcdCRlbC5hZGRDbGFzcyhjbGFzc05TKTtcclxuXHJcblx0XHRcdC8vIHNldCB1cCBuZXh0IGFuZCBwcmV2IGJ1dHRvbnNcclxuXHJcblx0XHRcdCRsaW5rcy5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHZhciByZXZlcnNlID0gJCh0aGlzKS5jbG9zZXN0KFwiLlwiICsgcHJldkxJQ2xhc3MpLmxlbmd0aDtcclxuXHJcblx0XHRcdFx0JCh0aGlzKVxyXG5cdFx0XHRcdFx0LmJ1dHRvbk1hcmt1cCh7XHJcblx0XHRcdFx0XHRcdFwicm9sZVwiXHRcdDogXCJidXR0b25cIixcclxuXHRcdFx0XHRcdFx0XCJ0aGVtZVwiXHRcdDogXCJkXCIsXHJcblx0XHRcdFx0XHRcdFwiaWNvbnBvc1wiXHQ6IFwibm90ZXh0XCIsXHJcblx0XHRcdFx0XHRcdFwiaWNvblwiXHRcdDogXCJhcnJvdy1cIiArIChyZXZlcnNlID8gXCJsXCIgOiBcInJcIilcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHJcbn0oIGpRdWVyeSApKTtcclxuXHJcblxyXG4vKlxyXG4gKiBBIEphdmFTY3JpcHQgaW1wbGVtZW50YXRpb24gb2YgdGhlIFNlY3VyZSBIYXNoIEFsZ29yaXRobSwgU0hBLTEsIGFzIGRlZmluZWRcclxuICogaW4gRklQUyBQVUIgMTgwLTFcclxuICogVmVyc2lvbiAyLjFhIENvcHlyaWdodCBQYXVsIEpvaG5zdG9uIDIwMDAgLSAyMDAyLlxyXG4gKiBPdGhlciBjb250cmlidXRvcnM6IEdyZWcgSG9sdCwgQW5kcmV3IEtlcGVydCwgWWRuYXIsIExvc3RpbmV0XHJcbiAqIERpc3RyaWJ1dGVkIHVuZGVyIHRoZSBCU0QgTGljZW5zZVxyXG4gKiBTZWUgaHR0cDovL3BhamhvbWUub3JnLnVrL2NyeXB0L21kNSBmb3IgZGV0YWlscy5cclxuICovXHJcblxyXG4vKlxyXG4gKiBDb25maWd1cmFibGUgdmFyaWFibGVzLiBZb3UgbWF5IG5lZWQgdG8gdHdlYWsgdGhlc2UgdG8gYmUgY29tcGF0aWJsZSB3aXRoXHJcbiAqIHRoZSBzZXJ2ZXItc2lkZSwgYnV0IHRoZSBkZWZhdWx0cyB3b3JrIGluIG1vc3QgY2FzZXMuXHJcbiAqL1xyXG52YXIgaGV4Y2FzZSA9IDA7ICAvKiBoZXggb3V0cHV0IGZvcm1hdC4gMCAtIGxvd2VyY2FzZTsgMSAtIHVwcGVyY2FzZSAgICAgICAgKi9cclxudmFyIGI2NHBhZCAgPSBcIj1cIjsgLyogYmFzZS02NCBwYWQgY2hhcmFjdGVyLiBcIj1cIiBmb3Igc3RyaWN0IFJGQyBjb21wbGlhbmNlICAgKi9cclxudmFyIGNocnN6ICAgPSA4OyAgLyogYml0cyBwZXIgaW5wdXQgY2hhcmFjdGVyLiA4IC0gQVNDSUk7IDE2IC0gVW5pY29kZSAgICAgICovXHJcblxyXG4vKlxyXG4gKiBUaGVzZSBhcmUgdGhlIGZ1bmN0aW9ucyB5b3UnbGwgdXN1YWxseSB3YW50IHRvIGNhbGxcclxuICogVGhleSB0YWtlIHN0cmluZyBhcmd1bWVudHMgYW5kIHJldHVybiBlaXRoZXIgaGV4IG9yIGJhc2UtNjQgZW5jb2RlZCBzdHJpbmdzXHJcbiAqL1xyXG5mdW5jdGlvbiBoZXhfc2hhMShzKXtyZXR1cm4gYmluYjJoZXgoY29yZV9zaGExKHN0cjJiaW5iKHMpLHMubGVuZ3RoICogY2hyc3opKTt9XHJcbmZ1bmN0aW9uIGI2NF9zaGExKHMpe3JldHVybiBiaW5iMmI2NChjb3JlX3NoYTEoc3RyMmJpbmIocykscy5sZW5ndGggKiBjaHJzeikpO31cclxuZnVuY3Rpb24gc3RyX3NoYTEocyl7cmV0dXJuIGJpbmIyc3RyKGNvcmVfc2hhMShzdHIyYmluYihzKSxzLmxlbmd0aCAqIGNocnN6KSk7fVxyXG5mdW5jdGlvbiBoZXhfaG1hY19zaGExKGtleSwgZGF0YSl7IHJldHVybiBiaW5iMmhleChjb3JlX2htYWNfc2hhMShrZXksIGRhdGEpKTt9XHJcbmZ1bmN0aW9uIGI2NF9obWFjX3NoYTEoa2V5LCBkYXRhKXsgcmV0dXJuIGJpbmIyYjY0KGNvcmVfaG1hY19zaGExKGtleSwgZGF0YSkpO31cclxuZnVuY3Rpb24gc3RyX2htYWNfc2hhMShrZXksIGRhdGEpeyByZXR1cm4gYmluYjJzdHIoY29yZV9obWFjX3NoYTEoa2V5LCBkYXRhKSk7fVxyXG5cclxuLypcclxuICogUGVyZm9ybSBhIHNpbXBsZSBzZWxmLXRlc3QgdG8gc2VlIGlmIHRoZSBWTSBpcyB3b3JraW5nXHJcbiAqL1xyXG5mdW5jdGlvbiBzaGExX3ZtX3Rlc3QoKSB7XHJcblx0cmV0dXJuIGhleF9zaGExKFwiYWJjXCIpID09IFwiYTk5OTNlMzY0NzA2ODE2YWJhM2UyNTcxNzg1MGMyNmM5Y2QwZDg5ZFwiO1xyXG59XHJcblxyXG4vKlxyXG4gKiBDYWxjdWxhdGUgdGhlIFNIQS0xIG9mIGFuIGFycmF5IG9mIGJpZy1lbmRpYW4gd29yZHMsIGFuZCBhIGJpdCBsZW5ndGhcclxuICovXHJcbmZ1bmN0aW9uIGNvcmVfc2hhMSh4LCBsZW4pIHtcclxuICAvKiBhcHBlbmQgcGFkZGluZyAqL1xyXG4gIHhbbGVuID4+IDVdIHw9IDB4ODAgPDwgKDI0IC0gbGVuICUgMzIpO1xyXG4gIHhbKChsZW4gKyA2NCA+PiA5KSA8PCA0KSArIDE1XSA9IGxlbjtcclxuXHJcbiAgdmFyIHcgPSBBcnJheSg4MCk7XHJcbiAgdmFyIGEgPSAgMTczMjU4NDE5MztcclxuICB2YXIgYiA9IC0yNzE3MzM4Nzk7XHJcbiAgdmFyIGMgPSAtMTczMjU4NDE5NDtcclxuICB2YXIgZCA9ICAyNzE3MzM4Nzg7XHJcbiAgdmFyIGUgPSAtMTAwOTU4OTc3NjtcclxuXHJcbiAgZm9yKHZhciBpID0gMDsgaSA8IHgubGVuZ3RoOyBpICs9IDE2KVxyXG4gIHtcclxuXHR2YXIgb2xkYSA9IGE7XHJcblx0dmFyIG9sZGIgPSBiO1xyXG5cdHZhciBvbGRjID0gYztcclxuXHR2YXIgb2xkZCA9IGQ7XHJcblx0dmFyIG9sZGUgPSBlO1xyXG5cclxuXHRmb3IodmFyIGogPSAwOyBqIDwgODA7IGorKylcclxuXHR7XHJcblx0ICBpZihqIDwgMTYpIHdbal0gPSB4W2kgKyBqXTtcclxuXHQgIGVsc2Ugd1tqXSA9IHJvbCh3W2otM10gXiB3W2otOF0gXiB3W2otMTRdIF4gd1tqLTE2XSwgMSk7XHJcblx0ICB2YXIgdCA9IHNhZmVfYWRkKHNhZmVfYWRkKHJvbChhLCA1KSwgc2hhMV9mdChqLCBiLCBjLCBkKSksXHJcblx0XHRcdFx0XHQgICBzYWZlX2FkZChzYWZlX2FkZChlLCB3W2pdKSwgc2hhMV9rdChqKSkpO1xyXG5cdCAgZSA9IGQ7XHJcblx0ICBkID0gYztcclxuXHQgIGMgPSByb2woYiwgMzApO1xyXG5cdCAgYiA9IGE7XHJcblx0ICBhID0gdDtcclxuXHR9XHJcblxyXG5cdGEgPSBzYWZlX2FkZChhLCBvbGRhKTtcclxuXHRiID0gc2FmZV9hZGQoYiwgb2xkYik7XHJcblx0YyA9IHNhZmVfYWRkKGMsIG9sZGMpO1xyXG5cdGQgPSBzYWZlX2FkZChkLCBvbGRkKTtcclxuXHRlID0gc2FmZV9hZGQoZSwgb2xkZSk7XHJcbiAgfVxyXG4gIHJldHVybiBBcnJheShhLCBiLCBjLCBkLCBlKTtcclxuXHJcbn1cclxuXHJcbi8qXHJcbiAqIFBlcmZvcm0gdGhlIGFwcHJvcHJpYXRlIHRyaXBsZXQgY29tYmluYXRpb24gZnVuY3Rpb24gZm9yIHRoZSBjdXJyZW50XHJcbiAqIGl0ZXJhdGlvblxyXG4gKi9cclxuZnVuY3Rpb24gc2hhMV9mdCh0LCBiLCBjLCBkKVxyXG57XHJcbiAgaWYodCA8IDIwKSByZXR1cm4gKGIgJiBjKSB8ICgofmIpICYgZCk7XHJcbiAgaWYodCA8IDQwKSByZXR1cm4gYiBeIGMgXiBkO1xyXG4gIGlmKHQgPCA2MCkgcmV0dXJuIChiICYgYykgfCAoYiAmIGQpIHwgKGMgJiBkKTtcclxuICByZXR1cm4gYiBeIGMgXiBkO1xyXG59XHJcblxyXG4vKlxyXG4gKiBEZXRlcm1pbmUgdGhlIGFwcHJvcHJpYXRlIGFkZGl0aXZlIGNvbnN0YW50IGZvciB0aGUgY3VycmVudCBpdGVyYXRpb25cclxuICovXHJcbmZ1bmN0aW9uIHNoYTFfa3QodClcclxue1xyXG4gIHJldHVybiAodCA8IDIwKSA/ICAxNTE4NTAwMjQ5IDogKHQgPCA0MCkgPyAgMTg1OTc3NTM5MyA6XHJcblx0XHQgKHQgPCA2MCkgPyAtMTg5NDAwNzU4OCA6IC04OTk0OTc1MTQ7XHJcbn1cclxuXHJcbi8qXHJcbiAqIENhbGN1bGF0ZSB0aGUgSE1BQy1TSEExIG9mIGEga2V5IGFuZCBzb21lIGRhdGFcclxuICovXHJcbmZ1bmN0aW9uIGNvcmVfaG1hY19zaGExKGtleSwgZGF0YSlcclxue1xyXG4gIHZhciBia2V5ID0gc3RyMmJpbmIoa2V5KTtcclxuICBpZihia2V5Lmxlbmd0aCA+IDE2KSBia2V5ID0gY29yZV9zaGExKGJrZXksIGtleS5sZW5ndGggKiBjaHJzeik7XHJcblxyXG4gIHZhciBpcGFkID0gQXJyYXkoMTYpLCBvcGFkID0gQXJyYXkoMTYpO1xyXG4gIGZvcih2YXIgaSA9IDA7IGkgPCAxNjsgaSsrKVxyXG4gIHtcclxuXHRpcGFkW2ldID0gYmtleVtpXSBeIDB4MzYzNjM2MzY7XHJcblx0b3BhZFtpXSA9IGJrZXlbaV0gXiAweDVDNUM1QzVDO1xyXG4gIH1cclxuXHJcbiAgdmFyIGhhc2ggPSBjb3JlX3NoYTEoaXBhZC5jb25jYXQoc3RyMmJpbmIoZGF0YSkpLCA1MTIgKyBkYXRhLmxlbmd0aCAqIGNocnN6KTtcclxuICByZXR1cm4gY29yZV9zaGExKG9wYWQuY29uY2F0KGhhc2gpLCA1MTIgKyAxNjApO1xyXG59XHJcblxyXG4vKlxyXG4gKiBBZGQgaW50ZWdlcnMsIHdyYXBwaW5nIGF0IDJeMzIuIFRoaXMgdXNlcyAxNi1iaXQgb3BlcmF0aW9ucyBpbnRlcm5hbGx5XHJcbiAqIHRvIHdvcmsgYXJvdW5kIGJ1Z3MgaW4gc29tZSBKUyBpbnRlcnByZXRlcnMuXHJcbiAqL1xyXG5mdW5jdGlvbiBzYWZlX2FkZCh4LCB5KVxyXG57XHJcbiAgdmFyIGxzdyA9ICh4ICYgMHhGRkZGKSArICh5ICYgMHhGRkZGKTtcclxuICB2YXIgbXN3ID0gKHggPj4gMTYpICsgKHkgPj4gMTYpICsgKGxzdyA+PiAxNik7XHJcbiAgcmV0dXJuIChtc3cgPDwgMTYpIHwgKGxzdyAmIDB4RkZGRik7XHJcbn1cclxuXHJcbi8qXHJcbiAqIEJpdHdpc2Ugcm90YXRlIGEgMzItYml0IG51bWJlciB0byB0aGUgbGVmdC5cclxuICovXHJcbmZ1bmN0aW9uIHJvbChudW0sIGNudClcclxue1xyXG4gIHJldHVybiAobnVtIDw8IGNudCkgfCAobnVtID4+PiAoMzIgLSBjbnQpKTtcclxufVxyXG5cclxuLypcclxuICogQ29udmVydCBhbiA4LWJpdCBvciAxNi1iaXQgc3RyaW5nIHRvIGFuIGFycmF5IG9mIGJpZy1lbmRpYW4gd29yZHNcclxuICogSW4gOC1iaXQgZnVuY3Rpb24sIGNoYXJhY3RlcnMgPjI1NSBoYXZlIHRoZWlyIGhpLWJ5dGUgc2lsZW50bHkgaWdub3JlZC5cclxuICovXHJcbmZ1bmN0aW9uIHN0cjJiaW5iKHN0cilcclxue1xyXG4gIHZhciBiaW4gPSBBcnJheSgpO1xyXG4gIHZhciBtYXNrID0gKDEgPDwgY2hyc3opIC0gMTtcclxuICBmb3IodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aCAqIGNocnN6OyBpICs9IGNocnN6KVxyXG5cdGJpbltpPj41XSB8PSAoc3RyLmNoYXJDb2RlQXQoaSAvIGNocnN6KSAmIG1hc2spIDw8ICgzMiAtIGNocnN6IC0gaSUzMik7XHJcbiAgcmV0dXJuIGJpbjtcclxufVxyXG5cclxuLypcclxuICogQ29udmVydCBhbiBhcnJheSBvZiBiaWctZW5kaWFuIHdvcmRzIHRvIGEgc3RyaW5nXHJcbiAqL1xyXG5mdW5jdGlvbiBiaW5iMnN0cihiaW4pXHJcbntcclxuICB2YXIgc3RyID0gXCJcIjtcclxuICB2YXIgbWFzayA9ICgxIDw8IGNocnN6KSAtIDE7XHJcbiAgZm9yKHZhciBpID0gMDsgaSA8IGJpbi5sZW5ndGggKiAzMjsgaSArPSBjaHJzeilcclxuXHRzdHIgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgoYmluW2k+PjVdID4+PiAoMzIgLSBjaHJzeiAtIGklMzIpKSAmIG1hc2spO1xyXG4gIHJldHVybiBzdHI7XHJcbn1cclxuXHJcbi8qXHJcbiAqIENvbnZlcnQgYW4gYXJyYXkgb2YgYmlnLWVuZGlhbiB3b3JkcyB0byBhIGhleCBzdHJpbmcuXHJcbiAqL1xyXG5mdW5jdGlvbiBiaW5iMmhleChiaW5hcnJheSlcclxue1xyXG4gIHZhciBoZXhfdGFiID0gaGV4Y2FzZSA/IFwiMDEyMzQ1Njc4OUFCQ0RFRlwiIDogXCIwMTIzNDU2Nzg5YWJjZGVmXCI7XHJcbiAgdmFyIHN0ciA9IFwiXCI7XHJcbiAgZm9yKHZhciBpID0gMDsgaSA8IGJpbmFycmF5Lmxlbmd0aCAqIDQ7IGkrKylcclxuICB7XHJcblx0c3RyICs9IGhleF90YWIuY2hhckF0KChiaW5hcnJheVtpPj4yXSA+PiAoKDMgLSBpJTQpKjgrNCkpICYgMHhGKSArXHJcblx0XHQgICBoZXhfdGFiLmNoYXJBdCgoYmluYXJyYXlbaT4+Ml0gPj4gKCgzIC0gaSU0KSo4ICApKSAmIDB4Rik7XHJcbiAgfVxyXG4gIHJldHVybiBzdHI7XHJcbn1cclxuXHJcbi8qXHJcbiAqIENvbnZlcnQgYW4gYXJyYXkgb2YgYmlnLWVuZGlhbiB3b3JkcyB0byBhIGJhc2UtNjQgc3RyaW5nXHJcbiAqL1xyXG5mdW5jdGlvbiBiaW5iMmI2NChiaW5hcnJheSlcclxue1xyXG4gIHZhciB0YWIgPSBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky9cIjtcclxuICB2YXIgc3RyID0gXCJcIjtcclxuICBmb3IodmFyIGkgPSAwOyBpIDwgYmluYXJyYXkubGVuZ3RoICogNDsgaSArPSAzKVxyXG4gIHtcclxuXHR2YXIgdHJpcGxldCA9ICgoKGJpbmFycmF5W2kgICA+PiAyXSA+PiA4ICogKDMgLSAgaSAgICU0KSkgJiAweEZGKSA8PCAxNilcclxuXHRcdFx0XHR8ICgoKGJpbmFycmF5W2krMSA+PiAyXSA+PiA4ICogKDMgLSAoaSsxKSU0KSkgJiAweEZGKSA8PCA4IClcclxuXHRcdFx0XHR8ICAoKGJpbmFycmF5W2krMiA+PiAyXSA+PiA4ICogKDMgLSAoaSsyKSU0KSkgJiAweEZGKTtcclxuXHRmb3IodmFyIGogPSAwOyBqIDwgNDsgaisrKVxyXG5cdHtcclxuXHQgIGlmKGkgKiA4ICsgaiAqIDYgPiBiaW5hcnJheS5sZW5ndGggKiAzMikgc3RyICs9IGI2NHBhZDtcclxuXHQgIGVsc2Ugc3RyICs9IHRhYi5jaGFyQXQoKHRyaXBsZXQgPj4gNiooMy1qKSkgJiAweDNGKTtcclxuXHR9XHJcbiAgfVxyXG4gIHJldHVybiBzdHI7XHJcbn1cclxuXHJcbi8qXHJcbiAqIGpRdWVyeSBNb2JpbGUgRnJhbWV3b3JrIDogcGx1Z2luIHRvIHByb3ZpZGUgYSBkYXRlIGFuZCB0aW1lIHBpY2tlci5cclxuICogQ29weXJpZ2h0IChjKSBKVFNhZ2VcclxuICogQ0MgMy4wIEF0dHJpYnV0aW9uLiAgTWF5IGJlIHJlbGljZW5zZWQgd2l0aG91dCBwZXJtaXNzaW9uL25vdGlmY2F0aW9uLlxyXG4gKiBodHRwczovL2dpdGh1Yi5jb20vanRzYWdlL2pxdWVyeS1tb2JpbGUtZGF0ZWJveFxyXG4gKlxyXG4gKiBUcmFuc2xhdGlvbiBieTogQ2hyaXMgUC4gVmlnZWxpdXMgPG1lQGN2LmdkPiwgUGFzY2FsIEhvZm1hbm4gPGNyb3dkaW4+XHJcbiAqXHJcbiAqL1xyXG5cclxualF1ZXJ5LmV4dGVuZChqUXVlcnkubW9iaWxlLmRhdGVib3gucHJvdG90eXBlLm9wdGlvbnMubGFuZywge1xyXG5cdCdkZSc6IHtcclxuXHRcdHNldERhdGVCdXR0b25MYWJlbDogXCJzcGVpY2hlcm5cIixcclxuXHRcdHNldFRpbWVCdXR0b25MYWJlbDogXCJzcGVpY2hlcm5cIixcclxuXHRcdHNldER1cmF0aW9uQnV0dG9uTGFiZWw6IFwic3BlaWNoZXJuXCIsXHJcblx0XHRjYWxUb2RheUJ1dHRvbkxhYmVsOiBcImhldXRlXCIsXHJcblx0XHR0aXRsZURhdGVEaWFsb2dMYWJlbDogXCJEYXR1bSB3w6RobGVuXCIsXHJcblx0XHR0aXRsZVRpbWVEaWFsb2dMYWJlbDogXCJaZWl0IHfDpGhsZW5cIixcclxuXHRcdGRheXNPZldlZWs6IFtcIlNvbm50YWdcIiwgXCJNb250YWdcIiwgXCJEaWVuc3RhZ1wiLCBcIk1pdHR3b2NoXCIsIFwiRG9ubmVyc3RhZ1wiLCBcIkZyZWl0YWdcIiwgXCJTYW1zdGFnXCJdLFxyXG5cdFx0ZGF5c09mV2Vla1Nob3J0OiBbXCJTb1wiLCBcIk1vXCIsIFwiRGlcIiwgXCJNaVwiLCBcIkRvXCIsIFwiRnJcIiwgXCJTYVwiXSxcclxuXHRcdG1vbnRoc09mWWVhcjogW1wiSmFudWFyXCIsIFwiRmVicnVhclwiLCBcIk3DpHJ6XCIsIFwiQXByaWxcIiwgXCJNYWlcIiwgXCJKdW5pXCIsIFwiSnVsaVwiLCBcIkF1Z3VzdFwiLCBcIlNlcHRlbWJlclwiLCBcIk9rdG9iZXJcIiwgXCJOb3ZlbWJlclwiLCBcIkRlemVtYmVyXCJdLFxyXG5cdFx0bW9udGhzT2ZZZWFyU2hvcnQ6IFtcIkphblwiLCBcIkZlYlwiLCBcIk3DpHJcIiwgXCJBcHJcIiwgXCJNYWlcIiwgXCJKdW5cIiwgXCJKdWxcIiwgXCJBdWdcIiwgXCJTZXBcIiwgXCJPY3RcIiwgXCJOb3ZcIiwgXCJEZXpcIl0sXHJcblx0XHRkdXJhdGlvbkxhYmVsOiBbXCJUYWdlXCIsIFwiU3R1bmRlblwiLCBcIk1pbnV0ZW5cIiwgXCJTZWt1bmRlblwiXSxcclxuXHRcdGR1cmF0aW9uRGF5czogW1wiVGFnXCIsIFwiVGFnZVwiXSxcclxuXHRcdHRvb2x0aXA6IFwiS2FsZW5kZXIgw7ZmZm5lblwiLFxyXG5cdFx0bmV4dE1vbnRoOiBcIk7DpGNoc3RlciBNb25hdFwiLFxyXG5cdFx0cHJldk1vbnRoOiBcIlZvcmhlcmlnZXIgTW9uYXRcIixcclxuXHRcdHRpbWVGb3JtYXQ6IDI0LFxyXG5cdFx0Ly9oZWFkZXJGb3JtYXQ6ICclQSwgJUIgJS1kLCAlWScsXHJcblx0XHRoZWFkZXJGb3JtYXQ6ICclWS0lbS0lZCcsXHJcblx0XHRkYXRlRmllbGRPcmRlcjogWydkJywnbScsJ3knXSxcclxuXHRcdHRpbWVGaWVsZE9yZGVyOiBbJ2gnLCAnaScsICdhJ10sXHJcblx0XHRzbGlkZUZpZWxkT3JkZXI6IFsneScsICdtJywgJ2QnXSxcclxuXHRcdGRhdGVGb3JtYXQ6IFwiJVktJW0tJWRcIixcclxuXHRcdHVzZUFyYWJpY0luZGljOiBmYWxzZSxcclxuXHRcdGlzUlRMOiBmYWxzZSxcclxuXHRcdGNhbFN0YXJ0RGF5OiAxLFxyXG5cdFx0Y2xlYXJCdXR0b246IFwibMO2c2NoZW5cIixcclxuXHRcdGR1cmF0aW9uT3JkZXI6IFsnZCcsICdoJywgJ2knLCAncyddLFxyXG5cdFx0bWVyaWRpZW06IFtcIkFNXCIsIFwiUE1cIl0sXHJcblx0XHR0aW1lT3V0cHV0OiBcIiVrOiVNXCIsXHJcblx0XHRkdXJhdGlvbkZvcm1hdDogXCIlRGQgJURBLCAlRGw6JURNOiVEU1wiLFxyXG5cdFx0Y2FsRGF0ZUxpc3RMYWJlbDogXCJXZWl0ZXJlIFRlcm1pbmVcIlxyXG5cdH1cclxufSk7XHJcbmpRdWVyeS5leHRlbmQoalF1ZXJ5Lm1vYmlsZS5kYXRlYm94LnByb3RvdHlwZS5vcHRpb25zLCB7XHJcblx0dXNlTGFuZzogJ2RlJ1xyXG59KTsiLCIvKipcclxuICogQ29udmVydCBDSCB5L3ggdG8gV0dTIGxhdFxyXG4gKiBAcmV0dXJuIHtudW1iZXJ9XHJcbiAqL1xyXG5cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih5LCB4KSB7XHJcbiAgICAvLyBDb252ZXJ0cyBtaWxpdGFyIHRvIGNpdmlsIGFuZCB0byB1bml0ID0gMTAwMGttXHJcbiAgICB2YXIgbGF0LFxyXG4gICAgICAgIHlfYXV4LFxyXG4gICAgICAgIHhfYXV4O1xyXG5cclxuICAgIC8vIEF4aWxpYXJ5IHZhbHVlcyAoJSBCZXJuKVxyXG4gICAgeV9hdXggPSAoeSAtIDYwMDAwMCkvMTAwMDAwMDtcclxuICAgIHhfYXV4ID0gKHggLSAyMDAwMDApLzEwMDAwMDA7XHJcblxyXG4gICAgLy8gUHJvY2VzcyBsYXRcclxuICAgIGxhdCA9IDE2LjkwMjM4OTJcclxuICAgICAgICArICAzLjIzODI3MiAqIHhfYXV4XHJcbiAgICAgICAgLSAgMC4yNzA5NzggKiBNYXRoLnBvdyh5X2F1eCwyKVxyXG4gICAgICAgIC0gIDAuMDAyNTI4ICogTWF0aC5wb3coeF9hdXgsMilcclxuICAgICAgICAtICAwLjA0NDcgICAqIE1hdGgucG93KHlfYXV4LDIpICogeF9hdXhcclxuICAgICAgICAtICAwLjAxNDAgICAqIE1hdGgucG93KHhfYXV4LDMpO1xyXG5cclxuICAgIC8vIFVuaXQgMTAwMDBcIiB0byAxIFwiIGFuZCBjb252ZXJ0cyBzZWNvbmRzIHRvIGRlZ3JlZXMgKGRlYylcclxuICAgIGxhdCA9IGxhdCAqIDEwMC8zNjtcclxuXHJcbiAgICByZXR1cm4gbGF0O1xyXG59OyIsIi8qKlxyXG4gKiBDb252ZXJ0IENIIHkveCB0byBXR1MgbG9uZ1xyXG4gKiBAcmV0dXJuIHtudW1iZXJ9XHJcbiAqL1xyXG5cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih5LCB4KSB7XHJcbiAgICAvLyBDb252ZXJ0cyBtaWxpdGFyIHRvIGNpdmlsIGFuZCB0byB1bml0ID0gMTAwMGttXHJcbiAgICB2YXIgbG5nLFxyXG4gICAgICAgIHlfYXV4LFxyXG4gICAgICAgIHhfYXV4O1xyXG5cclxuICAgIC8vIEF4aWxpYXJ5IHZhbHVlcyAoJSBCZXJuKVxyXG4gICAgeV9hdXggPSAoeSAtIDYwMDAwMCkvMTAwMDAwMDtcclxuICAgIHhfYXV4ID0gKHggLSAyMDAwMDApLzEwMDAwMDA7XHJcblxyXG4gICAgLy8gUHJvY2VzcyBsb25nXHJcbiAgICBsbmcgPSAyLjY3NzkwOTRcclxuICAgICAgICArIDQuNzI4OTgyICogeV9hdXhcclxuICAgICAgICArIDAuNzkxNDg0ICogeV9hdXggKiB4X2F1eFxyXG4gICAgICAgICsgMC4xMzA2ICAgKiB5X2F1eCAqIE1hdGgucG93KHhfYXV4LDIpXHJcbiAgICAgICAgLSAwLjA0MzYgICAqIE1hdGgucG93KHlfYXV4LDMpO1xyXG5cclxuICAgIC8vIFVuaXQgMTAwMDBcIiB0byAxIFwiIGFuZCBjb252ZXJ0cyBzZWNvbmRzIHRvIGRlZ3JlZXMgKGRlYylcclxuICAgIGxuZyA9IGxuZyAqIDEwMC8zNjtcclxuXHJcbiAgICByZXR1cm4gbG5nO1xyXG59OyIsIi8qKlxyXG4gKiB3YW5kZWx0IGRlY2ltYWwgZGVncmVlcyAodm9tIEdQUykgaW4gQ0gtTGFuZGVza29vcmRpbmF0ZW4gdW1cclxuICogQHJldHVybiB7bnVtYmVyfVxyXG4gKi9cclxuXHJcbid1c2Ugc3RyaWN0JztcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYnJlaXRlLCBsw6RuZ2UpIHtcclxuICAgIHZhciBEZEluV2dzODRCcmVpdGVHcmFkID0gcmVxdWlyZSgnLi9kZEluV2dzODRCcmVpdGVHcmFkJyksXHJcbiAgICAgICAgYnJlaXRlR3JhZCA9IERkSW5XZ3M4NEJyZWl0ZUdyYWQoYnJlaXRlKSxcclxuICAgICAgICBEZEluV2dzODRCcmVpdGVNaW4gPSByZXF1aXJlKCcuL2RkSW5XZ3M4NEJyZWl0ZU1pbicpLFxyXG4gICAgICAgIGJyZWl0ZU1pbiA9IERkSW5XZ3M4NEJyZWl0ZU1pbihicmVpdGUpLFxyXG4gICAgICAgIERkSW5XZ3M4NEJyZWl0ZVNlYyA9IHJlcXVpcmUoJy4vZGRJbldnczg0QnJlaXRlU2VjJyksXHJcbiAgICAgICAgYnJlaXRlU2VjID0gRGRJbldnczg0QnJlaXRlU2VjKGJyZWl0ZSksXHJcbiAgICAgICAgRGRJbldnczg0TMOkbmdlR3JhZCA9IHJlcXVpcmUoJy4vZGRJbldnczg0TGFlbmdlR3JhZCcpLFxyXG4gICAgICAgIGzDpG5nZUdyYWQgPSBEZEluV2dzODRMw6RuZ2VHcmFkKGzDpG5nZSksXHJcbiAgICAgICAgRGRJbldnczg0TMOkbmdlTWluID0gcmVxdWlyZSgnLi9kZEluV2dzODRMYWVuZ2VNaW4nKSxcclxuICAgICAgICBsw6RuZ2VNaW4gPSBEZEluV2dzODRMw6RuZ2VNaW4obMOkbmdlKSxcclxuICAgICAgICBEZEluV2dzODRMw6RuZ2VTZWMgPSByZXF1aXJlKCcuL2RkSW5XZ3M4NExhZW5nZVNlYycpLFxyXG4gICAgICAgIGzDpG5nZVNlYyA9IERkSW5XZ3M4NEzDpG5nZVNlYyhsw6RuZ2UpLFxyXG4gICAgICAgIFdnczg0SW5DaFggPSByZXF1aXJlKCcuL3dnczg0SW5DaFgnKTtcclxuICAgIHJldHVybiBNYXRoLmZsb29yKFdnczg0SW5DaFgoYnJlaXRlR3JhZCwgYnJlaXRlTWluLCBicmVpdGVTZWMsIGzDpG5nZUdyYWQsIGzDpG5nZU1pbiwgbMOkbmdlU2VjKSk7XHJcbn07IiwiLyoqXHJcbiAqIHdhbmRlbHQgZGVjaW1hbCBkZWdyZWVzICh2b20gR1BTKSBpbiBDSC1MYW5kZXNrb29yZGluYXRlbiB1bVxyXG4gKiBAcmV0dXJuIHtudW1iZXJ9XHJcbiAqL1xyXG5cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihicmVpdGUsIGzDpG5nZSkge1xyXG4gICAgdmFyIERkSW5XZ3M4NEJyZWl0ZUdyYWQgPSByZXF1aXJlKCcuL2RkSW5XZ3M4NEJyZWl0ZUdyYWQnKSxcclxuICAgICAgICBicmVpdGVHcmFkID0gRGRJbldnczg0QnJlaXRlR3JhZChicmVpdGUpLFxyXG4gICAgICAgIERkSW5XZ3M4NEJyZWl0ZU1pbiA9IHJlcXVpcmUoJy4vZGRJbldnczg0QnJlaXRlTWluJyksXHJcbiAgICAgICAgYnJlaXRlTWluID0gRGRJbldnczg0QnJlaXRlTWluKGJyZWl0ZSksXHJcbiAgICAgICAgRGRJbldnczg0QnJlaXRlU2VjID0gcmVxdWlyZSgnLi9kZEluV2dzODRCcmVpdGVTZWMnKSxcclxuICAgICAgICBicmVpdGVTZWMgPSBEZEluV2dzODRCcmVpdGVTZWMoYnJlaXRlKSxcclxuICAgICAgICBEZEluV2dzODRMw6RuZ2VHcmFkID0gcmVxdWlyZSgnLi9kZEluV2dzODRMYWVuZ2VHcmFkJyksXHJcbiAgICAgICAgbMOkbmdlR3JhZCA9IERkSW5XZ3M4NEzDpG5nZUdyYWQobMOkbmdlKSxcclxuICAgICAgICBEZEluV2dzODRMw6RuZ2VNaW4gPSByZXF1aXJlKCcuL2RkSW5XZ3M4NExhZW5nZU1pbicpLFxyXG4gICAgICAgIGzDpG5nZU1pbiA9IERkSW5XZ3M4NEzDpG5nZU1pbihsw6RuZ2UpLFxyXG4gICAgICAgIERkSW5XZ3M4NEzDpG5nZVNlYyA9IHJlcXVpcmUoJy4vZGRJbldnczg0TGFlbmdlU2VjJyksXHJcbiAgICAgICAgbMOkbmdlU2VjID0gRGRJbldnczg0TMOkbmdlU2VjKGzDpG5nZSksXHJcbiAgICAgICAgV2dzODRJbkNoWSA9IHJlcXVpcmUoJy4vd2dzODRJbkNoWScpO1xyXG4gICAgcmV0dXJuIE1hdGguZmxvb3IoV2dzODRJbkNoWShicmVpdGVHcmFkLCBicmVpdGVNaW4sIGJyZWl0ZVNlYywgbMOkbmdlR3JhZCwgbMOkbmdlTWluLCBsw6RuZ2VTZWMpKTtcclxufTsiLCIvKipcclxuICogd2FuZGVsdCBkZWNpbWFsIGRlZ3JlZXMgKHZvbSBHUFMpIGluIFdHUzg0IHVtXHJcbiAqIEByZXR1cm4ge251bWJlcn1cclxuICovXHJcblxyXG4ndXNlIHN0cmljdCc7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKEJyZWl0ZSkge1xyXG4gICAgcmV0dXJuIE1hdGguZmxvb3IoQnJlaXRlKTtcclxufTsiLCIvKipcclxuICogd2FuZGVsdCBQcm9qZWt0aW9uZW4gdW1cclxuICogQHJldHVybiB7bnVtYmVyfVxyXG4gKi9cclxuXHJcbid1c2Ugc3RyaWN0JztcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQnJlaXRlKSB7XHJcbiAgICB2YXIgQnJlaXRlR3JhZCA9IE1hdGguZmxvb3IoQnJlaXRlKTtcclxuICAgIHJldHVybiBNYXRoLmZsb29yKChCcmVpdGUtQnJlaXRlR3JhZCkqNjApO1xyXG59OyIsIi8qKlxyXG4gKiBLb252ZXJ0aWVydCBQcm9qZWt0aW9uZW5cclxuICogQHJldHVybiB7bnVtYmVyfVxyXG4gKi9cclxuXHJcbid1c2Ugc3RyaWN0JztcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQnJlaXRlKSB7XHJcbiAgICB2YXIgQnJlaXRlR3JhZCA9IE1hdGguZmxvb3IoQnJlaXRlKSxcclxuICAgICAgICBCcmVpdGVNaW4gPSBNYXRoLmZsb29yKChCcmVpdGUtQnJlaXRlR3JhZCkqNjApO1xyXG4gICAgcmV0dXJuIE1hdGgucm91bmQoKCgoQnJlaXRlIC0gQnJlaXRlR3JhZCkgLSAoQnJlaXRlTWluLzYwKSkgKiA2MCAqIDYwKSAqIDEwMCkgLyAxMDA7XHJcbn07IiwiLyoqXHJcbiAqIEtvbnZlcnRpZXJ0IFByb2pla3Rpb25lblxyXG4gKiBAcmV0dXJuIHtudW1iZXJ9XHJcbiAqL1xyXG5cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihMYWVuZ2UpIHtcclxuICAgIHJldHVybiBNYXRoLmZsb29yKExhZW5nZSk7XHJcbn07IiwiLyoqXHJcbiAqIEtvbnZlcnRpZXJ0IFByb2pla3Rpb25lblxyXG4gKiBAcmV0dXJuIHtudW1iZXJ9XHJcbiAqL1xyXG5cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihMYWVuZ2UpIHtcclxuICAgIHZhciBMYWVuZ2VHcmFkID0gTWF0aC5mbG9vcihMYWVuZ2UpO1xyXG4gICAgcmV0dXJuIE1hdGguZmxvb3IoKExhZW5nZS1MYWVuZ2VHcmFkKSo2MCk7XHJcbn07IiwiLyoqXHJcbiAqIEtvbnZlcnRpZXJ0IFByb2pla3Rpb25lblxyXG4gKiBAcmV0dXJuIHtudW1iZXJ9XHJcbiAqL1xyXG5cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihMYWVuZ2UpIHtcclxuICAgIHZhciBMYWVuZ2VHcmFkID0gTWF0aC5mbG9vcihMYWVuZ2UpLFxyXG4gICAgICAgIExhZW5nZU1pbiA9IE1hdGguZmxvb3IoKExhZW5nZS1MYWVuZ2VHcmFkKSo2MCk7XHJcbiAgICByZXR1cm4gTWF0aC5yb3VuZCgoKChMYWVuZ2UgLSBMYWVuZ2VHcmFkKSAtIChMYWVuZ2VNaW4vNjApKSAqIDYwICogNjApICogMTAwICkgLyAxMDA7XHJcbn07IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBqZXR6dCA9IG5ldyBEYXRlKCksXHJcbiAgICAgICAgU3RkID0gamV0enQuZ2V0SG91cnMoKSxcclxuICAgICAgICBTdGRBdXNnYWJlID0gKChTdGQgPCAxMCkgPyBcIjBcIiArIFN0ZCA6IFN0ZCksXHJcbiAgICAgICAgTWluID0gamV0enQuZ2V0TWludXRlcygpLFxyXG4gICAgICAgIE1pbkF1c2dhYmUgPSAoKE1pbiA8IDEwKSA/IFwiMFwiICsgTWluIDogTWluKSxcclxuICAgICAgICBTZWsgPSBqZXR6dC5nZXRTZWNvbmRzKCksXHJcbiAgICAgICAgU2VrQXVzZ2FiZSA9ICgoU2VrIDwgMTApID8gXCIwXCIgKyBTZWsgOiBTZWspO1xyXG4gICAgcmV0dXJuIFN0ZEF1c2dhYmUgKyBcIjpcIiArIE1pbkF1c2dhYmUgKyBcIjpcIiArIFNla0F1c2dhYmU7XHJcbn07IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBqZXR6dCA9IG5ldyBEYXRlKCksXHJcbiAgICAgICAgSmFociA9IGpldHp0LmdldEZ1bGxZZWFyKCksXHJcbiAgICAgICAgTW50ID0gamV0enQuZ2V0TW9udGgoKSsxLFxyXG4gICAgICAgIE1udEF1c2dhYmUgPSAoKE1udCA8IDEwKSA/IFwiMFwiICsgTW50IDogTW50KSxcclxuICAgICAgICBUYWcgPSBqZXR6dC5nZXREYXRlKCksXHJcbiAgICAgICAgVGFnQXVzZ2FiZSA9ICgoVGFnIDwgMTApID8gXCIwXCIgKyBUYWcgOiBUYWcpO1xyXG4gICAgcmV0dXJuIEphaHIgKyBcIi1cIiArIE1udEF1c2dhYmUgKyBcIi1cIiArIFRhZ0F1c2dhYmU7XHJcbn07IiwiLyoqXHJcbiAqIFdhbmRlbHQgV0dTODQgbGF0L2xvbmcgKMKwIGRlYykgaW4gQ0gtTGFuZGVza29vcmRpbmF0ZW4gdW1cclxuICogQHJldHVybiB7bnVtYmVyfVxyXG4gKi9cclxuXHJcbid1c2Ugc3RyaWN0JztcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYnJlaXRlR3JhZCwgYnJlaXRlTWluLCBicmVpdGVTZWMsIGzDpG5nZUdyYWQsIGzDpG5nZU1pbiwgbMOkbmdlU2VjKSB7XHJcbiAgICB2YXIgbGF0LFxyXG4gICAgICAgIGxuZyxcclxuICAgICAgICBsYXRfYXV4LFxyXG4gICAgICAgIGxuZ19hdXgsXHJcbiAgICAgICAgeDtcclxuXHJcbiAgICAvLyBDb252ZXJ0cyBkZWdyZWVzIGRlYyB0byBzZXhcclxuICAgIGxhdCA9IGJyZWl0ZVNlYyArIGJyZWl0ZU1pbio2MCArIGJyZWl0ZUdyYWQqMzYwMDtcclxuICAgIGxuZyA9IGzDpG5nZVNlYyArIGzDpG5nZU1pbio2MCArIGzDpG5nZUdyYWQqMzYwMDtcclxuXHJcbiAgICAvLyBBeGlsaWFyeSB2YWx1ZXMgKCUgQmVybilcclxuICAgIGxhdF9hdXggPSAobGF0IC0gMTY5MDI4LjY2KS8xMDAwMDtcclxuICAgIGxuZ19hdXggPSAobG5nIC0gMjY3ODIuNSkvMTAwMDA7XHJcblxyXG4gICAgeCA9IDIwMDE0Ny4wN1xyXG4gICAgICAgICsgMzA4ODA3Ljk1ICogbGF0X2F1eFxyXG4gICAgICAgICsgICAzNzQ1LjI1ICogTWF0aC5wb3cobG5nX2F1eCwyKVxyXG4gICAgICAgICsgICAgIDc2LjYzICogTWF0aC5wb3cobGF0X2F1eCwyKVxyXG4gICAgICAgIC0gICAgMTk0LjU2ICogTWF0aC5wb3cobG5nX2F1eCwyKSAqIGxhdF9hdXhcclxuICAgICAgICArICAgIDExOS43OSAqIE1hdGgucG93KGxhdF9hdXgsMyk7XHJcblxyXG4gICAgcmV0dXJuIHg7XHJcbn07IiwiLyoqXHJcbiAqIFdhbmRlbHQgV0dTODQgaW4gQ0gtTGFuZGVza29vcmRpbmF0ZW4gdW1cclxuICogQHJldHVybiB7bnVtYmVyfVxyXG4gKi9cclxuXHJcbid1c2Ugc3RyaWN0JztcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYnJlaXRlR3JhZCwgYnJlaXRlTWluLCBicmVpdGVTZWMsIGzDpG5nZUdyYWQsIGzDpG5nZU1pbiwgbMOkZW5nZVNlYykge1xyXG4gICAgdmFyIGxhdCxcclxuICAgICAgICBsbmcsXHJcbiAgICAgICAgbGF0X2F1eCxcclxuICAgICAgICBsbmdfYXV4LFxyXG4gICAgICAgIHk7XHJcblxyXG4gICAgLy8gQ29udmVydHMgZGVncmVlcyBkZWMgdG8gc2V4XHJcbiAgICBsYXQgPSBicmVpdGVTZWMgKyBicmVpdGVNaW4qNjAgKyBicmVpdGVHcmFkKjM2MDA7XHJcbiAgICBsbmcgPSBsw6RlbmdlU2VjICsgbMOkbmdlTWluKjYwICsgbMOkbmdlR3JhZCozNjAwO1xyXG5cclxuICAgIC8vIEF4aWxpYXJ5IHZhbHVlcyAoJSBCZXJuKVxyXG4gICAgbGF0X2F1eCA9IChsYXQgLSAxNjkwMjguNjYpLzEwMDAwO1xyXG4gICAgbG5nX2F1eCA9IChsbmcgLSAyNjc4Mi41KS8xMDAwMDtcclxuXHJcbiAgICAvLyBQcm9jZXNzIFlcclxuICAgIHkgPSA2MDAwNzIuMzdcclxuICAgICAgICArIDIxMTQ1NS45MyAqIGxuZ19hdXhcclxuICAgICAgICAtICAxMDkzOC41MSAqIGxuZ19hdXggKiBsYXRfYXV4XHJcbiAgICAgICAgLSAgICAgIDAuMzYgKiBsbmdfYXV4ICogTWF0aC5wb3cobGF0X2F1eCwyKVxyXG4gICAgICAgIC0gICAgIDQ0LjU0ICogTWF0aC5wb3cobG5nX2F1eCwzKTtcclxuXHJcbiAgICByZXR1cm4geTtcclxufTsiXX0=
