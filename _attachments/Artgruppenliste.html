<!DOCTYPE html>
<html>
  <head>
  	<link rel="SHORTCUT ICON" href="Bilder/favicon.ico">
  	<META http-equiv=Content-Type content="text/html; charset=UTF-8"/>
  	<title>EvAB</title>
  	<link rel="stylesheet" href="style/main.css" type="text/css">
  	<link rel="stylesheet" href="style/jquery.mobile.css" type="text/css"/>
  	<link rel="stylesheet" href="style/evab.css" type="text/css"/>
  	<link rel="stylesheet" href="style/jquery.mobile.simpledialog.css" type="text/css"/>
  	<script src="vendor/couchapp/sha1.js" type="text/javascript"></script>
  </head>
  <body>
	<div data-role="page" id="ArtgruppenlistePage">
		<div data-role="header" data-position="fixed">
			<a href="#hArtNeuPage" data-role="button" data-icon="arrow-l" data-rel="dialog" data-iconpos="notext">abbrechen</a>
			<h1>Art-Gruppe wählen</h1>
			<a href='#' id='Menu' name='Menu' data-role='button' data-icon="gear" data-iconpos="notext" class="r ui-btn-right">Menu</a>
		</div>
		<div data-role="content">
			<ul id="ArtgruppenListe" data-role="listview" data-theme="c" data-filter="true" data-filter-placeholder="Filter setzen..." />
		</div>
	</div>  	
  </body>
  <script src="vendor/couchapp/loader.js"></script>
  <script type="text/javascript" src="vendor/couchapp/jquery.mobile.simpledialog.js"></script>
  <script type="text/javascript" charset="utf-8">;
	function handleDocumentReady()
	{
		$db = $.couch.db("evab-ch_barbalex_evab");
		
		userCtx = null;
		$.couch.session({
			success : function(r) {
				var userCtx = r.userCtx;
				User = userCtx.name;
				}
		});

		//UserId ermitteln, um Link zum UserEdit im Menü zu setzen
		var UserId;
		$db.view("evab/User",
			{success: function(data) {
				var i;
				var doc;
				for(i in data.rows) {
					key = data.rows[i].key;
					doc = data.rows[i].value;
					if (key == User) {
						UserId = doc._id;
					}
				}
			}
		});

		//Menu aufbauen
		$("[name='Menu']").live('click', function(){
			MenuAufbauenAusArtListe(this, User, UserId, "");
		});
	
		//transitions ausschalten, weil das auf Android nativ miserabel funktioniert
		$(document).bind("mobileinit", function(){
			defaultDialogTransition = none;
		});
	}
	
	$(document).ready(handleDocumentReady);
  </script>
  <script type="text/javascript" charset="utf-8">	
  
  </script>
</html>
